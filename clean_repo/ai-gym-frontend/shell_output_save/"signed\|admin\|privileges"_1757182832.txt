--
  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:UG}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Xf.connecting:return wl.Connecting;case Xf.open:return wl.Open;case Xf.closing:return wl.Closing;default:return wl.Closed}}isConnected(){return this.connectionState()===wl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new _O(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(HG,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ug.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:o}=r,l=o?`(${o})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yi.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([tY],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:zG};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Yi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new vB(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ug.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,s,o,l,c,u;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Wk,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:ug.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:f=>ZG[f-1]||eY,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(f,d)=>d(JSON.stringify(f)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class OO extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class nY extends OO{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Gk extends OO{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var iY=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const wB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>_p(async()=>{const{default:n}=await Promise.resolve().then(()=>ud);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},sY=()=>iY(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _p(()=>Promise.resolve().then(()=>ud),void 0)).Response:Response}),Yk=t=>{if(Array.isArray(t))return t.map(r=>Yk(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Yk(n)}),e},oY=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var nc=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Mw=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),aY=(t,e,r)=>nc(void 0,void 0,void 0,function*(){const n=yield sY();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const s=t.status||500,o=(i==null?void 0:i.statusCode)||s+"";e(new nY(Mw(i),s,o))}).catch(i=>{e(new Gk(Mw(i),i))}):e(new Gk(Mw(t),t))}),lY=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(oY(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function Op(t,e,r,n,i,s){return nc(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,lY(e,n,i,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>aY(c,l,n))})})}function fy(t,e,r,n){return nc(this,void 0,void 0,function*(){return Op(t,"GET",e,r,n)})}function vs(t,e,r,n,i){return nc(this,void 0,void 0,function*(){return Op(t,"POST",e,n,i,r)})}function Xk(t,e,r,n,i){return nc(this,void 0,void 0,function*(){return Op(t,"PUT",e,n,i,r)})}function cY(t,e,r,n){return nc(this,void 0,void 0,function*(){return Op(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function jB(t,e,r,n,i){return nc(this,void 0,void 0,function*(){return Op(t,"DELETE",e,n,i,r)})}var hn=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const uY={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},sM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dY{constructor(e,r={},n,i){this.url=e,this.headers=r,this.bucketId=n,this.fetch=wB(i)}uploadOrUpdate(e,r,n,i){return hn(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},sM),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),d=yield(e=="PUT"?Xk:vs)(this.fetch,`${this.url}/object/${f}`,s,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(jr(s))return{data:null,error:s};throw s}})}upload(e,r,n){return hn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return hn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:sM.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const d=yield Xk(this.fetch,l.toString(),c,{headers:f});return{data:{path:s,fullPath:d.Key},error:null}}catch(c){if(jr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return hn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield vs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new OO("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}update(e,r,n){return hn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return hn(this,void 0,void 0,function*(){try{return{data:yield vs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}copy(e,r,n){return hn(this,void 0,void 0,function*(){try{return{data:{path:(yield vs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return hn(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield vs(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return hn(this,void 0,void 0,function*(){try{const i=yield vs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}download(e,r){return hn(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield fy(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(jr(l))return{data:null,error:l};throw l}})}info(e){return hn(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield fy(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Yk(n),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}exists(e){return hn(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield cY(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(jr(n)&&n instanceof Gk){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(e){return hn(this,void 0,void 0,function*(){try{return{data:yield jB(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}list(e,r,n){return hn(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},uY),r),{prefix:e||""});return{data:yield vs(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}listV2(e,r){return hn(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield vs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const fY="2.11.0",hY={"X-Client-Info":`storage-js/${fY}`};var zc=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class pY{constructor(e,r={},n,i){const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},hY),r),this.fetch=wB(n)}listBuckets(){return zc(this,void 0,void 0,function*(){try{return{data:yield fy(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(jr(e))return{data:null,error:e};throw e}})}getBucket(e){return zc(this,void 0,void 0,function*(){try{return{data:yield fy(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return zc(this,void 0,void 0,function*(){try{return{data:yield vs(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return zc(this,void 0,void 0,function*(){try{return{data:yield Xk(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}emptyBucket(e){return zc(this,void 0,void 0,function*(){try{return{data:yield vs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}deleteBucket(e){return zc(this,void 0,void 0,function*(){try{return{data:yield jB(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}}class mY extends pY{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new dY(this.url,this.headers,e,this.fetch)}}const gY="2.56.0";let Df="";typeof Deno<"u"?Df="deno":typeof document<"u"?Df="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Df="react-native":Df="node";const yY={"X-Client-Info":`supabase-js-${Df}/${gY}`},vY={headers:yY},xY={schema:"public"},bY={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wY={};var jY=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const SY=t=>{let e;return t?e=t:typeof fetch>"u"?e=fB:e=fetch,(...r)=>e(...r)},NY=()=>typeof Headers>"u"?hB:Headers,kY=(t,e,r)=>{const n=SY(r),i=NY();return(s,o)=>jY(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},o),{headers:u}))})};var _Y=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};function OY(t){return t.endsWith("/")?t:t+"/"}function EY(t,e){var r,n;const{db:i,auth:s,realtime:o,global:l}=t,{db:c,auth:u,realtime:f,global:d}=e,p={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},f),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>_Y(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}const SB="2.71.1",nu=30*1e3,Jk=3,Rw=Jk*nu,CY="http://localhost:9999",AY="supabase.auth.token",TY={"X-Client-Info":`gotrue-js/${SB}`},Qk="X-Supabase-Api-Version",NB={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},PY=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,MY=10*60*1e3;class EO extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function nt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class RY extends EO{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function IY(t){return nt(t)&&t.name==="AuthApiError"}class kB extends EO{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Ba extends EO{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class na extends Ba{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function DY(t){return nt(t)&&t.name==="AuthSessionMissingError"}class dg extends Ba{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fg extends Ba{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class hg extends Ba{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function LY(t){return nt(t)&&t.name==="AuthImplicitGrantRedirectError"}class oM extends Ba{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zk extends Ba{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Iw(t){return nt(t)&&t.name==="AuthRetryableFetchError"}class aM extends Ba{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class e_ extends Ba{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lM=` 	
\r=`.split(""),$Y=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<lM.length;e+=1)t[lM[e].charCodeAt(0)]=-2;for(let e=0;e<hy.length;e+=1)t[hy[e].charCodeAt(0)]=e;return t})();function cM(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(hy[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(hy[n]),e.queuedBits-=6}}function _B(t,e,r){const n=$Y[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function uM(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{qY(o,n,r)};for(let o=0;o<t.length;o+=1)_B(t.charCodeAt(o),i,s);return e.join("")}function BY(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function FY(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}BY(n,e)}}function qY(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function zY(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)_B(t.charCodeAt(i),r,n);return new Uint8Array(e)}function UY(t){const e=[];return FY(t,r=>e.push(r)),new Uint8Array(e)}function HY(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>cM(i,r,n)),cM(null,r,n),e.join("")}function WY(t){return Math.round(Date.now()/1e3)+t}function VY(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Ki=()=>typeof window<"u"&&typeof document<"u",ll={tested:!1,writable:!1},OB=()=>{if(!Ki())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ll.tested)return ll.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ll.tested=!0,ll.writable=!0}catch{ll.tested=!0,ll.writable=!1}return ll.writable};function KY(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const EB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>_p(async()=>{const{default:n}=await Promise.resolve().then(()=>ud);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},GY=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",iu=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},cl=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Jo=async(t,e)=>{await t.removeItem(e)};class O0{constructor(){this.promise=new O0.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}O0.promiseConstructor=Promise;function Dw(t){const e=t.split(".");if(e.length!==3)throw new e_("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!PY.test(e[n]))throw new e_("JWT not in base64url format");return{header:JSON.parse(uM(e[0])),payload:JSON.parse(uM(e[1])),signature:zY(e[2]),raw:{header:e[0],payload:e[1]}}}async function YY(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function XY(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function JY(t){return("0"+t.toString(16)).substr(-2)}function QY(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,JY).join("")}async function ZY(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function eX(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await ZY(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Uc(t,e,r=!1){const n=QY();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await iu(t,`${e}-code-verifier`,i);const s=await eX(n);return[s,n===s?"plain":"s256"]}const tX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rX(t){const e=t.headers.get(Qk);if(!e||!e.match(tX))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function nX(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function iX(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sX=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hc(t){if(!sX.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Lw(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function dM(t){return JSON.parse(JSON.stringify(t))}var oX=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const yl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),aX=[502,503,504];async function fM(t){var e;if(!GY(t))throw new Zk(yl(t),0);if(aX.includes(t.status))throw new Zk(yl(t),t.status);let r;try{r=await t.json()}catch(s){throw new kB(yl(s),s)}let n;const i=rX(t);if(i&&i.getTime()>=NB["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new aM(yl(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new na}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new aM(yl(r),t.status,r.weak_password.reasons);throw new RY(yl(r),t.status||500,n)}const lX=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function dt(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Qk]||(s[Qk]=NB["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await cX(t,e,r+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function cX(t,e,r,n,i,s){const o=lX(e,n,i,s);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new Zk(yl(c),0)}if(l.ok||await fM(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await fM(c)}}function Zs(t){var e;let r=null;hX(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=WY(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function hM(t){const e=Zs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function fa(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function uX(t){return{data:t,error:null}}function dX(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,o=oX(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function fX(t){return t}function hX(t){return t.access_token&&t.refresh_token&&t.expires_in}const $w=["global","local","others"];var pX=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class mX{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=EB(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=$w[0]){if($w.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$w.join(", ")}`);try{return await dt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(nt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:fa})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=pX(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:dX,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(nt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await dt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:fa})}catch(r){if(nt(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},f=await dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:fX});if(f.error)throw f.error;const d=await f.json(),p=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const y=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);u[`${v}Page`]=y}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(nt(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Hc(e);try{return await dt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:fa})}catch(r){if(nt(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Hc(e);try{return await dt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:fa})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Hc(e);try{return await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:fa})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Hc(e.userId);try{const{data:r,error:n}=await dt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Hc(e.userId),Hc(e.id);try{return{data:await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(nt(r))return{data:null,error:r};throw r}}}function pM(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function gX(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Wc={debug:!!(globalThis&&OB()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class CB extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class yX extends CB{}async function vX(t,e,r){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new yX(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Wc.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}gX();const xX={url:CY,storageKey:AY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:TY,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function mM(t,e,r){return await r()}const Vc={};class wh{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wh.nextInstanceID,wh.nextInstanceID+=1,this.instanceID>0&&Ki()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},xX),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new mX({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=EB(i.fetch),this.lock=i.lock||mM,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Ki()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=vX:this.lock=mM,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:OB()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pM(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=pM(this.memoryStorage)),Ki()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Vc[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Vc[this.storageKey]=Object.assign(Object.assign({},Vc[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Vc[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Vc[this.storageKey]=Object.assign(Object.assign({},Vc[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${SB}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=KY(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ki()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),LY(s)){const c=(e=s.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return nt(r)?{error:r}:{error:new kB("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Zs}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(nt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:f,password:d,options:p}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Uc(this.storage,this.storageKey)),s=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:f,password:d,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:x},xform:Zs})}else if("phone"in e){const{phone:f,password:d,options:p}=e;s=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Zs})}else throw new fg("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(nt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:o,options:l}=e;r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:hM})}else if("phone"in e){const{phone:s,password:o,options:l}=e;r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:hM})}else throw new fg("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new dg}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,i,s,o,l,c,u,f,d,p,m;let x,y;if("message"in e)x=e.message,y=e.signature;else{const{chain:v,wallet:b,statement:w,options:N}=e;let j;if(Ki())if(typeof b=="object")j=b;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))j=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=b}const k=new URL((r=N==null?void 0:N.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const _=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let E;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")E=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)E=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)x=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),y=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${k.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(i=(n=N==null?void 0:N.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=N==null?void 0:N.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((d=(f=N==null?void 0:N.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...N.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const _=await j.signMessage(new TextEncoder().encode(x),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=_}}try{const{data:v,error:b}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:HY(y)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Zs});if(b)throw b;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new dg}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:b})}catch(v){if(nt(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const r=await cl(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:o}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Zs});if(await Jo(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new dg}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(nt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:o}=e,l=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Zs}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new dg}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,s,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await Uc(this.storage,this.storageKey));const{error:d}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:f}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f}}throw new fg("You must provide either an email or phone number.")}catch(l){if(nt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Zs});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(nt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Uc(this.storage,this.storageKey)),await dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:uX})}catch(s){if(nt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new na;const{error:i}=await dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(nt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await dt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:l}=await dt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new fg("You must provide either an email or phone number and a type")}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await cl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Rw:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await cl(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Lw()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,f)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,f))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:fa}):await this._useSession(async r=>{var n,i,s;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new na}:await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:fa})})}catch(r){if(nt(r))return DY(r)&&(await this._removeSession(),await Jo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new na;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Uc(this.storage,this.storageKey));const{data:u,error:f}=await dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:fa});if(f)throw f;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new na;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:o}=Dw(e.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(nt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new na;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Ki())throw new hg("No browser detected.");if(e.error||e.error_description||e.error_code)throw new hg(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new oM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hg("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new oM("No code detected.");const{data:w,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!s||!l||!o||!u)throw new hg("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(l);let p=f+d;c&&(p=parseInt(c));const m=p-f;m*1e3<=nu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const x=p-d;f-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,p,f):f-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,p,f);const{data:y,error:v}=await this._getUser(s);if(v)throw v;const b={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:p,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(nt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await cl(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(IY(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Jo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=VY(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Uc(this.storage,this.storageKey,!0));try{return await dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(nt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var o,l,c,u,f;const{data:d,error:p}=s;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await dt(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return Ki()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(nt(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)throw o;return await dt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await XY(async i=>(i>0&&await YY(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Zs})),(i,s)=>{const o=200*Math.pow(2,i);return s&&Iw(s)&&Date.now()+o-n<nu})}catch(n){if(this._debug(r,"error",n),nt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Ki()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await cl(this.storage,this.storageKey);if(i&&this.userStorage){let o=await cl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await iu(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Lw()}else if(i&&!i.user&&!i.user){const o=await cl(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Jo(this.storage,this.storageKey+"-user"),await iu(this.storage,this.storageKey,i)):i.user=Lw()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Rw;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Rw}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Iw(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new na;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new O0;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new na;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),nt(s)){const o={session:null,error:s};return Iw(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){s.push(c)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await iu(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=dM(i);await iu(this.storage,this.storageKey,s)}else{const i=dM(r);await iu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Jo(this.storage,this.storageKey),await Jo(this.storage,this.storageKey+"-code-verifier"),await Jo(this.storage,this.storageKey+"-user"),this.userStorage&&await Jo(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ki()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),nu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/nu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${nu}ms, refresh threshold is ${Jk} ticks`),i<=Jk&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof CB)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ki()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await Uc(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await dt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await dt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(nt(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(nt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Dw(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const f=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+MY>i)return n;const{data:s,error:o}=await dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};n=m.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:c}}=Dw(n);r!=null&&r.allowExpired||nX(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:i,signature:o},error:null}}const f=iX(i.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,o,UY(`${l}.${c}`)))throw new e_("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(nt(n))return{data:null,error:n};throw n}}}wh.nextInstanceID=0;const bX=wh;class wX extends bX{constructor(e){super(e)}}var jX=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class SX{constructor(e,r,n){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=OY(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:xY,realtime:wY,auth:Object.assign(Object.assign({},bY),{storageKey:u}),global:vY},d=EY(n??{},f);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=kY(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new BG(new URL("rest/v1",c).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new mY(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new CG(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return jX(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:o,lock:l,debug:c},u,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wX({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,flowType:o,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new rY(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const NX=(t,e,r)=>new SX(t,e,r);function kX(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}kX()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const _X="https://givgsxytkbsdrlmoxzkp.supabase.co",OX="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA",pe=NX(_X,OX),xn={ai_agent:{label:"AI Agents",color:"#3B82F6",description:"Intelligent AI agents with custom prompts"},video:{label:"Videos",color:"#EF4444",description:"Educational videos with transcriptions"},document:{label:"Documents",color:"#10B981",description:"Rich text documents and guides"},prompt:{label:"Prompts",color:"#8B5CF6",description:"Reusable prompt templates"},automation:{label:"Automations",color:"#F59E0B",description:"Process automations and workflows"}},AB=O.createContext(void 0);function Ln(){const t=O.useContext(AB);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function EX({children:t}){const[e,r]=O.useState(null),[n,i]=O.useState(null),[s,o]=O.useState(!0),[l,c]=O.useState(!1),u=O.useRef(!0),f=O.useRef(null);O.useEffect(()=>{const y=setTimeout(()=>{u.current&&(console.warn("Auth loading timeout reached - switching to production auth"),c(!0),o(!1))},1e4);return()=>clearTimeout(y)},[]);const d=O.useCallback(async y=>{console.log("🔍 Fetching admin data for user:",y);try{const{data:v,error:b}=await pe.from("admins").select("*").eq("id",y).maybeSingle();return console.log("🔍 Admin query result:",{data:v,error:b}),b?(console.error("❌ Admin lookup error:",b),null):(v?console.log("✅ Admin data found:",v):console.log("❌ No admin data found for user:",y),v)}catch(v){return console.error("❌ Admin fetch failed with exception:",v),null}},[]);O.useEffect(()=>{let y=!0;const v=new AbortController;(async()=>{var N;try{o(!0);const{data:{user:j},error:k}=await pe.auth.getUser();if(!y)return;k&&!((N=k.message)!=null&&N.includes("Auth session missing"))&&console.error("Auth initialization error:",k);const _=j||null;if(r(_),_){const E=await d(_.id);y&&i(E)}else i(null);y&&o(!1)}catch(j){console.error("Auth initialization failed:",j),y&&(r(null),i(null),o(!1))}})();const{data:{subscription:w}}=pe.auth.onAuthStateChange(async(N,j)=>{var _;if(!y)return;console.log("Auth state change:",N,(_=j==null?void 0:j.user)==null?void 0:_.id);const k=(j==null?void 0:j.user)||null;if(console.log("🔄 Processing auth state change:",{event:N,userId:k==null?void 0:k.id}),r(k),k){console.log("👤 User authenticated, fetching admin data...");try{const E=await d(k.id);y&&(console.log("✅ Setting admin data:",E),i(E))}catch(E){console.error("❌ Failed to fetch admin data:",E),y&&i(null)}}else console.log("❌ No user, clearing admin data"),i(null);y&&o(!1)});return()=>{y=!1,v.abort(),w.unsubscribe()}},[d]),O.useEffect(()=>()=>{u.current=!1,f.current&&clearTimeout(f.current)},[]);const p=O.useCallback(async(y,v)=>{try{o(!0);const{error:b}=await pe.auth.signInWithPassword({email:y,password:v});return b?(o(!1),{error:b.message}):{}}catch{return o(!1),{error:"Sign in failed"}}},[]),m=O.useCallback(async()=>{try{o(!0),await pe.auth.signOut()}catch(y){console.error("Sign out error:",y),o(!1)}},[]),x=O.useMemo(()=>({user:e,admin:n,loading:s,signIn:p,signOut:m}),[e==null?void 0:e.id,n==null?void 0:n.id,s,p,m]);return a.jsx(AB.Provider,{value:x,children:t})}/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var CX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
--
 */const SM=ke("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=ke("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);class Nh extends Z.Component{constructor(r){super(r);vf(this,"retryCount",0);vf(this,"maxRetries",3);vf(this,"handleRetry",()=>{this.retryCount<this.maxRetries?(this.retryCount++,console.log(`🔄 Error Boundary Retry Attempt ${this.retryCount}/${this.maxRetries}`),this.setState({hasError:!1,error:null,errorId:Date.now().toString(36)})):(console.warn("⚠️ Max retry attempts reached, manual intervention required"),window.location.reload())});vf(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorId:Date.now().toString(36)}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorId:Date.now().toString(36)}}componentDidCatch(r,n){var i,s;console.group("🚨 Error Boundary Caught Error"),console.error("Error:",r),console.error("Error Info:",n),console.error("Component Stack:",n.componentStack),console.groupEnd(),(s=(i=this.props).onError)==null||s.call(i,r,n),console.warn("Production error reporting not configured")}render(){var r,n,i,s,o,l;if(this.state.hasError){if(this.props.fallback){const f=this.props.fallback;return a.jsx(f,{error:this.state.error,retry:this.handleRetry})}const c=(n=(r=this.state.error)==null?void 0:r.message)==null?void 0:n.includes("Maximum update depth exceeded"),u=((s=(i=this.state.error)==null?void 0:i.message)==null?void 0:s.includes("navigate"))||((l=(o=this.state.error)==null?void 0:o.message)==null?void 0:l.includes("router"));return a.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:a.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:a.jsxs("div",{className:"bg-white py-8 px-4 shadow-lg sm:rounded-lg sm:px-10",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(Pl,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:c?"System Stability Error":u?"Navigation Error":"Something went wrong"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:c?"The application encountered a rendering loop. This has been automatically contained.":u?"There was an issue with page navigation. You can safely continue using the application.":"An unexpected error occurred, but the system remains stable."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{onClick:this.handleRetry,disabled:this.retryCount>=this.maxRetries,className:"w-full flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(IO,{className:"h-4 w-4 mr-2"}),this.retryCount>=this.maxRetries?"Max Retries Reached":`Try Again (${this.retryCount}/${this.maxRetries})`]}),a.jsxs("button",{onClick:this.handleGoHome,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(PO,{className:"h-4 w-4 mr-2"}),"Go to Dashboard"]})]}),!1]})})})}return this.props.children}}function HB(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=HB(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function it(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=HB(t))&&(n&&(n+=" "),n+=e);return n}const LO="-",GX=t=>{const e=XX(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const l=o.split(LO);return l[0]===""&&l.length!==1&&l.shift(),WB(l,e)||YX(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},WB=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?WB(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(LO);return(o=e.validators.find(({validator:l})=>l(s)))==null?void 0:o.classGroupId},kM=/^\[(.+)\]$/,YX=t=>{if(kM.test(t)){const e=kM.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},XX=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return QX(Object.entries(t.classGroups),r).forEach(([s,o])=>{o_(o,n,s,e)}),n},o_=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:_M(e,i);s.classGroupId=r;return}if(typeof i=="function"){if(JX(i)){o_(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([s,o])=>{o_(o,_M(e,s),r,n)})})},_M=(t,e)=>{let r=t;return e.split(LO).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},JX=t=>t.isThemeGetter,QX=(t,e)=>e?t.map(([r,n])=>{const i=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,l])=>[e+o,l])):s);return[r,i]}):t,ZX=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(s,o)=>{r.set(s,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(s){let o=r.get(s);if(o!==void 0)return o;if((o=n.get(s))!==void 0)return i(s,o),o},set(s,o){r.has(s)?r.set(s,o):i(s,o)}}},VB="!",eJ=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],s=e.length,o=l=>{const c=[];let u=0,f=0,d;for(let v=0;v<l.length;v++){let b=l[v];if(u===0){if(b===i&&(n||l.slice(v,v+s)===e)){c.push(l.slice(f,v)),f=v+s;continue}if(b==="/"){d=v;continue}}b==="["?u++:b==="]"&&u--}const p=c.length===0?l:l.substring(f),m=p.startsWith(VB),x=m?p.substring(1):p,y=d&&d>f?d-f:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:y}};return r?l=>r({className:l,parseClassName:o}):o},tJ=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},rJ=t=>({cache:ZX(t.cacheSize),parseClassName:eJ(t),...GX(t)}),nJ=/\s+/,iJ=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,s=[],o=t.trim().split(nJ);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:f,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:m}=r(u);let x=!!m,y=n(x?p.substring(0,m):p);if(!y){if(!x){l=u+(l.length>0?" "+l:l);continue}if(y=n(p),!y){l=u+(l.length>0?" "+l:l);continue}x=!1}const v=tJ(f).join(":"),b=d?v+VB:v,w=b+y;if(s.includes(w))continue;s.push(w);const N=i(y,x);for(let j=0;j<N.length;++j){const k=N[j];s.push(b+k)}l=u+(l.length>0?" "+l:l)}return l};function sJ(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=KB(e))&&(n&&(n+=" "),n+=r);return n}const KB=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=KB(t[n]))&&(r&&(r+=" "),r+=e);return r};function oJ(t,...e){let r,n,i,s=o;function o(c){const u=e.reduce((f,d)=>d(f),t());return r=rJ(u),n=r.cache.get,i=r.cache.set,s=l,l(c)}function l(c){const u=n(c);if(u)return u;const f=iJ(c,r);return i(c,f),f}return function(){return s(sJ.apply(null,arguments))}}const qt=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},GB=/^\[(?:([a-z-]+):)?(.+)\]$/i,aJ=/^\d+\/\d+$/,lJ=new Set(["px","full","screen"]),cJ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uJ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dJ=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,fJ=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,hJ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Gs=t=>gu(t)||lJ.has(t)||aJ.test(t),Qo=t=>fd(t,"length",wJ),gu=t=>!!t&&!Number.isNaN(Number(t)),qw=t=>fd(t,"number",gu),bf=t=>!!t&&Number.isInteger(Number(t)),pJ=t=>t.endsWith("%")&&gu(t.slice(0,-1)),st=t=>GB.test(t),Zo=t=>cJ.test(t),mJ=new Set(["length","size","percentage"]),gJ=t=>fd(t,mJ,YB),yJ=t=>fd(t,"position",YB),vJ=new Set(["image","url"]),xJ=t=>fd(t,vJ,SJ),bJ=t=>fd(t,"",jJ),wf=()=>!0,fd=(t,e,r)=>{const n=GB.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},wJ=t=>uJ.test(t)&&!dJ.test(t),YB=()=>!1,jJ=t=>fJ.test(t),SJ=t=>hJ.test(t),NJ=()=>{const t=qt("colors"),e=qt("spacing"),r=qt("blur"),n=qt("brightness"),i=qt("borderColor"),s=qt("borderRadius"),o=qt("borderSpacing"),l=qt("borderWidth"),c=qt("contrast"),u=qt("grayscale"),f=qt("hueRotate"),d=qt("invert"),p=qt("gap"),m=qt("gradientColorStops"),x=qt("gradientColorStopPositions"),y=qt("inset"),v=qt("margin"),b=qt("opacity"),w=qt("padding"),N=qt("saturate"),j=qt("scale"),k=qt("sepia"),_=qt("skew"),E=qt("space"),A=qt("translate"),T=()=>["auto","contain","none"],M=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",st,e],R=()=>[st,e],L=()=>["",Gs,Qo],$=()=>["auto",gu,st],F=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],q=()=>["","0",st],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[gu,st];return{cacheSize:500,separator:":",theme:{colors:[wf],spacing:[Gs,Qo],blur:["none","",Zo,st],brightness:D(),borderColor:[t],borderRadius:["none","","full",Zo,st],borderSpacing:R(),borderWidth:L(),contrast:D(),grayscale:q(),hueRotate:D(),invert:q(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[pJ,Qo],inset:P(),margin:P(),opacity:D(),padding:R(),saturate:D(),scale:D(),sepia:q(),skew:D(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",st]}],container:["container"],columns:[{columns:[Zo]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...F(),st]}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bf,st]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",st]}],grow:[{grow:q()}],shrink:[{shrink:q()}],order:[{order:["first","last","none",bf,st]}],"grid-cols":[{"grid-cols":[wf]}],"col-start-end":[{col:["auto",{span:["full",bf,st]},st]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[wf]}],"row-start-end":[{row:["auto",{span:[bf,st]},st]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",st]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",st]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",st,e]}],"min-w":[{"min-w":[st,e,"min","max","fit"]}],"max-w":[{"max-w":[st,e,"none","full","min","max","fit","prose",{screen:[Zo]},Zo]}],h:[{h:[st,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[st,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[st,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[st,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Zo,Qo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qw]}],"font-family":[{font:[wf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",st]}],"line-clamp":[{"line-clamp":["none",gu,qw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Gs,st]}],"list-image":[{"list-image":["none",st]}],"list-style-type":[{list:["none","disc","decimal",st]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Gs,Qo]}],"underline-offset":[{"underline-offset":["auto",Gs,st]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",st]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",st]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...F(),yJ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gJ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},xJ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:z()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Gs,st]}],"outline-w":[{outline:[Gs,Qo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[Gs,Qo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Zo,bJ]}],"shadow-color":[{shadow:[wf]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Zo,st]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[N]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",st]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",st]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",st]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[bf,st]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",st]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",st]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",st]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Gs,Qo,qw]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},kJ=oJ(NJ);function ge(...t){return kJ(it(t))}function cr({size:t="md",className:e}){const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return a.jsx("div",{className:ge("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",r[t],e)})}function ft({children:t,requireAdmin:e=!1}){const{user:r,admin:n,loading:i}=Ln(),[s,o]=O.useState(!1),l=O.useRef(null),c=O.useRef(!0);if(O.useEffect(()=>(i?l.current=setTimeout(()=>{c.current&&(console.warn("ProtectedRoute: Loading timeout reached - authentication may have failed"),o(!0))},15e3):(l.current&&(clearTimeout(l.current),l.current=null),o(!1)),()=>{l.current&&clearTimeout(l.current)}),[i]),O.useEffect(()=>()=>{c.current=!1,l.current&&clearTimeout(l.current)},[]),i&&!s)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Verifying authentication..."})]})});if(s)return console.warn("ProtectedRoute: Authentication timeout - redirecting to login"),a.jsx(da,{to:"/login",replace:!0});if(!r)return a.jsx(da,{to:"/login",replace:!0});if(e){if(console.log("🔒 Checking admin access:",{user:!!r,admin:n,loading:i}),n===null)return console.log("❌ Access denied - user is not an admin"),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."}),a.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["User ID: ",r==null?void 0:r.id]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Admin Status: ",n===null?"Not Admin":n===void 0?"Loading...":"Admin"]}),a.jsx("button",{onClick:()=>window.location.href="/login",className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Return to Login"})]})});if(n===void 0)return console.log("⏳ Admin status still loading..."),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Verifying admin permissions..."})]})});console.log("✅ Admin access granted:",n)}return a.jsx(a.Fragment,{children:t})}function _J(){var y,v;const[t,e]=O.useState(""),[r,n]=O.useState(""),[i,s]=O.useState(!1),[o,l]=O.useState(""),[c,u]=O.useState(!1),{user:f,signIn:d}=Ln(),m=((v=(y=rc().state)==null?void 0:y.from)==null?void 0:v.pathname)||"/dashboard";if(f)return a.jsx(da,{to:m,replace:!0});const x=async b=>{b.preventDefault(),l(""),u(!0);const{error:w}=await d(t,r);w&&l(w),u(!1)};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center mb-4",children:a.jsx(Ou,{className:"h-8 w-8 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"AI GYM"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Training Zone Access Portal"})]}),a.jsx("div",{className:"bg-white shadow-lg rounded-xl border border-gray-200 p-8",children:a.jsxs("form",{className:"space-y-6",onSubmit:x,children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:b=>e(b.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"admin@example.com",disabled:c})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"password",name:"password",type:i?"text":"password",autoComplete:"current-password",required:!0,value:r,onChange:b=>n(b.target.value),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",disabled:c}),a.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!i),disabled:c,children:i?a.jsx(TO,{className:"h-5 w-5 text-gray-400"}):a.jsx(ii,{className:"h-5 w-5 text-gray-400"})})]})]}),o&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-red-800",children:o})}),a.jsx("button",{type:"submit",disabled:c,className:"w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?a.jsxs(a.Fragment,{children:[a.jsx(cr,{size:"sm",className:"mr-2"}),"Signing in..."]}):"Sign In"})]})})]})})}function OJ(){var d;const{admin:t,signOut:e}=Ln(),[r,n]=O.useState(!1),[i,s]=O.useState(!1),o=rc(),l=[{name:"Dashboard",href:"/dashboard",icon:PO},{name:"Clients",href:"/clients",icon:Ou},{name:"Users",href:"/users",icon:oi},{name:"Tags",href:"/tags",icon:Es},{name:"Training Zone",href:"/training-zone",icon:Sh}],c=[{name:"AI Agents",href:"/content/ai-agents",icon:Kr,color:"#3B82F6"},{name:"Videos",href:"/content/videos",icon:si,color:"#EF4444"},{name:"Documents",href:"/content/documents",icon:Ot,color:"#10B981"},{name:"Prompts",href:"/content/prompts",icon:Gr,color:"#8B5CF6"},{name:"Automations",href:"/content/automations",icon:Ei,color:"#F59E0B"}],u=async()=>{await e()},f=o.pathname.startsWith("/content");return a.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsxs(Qn,{to:"/dashboard",className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center",children:a.jsx(Ou,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"AI GYM"}),a.jsx("p",{className:"text-xs text-gray-500",children:"by AI Workify"})]})]})}),a.jsxs("nav",{className:"hidden md:flex space-x-8",children:[l.map(p=>{const m=o.pathname===p.href,x=p.icon;return a.jsxs(Qn,{to:p.href,className:`inline-flex items-center space-x-1 px-1 pt-1 text-sm font-medium transition-colors ${m?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[a.jsx(x,{className:"h-4 w-4"}),a.jsx("span",{children:p.name})]},p.name)}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!i),className:`inline-flex items-center space-x-1 px-1 pt-1 text-sm font-medium transition-colors ${f?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Ot,{className:"h-4 w-4"}),a.jsx("span",{children:"Content"}),a.jsx(mo,{className:"h-3 w-3"})]}),i&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),a.jsx("div",{className:"absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:a.jsxs("div",{className:"py-2",children:[a.jsx("div",{className:"px-3 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Repositories"}),c.map(p=>{const m=p.icon,x=o.pathname===p.href;return a.jsxs(Qn,{to:p.href,className:`flex items-center px-3 py-2 text-sm transition-colors ${x?"bg-blue-50 text-blue-700 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[a.jsx(m,{className:"mr-3 h-4 w-4",style:{color:p.color}}),p.name]},p.name)})]})})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>n(!r),className:"flex items-center space-x-3 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-sm font-medium",children:t==null?void 0:t.email.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"hidden md:block text-left",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.email}),a.jsx("p",{className:"text-xs text-gray-500 capitalize",children:(d=t==null?void 0:t.role)==null?void 0:d.replace("_"," ")})]}),a.jsx(mo,{className:"h-4 w-4 text-gray-400"})]})}),r&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:a.jsxs("div",{className:"py-1",children:[a.jsxs(Qn,{to:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>n(!1),children:[a.jsx(Dn,{className:"mr-3 h-4 w-4"}),"Settings"]}),a.jsxs("button",{onClick:u,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[a.jsx(LB,{className:"mr-3 h-4 w-4"}),"Sign Out"]})]})})]})]})]})})})}function pr({children:t}){return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(OJ,{}),a.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:t})]})}var zw,OM;function $n(){if(OM)return zw;OM=1;var t=Array.isArray;return zw=t,zw}var Uw,EM;function XB(){if(EM)return Uw;EM=1;var t=typeof ag=="object"&&ag&&ag.Object===Object&&ag;return Uw=t,Uw}var Hw,CM;function Is(){if(CM)return Hw;CM=1;var t=XB(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return Hw=r,Hw}var Ww,AM;function Ap(){if(AM)return Ww;AM=1;var t=Is(),e=t.Symbol;return Ww=e,Ww}var Vw,TM;function EJ(){if(TM)return Vw;TM=1;var t=Ap(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function s(o){var l=r.call(o,i),c=o[i];try{o[i]=void 0;var u=!0}catch{}var f=n.call(o);return u&&(l?o[i]=c:delete o[i]),f}return Vw=s,Vw}var Kw,PM;function CJ(){if(PM)return Kw;PM=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return Kw=r,Kw}var Gw,MM;function _o(){if(MM)return Gw;MM=1;var t=Ap(),e=EJ(),r=CJ(),n="[object Null]",i="[object Undefined]",s=t?t.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?e(l):r(l)}return Gw=o,Gw}var Yw,RM;function Oo(){if(RM)return Yw;RM=1;function t(e){return e!=null&&typeof e=="object"}return Yw=t,Yw}var Xw,IM;function hd(){if(IM)return Xw;IM=1;var t=_o(),e=Oo(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return Xw=n,Xw}var Jw,DM;function $O(){if(DM)return Jw;DM=1;var t=$n(),e=hd(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){if(t(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||e(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Jw=i,Jw}var Qw,LM;function Fa(){if(LM)return Qw;LM=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return Qw=t,Qw}var Zw,$M;function BO(){if($M)return Zw;$M=1;var t=_o(),e=Fa(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var c=t(l);return c==n||c==i||c==r||c==s}return Zw=o,Zw}var e1,BM;function AJ(){if(BM)return e1;BM=1;var t=Is(),e=t["__core-js_shared__"];return e1=e,e1}var t1,FM;function TJ(){if(FM)return t1;FM=1;var t=AJ(),e=function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!e&&e in n}return t1=r,t1}var r1,qM;function JB(){if(qM)return r1;qM=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return r1=r,r1}var n1,zM;function PJ(){if(zM)return n1;zM=1;var t=BO(),e=TJ(),r=Fa(),n=JB(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,f=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!r(p)||e(p))return!1;var m=t(p)?f:s;return m.test(n(p))}return n1=d,n1}var i1,UM;function MJ(){if(UM)return i1;UM=1;function t(e,r){return e==null?void 0:e[r]}return i1=t,i1}var s1,HM;function ic(){if(HM)return s1;HM=1;var t=PJ(),e=MJ();function r(n,i){var s=e(n,i);return t(s)?s:void 0}return s1=r,s1}var o1,WM;function A0(){if(WM)return o1;WM=1;var t=ic(),e=t(Object,"create");return o1=e,o1}var a1,VM;function RJ(){if(VM)return a1;VM=1;var t=A0();function e(){this.__data__=t?t(null):{},this.size=0}return a1=e,a1}var l1,KM;function IJ(){if(KM)return l1;KM=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return l1=t,l1}var c1,GM;function DJ(){if(GM)return c1;GM=1;var t=A0(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(s){var o=this.__data__;if(t){var l=o[s];return l===e?void 0:l}return n.call(o,s)?o[s]:void 0}return c1=i,c1}var u1,YM;function LJ(){if(YM)return u1;YM=1;var t=A0(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var s=this.__data__;return t?s[i]!==void 0:r.call(s,i)}return u1=n,u1}var d1,XM;function $J(){if(XM)return d1;XM=1;var t=A0(),e="__lodash_hash_undefined__";function r(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=t&&i===void 0?e:i,this}return d1=r,d1}var f1,JM;function BJ(){if(JM)return f1;JM=1;var t=RJ(),e=IJ(),r=DJ(),n=LJ(),i=$J();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,f1=s,f1}var h1,QM;function FJ(){if(QM)return h1;QM=1;function t(){this.__data__=[],this.size=0}return h1=t,h1}var p1,ZM;function FO(){if(ZM)return p1;ZM=1;function t(e,r){return e===r||e!==e&&r!==r}return p1=t,p1}var m1,eR;function T0(){if(eR)return m1;eR=1;var t=FO();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return m1=e,m1}var g1,tR;function qJ(){if(tR)return g1;tR=1;var t=T0(),e=Array.prototype,r=e.splice;function n(i){var s=this.__data__,o=t(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return g1=n,g1}var y1,rR;function zJ(){if(rR)return y1;rR=1;var t=T0();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return y1=e,y1}var v1,nR;function UJ(){if(nR)return v1;nR=1;var t=T0();function e(r){return t(this.__data__,r)>-1}return v1=e,v1}var x1,iR;function HJ(){if(iR)return x1;iR=1;var t=T0();function e(r,n){var i=this.__data__,s=t(i,r);return s<0?(++this.size,i.push([r,n])):i[s][1]=n,this}return x1=e,x1}var b1,sR;function P0(){if(sR)return b1;sR=1;var t=FJ(),e=qJ(),r=zJ(),n=UJ(),i=HJ();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,b1=s,b1}var w1,oR;function qO(){if(oR)return w1;oR=1;var t=ic(),e=Is(),r=t(e,"Map");return w1=r,w1}var j1,aR;function WJ(){if(aR)return j1;aR=1;var t=BJ(),e=P0(),r=qO();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return j1=n,j1}var S1,lR;function VJ(){if(lR)return S1;lR=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return S1=t,S1}var N1,cR;function M0(){if(cR)return N1;cR=1;var t=VJ();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return N1=e,N1}var k1,uR;function KJ(){if(uR)return k1;uR=1;var t=M0();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return k1=e,k1}var _1,dR;function GJ(){if(dR)return _1;dR=1;var t=M0();function e(r){return t(this,r).get(r)}return _1=e,_1}var O1,fR;function YJ(){if(fR)return O1;fR=1;var t=M0();function e(r){return t(this,r).has(r)}return O1=e,O1}var E1,hR;function XJ(){if(hR)return E1;hR=1;var t=M0();function e(r,n){var i=t(this,r),s=i.size;return i.set(r,n),this.size+=i.size==s?0:1,this}return E1=e,E1}var C1,pR;function zO(){if(pR)return C1;pR=1;var t=WJ(),e=KJ(),r=GJ(),n=YJ(),i=XJ();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,C1=s,C1}var A1,mR;function QB(){if(mR)return A1;mR=1;var t=zO(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var u=n.apply(this,o);return s.cache=c.set(l,u)||c,u};return s.cache=new(r.Cache||t),s}return r.Cache=t,A1=r,A1}var T1,gR;function JJ(){if(gR)return T1;gR=1;var t=QB(),e=500;function r(n){var i=t(n,function(o){return s.size===e&&s.clear(),o}),s=i.cache;return i}return T1=r,T1}var P1,yR;function QJ(){if(yR)return P1;yR=1;var t=JJ(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(e,function(o,l,c,u){s.push(c?u.replace(r,"$1"):l||o)}),s});return P1=n,P1}var M1,vR;function UO(){if(vR)return M1;vR=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,s=Array(i);++n<i;)s[n]=r(e[n],n,e);return s}return M1=t,M1}var R1,xR;function ZJ(){if(xR)return R1;xR=1;var t=Ap(),e=UO(),r=$n(),n=hd(),i=t?t.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return e(l,o)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return R1=o,R1}var I1,bR;function ZB(){if(bR)return I1;bR=1;var t=ZJ();function e(r){return r==null?"":t(r)}return I1=e,I1}var D1,wR;function eF(){if(wR)return D1;wR=1;var t=$n(),e=$O(),r=QJ(),n=ZB();function i(s,o){return t(s)?s:e(s,o)?[s]:r(n(s))}return D1=i,D1}var L1,jR;function R0(){if(jR)return L1;jR=1;var t=hd();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return L1=e,L1}var $1,SR;function HO(){if(SR)return $1;SR=1;var t=eF(),e=R0();function r(n,i){i=t(i,n);for(var s=0,o=i.length;n!=null&&s<o;)n=n[e(i[s++])];return s&&s==o?n:void 0}return $1=r,$1}var B1,NR;function tF(){if(NR)return B1;NR=1;var t=HO();function e(r,n,i){var s=r==null?void 0:t(r,n);return s===void 0?i:s}return B1=e,B1}var eQ=tF();const ei=ht(eQ);var F1,kR;function tQ(){if(kR)return F1;kR=1;function t(e){return e==null}return F1=t,F1}var rQ=tQ();const tt=ht(rQ);var q1,_R;function nQ(){if(_R)return q1;_R=1;var t=_o(),e=$n(),r=Oo(),n="[object String]";function i(s){return typeof s=="string"||!e(s)&&r(s)&&t(s)==n}return q1=i,q1}var iQ=nQ();const Tp=ht(iQ);var sQ=BO();const Ze=ht(sQ);var oQ=Fa();const pd=ht(oQ);var z1={exports:{}},xt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
--
              id,
              name,
              color
            )
          )
        `).eq("client_id",t).order("created_at",{ascending:!1});if(ye)throw ye;const Te=(ie==null?void 0:ie.map(Le=>{var ue;return{...Le,tags:((ue=Le.user_tag_assignments)==null?void 0:ue.map(he=>he.user_tags))||[]}}))||[];L(Te)}catch(ie){console.error("Error loading users:",ie)}},[t]);O.useEffect(()=>{U()},[U]),O.useEffect(()=>{o==="tags"?ee():o==="users"&&Q()},[o,ee,Q]);const H=(ie,ye)=>{d(Te=>({...Te,[ie]:ye})),m(!0)},Y=async()=>{if(r){u(!0);try{const{error:ie}=await pe.from("clients").update({name:f.name,project_name:f.project_name||null,brand_color:f.brand_color,forum_enabled:f.forum_enabled}).eq("id",r.id);if(ie)throw ie;n(ye=>ye?{...ye,...f}:null),m(!1),alert("Settings saved successfully!")}catch(ie){console.error("Error saving settings:",ie),alert("Error saving settings")}finally{u(!1)}}},re=async ie=>{var Le;const ye=x[ie],Te=!ye.enabled;try{if(ye.id){const{error:he}=await pe.from("client_features").update({enabled:Te}).eq("id",ye.id);if(he)throw he}else{const{data:he,error:we}=await pe.from("client_features").insert({client_id:t,feature_name:ye.feature_name,enabled:Te}).select().single();if(we)throw we;y(Oe=>Oe.map((be,We)=>We===ie?{...be,id:he.id,enabled:Te}:be));return}y(he=>he.map((we,Oe)=>Oe===ie?{...we,enabled:Te}:we));const ue=((Le=HN.find(he=>he.key===ye.feature_name))==null?void 0:Le.label)||ye.feature_name;alert(`${ue} ${Te?"enabled":"disabled"}`)}catch(ue){console.error("Error toggling feature:",ue),alert("Error updating feature")}},J=async()=>{if(!(!w.trim()||!t))try{const{data:ie,error:ye}=await pe.functions.invoke("manage-user-tags",{body:{client_id:t,action:"create",tag_data:{name:w.trim(),color:j}}});if(ye)throw ye;b(Te=>[...Te,{...ie,user_count:0}]),N(""),k("#3B82F6")}catch(ie){console.error("Error creating tag:",ie),alert("Error creating tag")}},ne=async()=>{if(!(!A||M!==A.name))try{const{error:ie}=await pe.functions.invoke("manage-user-tags",{body:{client_id:t,action:"delete",tag_data:{id:A.id}}});if(ie)throw ie;b(ye=>ye.filter(Te=>Te.id!==A.id)),T(null),P(""),Q()}catch(ie){console.error("Error deleting tag:",ie),alert("Error deleting tag")}},te=R.filter(ie=>{var Le,ue;const ye=((Le=ie.first_name)==null?void 0:Le.toLowerCase().includes($.toLowerCase()))||((ue=ie.last_name)==null?void 0:ue.toLowerCase().includes($.toLowerCase()))||ie.email.toLowerCase().includes($.toLowerCase()),Te=z==="all"||ie.tags.some(he=>he.id===z);return ye&&Te}),se=ie=>new Date(ie).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ve=()=>{switch(o){case"settings":return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),a.jsx("input",{type:"text",value:f.name,onChange:ie=>H("name",ie.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter client name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name"}),a.jsx("input",{type:"text",value:f.project_name,onChange:ie=>H("project_name",ie.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional project name"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand Color"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-md border border-gray-300 cursor-pointer",style:{backgroundColor:f.brand_color},onClick:()=>{const ie=document.createElement("input");ie.type="color",ie.value=f.brand_color,ie.onchange=ye=>{H("brand_color",ye.target.value)},ie.click()}}),a.jsx("input",{type:"text",value:f.brand_color,onChange:ie=>H("brand_color",ie.target.value),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono",placeholder:"#3B82F6"})]})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:f.forum_enabled,onChange:ie=>H("forum_enabled",ie.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Forum"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Allow users to participate in community discussions"})]})]})}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsxs("button",{onClick:Y,disabled:!p||c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[c&&a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx(Cp,{size:16}),a.jsx("span",{children:"Save Changes"})]})})]});case"features":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"Control which platform features are available to this client's users."}),HN.map((ie,ye)=>{const Te=x.find(ue=>ue.feature_name===ie.key),Le=(Te==null?void 0:Te.enabled)??!0;return a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900",children:ie.label}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ie.description})]}),a.jsxs("button",{onClick:()=>re(ye),className:`flex items-center space-x-2 px-3 py-2 rounded-md transition-colors ${Le?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[Le?a.jsx(WX,{size:20}):a.jsx(jM,{size:20}),a.jsx("span",{className:"text-sm font-medium",children:Le?"Enabled":"Disabled"})]})]},ie.key)})]});case"tags":return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Create New Tag"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"text",value:w,onChange:ie=>N(ie.target.value),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tag name"}),a.jsx("div",{className:"w-10 h-10 rounded-md border border-gray-300 cursor-pointer",style:{backgroundColor:j},onClick:()=>{const ie=document.createElement("input");ie.type="color",ie.value=j,ie.onchange=ye=>{k(ye.target.value)},ie.click()}}),a.jsxs("button",{onClick:J,disabled:!w.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[a.jsx(Vt,{size:16}),a.jsx("span",{children:"Create Tag"})]})]})]}),a.jsx("div",{className:"space-y-3",children:v.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Es,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No tags created yet"}),a.jsx("p",{className:"text-sm",children:"Create your first tag above"})]}):v.map(ie=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-white text-sm font-medium",style:{backgroundColor:ie.color},children:ie.name}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",ie.user_count," users)"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>E(ie),className:"text-gray-400 hover:text-blue-600 transition-colors",children:a.jsx(C0,{size:16})}),a.jsx("button",{onClick:()=>T(ie),className:"text-gray-400 hover:text-red-600 transition-colors",children:a.jsx(ns,{size:16})})]})]},ie.id))}),A&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(Pl,{className:"text-red-500 mr-3",size:24}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Tag"})]}),a.jsxs("p",{className:"text-gray-600 mb-4",children:['This will permanently delete the tag "',A.name,'" and remove it from all ',A.user_count," assigned users."]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type the tag name to confirm:"}),a.jsx("input",{type:"text",value:M,onChange:ie=>P(ie.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:A.name})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{T(null),P("")},className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:ne,disabled:M!==A.name,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete Tag"})]})]})})]});case"users":return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(In,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:$,onChange:ie=>F(ie.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search users..."})]}),a.jsxs("select",{value:z,onChange:ie=>W(ie.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Tags"}),v.map(ie=>a.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),a.jsxs("button",{onClick:()=>q(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[a.jsx(Ir,{size:20}),a.jsx("span",{children:"Upload CSV"})]})]}),a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:te.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(oi,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:$||z!=="all"?"Try adjusting your search criteria.":"Start by uploading users via CSV or create them manually."}),!$&&z==="all"&&a.jsx("button",{onClick:()=>q(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Upload First Users"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:te.map(ie=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[ie.first_name," ",ie.last_name]}),a.jsx("div",{className:"text-sm text-gray-500",children:ie.email})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[ie.tags.map(ye=>a.jsx("span",{className:"inline-block px-2 py-1 text-xs text-white rounded-full",style:{backgroundColor:ye.color},children:ye.name},ye.id)),ie.tags.length===0&&a.jsx("span",{className:"text-sm text-gray-400",children:"No tags"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ie.last_active?se(ie.last_active):"Never"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:se(ie.created_at)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:a.jsx("button",{onClick:()=>e(`/users/${ie.id}`),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"View Details",children:a.jsx(ii,{size:16})})})]},ie.id))})]})})})]});default:return null}};return i?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex items-center justify-between py-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e("/clients"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(lo,{size:24})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[r.logo_url?a.jsx("img",{src:r.logo_url,alt:r.name,className:"w-12 h-12 rounded-full object-cover border border-gray-200"}):a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold",style:{backgroundColor:r.brand_color},children:r.name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.name}),r.project_name&&a.jsx("p",{className:"text-gray-600",children:r.project_name})]})]})]})})})}),a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("nav",{className:"flex space-x-8",children:[{id:"settings",label:"Settings",icon:Dn},{id:"features",label:"Enabled Features",icon:jM},{id:"tags",label:"Tag Management",icon:Es},{id:"users",label:"User Management",icon:oi}].map(ie=>{const ye=ie.icon;return a.jsxs("button",{onClick:()=>l(ie.id),className:`flex items-center space-x-2 px-1 py-4 border-b-2 font-medium text-sm transition-colors ${o===ie.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(ye,{size:18}),a.jsx("span",{children:ie.label})]},ie.id)})})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:ve()})}),a.jsx(jge,{isOpen:K,onClose:()=>q(!1),clientId:t,onUploadComplete:()=>{Q(),ee()}})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Client not found"}),a.jsx("button",{onClick:()=>e("/clients"),className:"mt-4 text-blue-600 hover:text-blue-800",children:"Back to Clients"})]})},Nge=()=>{const{userId:t}=us(),e=Ti(),[r,n]=O.useState(null),[i,s]=O.useState(!0),[o,l]=O.useState("overview"),[c,u]=O.useState([]),[f,d]=O.useState([]),[p,m]=O.useState([]),[x,y]=O.useState({totalActivities:0,contentCompleted:0,avgScore:0,streakDays:0,totalTimeSpent:0}),v=O.useCallback(async()=>{var T;if(t)try{const{data:M,error:P}=await pe.from("users").select(`
          *,
          clients!inner(
            id,
            name,
            logo_url,
--
          content_categories (
            id,
            name,
            color
          )
        `).order("created_at",{ascending:!1});if(k)throw k;e(j||[])}catch(j){console.error("Error fetching articles:",j)}finally{s(!1)}},y=async()=>{try{const{data:j,error:k}=await pe.from("content_categories").select("*").order("name");if(k)throw k;n(j||[])}catch(j){console.error("Error fetching categories:",j)}},v=async j=>{if(confirm("Are you sure you want to delete this article?"))try{const{error:k}=await pe.from("content_articles").delete().eq("id",j);if(k)throw k;await x()}catch(k){console.error("Error deleting article:",k)}},b=t.filter(j=>{var A;const k=j.title.toLowerCase().includes(o.toLowerCase())||j.author.toLowerCase().includes(o.toLowerCase()),_=c==="all"||((A=j.category_id)==null?void 0:A.toString())===c,E=f==="all"||j.status===f;return k&&_&&E}),w=j=>{const _={draft:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Draft"},published:{bg:"bg-green-100",text:"text-green-800",label:"Published"},archived:{bg:"bg-gray-100",text:"text-gray-800",label:"Archived"}}[j];return a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.bg} ${_.text}`,children:_.label})},N=j=>j?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(j)):"-";return i?a.jsx(pr,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):a.jsx(pr,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Articles Management"}),a.jsx("p",{className:"text-gray-600",children:"Create and manage your content articles"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:()=>m(!p),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Ep,{className:"h-4 w-4 mr-2"}),"Filters"]}),a.jsxs(Qn,{to:"/content/articles/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Add New Article"]})]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 space-y-4",children:[a.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search articles by title or author...",value:o,onChange:j=>l(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})})}),p&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),a.jsxs("select",{value:c,onChange:j=>u(j.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),r.map(j=>a.jsx("option",{value:j.id.toString(),children:j.name},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:f,onChange:j=>d(j.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"published",children:"Published"}),a.jsx("option",{value:"archived",children:"Archived"})]})]})]})]}),a.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center",children:[a.jsx(Ot,{className:"mx-auto h-12 w-12 text-gray-300"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No articles found"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o||c!=="all"||f!=="all"?"Try adjusting your search or filters.":"Get started by creating your first article."})]})}):b.map(j=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 mb-1",children:j.title}),j.excerpt&&a.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:j.excerpt})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.content_categories?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:j.content_categories.color}}),a.jsx("span",{className:"text-sm text-gray-900",children:j.content_categories.name})]}):a.jsx("span",{className:"text-sm text-gray-500",children:"Uncategorized"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(zB,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:j.author})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:w(j.status)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Fl,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:N(j.created_at)})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx(Qn,{to:`/content/articles/${j.id}/edit`,className:"text-blue-600 hover:text-blue-900 p-1",children:a.jsx(ii,{className:"h-4 w-4"})}),a.jsx(Qn,{to:`/content/articles/${j.id}/edit`,className:"text-indigo-600 hover:text-indigo-900 p-1",children:a.jsx(yo,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>v(j.id),className:"text-red-600 hover:text-red-900 p-1",children:a.jsx(ns,{className:"h-4 w-4"})})]})})]},j.id))})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ot,{className:"h-8 w-8 text-blue-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Articles"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.length})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ii,{className:"h-8 w-8 text-green-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Published"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(j=>j.status==="published").length})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(yo,{className:"h-8 w-8 text-yellow-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Drafts"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(j=>j.status==="draft").length})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Es,{className:"h-8 w-8 text-purple-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Categories"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.length})]})]})})]})]})})}function A5(){const{id:t}=us(),e=Ti(),r=!!t,[n,i]=O.useState({title:"",content:"",excerpt:"",author:"Admin User",category_id:null,status:"draft",tags:[],featured_image_url:"",slug:"",seo_title:"",seo_description:""}),[s,o]=O.useState([]),[l,c]=O.useState(!1),[u,f]=O.useState(!1),[d,p]=O.useState(""),[m,x]=O.useState("content"),[y,v]=O.useState(null);O.useEffect(()=>{b(),r&&w()},[t]);const b=async()=>{try{const{data:T,error:M}=await pe.from("content_categories").select("*").order("name");if(M)throw M;o(T||[])}catch(T){console.error("Error fetching categories:",T)}},w=async()=>{if(t)try{c(!0);const{data:T,error:M}=await pe.from("content_articles").select("*").eq("id",parseInt(t)).single();if(M)throw M;T&&i({...T,tags:T.tags||[]})}catch(T){console.error("Error fetching article:",T)}finally{c(!1)}},N=T=>T.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),j=T=>{i(M=>({...M,title:T,slug:M.slug||N(T),seo_title:M.seo_title||T}))},k=()=>{d.trim()&&!n.tags.includes(d.trim())&&(i(T=>({...T,tags:[...T.tags,d.trim()]})),p(""))},_=T=>{i(M=>({...M,tags:M.tags.filter(P=>P!==T)}))},E=(T,M)=>{v({message:T,type:M}),setTimeout(()=>{v(null)},3e3)},A=async(T=!1)=>{try{f(!0);const M={...n,status:T?"published":n.status,published_at:T?new Date().toISOString():null,updated_at:new Date().toISOString()};if(r){const{error:P}=await pe.from("content_articles").update(M).eq("id",parseInt(t));if(P)throw P;E(T?"Article published successfully!":"Article saved successfully!","success"),setTimeout(()=>{e("/content/articles")},1500)}else{const{data:P,error:R}=await pe.from("content_articles").insert([M]).select().single();if(R)throw R;E(T?"Article published successfully!":"Article created successfully!","success"),setTimeout(()=>{P?e(`/content/articles/${P.id}/edit`,{replace:!0}):e("/content/articles")},1500)}}catch(M){console.error("Error saving article:",M),E("Failed to save article. Please try again.","error")}finally{f(!1)}};return l?a.jsx(pr,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):a.jsxs(pr,{children:[y&&a.jsx("div",{className:"fixed top-4 right-4 z-50 transition-all duration-500 ease-in-out transform translate-x-0 opacity-100",children:a.jsx("div",{className:`max-w-sm w-full ${y.type==="success"?"bg-green-500":"bg-red-500"} shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5`,children:a.jsx("div",{className:"flex-1 w-0 p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("p",{className:"text-sm font-medium text-white",children:y.message})}),a.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:a.jsxs("button",{className:"bg-transparent rounded-md inline-flex text-white hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-white",onClick:()=>v(null),children:[a.jsx("span",{className:"sr-only",children:"Close"}),a.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})})}),a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e("/content/articles"),className:"p-2 hover:bg-gray-100 rounded-md",children:a.jsx(lo,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Article":"Create New Article"}),a.jsx("p",{className:"text-gray-600",children:"Write and publish your content"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:()=>A(!1),disabled:u,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[a.jsx(Cp,{className:"h-4 w-4 mr-2"}),"Save Draft"]}),a.jsxs("button",{onClick:()=>A(!0),disabled:u,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[a.jsx(ii,{className:"h-4 w-4 mr-2"}),"Publish"]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsx("button",{onClick:()=>x("content"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="content"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Content"}),a.jsx("button",{onClick:()=>x("settings"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Settings"}),a.jsx("button",{onClick:()=>x("seo"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="seo"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"SEO"})]})}),m==="content"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",value:n.title,onChange:T=>j(T.target.value),placeholder:"Enter article title...",className:"w-full text-2xl font-bold border-0 border-b border-gray-200 focus:border-blue-500 focus:ring-0 px-0 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excerpt"}),a.jsx("textarea",{value:n.excerpt,onChange:T=>i(M=>({...M,excerpt:T.target.value})),placeholder:"Brief description of the article...",rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content *"}),a.jsx("textarea",{value:n.content,onChange:T=>i(M=>({...M,content:T.target.value})),placeholder:"Write your article content here...",rows:20,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",required:!0}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You can use HTML tags for formatting."})]})]}),m==="settings"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),a.jsxs("select",{value:n.category_id||"",onChange:T=>i(M=>({...M,category_id:T.target.value?parseInt(T.target.value):null})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"No Category"}),s.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Author"}),a.jsx("input",{type:"text",value:n.author,onChange:T=>i(M=>({...M,author:T.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:n.status,onChange:T=>i(M=>({...M,status:T.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"published",children:"Published"}),a.jsx("option",{value:"archived",children:"Archived"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Slug"}),a.jsx("input",{type:"text",value:n.slug,onChange:T=>i(M=>({...M,slug:T.target.value})),placeholder:"article-url-slug",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Featured Image URL"}),a.jsx("input",{type:"url",value:n.featured_image_url,onChange:T=>i(M=>({...M,featured_image_url:T.target.value})),placeholder:"https://example.com/image.jpg",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:n.tags.map((T,M)=>a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[T,a.jsx("button",{type:"button",onClick:()=>_(T),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full hover:bg-blue-200",children:"×"})]},M))}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"text",value:d,onChange:T=>p(T.target.value),onKeyPress:T=>T.key==="Enter"&&k(),placeholder:"Add a tag...",className:"flex-1 border border-gray-300 rounded-l-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 border border-l-0 border-gray-300 bg-gray-50 rounded-r-md hover:bg-gray-100",children:"Add"})]})]})]}),m==="seo"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SEO Title"}),a.jsx("input",{type:"text",value:n.seo_title,onChange:T=>i(M=>({...M,seo_title:T.target.value})),placeholder:"SEO optimized title...",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Recommended: 50-60 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SEO Description"}),a.jsx("textarea",{value:n.seo_description,onChange:T=>i(M=>({...M,seo_description:T.target.value})),placeholder:"Meta description for search engines...",rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Recommended: 150-160 characters"})]})]})]})]})}function qp({contentType:t,title:e,description:r,icon:n,color:i}){const s=Ti(),[o,l]=O.useState([]),[c,u]=O.useState([]),[f,d]=O.useState(!0),[p,m]=O.useState(null),[x,y]=O.useState({}),v=O.useRef(!0),b=O.useRef(""),[w,N]=O.useState({search:"",clients:[],status:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:"cards"}),[j,k]=O.useState(!1),_=O.useMemo(()=>JSON.stringify({contentType:t,search:w.search,clients:w.clients.sort(),status:w.status,sortBy:w.sortBy,sortOrder:w.sortOrder}),[t,w.search,w.clients,w.status,w.sortBy,w.sortOrder]),E=O.useCallback(async()=>{if(!v.current)return;const z=_;if(b.current!==z)try{d(!0),m(null),b.current=z;let W=pe.from("content_items").select("*").eq("content_type",t);w.search.trim()&&(W=W.or(`title.ilike.%${w.search}%,description.ilike.%${w.search}%`)),w.status!=="all"&&(W=W.eq("status",w.status)),W=W.order(w.sortBy,{ascending:w.sortOrder==="asc"});const{data:K,error:q}=await W;if(!v.current)return;if(q){console.error("Error fetching content items:",q),m("Failed to load content items"),l([]);return}let V=K||[];if(w.clients.length>0){const{data:D,error:U}=await pe.from("content_client_assignments").select("content_item_id").in("client_id",w.clients);if(U)console.error("Error fetching assignments:",U);else if(D){const G=D.map(ee=>ee.content_item_id);V=V.filter(ee=>G.includes(ee.id))}}if(!v.current)return;if(l(V),V.length>0){const D=V.map(Q=>Q.id),[U,G]=await Promise.all([pe.from("content_client_assignments").select("content_item_id").in("content_item_id",D),pe.from("content_user_assignments").select("content_item_id").in("content_item_id",D)]),ee={};D.forEach(Q=>{var re,J;const H=((re=U.data)==null?void 0:re.filter(ne=>ne.content_item_id===Q).length)||0,Y=((J=G.data)==null?void 0:J.filter(ne=>ne.content_item_id===Q).length)||0;ee[Q]=H+Y}),v.current&&y(ee)}}catch(W){console.error("Error in fetchData:",W),v.current&&(m("Failed to load content"),l([]))}finally{v.current&&d(!1)}},[t,_,w.search,w.clients,w.status,w.sortBy,w.sortOrder]),A=O.useCallback(async()=>{try{const{data:z,error:W}=await pe.from("clients").select("*").eq("status","active").order("name");W?console.error("Error fetching clients:",W):z&&v.current&&u(z)}catch(z){console.error("Error fetching clients:",z)}},[]);O.useEffect(()=>{E()},[E]),O.useEffect(()=>{A()},[A]),O.useEffect(()=>()=>{v.current=!1},[]);const T=O.useCallback(()=>({ai_agent:"ai-agents",video:"videos",document:"documents",prompt:"prompts",automation:"automations"})[t]||t,[t]),M=O.useCallback(()=>{const z=T();s(`/content/${z}/create`)},[s,T]),P=O.useCallback(z=>{const W=T();s(`/content/${W}/${z}/edit`)},[s,T]),R=O.useCallback((z,W)=>{N(K=>({...K,[z]:W}))},[]),L=O.useCallback(()=>{N(z=>({search:"",clients:[],status:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:z.viewMode}))},[]),$=O.useCallback(z=>a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${z==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:z==="published"?a.jsxs(a.Fragment,{children:[a.jsx(ii,{className:"h-3 w-3 mr-1"})," Published"]}):a.jsxs(a.Fragment,{children:[a.jsx(TO,{className:"h-3 w-3 mr-1"})," Draft"]})}),[]),F=O.useCallback(z=>new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[]);return p&&!f?a.jsx(pr,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-red-500 mb-4",children:a.jsx(n,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Content"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:p}),a.jsx("button",{onClick:()=>{m(null),E()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})})}):a.jsx(pr,{children:a.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[a.jsxs("div",{className:`transition-all duration-300 ${j?"w-80":"w-12"} bg-white border-r border-gray-200 flex flex-col shadow-sm`,children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("button",{onClick:()=>k(!j),className:"flex items-center justify-center w-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(Ep,{className:"h-5 w-5"}),j&&a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Filters"})]})}),j&&a.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Content"}),a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",placeholder:"Search by title or description...",value:w.search,onChange:z=>R("search",z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),a.jsxs("select",{value:w.status,onChange:z=>R("status",z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"published",children:"Published Only"}),a.jsx("option",{value:"draft",children:"Drafts Only"})]})]}),c.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Clients"}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:c.map(z=>a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:w.clients.includes(z.id),onChange:W=>{W.target.checked?R("clients",[...w.clients,z.id]):R("clients",w.clients.filter(K=>K!==z.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:z.brand_color}}),a.jsx("span",{className:"text-sm text-gray-900",children:z.name})]})]},z.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Content"}),a.jsxs("select",{value:`${w.sortBy}_${w.sortOrder}`,onChange:z=>{const[W,K]=z.target.value.split("_");R("sortBy",W),R("sortOrder",K)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[a.jsx("option",{value:"updated_at_desc",children:"Last Updated (Newest)"}),a.jsx("option",{value:"updated_at_asc",children:"Last Updated (Oldest)"}),a.jsx("option",{value:"created_at_desc",children:"Date Created (Newest)"}),a.jsx("option",{value:"created_at_asc",children:"Date Created (Oldest)"}),a.jsx("option",{value:"title_asc",children:"Title (A-Z)"}),a.jsx("option",{value:"title_desc",children:"Title (Z-A)"})]})]}),a.jsx("div",{className:"pt-4 border-t border-gray-200",children:a.jsx("button",{onClick:L,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Clear All Filters"})})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center shadow-sm",style:{backgroundColor:i+"15"},children:a.jsx(n,{className:"h-6 w-6",style:{color:i}})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r}),a.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[a.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," ",o.length===1?"item":"items"]}),w.status!=="all"&&a.jsxs("span",{className:"text-xs text-gray-500",children:["• Filtered by ",w.status]}),w.clients.length>0&&a.jsxs("span",{className:"text-xs text-gray-500",children:["• ",w.clients.length," client(s)"]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>R("viewMode","cards"),className:`p-2 rounded-md transition-colors ${w.viewMode==="cards"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Card View",children:a.jsx(dd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>R("viewMode","list"),className:`p-2 rounded-md transition-colors ${w.viewMode==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:a.jsx(rs,{className:"h-4 w-4"})})]}),a.jsxs("button",{onClick:M,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all",style:{backgroundColor:i,boxShadow:`0 4px 12px ${i}40`},children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-4 w-4"}),"Create New"]})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:f?a.jsx("div",{className:"flex justify-center items-center py-20",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-3",children:["Loading ",e.toLowerCase(),"..."]})]})}):a.jsx(a.Fragment,{children:o.length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",style:{backgroundColor:i+"10"},children:a.jsx(n,{className:"h-12 w-12",style:{color:i}})}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["No ",e.toLowerCase()," yet"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:w.search||w.status!=="all"||w.clients.length>0?`No ${e.toLowerCase()} match your current filters. Try adjusting your search criteria.`:`Get started by creating your first ${t.replace("_"," ")}.`}),a.jsx("div",{className:"mt-8",children:w.search||w.status!=="all"||w.clients.length>0?a.jsx("button",{onClick:L,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear Filters"}):a.jsxs("button",{onClick:M,className:"inline-flex items-center px-6 py-3 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2",style:{backgroundColor:i},children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-5 w-5"}),"Create ",t.replace("_"," ")]})})]}):a.jsx("div",{className:w.viewMode==="cards"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-3",children:o.map(z=>a.jsx("div",{onClick:()=>P(z.id),className:`${w.viewMode==="cards"?"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md cursor-pointer transition-all hover:scale-105":"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md cursor-pointer transition-all"}`,children:w.viewMode==="cards"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"h-32 bg-gradient-to-br from-opacity-10 to-opacity-20 flex items-center justify-center relative",style:{backgroundColor:i+"08",backgroundImage:`linear-gradient(135deg, ${i}15, ${i}05)`},children:[a.jsx(n,{className:"h-8 w-8",style:{color:i}}),z.thumbnail_url&&a.jsx("img",{src:z.thumbnail_url,alt:z.title,className:"absolute inset-0 w-full h-full object-cover"})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 leading-5",children:z.title}),$(z.status)]}),z.description&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-3 leading-4",children:z.description}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{className:"h-3 w-3"}),a.jsx("span",{children:F(z.updated_at)})]}),x[z.id]>0&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(oi,{className:"h-3 w-3"}),a.jsx("span",{children:x[z.id]})]})]})]})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:i+"15"},children:a.jsx(n,{className:"h-6 w-6",style:{color:i}})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:z.title}),$(z.status)]}),z.description&&a.jsx("p",{className:"text-xs text-gray-600 truncate mt-1",children:z.description}),a.jsx("div",{className:"flex items-center justify-between mt-2",children:a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{className:"h-3 w-3"}),a.jsxs("span",{children:["Updated ",F(z.updated_at)]})]}),x[z.id]>0&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(oi,{className:"h-3 w-3"}),a.jsxs("span",{children:[x[z.id]," assignment",x[z.id]!==1?"s":""]})]})]})})]})]})},z.id))})})})]})]})})}function Ege(){return a.jsx(qp,{contentType:"ai_agent",title:xn.ai_agent.label,description:xn.ai_agent.description,icon:Kr,color:xn.ai_agent.color})}function Cge(){return a.jsx(qp,{contentType:"video",title:xn.video.label,description:xn.video.description,icon:si,color:xn.video.color})}function Age(){return a.jsx(qp,{contentType:"document",title:xn.document.label,description:xn.document.description,icon:Ot,color:xn.document.color})}function Tge(){return a.jsx(qp,{contentType:"prompt",title:xn.prompt.label,description:xn.prompt.description,icon:Gr,color:xn.prompt.color})}function Pge(){return a.jsx(qp,{contentType:"automation",title:xn.automation.label,description:xn.automation.description,icon:Ei,color:xn.automation.color})}function Mge({isOpen:t,onClose:e,client:r,contentItemId:n,onSave:i}){const[s,o]=O.useState([]),[l,c]=O.useState([]),[u,f]=O.useState([]),[d,p]=O.useState([]),[m,x]=O.useState(!1),[y,v]=O.useState(!1);O.useEffect(()=>{t&&b()},[t,r.id]);const b=async()=>{try{x(!0);const{data:N,error:j}=await pe.from("user_tags").select("*").eq("client_id",r.id).order("name");j?console.error("Error fetching tags:",j):N&&f(N);const{data:k,error:_}=await pe.from("users").select("*").eq("client_id",r.id).order("first_name");_?console.error("Error fetching users:",_):k&&p(k);const[E,A]=await Promise.all([pe.from("content_tag_assignments").select("tag_id").eq("content_item_id",n),pe.from("content_user_assignments").select("user_id").eq("content_item_id",n)]);E.data&&o(E.data.map(T=>T.tag_id)),A.data&&c(A.data.map(T=>T.user_id))}catch(N){console.error("Error fetching assignment data:",N)}finally{x(!1)}},w=async()=>{try{v(!0);const{data:{user:N}}=await pe.auth.getUser();if(!N)return;const j=[];u.length>0&&j.push(pe.from("content_tag_assignments").delete().eq("content_item_id",n).in("tag_id",u.map(_=>_.id))),d.length>0&&j.push(pe.from("content_user_assignments").delete().eq("content_item_id",n).in("user_id",d.map(_=>_.id))),await Promise.all(j);const k=[];if(s.length>0){const _=s.map(E=>({content_item_id:n,tag_id:E,assigned_by:N.id}));k.push(pe.from("content_tag_assignments").insert(_))}if(l.length>0){const _=l.map(E=>({content_item_id:n,user_id:E,assigned_by:N.id}));k.push(pe.from("content_user_assignments").insert(_))}await Promise.all(k),i(),e()}catch(N){console.error("Error saving assignments:",N)}finally{v(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-8 w-8 rounded-lg flex items-center justify-center",style:{backgroundColor:r.brand_color+"20"},children:a.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:r.brand_color}})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Assign to ",r.name]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Configure content visibility and access"})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx($r,{className:"h-5 w-5"})})]}),m?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(cr,{size:"md"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading assignment options..."})]}):a.jsxs("div",{className:"p-6 space-y-6",children:[u.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[a.jsx(Es,{className:"h-4 w-4 inline mr-2"}),"Assign to User Tags (",s.length," selected)"]}),a.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:u.map(N=>a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-50 rounded-md",children:[a.jsx("input",{type:"checkbox",checked:s.includes(N.id),onChange:j=>{j.target.checked?o([...s,N.id]):o(s.filter(k=>k!==N.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:N.color}}),a.jsx("span",{className:"text-sm text-gray-900",children:N.name})]})]},N.id))}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Content will be visible to all users with the selected tags"})]}),d.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[a.jsx(oi,{className:"h-4 w-4 inline mr-2"}),"Assign to Specific Users (",l.length," selected)"]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3",children:d.map(N=>a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-50 rounded-md",children:[a.jsx("input",{type:"checkbox",checked:l.includes(N.id),onChange:j=>{j.target.checked?c([...l,N.id]):c(l.filter(k=>k!==N.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[N.first_name," ",N.last_name]}),a.jsx("div",{className:"text-xs text-gray-500",children:N.email})]})]},N.id))}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Content will be visible to the specifically selected users"})]}),u.length===0&&d.length===0&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx(oi,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),a.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"No assignment options"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This client has no users or tags configured. Set up users and tags first."})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[a.jsx("button",{onClick:e,disabled:y,className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),a.jsxs("button",{onClick:w,disabled:y||u.length===0&&d.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[y?a.jsx(cr,{size:"sm",className:"mr-2"}):null,"Save Assignments"]})]})]})}):null}function zp({contentType:t,isEdit:e=!1,children:r,onSaveContent:n,title:i,description:s,color:o,icon:l}){const{id:c}=us(),u=Ti(),{admin:f}=Ln(),[d,p]=O.useState(null),[m,x]=O.useState([]),[y,v]=O.useState([]),[b,w]=O.useState(e),[N,j]=O.useState(!1),[k,_]=O.useState(!1),[E,A]=O.useState(null),[T,M]=O.useState(!1),[P,R]=O.useState(null),[L,$]=O.useState(""),[F,z]=O.useState(""),[W,K]=O.useState("draft"),[q,V]=O.useState(""),D=O.useRef(null),U=O.useCallback(()=>{if(!D.current)return!1;const te=D.current;return L!==te.title||F!==te.description||W!==te.status||q!==te.thumbnailUrl||JSON.stringify(y.slice().sort())!==JSON.stringify(te.assignedClients.slice().sort())},[L,F,W,q,y]);O.useEffect(()=>{const te=setTimeout(()=>{const se=U();se!==k&&_(se)},50);return()=>clearTimeout(te)},[L,F,W,q,y,k,U]),O.useEffect(()=>{let te=!0;return(async()=>{try{R(null),e&&c&&await G(),te&&await ee()}catch(ve){te&&(console.error("Error initializing ContentEditor:",ve),R(ve instanceof Error?ve.message:"Failed to load content"))}})(),()=>{te=!1}},[e,c]);const G=O.useCallback(async()=>{if(c)try{R(null);const{data:te,error:se}=await pe.from("content_items").select("*").eq("id",c).maybeSingle();if(se)throw se;if(!te){console.warn("Content item not found, redirecting to content list"),u("/content",{replace:!0});return}p(te);const ve=te.title||"",ie=te.description||"",ye=te.status||"draft",Te=te.thumbnail_url||"";$(ve),z(ie),K(ye),V(Te);const{data:Le,error:ue}=await pe.from("content_client_assignments").select("client_id").eq("content_item_id",te.id);ue&&console.error("Error fetching client assignments:",ue);const he=Le?Le.map(we=>we.client_id):[];v(he),D.current={title:ve,description:ie,status:ye,thumbnailUrl:Te,assignedClients:he},_(!1)}catch(te){console.error("Error fetching content item:",te),R(te instanceof Error?te.message:"Failed to load content item")}finally{w(!1)}},[c,u]),ee=O.useCallback(async()=>{try{R(null);const{data:te,error:se}=await pe.from("clients").select("*").eq("status","active").order("name");if(se)throw se;x(te||[]),!e&&!D.current&&(D.current={title:"",description:"",status:"draft",thumbnailUrl:"",assignedClients:[]})}catch(te){console.error("Error fetching clients:",te),R(te instanceof Error?te.message:"Failed to load clients")}},[e]),Q=O.useCallback(()=>({ai_agent:"ai-agents",video:"videos",document:"documents",prompt:"prompts",automation:"automations"})[t]||t,[t]),H=O.useCallback(async te=>{if(!f)throw new Error("Admin authentication required");try{const{error:se}=await pe.from("content_client_assignments").delete().eq("content_item_id",te);if(se)throw se;if(y.length>0){const ve=y.map(ye=>({content_item_id:te,client_id:ye,assigned_by:f.id})),{error:ie}=await pe.from("content_client_assignments").insert(ve);if(ie)throw ie}}catch(se){throw console.error("Error saving client assignments:",se),new Error("Failed to save client assignments")}},[f,y]),Y=O.useCallback(async()=>{if(!d||!f){R("Unable to delete: missing content item or admin authentication");return}if(confirm("Are you sure you want to delete this content? This action cannot be undone."))try{j(!0),R(null);const{error:te}=await pe.from("content_items").delete().eq("id",d.id);if(te)throw te;const se=Q();u(`/content/${se}`,{replace:!0})}catch(te){console.error("Error deleting content:",te);const se=te instanceof Error?te.message:"Error deleting content. Please try again.";R(se)}finally{j(!1)}},[d,f,u]),re=O.useCallback(async()=>{if(!f){R("Admin authentication required");return}try{j(!0),R(null);let te=c;const se={title:L.trim(),description:F.trim()||null,content_type:t,status:W,thumbnail_url:q.trim()||null,created_by:f.id,updated_at:new Date().toISOString()};if(e&&te){const{error:ve}=await pe.from("content_items").update(se).eq("id",te);if(ve)throw ve}else{const{data:ve,error:ie}=await pe.from("content_items").insert([{...se,created_at:new Date().toISOString()}]).select().single();if(ie)throw ie;ve&&(te=ve.id,p(ve))}if(n&&te&&await n(te),await H(te),D.current={title:L.trim(),description:F.trim(),status:W,thumbnailUrl:q.trim(),assignedClients:[...y]},_(!1),!e&&te){const ve=Q();u(`/content/${ve}/${te}/edit`,{replace:!0})}}catch(te){console.error("Error saving content:",te);const se=te instanceof Error?te.message:"Error saving content. Please try again.";R(se)}finally{j(!1)}},[f,c,L,F,t,W,q,n,y,e,u]),J=O.useCallback(async()=>{if(!f){R("Admin authentication required");return}try{j(!0),R(null);let te=c;const se={title:L.trim(),description:F.trim()||null,content_type:t,status:W,thumbnail_url:q.trim()||null,created_by:f.id,updated_at:new Date().toISOString()};if(e&&te){const{error:ie}=await pe.from("content_items").update(se).eq("id",te);if(ie)throw ie}else{const{data:ie,error:ye}=await pe.from("content_items").insert([{...se,created_at:new Date().toISOString()}]).select().single();if(ye)throw ye;ie&&(te=ie.id,p(ie))}n&&te&&await n(te),await H(te),_(!1);const ve=Q();u(`/content/${ve}`,{replace:!0})}catch(te){console.error("Error saving content:",te);const se=te instanceof Error?te.message:"Error saving content. Please try again.";R(se)}finally{j(!1)}},[f,c,L,F,t,W,q,n,y,u]),ne=O.useCallback(te=>{v(se=>se.includes(te)?se.filter(ie=>ie!==te):[...se,te])},[]);return b?a.jsx(pr,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading content..."})]})})}):P?a.jsx(pr,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"text-center max-w-md mx-auto",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"text-red-800 mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Content"}),a.jsx("p",{className:"text-sm",children:P})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:()=>{R(null),e&&c&&G(),ee()},className:"w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Try Again"}),a.jsx(Qn,{to:"/content",className:"block w-full px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500 text-center",children:"Back to Content"})]})]})})})}):a.jsx(Nh,{onError:(te,se)=>{console.error("ContentEditor Error Boundary:",te,se),R(`Component Error: ${te.message}`)},children:a.jsx(pr,{children:a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(Qn,{to:`/content/${Q()}`,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(lo,{className:"h-5 w-5"})}),a.jsx("div",{className:"h-8 w-8 rounded-lg flex items-center justify-center",style:{backgroundColor:o+"20"},children:a.jsx(l,{className:"h-5 w-5",style:{color:o}})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:[e?"Edit":"Create"," ",i.slice(0,-1)]}),a.jsx("p",{className:"text-sm text-gray-500",children:s})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[e&&a.jsxs("button",{onClick:Y,disabled:N,className:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:[a.jsx(ns,{className:"h-4 w-4 mr-1"}),"Delete"]}),!e&&a.jsxs("button",{onClick:J,disabled:N||!L.trim(),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[N?a.jsx(cr,{size:"sm",className:"mr-2"}):a.jsx(lo,{className:"h-4 w-4 mr-2"}),N?"Saving...":"Save & Return to List"]}),a.jsxs("button",{onClick:re,disabled:N||!L.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50",style:{backgroundColor:o},children:[N?a.jsx(cr,{size:"sm",className:"mr-2"}):a.jsx(Cp,{className:"h-4 w-4 mr-2"}),N?"Saving...":e?"Update":"Save & Continue Editing"]})]})]})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",id:"title",value:L,onChange:te=>$(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter ${i.slice(0,-1).toLowerCase()} title...`,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{id:"description",rows:3,value:F,onChange:te=>z(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Brief description of this ${i.slice(0,-1).toLowerCase()}...`})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Thumbnail URL"}),a.jsx("input",{type:"url",id:"thumbnail",value:q,onChange:te=>V(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/image.jpg"})]})]})]}),r]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status & Visibility"}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),a.jsxs("select",{value:W,onChange:te=>K(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"draft",children:"📝 Draft"}),a.jsx("option",{value:"published",children:"👁️ Published"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W==="draft"?"Only visible to admin users":"Visible to assigned clients and users"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Client Assignment"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[y.length," of ",m.length]})]}),m.length>0?a.jsx("div",{className:"space-y-3",children:m.map(te=>{const se=y.includes(te.id);return a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:se,onChange:()=>ne(te.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:te.brand_color}}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:te.name})]})]}),se&&a.jsx("button",{onClick:()=>A(te.id),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Configure"})]},te.id)})}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(oi,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"No clients available"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsxs("button",{onClick:()=>M(!T),className:"w-full flex items-center justify-between p-6 text-left",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Dn,{className:"h-5 w-5 text-gray-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Advanced Settings"})]}),T?a.jsx(mo,{className:"h-5 w-5 text-gray-600"}):a.jsx(jh,{className:"h-5 w-5 text-gray-600"})]}),T&&a.jsx("div",{className:"px-6 pb-6 border-t border-gray-200",children:a.jsx("div",{className:"pt-4 space-y-4",children:a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("p",{children:["Content ID: ",a.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:(d==null?void 0:d.id)||"Not created yet"})]}),a.jsxs("p",{children:["Content Type: ",a.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:t})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Created: ",new Date(d.created_at).toLocaleString()]}),a.jsxs("p",{children:["Updated: ",new Date(d.updated_at).toLocaleString()]})]})]})})})]})]})]})}),E&&a.jsx(Nh,{children:a.jsx(Mge,{isOpen:!0,onClose:()=>A(null),client:m.find(te=>te.id===E),contentItemId:(d==null?void 0:d.id)||c,onSave:()=>{}})})]})})})}function Rge(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T5(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function P5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?T5(Object(r),!0).forEach(function(n){Rge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T5(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ige(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Dge(t,e){if(t==null)return{};var r=Ige(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Lge(t,e){return $ge(t)||Bge(t,e)||Fge(t,e)||qge()}function $ge(t){if(Array.isArray(t))return t}function Bge(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,s=void 0;try{for(var o=t[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(e&&r.length===e));n=!0);}catch(c){i=!0,s=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw s}}return r}}function Fge(t,e){if(t){if(typeof t=="string")return M5(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M5(t,e)}}function M5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zge(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R5(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function I5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?R5(Object(r),!0).forEach(function(n){zge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R5(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Uge(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(n){return e.reduceRight(function(i,s){return s(i)},n)}}function Ff(t){return function e(){for(var r=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return e.apply(r,[].concat(i,l))}}}function xv(t){return{}.toString.call(t).includes("Object")}function Hge(t){return!Object.keys(t).length}function ap(t){return typeof t=="function"}function Wge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vge(t,e){return xv(e)||Sa("changeType"),Object.keys(e).some(function(r){return!Wge(t,r)})&&Sa("changeField"),e}function Kge(t){ap(t)||Sa("selectorType")}function Gge(t){ap(t)||xv(t)||Sa("handlerType"),xv(t)&&Object.values(t).some(function(e){return!ap(e)})&&Sa("handlersType")}function Yge(t){t||Sa("initialIsRequired"),xv(t)||Sa("initialType"),Hge(t)&&Sa("initialContent")}function Xge(t,e){throw new Error(t[e]||t.default)}var Jge={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Sa=Ff(Xge)(Jge),Cg={changes:Vge,selector:Kge,handler:Gge,initial:Yge};function Qge(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Cg.initial(t),Cg.handler(e);var r={current:t},n=Ff(tye)(r,e),i=Ff(eye)(r),s=Ff(Cg.changes)(t),o=Ff(Zge)(r);function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return Cg.selector(u),u(r.current)}function c(u){Uge(n,i,s,o)(u)}return[l,c]}function Zge(t,e){return ap(e)?e(t.current):e}function eye(t,e){return t.current=I5(I5({},t.current),e),e}function tye(t,e,r){return ap(e)?e(t.current):Object.keys(r).forEach(function(n){var i;return(i=e[n])===null||i===void 0?void 0:i.call(e,t.current[n])}),r}var rye={create:Qge},nye={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function iye(t){return function e(){for(var r=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return e.apply(r,[].concat(i,l))}}}function sye(t){return{}.toString.call(t).includes("Object")}function oye(t){return t||D5("configIsRequired"),sye(t)||D5("configType"),t.urls?(aye(),{paths:{vs:t.urls.monacoBase}}):t}function aye(){console.warn(w8.deprecation)}function lye(t,e){throw new Error(t[e]||t.default)}var w8={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
--
`)||(H(ue)||he.length()>0&&ue.nextSibling&&H(ue.nextSibling))&&he.insert(`
`),he}function ye(ue,he){if(H(ue)&&ue.nextElementSibling!=null&&!Q(he,`

`)){var we=ue.offsetHeight+parseFloat(ee(ue).marginTop)+parseFloat(ee(ue).marginBottom);ue.nextElementSibling.offsetTop>ue.offsetTop+we*1.5&&he.insert(`
`)}return he}function Te(ue,he){var we={},Oe=ue.style||{};return Oe.fontStyle&&ee(ue).fontStyle==="italic"&&(we.italic=!0),Oe.fontWeight&&(ee(ue).fontWeight.startsWith("bold")||parseInt(ee(ue).fontWeight)>=700)&&(we.bold=!0),Object.keys(we).length>0&&(he=G(he,we)),parseFloat(Oe.textIndent||0)>0&&(he=new d.default().insert("	").concat(he)),he}function Le(ue,he){var we=ue.data;if(ue.parentNode.tagName==="O:P")return he.insert(we.trim());if(we.trim().length===0&&ue.parentNode.classList.contains("ql-clipboard"))return he;if(!ee(ue.parentNode).whiteSpace.startsWith("pre")){var Oe=function(We,Je){return Je=Je.replace(/[^\u00a0]/g,""),Je.length<1&&We?" ":Je};we=we.replace(/\r\n/g," ").replace(/\n/g," "),we=we.replace(/\s\s+/g,Oe.bind(Oe,!0)),(ue.previousSibling==null&&H(ue.parentNode)||ue.previousSibling!=null&&H(ue.previousSibling))&&(we=we.replace(/^\s+/,Oe.bind(Oe,!1))),(ue.nextSibling==null&&H(ue.parentNode)||ue.nextSibling!=null&&H(ue.nextSibling))&&(we=we.replace(/\s+$/,Oe.bind(Oe,!1)))}return he.insert(we)}n.default=U,n.matchAttributor=J,n.matchBlot=ne,n.matchNewline=ie,n.matchSpacing=ye,n.matchText=Le},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(6),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(){return f(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"optimize",value:function(b){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,b),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),y}(c.default);m.blotName="bold",m.tagName=["STRONG","B"],n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function P(R,L){var $=[],F=!0,z=!1,W=void 0;try{for(var K=R[Symbol.iterator](),q;!(F=(q=K.next()).done)&&($.push(q.value),!(L&&$.length===L));F=!0);}catch(V){z=!0,W=V}finally{try{!F&&K.return&&K.return()}finally{if(z)throw W}}return $}return function(R,L){if(Array.isArray(R))return R;if(Symbol.iterator in Object(R))return P(R,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function P(R,L){for(var $=0;$<L.length;$++){var F=L[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(R,F.key,F)}}return function(R,L,$){return L&&P(R.prototype,L),$&&P(R,$),R}}(),l=i(2),c=b(l),u=i(0),f=b(u),d=i(5),p=b(d),m=i(10),x=b(m),y=i(9),v=b(y);function b(P){return P&&P.__esModule?P:{default:P}}function w(P,R,L){return R in P?Object.defineProperty(P,R,{value:L,enumerable:!0,configurable:!0,writable:!0}):P[R]=L,P}function N(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")}function j(P,R){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:P}function k(P,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);P.prototype=Object.create(R&&R.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(P,R):P.__proto__=R)}var _=(0,x.default)("quill:toolbar"),E=function(P){k(R,P);function R(L,$){N(this,R);var F=j(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,L,$));if(Array.isArray(F.options.container)){var z=document.createElement("div");T(z,F.options.container),L.container.parentNode.insertBefore(z,L.container),F.container=z}else typeof F.options.container=="string"?F.container=document.querySelector(F.options.container):F.container=F.options.container;if(!(F.container instanceof HTMLElement)){var W;return W=_.error("Container required for toolbar",F.options),j(F,W)}return F.container.classList.add("ql-toolbar"),F.controls=[],F.handlers={},Object.keys(F.options.handlers).forEach(function(K){F.addHandler(K,F.options.handlers[K])}),[].forEach.call(F.container.querySelectorAll("button, select"),function(K){F.attach(K)}),F.quill.on(p.default.events.EDITOR_CHANGE,function(K,q){K===p.default.events.SELECTION_CHANGE&&F.update(q)}),F.quill.on(p.default.events.SCROLL_OPTIMIZE,function(){var K=F.quill.selection.getRange(),q=s(K,1),V=q[0];F.update(V)}),F}return o(R,[{key:"addHandler",value:function($,F){this.handlers[$]=F}},{key:"attach",value:function($){var F=this,z=[].find.call($.classList,function(K){return K.indexOf("ql-")===0});if(z){if(z=z.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){_.warn("ignoring attaching to disabled format",z,$);return}if(f.default.query(z)==null){_.warn("ignoring attaching to nonexistent format",z,$);return}}var W=$.tagName==="SELECT"?"change":"click";$.addEventListener(W,function(K){var q=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var V=$.options[$.selectedIndex];V.hasAttribute("selected")?q=!1:q=V.value||!1}else $.classList.contains("ql-active")?q=!1:q=$.value||!$.hasAttribute("value"),K.preventDefault();F.quill.focus();var D=F.quill.selection.getRange(),U=s(D,1),G=U[0];if(F.handlers[z]!=null)F.handlers[z].call(F,q);else if(f.default.query(z).prototype instanceof f.default.Embed){if(q=prompt("Enter "+z),!q)return;F.quill.updateContents(new c.default().retain(G.index).delete(G.length).insert(w({},z,q)),p.default.sources.USER)}else F.quill.format(z,q,p.default.sources.USER);F.update(G)}),this.controls.push([z,$])}}},{key:"update",value:function($){var F=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(z){var W=s(z,2),K=W[0],q=W[1];if(q.tagName==="SELECT"){var V=void 0;if($==null)V=null;else if(F[K]==null)V=q.querySelector("option[selected]");else if(!Array.isArray(F[K])){var D=F[K];typeof D=="string"&&(D=D.replace(/\"/g,'\\"')),V=q.querySelector('option[value="'+D+'"]')}V==null?(q.value="",q.selectedIndex=-1):V.selected=!0}else if($==null)q.classList.remove("ql-active");else if(q.hasAttribute("value")){var U=F[K]===q.getAttribute("value")||F[K]!=null&&F[K].toString()===q.getAttribute("value")||F[K]==null&&!q.getAttribute("value");q.classList.toggle("ql-active",U)}else q.classList.toggle("ql-active",F[K]!=null)})}}]),R}(v.default);E.DEFAULTS={};function A(P,R,L){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+R),L!=null&&($.value=L),P.appendChild($)}function T(P,R){Array.isArray(R[0])||(R=[R]),R.forEach(function(L){var $=document.createElement("span");$.classList.add("ql-formats"),L.forEach(function(F){if(typeof F=="string")A($,F);else{var z=Object.keys(F)[0],W=F[z];Array.isArray(W)?M($,z,W):A($,z,W)}}),P.appendChild($)})}function M(P,R,L){var $=document.createElement("select");$.classList.add("ql-"+R),L.forEach(function(F){var z=document.createElement("option");F!==!1?z.setAttribute("value",F):z.setAttribute("selected","selected"),$.appendChild(z)}),P.appendChild($)}E.DEFAULTS={container:null,handlers:{clean:function(){var R=this,L=this.quill.getSelection();if(L!=null)if(L.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(F){f.default.query(F,f.default.Scope.INLINE)!=null&&R.quill.format(F,!1)})}else this.quill.removeFormat(L,p.default.sources.USER)},direction:function(R){var L=this.quill.getFormat().align;R==="rtl"&&L==null?this.quill.format("align","right",p.default.sources.USER):!R&&L==="right"&&this.quill.format("align",!1,p.default.sources.USER),this.quill.format("direction",R,p.default.sources.USER)},indent:function(R){var L=this.quill.getSelection(),$=this.quill.getFormat(L),F=parseInt($.indent||0);if(R==="+1"||R==="-1"){var z=R==="+1"?1:-1;$.direction==="rtl"&&(z*=-1),this.quill.format("indent",F+z,p.default.sources.USER)}},link:function(R){R===!0&&(R=prompt("Enter link URL:")),this.quill.format("link",R,p.default.sources.USER)},list:function(R){var L=this.quill.getSelection(),$=this.quill.getFormat(L);R==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,p.default.sources.USER):this.quill.format("list","unchecked",p.default.sources.USER):this.quill.format("list",R,p.default.sources.USER)}}},n.default=E,n.addControls=T},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(28),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(v,b){f(this,y);var w=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,v));return w.label.innerHTML=b,w.container.classList.add("ql-color-picker"),[].slice.call(w.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(N){N.classList.add("ql-primary")}),w}return s(y,[{key:"buildItem",value:function(b){var w=o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"buildItem",this).call(this,b);return w.style.backgroundColor=b.getAttribute("value")||"",w}},{key:"selectItem",value:function(b,w){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,b,w);var N=this.label.querySelector(".ql-color-label"),j=b&&b.getAttribute("data-value")||"";N&&(N.tagName==="line"?N.style.stroke=j:N.style.fill=j)}}]),y}(c.default);n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(28),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(v,b){f(this,y);var w=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,v));return w.container.classList.add("ql-icon-picker"),[].forEach.call(w.container.querySelectorAll(".ql-picker-item"),function(N){N.innerHTML=b[N.getAttribute("data-value")||""]}),w.defaultItem=w.container.querySelector(".ql-selected"),w.selectItem(w.defaultItem),w}return s(y,[{key:"selectItem",value:function(b,w){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,b,w),b=b||this.defaultItem,this.label.innerHTML=b.innerHTML}}]),y}(c.default);n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function c(u,f){for(var d=0;d<f.length;d++){var p=f[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}}();function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(u,f){var d=this;o(this,c),this.quill=u,this.boundsContainer=f||document.body,this.root=u.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){d.root.style.marginTop=-1*d.quill.root.scrollTop+"px"}),this.hide()}return s(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(f){var d=f.left+f.width/2-this.root.offsetWidth/2,p=f.bottom+this.quill.root.scrollTop;this.root.style.left=d+"px",this.root.style.top=p+"px",this.root.classList.remove("ql-flip");var m=this.boundsContainer.getBoundingClientRect(),x=this.root.getBoundingClientRect(),y=0;if(x.right>m.right&&(y=m.right-x.right,this.root.style.left=d+y+"px"),x.left<m.left&&(y=m.left-x.left,this.root.style.left=d+y+"px"),x.bottom>m.bottom){var v=x.bottom-x.top,b=f.bottom-f.top+v;this.root.style.top=p-b+"px",this.root.classList.add("ql-flip")}return y}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c}();n.default=l},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function M(P,R){var L=[],$=!0,F=!1,z=void 0;try{for(var W=P[Symbol.iterator](),K;!($=(K=W.next()).done)&&(L.push(K.value),!(R&&L.length===R));$=!0);}catch(q){F=!0,z=q}finally{try{!$&&W.return&&W.return()}finally{if(F)throw z}}return L}return function(P,R){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return M(P,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function M(P,R,L){P===null&&(P=Function.prototype);var $=Object.getOwnPropertyDescriptor(P,R);if($===void 0){var F=Object.getPrototypeOf(P);return F===null?void 0:M(F,R,L)}else{if("value"in $)return $.value;var z=$.get;return z===void 0?void 0:z.call(L)}},l=function(){function M(P,R){for(var L=0;L<R.length;L++){var $=R[L];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(P,$.key,$)}}return function(P,R,L){return R&&M(P.prototype,R),L&&M(P,L),P}}(),c=i(3),u=N(c),f=i(8),d=N(f),p=i(43),m=N(p),x=i(27),y=N(x),v=i(15),b=i(41),w=N(b);function N(M){return M&&M.__esModule?M:{default:M}}function j(M,P){if(!(M instanceof P))throw new TypeError("Cannot call a class as a function")}function k(M,P){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:M}function _(M,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);M.prototype=Object.create(P&&P.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(M,P):M.__proto__=P)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],A=function(M){_(P,M);function P(R,L){j(this,P),L.modules.toolbar!=null&&L.modules.toolbar.container==null&&(L.modules.toolbar.container=E);var $=k(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,R,L));return $.quill.container.classList.add("ql-snow"),$}return l(P,[{key:"extendToolbar",value:function(L){L.container.classList.add("ql-snow"),this.buildButtons([].slice.call(L.container.querySelectorAll("button")),w.default),this.buildPickers([].slice.call(L.container.querySelectorAll("select")),w.default),this.tooltip=new T(this.quill,this.options.bounds),L.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,F){L.handlers.link.call(L,!F.format.link)})}}]),P}(m.default);A.DEFAULTS=(0,u.default)(!0,{},m.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(P){if(P){var R=this.quill.getSelection();if(R==null||R.length==0)return;var L=this.quill.getText(R);/^\S+@\S+\.\S+$/.test(L)&&L.indexOf("mailto:")!==0&&(L="mailto:"+L);var $=this.quill.theme.tooltip;$.edit("link",L)}else this.quill.format("link",!1)}}}}});var T=function(M){_(P,M);function P(R,L){j(this,P);var $=k(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,R,L));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(P,[{key:"listen",value:function(){var L=this;o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){L.root.classList.contains("ql-editing")?L.save():L.edit("link",L.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(L.linkRange!=null){var F=L.linkRange;L.restoreFocus(),L.quill.formatText(F,"link",!1,d.default.sources.USER),delete L.linkRange}$.preventDefault(),L.hide()}),this.quill.on(d.default.events.SELECTION_CHANGE,function($,F,z){if($!=null){if($.length===0&&z===d.default.sources.USER){var W=L.quill.scroll.descendant(y.default,$.index),K=s(W,2),q=K[0],V=K[1];if(q!=null){L.linkRange=new v.Range($.index-V,q.length());var D=y.default.formats(q.domNode);L.preview.textContent=D,L.preview.setAttribute("href",D),L.show(),L.position(L.quill.getBounds(L.linkRange));return}}else delete L.linkRange;L.hide()}})}},{key:"show",value:function(){o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),P}(p.BaseTooltip);T.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=A},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=be(s),l=i(36),c=i(38),u=i(64),f=i(65),d=be(f),p=i(66),m=be(p),x=i(67),y=be(x),v=i(37),b=i(26),w=i(39),N=i(40),j=i(56),k=be(j),_=i(68),E=be(_),A=i(27),T=be(A),M=i(69),P=be(M),R=i(70),L=be(R),$=i(71),F=be($),z=i(72),W=be(z),K=i(73),q=be(K),V=i(13),D=be(V),U=i(74),G=be(U),ee=i(75),Q=be(ee),H=i(57),Y=be(H),re=i(41),J=be(re),ne=i(28),te=be(ne),se=i(59),ve=be(se),ie=i(60),ye=be(ie),Te=i(61),Le=be(Te),ue=i(108),he=be(ue),we=i(62),Oe=be(we);function be(We){return We&&We.__esModule?We:{default:We}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":v.BackgroundClass,"attributors/class/color":b.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":w.FontClass,"attributors/class/size":N.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":v.BackgroundStyle,"attributors/style/color":b.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":w.FontStyle,"attributors/style/size":N.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":u.IndentClass,"formats/background":v.BackgroundStyle,"formats/color":b.ColorStyle,"formats/font":w.FontClass,"formats/size":N.SizeClass,"formats/blockquote":d.default,"formats/code-block":D.default,"formats/header":m.default,"formats/list":y.default,"formats/bold":k.default,"formats/code":V.Code,"formats/italic":E.default,"formats/link":T.default,"formats/script":P.default,"formats/strike":L.default,"formats/underline":F.default,"formats/image":W.default,"formats/video":q.default,"formats/list/item":x.ListItem,"modules/formula":G.default,"modules/syntax":Q.default,"modules/toolbar":Y.default,"themes/bubble":he.default,"themes/snow":Oe.default,"ui/icons":J.default,"ui/picker":te.default,"ui/icon-picker":ye.default,"ui/color-picker":ve.default,"ui/tooltip":Le.default},!0),n.default=o.default},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function y(v,b){for(var w=0;w<b.length;w++){var N=b[w];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(v,N.key,N)}}return function(v,b,w){return b&&y(v.prototype,b),w&&y(v,w),v}}(),o=function y(v,b,w){v===null&&(v=Function.prototype);var N=Object.getOwnPropertyDescriptor(v,b);if(N===void 0){var j=Object.getPrototypeOf(v);return j===null?void 0:y(j,b,w)}else{if("value"in N)return N.value;var k=N.get;return k===void 0?void 0:k.call(w)}},l=i(0),c=u(l);function u(y){return y&&y.__esModule?y:{default:y}}function f(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function d(y,v){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:y}function p(y,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);y.prototype=Object.create(v&&v.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(y,v):y.__proto__=v)}var m=function(y){p(v,y);function v(){return f(this,v),d(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,[{key:"add",value:function(w,N){if(N==="+1"||N==="-1"){var j=this.value(w)||0;N=N==="+1"?j+1:j-1}return N===0?(this.remove(w),!0):o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"add",this).call(this,w,N)}},{key:"canAdd",value:function(w,N){return o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"canAdd",this).call(this,w,N)||o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"canAdd",this).call(this,w,parseInt(N))}},{key:"value",value:function(w){return parseInt(o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"value",this).call(this,w))||void 0}}]),v}(c.default.Attributor.Class),x=new m("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=x},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="blockquote",d.tagName="blockquote",n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(x,y){for(var v=0;v<y.length;v++){var b=y[v];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(x,b.key,b)}}return function(x,y,v){return y&&m(x.prototype,y),v&&m(x,v),x}}(),o=i(4),l=c(o);function c(m){return m&&m.__esModule?m:{default:m}}function u(m,x){if(!(m instanceof x))throw new TypeError("Cannot call a class as a function")}function f(m,x){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:m}function d(m,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);m.prototype=Object.create(x&&x.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(m,x):m.__proto__=x)}var p=function(m){d(x,m);function x(){return u(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"formats",value:function(v){return this.tagName.indexOf(v.tagName)+1}}]),x}(l.default);p.blotName="header",p.tagName=["H1","H2","H3","H4","H5","H6"],n.default=p},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function j(k,_){for(var E=0;E<_.length;E++){var A=_[E];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(k,A.key,A)}}return function(k,_,E){return _&&j(k.prototype,_),E&&j(k,E),k}}(),o=function j(k,_,E){k===null&&(k=Function.prototype);var A=Object.getOwnPropertyDescriptor(k,_);if(A===void 0){var T=Object.getPrototypeOf(k);return T===null?void 0:j(T,_,E)}else{if("value"in A)return A.value;var M=A.get;return M===void 0?void 0:M.call(E)}},l=i(0),c=m(l),u=i(4),f=m(u),d=i(25),p=m(d);function m(j){return j&&j.__esModule?j:{default:j}}function x(j,k,_){return k in j?Object.defineProperty(j,k,{value:_,enumerable:!0,configurable:!0,writable:!0}):j[k]=_,j}function y(j,k){if(!(j instanceof k))throw new TypeError("Cannot call a class as a function")}function v(j,k){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:j}function b(j,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);j.prototype=Object.create(k&&k.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(j,k):j.__proto__=k)}var w=function(j){b(k,j);function k(){return y(this,k),v(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}return s(k,[{key:"format",value:function(E,A){E===N.blotName&&!A?this.replaceWith(c.default.create(this.statics.scope)):o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"format",this).call(this,E,A)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,A){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,A),this):(this.parent.unwrap(),o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"replaceWith",this).call(this,E,A))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:o(k.__proto__||Object.getPrototypeOf(k),"formats",this).call(this,E)}}]),k}(f.default);w.blotName="list-item",w.tagName="LI";var N=function(j){b(k,j),s(k,null,[{key:"create",value:function(E){var A=E==="ordered"?"OL":"UL",T=o(k.__proto__||Object.getPrototypeOf(k),"create",this).call(this,A);return(E==="checked"||E==="unchecked")&&T.setAttribute("data-checked",E==="checked"),T}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function k(_){y(this,k);var E=v(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,_)),A=function(M){if(M.target.parentNode===_){var P=E.statics.formats(_),R=c.default.find(M.target);P==="checked"?R.format("list","unchecked"):P==="unchecked"&&R.format("list","checked")}};return _.addEventListener("touchstart",A),_.addEventListener("mousedown",A),E}return s(k,[{key:"format",value:function(E,A){this.children.length>0&&this.children.tail.format(E,A)}},{key:"formats",value:function(){return x({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,A){if(E instanceof w)o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"insertBefore",this).call(this,E,A);else{var T=A==null?this.length():A.offset(this),M=this.split(T);M.parent.insertBefore(E,M)}}},{key:"optimize",value:function(E){o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"optimize",this).call(this,E);var A=this.next;A!=null&&A.prev===this&&A.statics.blotName===this.statics.blotName&&A.domNode.tagName===this.domNode.tagName&&A.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(A.moveChildren(this),A.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var A=c.default.create(this.statics.defaultChild);E.moveChildren(A),this.appendChild(A)}o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"replace",this).call(this,E)}}]),k}(p.default);N.blotName="list",N.scope=c.default.Scope.BLOCK_BLOT,N.tagName=["OL","UL"],N.defaultChild="list-item",N.allowedChildren=[w],n.ListItem=w,n.default=N},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="italic",d.tagName=["EM","I"],n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(6),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(){return f(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,null,[{key:"create",value:function(b){return b==="super"?document.createElement("sup"):b==="sub"?document.createElement("sub"):o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,b)}},{key:"formats",value:function(b){if(b.tagName==="SUB")return"sub";if(b.tagName==="SUP")return"super"}}]),y}(c.default);m.blotName="script",m.tagName=["SUB","SUP"],n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="strike",d.tagName="S",n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="underline",d.tagName="U",n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(b,w){for(var N=0;N<w.length;N++){var j=w[N];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,w,N){return w&&v(b.prototype,w),N&&v(b,N),b}}(),o=function v(b,w,N){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,w);if(j===void 0){var k=Object.getPrototypeOf(b);return k===null?void 0:v(k,w,N)}else{if("value"in j)return j.value;var _=j.get;return _===void 0?void 0:_.call(N)}},l=i(0),c=f(l),u=i(27);function f(v){return v&&v.__esModule?v:{default:v}}function d(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function p(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function m(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var x=["alt","height","width"],y=function(v){m(b,v);function b(){return d(this,b),p(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(N,j){x.indexOf(N)>-1?j?this.domNode.setAttribute(N,j):this.domNode.removeAttribute(N):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,N,j)}}],[{key:"create",value:function(N){var j=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,N);return typeof N=="string"&&j.setAttribute("src",this.sanitize(N)),j}},{key:"formats",value:function(N){return x.reduce(function(j,k){return N.hasAttribute(k)&&(j[k]=N.getAttribute(k)),j},{})}},{key:"match",value:function(N){return/\.(jpe?g|gif|png)$/.test(N)||/^data:image\/.+;base64/.test(N)}},{key:"sanitize",value:function(N){return(0,u.sanitize)(N,["http","https","data"])?N:"//:0"}},{key:"value",value:function(N){return N.getAttribute("src")}}]),b}(c.default.Embed);y.blotName="image",y.tagName="IMG",n.default=y},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(b,w){for(var N=0;N<w.length;N++){var j=w[N];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,w,N){return w&&v(b.prototype,w),N&&v(b,N),b}}(),o=function v(b,w,N){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,w);if(j===void 0){var k=Object.getPrototypeOf(b);return k===null?void 0:v(k,w,N)}else{if("value"in j)return j.value;var _=j.get;return _===void 0?void 0:_.call(N)}},l=i(4),c=i(27),u=f(c);function f(v){return v&&v.__esModule?v:{default:v}}function d(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function p(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function m(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var x=["height","width"],y=function(v){m(b,v);function b(){return d(this,b),p(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(N,j){x.indexOf(N)>-1?j?this.domNode.setAttribute(N,j):this.domNode.removeAttribute(N):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,N,j)}}],[{key:"create",value:function(N){var j=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,N);return j.setAttribute("frameborder","0"),j.setAttribute("allowfullscreen",!0),j.setAttribute("src",this.sanitize(N)),j}},{key:"formats",value:function(N){return x.reduce(function(j,k){return N.hasAttribute(k)&&(j[k]=N.getAttribute(k)),j},{})}},{key:"sanitize",value:function(N){return u.default.sanitize(N)}},{key:"value",value:function(N){return N.getAttribute("src")}}]),b}(l.BlockEmbed);y.blotName="video",y.className="ql-video",y.tagName="IFRAME",n.default=y},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function N(j,k){for(var _=0;_<k.length;_++){var E=k[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(j,E.key,E)}}return function(j,k,_){return k&&N(j.prototype,k),_&&N(j,_),j}}(),o=function N(j,k,_){j===null&&(j=Function.prototype);var E=Object.getOwnPropertyDescriptor(j,k);if(E===void 0){var A=Object.getPrototypeOf(j);return A===null?void 0:N(A,k,_)}else{if("value"in E)return E.value;var T=E.get;return T===void 0?void 0:T.call(_)}},l=i(35),c=m(l),u=i(5),f=m(u),d=i(9),p=m(d);function m(N){return N&&N.__esModule?N:{default:N}}function x(N,j){if(!(N instanceof j))throw new TypeError("Cannot call a class as a function")}function y(N,j){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:N}function v(N,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);N.prototype=Object.create(j&&j.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(N,j):N.__proto__=j)}var b=function(N){v(j,N);function j(){return x(this,j),y(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,null,[{key:"create",value:function(_){var E=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,_);return typeof _=="string"&&(window.katex.render(_,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",_)),E}},{key:"value",value:function(_){return _.getAttribute("data-value")}}]),j}(c.default);b.blotName="formula",b.className="ql-formula",b.tagName="SPAN";var w=function(N){v(j,N),s(j,null,[{key:"register",value:function(){f.default.register(b,!0)}}]);function j(){x(this,j);var k=y(this,(j.__proto__||Object.getPrototypeOf(j)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return k}return j}(p.default);n.FormulaBlot=b,n.default=w},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function _(E,A){for(var T=0;T<A.length;T++){var M=A[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}return function(E,A,T){return A&&_(E.prototype,A),T&&_(E,T),E}}(),o=function _(E,A,T){E===null&&(E=Function.prototype);var M=Object.getOwnPropertyDescriptor(E,A);if(M===void 0){var P=Object.getPrototypeOf(E);return P===null?void 0:_(P,A,T)}else{if("value"in M)return M.value;var R=M.get;return R===void 0?void 0:R.call(T)}},l=i(0),c=y(l),u=i(5),f=y(u),d=i(9),p=y(d),m=i(13),x=y(m);function y(_){return _&&_.__esModule?_:{default:_}}function v(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")}function b(_,E){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:_}function w(_,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);_.prototype=Object.create(E&&E.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(_,E):_.__proto__=E)}var N=function(_){w(E,_);function E(){return v(this,E),b(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,[{key:"replaceWith",value:function(T){this.domNode.textContent=this.domNode.textContent,this.attach(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,T)}},{key:"highlight",value:function(T){var M=this.domNode.textContent;this.cachedText!==M&&((M.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=T(M),this.domNode.normalize(),this.attach()),this.cachedText=M)}}]),E}(x.default);N.className="ql-syntax";var j=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),k=function(_){w(E,_),s(E,null,[{key:"register",value:function(){f.default.register(j,!0),f.default.register(N,!0)}}]);function E(A,T){v(this,E);var M=b(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,A,T));if(typeof M.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var P=null;return M.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(P),P=setTimeout(function(){M.highlight(),P=null},M.options.interval)}),M.highlight(),M}return s(E,[{key:"highlight",value:function(){var T=this;if(!this.quill.selection.composing){this.quill.update(f.default.sources.USER);var M=this.quill.getSelection();this.quill.scroll.descendants(N).forEach(function(P){P.highlight(T.options.highlight)}),this.quill.update(f.default.sources.SILENT),M!=null&&this.quill.setSelection(M,f.default.sources.SILENT)}}}]),E}(p.default);k.DEFAULTS={highlight:function(){return window.hljs==null?null:function(_){var E=window.hljs.highlightAuto(_);return E.value}}(),interval:1e3},n.CodeBlock=N,n.CodeToken=j,n.default=k},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function E(A,T,M){A===null&&(A=Function.prototype);var P=Object.getOwnPropertyDescriptor(A,T);if(P===void 0){var R=Object.getPrototypeOf(A);return R===null?void 0:E(R,T,M)}else{if("value"in P)return P.value;var L=P.get;return L===void 0?void 0:L.call(M)}},o=function(){function E(A,T){for(var M=0;M<T.length;M++){var P=T[M];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(A,P.key,P)}}return function(A,T,M){return T&&E(A.prototype,T),M&&E(A,M),A}}(),l=i(3),c=v(l),u=i(8),f=v(u),d=i(43),p=v(d),m=i(15),x=i(41),y=v(x);function v(E){return E&&E.__esModule?E:{default:E}}function b(E,A){if(!(E instanceof A))throw new TypeError("Cannot call a class as a function")}function w(E,A){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:E}function N(E,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);E.prototype=Object.create(A&&A.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(E,A):E.__proto__=A)}var j=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],k=function(E){N(A,E);function A(T,M){b(this,A),M.modules.toolbar!=null&&M.modules.toolbar.container==null&&(M.modules.toolbar.container=j);var P=w(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,M));return P.quill.container.classList.add("ql-bubble"),P}return o(A,[{key:"extendToolbar",value:function(M){this.tooltip=new _(this.quill,this.options.bounds),this.tooltip.root.appendChild(M.container),this.buildButtons([].slice.call(M.container.querySelectorAll("button")),y.default),this.buildPickers([].slice.call(M.container.querySelectorAll("select")),y.default)}}]),A}(p.default);k.DEFAULTS=(0,c.default)(!0,{},p.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(A){A?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var _=function(E){N(A,E);function A(T,M){b(this,A);var P=w(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,M));return P.quill.on(f.default.events.EDITOR_CHANGE,function(R,L,$,F){if(R===f.default.events.SELECTION_CHANGE)if(L!=null&&L.length>0&&F===f.default.sources.USER){P.show(),P.root.style.left="0px",P.root.style.width="",P.root.style.width=P.root.offsetWidth+"px";var z=P.quill.getLines(L.index,L.length);if(z.length===1)P.position(P.quill.getBounds(L));else{var W=z[z.length-1],K=P.quill.getIndex(W),q=Math.min(W.length()-1,L.index+L.length-K),V=P.quill.getBounds(new m.Range(K,q));P.position(V)}}else document.activeElement!==P.textbox&&P.quill.hasFocus()&&P.hide()}),P}return o(A,[{key:"listen",value:function(){var M=this;s(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){M.root.classList.remove("ql-editing")}),this.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!M.root.classList.contains("ql-hidden")){var P=M.quill.getSelection();P!=null&&M.position(M.quill.getBounds(P))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(M){var P=s(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"position",this).call(this,M),R=this.root.querySelector(".ql-tooltip-arrow");if(R.style.marginLeft="",P===0)return P;R.style.marginLeft=-1*P-R.offsetWidth/2+"px"}}]),A}(d.BaseTooltip);_.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=_,n.default=k},function(r,n,i){r.exports=i(63)}]).default})}(Zg)),Zg.exports}var Vi,F5;function zye(){if(F5)return Vi;F5=1;var t=Vi&&Vi.__extends||function(){var f=function(d,p){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,x){m.__proto__=x}||function(m,x){for(var y in x)x.hasOwnProperty(y)&&(m[y]=x[y])},f(d,p)};return function(d,p){f(d,p);function m(){this.constructor=d}d.prototype=p===null?Object.create(p):(m.prototype=p.prototype,new m)}}(),e=Vi&&Vi.__assign||function(){return e=Object.assign||function(f){for(var d,p=1,m=arguments.length;p<m;p++){d=arguments[p];for(var x in d)Object.prototype.hasOwnProperty.call(d,x)&&(f[x]=d[x])}return f},e.apply(this,arguments)},r=Vi&&Vi.__spreadArrays||function(){for(var f=0,d=0,p=arguments.length;d<p;d++)f+=arguments[d].length;for(var m=Array(f),x=0,d=0;d<p;d++)for(var y=arguments[d],v=0,b=y.length;v<b;v++,x++)m[x]=y[v];return m},n=Vi&&Vi.__importDefault||function(f){return f&&f.__esModule?f:{default:f}},i=n(ad()),s=n(xO()),o=n(Iq()),l=n(qye()),c=function(f){t(d,f);function d(p){var m=f.call(this,p)||this;m.dirtyProps=["modules","formats","bounds","theme","children"],m.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],m.state={generation:0},m.selection=null,m.onEditorChange=function(y,v,b,w){var N,j,k,_;y==="text-change"?(j=(N=m).onEditorChangeText)===null||j===void 0||j.call(N,m.editor.root.innerHTML,v,w,m.unprivilegedEditor):y==="selection-change"&&((_=(k=m).onEditorChangeSelection)===null||_===void 0||_.call(k,v,w,m.unprivilegedEditor))};var x=m.isControlled()?p.value:p.defaultValue;return m.value=x??"",m}return d.prototype.validateProps=function(p){var m;if(i.default.Children.count(p.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(p.children)){var x=i.default.Children.only(p.children);if(((m=x)===null||m===void 0?void 0:m.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&p.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},d.prototype.shouldComponentUpdate=function(p,m){var x=this,y;if(this.validateProps(p),!this.editor||this.state.generation!==m.generation)return!0;if("value"in p){var v=this.getEditorContents(),b=(y=p.value,y??"");this.isEqualValue(b,v)||this.setEditorContents(this.editor,b)}return p.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,p.readOnly),r(this.cleanProps,this.dirtyProps).some(function(w){return!o.default(p[w],x.props[w])})},d.prototype.shouldComponentRegenerate=function(p){var m=this;return this.dirtyProps.some(function(x){return!o.default(p[x],m.props[x])})},d.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},d.prototype.componentWillUnmount=function(){this.destroyEditor()},d.prototype.componentDidUpdate=function(p,m){var x=this;if(this.editor&&this.shouldComponentRegenerate(p)){var y=this.editor.getContents(),v=this.editor.getSelection();this.regenerationSnapshot={delta:y,selection:v},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==m.generation){var b=this.regenerationSnapshot,y=b.delta,w=b.selection;delete this.regenerationSnapshot,this.instantiateEditor();var N=this.editor;N.setContents(y),u(function(){return x.setEditorSelection(N,w)})}},d.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},d.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},d.prototype.isControlled=function(){return"value"in this.props},d.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},d.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},d.prototype.createEditor=function(p,m){var x=new l.default(p,m);return m.tabIndex!=null&&this.setEditorTabIndex(x,m.tabIndex),this.hookEditor(x),x},d.prototype.hookEditor=function(p){this.unprivilegedEditor=this.makeUnprivilegedEditor(p),p.on("editor-change",this.onEditorChange)},d.prototype.unhookEditor=function(p){p.off("editor-change",this.onEditorChange)},d.prototype.getEditorContents=function(){return this.value},d.prototype.getEditorSelection=function(){return this.selection},d.prototype.isDelta=function(p){return p&&p.ops},d.prototype.isEqualValue=function(p,m){return this.isDelta(p)&&this.isDelta(m)?o.default(p.ops,m.ops):o.default(p,m)},d.prototype.setEditorContents=function(p,m){var x=this;this.value=m;var y=this.getEditorSelection();typeof m=="string"?p.setContents(p.clipboard.convert(m)):p.setContents(m),u(function(){return x.setEditorSelection(p,y)})},d.prototype.setEditorSelection=function(p,m){if(this.selection=m,m){var x=p.getLength();m.index=Math.max(0,Math.min(m.index,x-1)),m.length=Math.max(0,Math.min(m.length,x-1-m.index)),p.setSelection(m)}},d.prototype.setEditorTabIndex=function(p,m){var x,y;!((y=(x=p)===null||x===void 0?void 0:x.scroll)===null||y===void 0)&&y.domNode&&(p.scroll.domNode.tabIndex=m)},d.prototype.setEditorReadOnly=function(p,m){m?p.disable():p.enable()},d.prototype.makeUnprivilegedEditor=function(p){var m=p;return{getHTML:function(){return m.root.innerHTML},getLength:m.getLength.bind(m),getText:m.getText.bind(m),getContents:m.getContents.bind(m),getSelection:m.getSelection.bind(m),getBounds:m.getBounds.bind(m)}},d.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var p=s.default.findDOMNode(this.editingArea);if(!p)throw new Error("Cannot find element for editing area");if(p.nodeType===3)throw new Error("Editing area cannot be a text node");return p},d.prototype.renderEditingArea=function(){var p=this,m=this.props,x=m.children,y=m.preserveWhitespace,v=this.state.generation,b={key:v,ref:function(w){p.editingArea=w}};return i.default.Children.count(x)?i.default.cloneElement(i.default.Children.only(x),b):y?i.default.createElement("pre",e({},b)):i.default.createElement("div",e({},b))},d.prototype.render=function(){var p;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(p=this.props.className,p??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},d.prototype.onEditorChangeText=function(p,m,x,y){var v,b;if(this.editor){var w=this.isDelta(this.value)?y.getContents():y.getHTML();w!==this.getEditorContents()&&(this.lastDeltaChangeSet=m,this.value=w,(b=(v=this.props).onChange)===null||b===void 0||b.call(v,p,m,x,y))}},d.prototype.onEditorChangeSelection=function(p,m,x){var y,v,b,w,N,j;if(this.editor){var k=this.getEditorSelection(),_=!k&&p,E=k&&!p;o.default(p,k)||(this.selection=p,(v=(y=this.props).onChangeSelection)===null||v===void 0||v.call(y,p,m,x),_?(w=(b=this.props).onFocus)===null||w===void 0||w.call(b,p,m,x):E&&((j=(N=this.props).onBlur)===null||j===void 0||j.call(N,k,m,x)))}},d.prototype.focus=function(){this.editor&&this.editor.focus()},d.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},d.displayName="React Quill",d.Quill=l.default,d.defaultProps={theme:"snow",modules:{},readOnly:!1},d}(i.default.Component);function u(f){Promise.resolve().then(f)}return Vi=c,Vi}var Uye=zye();const Hye=ht(Uye);function q5(){const{id:t}=us(),e=!!t,r=O.useRef(null),[n,i]=O.useState(null),[s,o]=O.useState(""),[l,c]=O.useState(null),[u,f]=O.useState(e),[d,p]=O.useState(!1),[m,x]=O.useState({wordCount:0,characterCount:0,readingTime:0,paragraphs:0});O.useEffect(()=>{e&&t&&y()},[e,t]),O.useEffect(()=>{v(s)},[s]);const y=async()=>{if(t)try{const{data:k,error:_}=await pe.from("documents").select("*").eq("content_item_id",t).maybeSingle();if(_)throw _;k&&(i(k),o(k.content_html||""),c(k.content_json))}catch(k){console.error("Error fetching document:",k)}finally{f(!1)}},v=k=>{const _=k.replace(/<[^>]*>/g,"").trim(),E=_?_.split(/\s+/).length:0,A=_.length,T=Math.ceil(E/200),M=k.split(/<\/p>/gi).length-1||(_?1:0);x({wordCount:E,characterCount:A,readingTime:Math.max(1,T),paragraphs:M})},b=async k=>{try{const _={content_item_id:k,content_html:s,content_json:l,word_count:m.wordCount,reading_time_minutes:m.readingTime};if(n){const{error:E}=await pe.from("documents").update({..._,updated_at:new Date().toISOString()}).eq("id",n.id);if(E)throw E}else{const{error:E}=await pe.from("documents").insert([_]);if(E)throw E}}catch(_){throw console.error("Error saving document data:",_),_}},w=(k,_,E,A)=>{o(k),c(A.getContents())},N={toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]},{size:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{align:[]}],["blockquote","code-block"],["link","image","video"],["clean"]]},clipboard:{matchVisual:!1}},j=["header","font","size","bold","italic","underline","strike","color","background","script","list","bullet","indent","align","blockquote","code-block","link","image","video"];return u?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading document..."})]})}):a.jsx(zp,{contentType:"document",isEdit:e,onSaveContent:b,title:"Documents",description:"Rich text documents and guides",color:"#10B981",icon:Ot,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(py,{className:"h-5 w-5 mr-2 text-green-500"}),"Document Statistics"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.wordCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide font-medium",children:"Words"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.characterCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-green-600 uppercase tracking-wide font-medium",children:"Characters"})]}),a.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:m.readingTime}),a.jsx("div",{className:"text-xs text-purple-600 uppercase tracking-wide font-medium",children:"Min Read"})]}),a.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.paragraphs}),a.jsx("div",{className:"text-xs text-orange-600 uppercase tracking-wide font-medium",children:"Paragraphs"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(DO,{className:"h-5 w-5 mr-2 text-green-500"}),"Document Content"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:()=>p(!1),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${d?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-green-100 text-green-700"}`,children:[a.jsx(MX,{className:"h-4 w-4 mr-1 inline"}),"Edit"]}),a.jsxs("button",{onClick:()=>p(!0),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${d?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(ii,{className:"h-4 w-4 mr-1 inline"}),"Preview"]})]})]}),d?a.jsx("div",{className:"prose max-w-none",children:a.jsx("div",{className:"min-h-96 p-6 border border-gray-200 rounded-lg bg-gray-50",children:s?a.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:s}}):a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Ot,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No content to preview"}),a.jsx("p",{className:"text-sm mt-1",children:"Switch to Edit mode to start writing"})]})})}):a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsx(Hye,{ref:r,theme:"snow",value:s,onChange:w,modules:N,formats:j,placeholder:"Start writing your document content here...\\n\\nYou can use the toolbar above to format text, add images, create lists, and more. This editor supports rich text formatting similar to Google Docs or Microsoft Word.",style:{minHeight:"400px",fontSize:"16px",lineHeight:"1.6"}})}),a.jsx("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(Ot,{className:"h-4 w-4 text-green-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-green-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"Professional Document Editor"}),a.jsx("p",{className:"text-xs leading-relaxed",children:"This rich-text editor supports all standard formatting options including headers, lists, links, images, and code blocks. Content is automatically saved and can be exported or shared with clients."})]})]})})]}),n&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Metadata"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Word Count"}),a.jsxs("p",{className:"text-gray-900",children:[m.wordCount.toLocaleString()," words"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Reading Time"}),a.jsxs("p",{className:"text-gray-900",children:[m.readingTime," minute",m.readingTime!==1?"s":""]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Last Updated"}),a.jsx("p",{className:"text-gray-900",children:new Date(n.updated_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Document ID"}),a.jsx("p",{className:"text-gray-900 font-mono text-xs",children:n.id})]})]})]})]})})}const Wye=["General","Creative Writing","Business","Technical","Educational","Marketing","Customer Support","Data Analysis","Programming","Research","Social Media","Email","Other"];function z5(){const{id:t}=us(),e=!!t,[r,n]=O.useState(null),[i,s]=O.useState(""),[o,l]=O.useState("General"),[c,u]=O.useState(e),[f,d]=O.useState(!1),[p,m]=O.useState({characterCount:0,wordCount:0,lineCount:0,variables:[]});O.useEffect(()=>{e&&t&&x()},[e,t]),O.useEffect(()=>{y(i)},[i]);const x=async()=>{if(t)try{const{data:N,error:j}=await pe.from("prompts").select("*").eq("content_item_id",t).maybeSingle();if(j)throw j;N&&(n(N),s(N.prompt_text||""),l(N.prompt_category||"General"))}catch(N){console.error("Error fetching prompt:",N)}finally{u(!1)}},y=N=>{const j=N.length,k=N.trim()?N.trim().split(/\s+/).length:0,_=N.split(`
`).length,E=N.match(/\{([^}]+)\}|\[([^\]]+)\]/g)||[],A=[...new Set(E.map(T=>T.replace(/[{}\[\]]/g,"")))];m({characterCount:j,wordCount:k,lineCount:_,variables:A})},v=async()=>{try{await navigator.clipboard.writeText(i),d(!0),setTimeout(()=>d(!1),2e3),r&&(await pe.from("prompts").update({usage_count:(r.usage_count||0)+1,last_copied_at:new Date().toISOString()}).eq("id",r.id),n(N=>N?{...N,usage_count:(N.usage_count||0)+1,last_copied_at:new Date().toISOString()}:null))}catch(N){console.error("Failed to copy prompt:",N)}},b=N=>{const j=document.getElementById("promptText");if(j){const k=j.selectionStart,_=j.selectionEnd,E=i.substring(0,k)+`{${N}}`+i.substring(_);s(E),setTimeout(()=>{j.focus(),j.setSelectionRange(k+N.length+2,k+N.length+2)},0)}},w=async N=>{try{const j={content_item_id:N,prompt_text:i,prompt_category:o,usage_count:(r==null?void 0:r.usage_count)||0,last_copied_at:(r==null?void 0:r.last_copied_at)||null};if(r){const{error:k}=await pe.from("prompts").update({...j,updated_at:new Date().toISOString()}).eq("id",r.id);if(k)throw k}else{const{error:k}=await pe.from("prompts").insert([j]);if(k)throw k}}catch(j){throw console.error("Error saving prompt data:",j),j}};return c?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading prompt..."})]})}):a.jsx(zp,{contentType:"prompt",isEdit:e,onSaveContent:w,title:"Prompts",description:"Reusable prompt templates",color:"#8B5CF6",icon:Gr,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(py,{className:"h-5 w-5 mr-2 text-purple-500"}),"Prompt Statistics"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.characterCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide font-medium",children:"Characters"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.wordCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-green-600 uppercase tracking-wide font-medium",children:"Words"})]}),a.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:p.lineCount}),a.jsx("div",{className:"text-xs text-purple-600 uppercase tracking-wide font-medium",children:"Lines"})]}),a.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p.variables.length}),a.jsx("div",{className:"text-xs text-orange-600 uppercase tracking-wide font-medium",children:"Variables"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Es,{className:"h-5 w-5 mr-2 text-purple-500"}),"Category & Classification"]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Prompt Category"}),a.jsx("select",{id:"category",value:o,onChange:N=>l(N.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:Wye.map(N=>a.jsx("option",{value:N,children:N},N))}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Categorize your prompt to make it easier to find and organize"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(Gr,{className:"h-5 w-5 mr-2 text-purple-500"}),"Prompt Content"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:v,disabled:!i.trim(),className:`inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md transition-all ${f?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700 hover:bg-purple-200"} disabled:opacity-50`,children:f?a.jsxs(a.Fragment,{children:[a.jsx(ln,{className:"h-4 w-4 mr-1"}),"Copied!"]}):a.jsxs(a.Fragment,{children:[a.jsx(gy,{className:"h-4 w-4 mr-1"}),"Copy"]})}),a.jsxs("div",{className:"text-sm text-gray-500",children:[p.characterCount," / ",p.wordCount," words"]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("textarea",{id:"promptText",value:i,onChange:N=>s(N.target.value),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm leading-relaxed",placeholder:"Enter your prompt template here...\\n\\nYou can use variables like {name}, {topic}, or [variable] to make your prompts reusable.\\n\\nExample:\\nYou are a helpful AI assistant specialized in {field}. Please help me with {task} by providing {output_format} that is {tone} and {length}."}),p.variables.length>0&&a.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[a.jsxs("h4",{className:"text-sm font-medium text-purple-900 mb-2 flex items-center",children:[a.jsx(xM,{className:"h-4 w-4 mr-1"}),"Detected Variables (",p.variables.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:p.variables.map((N,j)=>a.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-md font-mono",children:[a.jsx(xM,{className:"h-3 w-3 mr-1"}),N]},j))}),a.jsx("p",{className:"text-xs text-purple-700 mt-2",children:"These variables can be replaced when using the prompt"})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Quick Variables"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["name","topic","context","tone","format","length","audience","goal"].map(N=>a.jsxs("button",{onClick:()=>b(N),className:"inline-flex items-center px-2 py-1 bg-white border border-gray-200 text-gray-700 text-xs rounded-md hover:bg-gray-100 transition-colors",children:["+ ",N]},N))}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Click to insert common variables into your prompt"})]}),a.jsx("div",{className:"p-4 bg-purple-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(Gr,{className:"h-4 w-4 text-purple-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-purple-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"Prompt Template Tips"}),a.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:["Use ","{variable}"," or [variable] syntax for replaceable parts"]}),a.jsx("li",{children:"Be specific about the desired output format and style"}),a.jsx("li",{children:"Include context and constraints to guide the AI response"}),a.jsx("li",{children:"Test your prompts with different variables to ensure consistency"})]})]})]})})]})]}),r&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(go,{className:"h-5 w-5 mr-2 text-blue-500"}),"Usage Statistics"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.usage_count||0}),a.jsx("div",{className:"text-sm text-blue-600",children:"Times Copied"})]}),a.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium text-green-600",children:r.last_copied_at?new Date(r.last_copied_at).toLocaleDateString():"Never"}),a.jsx("div",{className:"text-sm text-green-600",children:"Last Copied"})]})]})]}),i.trim()&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prompt Preview"}),a.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:a.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono leading-relaxed",children:i})}),a.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm text-gray-600",children:[a.jsx("span",{children:"This is how your prompt will appear when copied"}),a.jsxs("button",{onClick:v,className:"inline-flex items-center px-3 py-1 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors",children:[a.jsx(gy,{className:"h-3 w-3 mr-1"}),"Copy Preview"]})]})]})]})})}const Vye=["Zapier","Make (Integromat)","Microsoft Power Automate","IFTTT","n8n","Bubble","Airtable","Google Sheets","Slack","Discord","Trello","Asana","Notion","Monday.com","HubSpot","Salesforce","Gmail","Outlook","Google Drive","Dropbox","AWS Lambda","GitHub Actions","Custom API","Other"];function U5(){const{id:t}=us(),e=!!t,[r,n]=O.useState(null),[i,s]=O.useState(""),[o,l]=O.useState([]),[c,u]=O.useState(""),[f,d]=O.useState(""),[p,m]=O.useState(""),[x,y]=O.useState(e),[v,b]=O.useState(!1),[w,N]=O.useState(null);O.useEffect(()=>{e&&t&&j()},[e,t]),O.useEffect(()=>{i.trim()?k(i.trim()):N(null)},[i]);const j=async()=>{if(t)try{const{data:M,error:P}=await pe.from("automations").select("*").eq("content_item_id",t).maybeSingle();if(P)throw P;M&&(n(M),s(M.automation_url||""),l(M.required_tools||[]),u(M.tool_description||""),d(M.setup_instructions||""))}catch(M){console.error("Error fetching automation:",M)}finally{y(!1)}},k=async M=>{b(!0);try{const P=new URL(M);let R="Unknown";P.hostname.includes("zapier.com")?R="Zapier":P.hostname.includes("make.com")||P.hostname.includes("integromat.com")?R="Make (Integromat)":P.hostname.includes("flow.microsoft.com")?R="Microsoft Power Automate":P.hostname.includes("ifttt.com")?R="IFTTT":P.hostname.includes("n8n.io")?R="n8n":P.hostname.includes("bubble.io")&&(R="Bubble"),N({isValid:!0,isReachable:!0,platform:R,title:`${R} Automation`,description:`Automation workflow hosted on ${R}`})}catch{N({isValid:!1,isReachable:!1})}finally{b(!1)}},_=M=>{const P=M.trim();P&&!o.includes(P)&&l([...o,P]),m("")},E=M=>{l(o.filter(P=>P!==M))},A=M=>{o.includes(M)||l([...o,M])},T=async M=>{try{const P={content_item_id:M,automation_url:i.trim(),required_tools:o,tool_description:c.trim()||null,setup_instructions:f.trim()||null};if(r){const{error:R}=await pe.from("automations").update({...P,updated_at:new Date().toISOString()}).eq("id",r.id);if(R)throw R}else{const{error:R}=await pe.from("automations").insert([P]);if(R)throw R}}catch(P){throw console.error("Error saving automation data:",P),P}};return x?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading automation..."})]})}):a.jsx(zp,{contentType:"automation",isEdit:e,onSaveContent:T,title:"Automations",description:"Process automations and workflows",color:"#F59E0B",icon:Ei,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(n_,{className:"h-5 w-5 mr-2 text-orange-500"}),"Automation Link"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"automationUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"Automation URL *"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"url",id:"automationUrl",value:i,onChange:M=>s(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"https://zapier.com/shared/... or https://make.com/template/...",required:!0}),v&&a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:a.jsx(cr,{size:"sm"})})]}),w&&a.jsxs("div",{className:`mt-2 p-3 rounded-lg border ${w.isValid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[w.isValid?a.jsx(ln,{className:"h-4 w-4 text-green-600"}):a.jsx(ql,{className:"h-4 w-4 text-red-600"}),a.jsx("p",{className:`text-sm font-medium ${w.isValid?"text-green-700":"text-red-700"}`,children:w.isValid?`Valid ${w.platform} automation URL`:"Invalid URL format"})]}),w.isValid&&w.platform&&a.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:["Platform: ",a.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:w.platform})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Link to the automation template, workflow, or shared automation"})]}),i.trim()&&(w==null?void 0:w.isValid)&&a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-orange-900",children:"Automation Preview"}),a.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-orange-600 hover:text-orange-800",children:[a.jsx(Os,{className:"h-4 w-4 mr-1"}),"Open in New Tab"]})]}),a.jsxs("div",{className:"text-sm text-orange-800",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"URL:"})," ",a.jsx("span",{className:"font-mono text-xs break-all",children:i})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Platform:"})," ",w.platform]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(KX,{className:"h-5 w-5 mr-2 text-orange-500"}),"Required Tools & Services"]}),a.jsxs("div",{className:"space-y-4",children:[o.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Selected Tools (",o.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:o.map((M,P)=>a.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-orange-100 text-orange-800 border border-orange-200",children:[M,a.jsx("button",{onClick:()=>E(M),className:"ml-2 text-orange-600 hover:text-orange-800",children:a.jsx($r,{className:"h-3 w-3"})})]},P))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Custom Tool"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:p,onChange:M=>m(M.target.value),onKeyPress:M=>M.key==="Enter"&&_(p),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter tool or service name..."}),a.jsxs("button",{onClick:()=>_(p),disabled:!p.trim()||o.includes(p.trim()),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:[a.jsx(Vt,{className:"h-4 w-4 mr-1"}),"Add"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Add - Common Tools"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:Vye.map(M=>a.jsxs("button",{onClick:()=>A(M),disabled:o.includes(M),className:`px-3 py-2 text-sm border rounded-lg transition-colors ${o.includes(M)?"bg-green-50 border-green-200 text-green-700 cursor-default":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[o.includes(M)?a.jsx(ln,{className:"h-3 w-3 inline mr-1"}):a.jsx(Vt,{className:"h-3 w-3 inline mr-1"}),M]},M))})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Zn,{className:"h-5 w-5 mr-2 text-blue-500"}),"Tools Description"]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"toolDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description of Required Tools"}),a.jsx("textarea",{id:"toolDescription",rows:4,value:c,onChange:M=>u(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Explain what each tool is used for in this automation...\\n\\nExample:\\n- Zapier: Connects different apps and triggers actions\\n- Google Sheets: Stores and manages data\\n- Slack: Sends notifications to the team"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Help users understand what each tool does in the automation workflow"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Ei,{className:"h-5 w-5 mr-2 text-orange-500"}),"Setup Instructions"]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"setupInstructions",className:"block text-sm font-medium text-gray-700 mb-2",children:"Step-by-Step Setup Guide"}),a.jsx("textarea",{id:"setupInstructions",rows:8,value:f,onChange:M=>d(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 font-mono text-sm",placeholder:"Provide detailed setup instructions...\\n\\nExample:\\n1. Click the automation link above\\n2. Sign up for a Zapier account if you don't have one\\n3. Connect your Google Sheets and Slack accounts\\n4. Configure the trigger conditions\\n5. Test the automation\\n6. Turn on the automation\\n\\nTroubleshooting:\\n- If connection fails, check API permissions\\n- Make sure all required fields are filled"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Provide clear, step-by-step instructions for setting up this automation"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Automation Summary"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Configuration"}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"URL:"})," ",i?"Configured":"Not set"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Required Tools:"})," ",o.length," tool",o.length!==1?"s":""]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Instructions:"})," ",f.trim()?"Provided":"None"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Tool Description:"})," ",c.trim()?"Provided":"None"]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Tools Required"}),a.jsx("div",{className:"space-y-1",children:o.length>0?a.jsx("ul",{className:"text-sm text-gray-600 space-y-0.5",children:o.map((M,P)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full mr-2"}),M]},P))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No tools specified"})})]})]})]})]})})}const qf={async getAll(t){let e=pe.from("missions").select("*").order("created_at",{ascending:!1});t!=null&&t.status&&(e=e.eq("status",t.status)),t!=null&&t.difficulty_level&&(e=e.eq("difficulty_level",t.difficulty_level)),t!=null&&t.tags&&t.tags.length>0&&(e=e.overlaps("tags",t.tags));const{data:r,error:n}=await e;if(n)throw n;return r||[]},async getById(t){const{data:e,error:r}=await pe.from("missions").select("*").eq("id",t).maybeSingle();if(r)throw r;return e},async create(t){const{data:e,error:r}=await pe.from("missions").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("missions").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("missions").delete().eq("id",t);if(e)throw e},async getAssignments(t){const[e,r,n]=await Promise.all([pe.from("mission_client_assignments").select("*").eq("mission_id",t),pe.from("mission_user_assignments").select("*").eq("mission_id",t),pe.from("mission_tag_assignments").select("*").eq("mission_id",t)]);return{clients:e.data||[],users:r.data||[],tags:n.data||[]}},async assignToClients(t,e,r){const n=e.map(s=>({mission_id:t,client_id:s,assigned_by:r})),{error:i}=await pe.from("mission_client_assignments").upsert(n);if(i)throw i}},zf={async getAll(t){let e=pe.from("courses").select("*").order("created_at",{ascending:!1});t!=null&&t.status&&(e=e.eq("status",t.status)),t!=null&&t.difficulty_level&&(e=e.eq("difficulty_level",t.difficulty_level)),t!=null&&t.tags&&t.tags.length>0&&(e=e.overlaps("tags",t.tags));const{data:r,error:n}=await e;if(n)throw n;return r||[]},async getById(t){const{data:e,error:r}=await pe.from("courses").select("*").eq("id",t).maybeSingle();if(r)throw r;return e},async create(t){const{data:e,error:r}=await pe.from("courses").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("courses").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("courses").delete().eq("id",t);if(e)throw e}},YN={async getByParent(t,e){const r=t==="mission"?"mission_id":"course_id",{data:n,error:i}=await pe.from("pages").select("*").eq(r,e).order("order_index",{ascending:!0});if(i)throw i;return n||[]},async getById(t,e=!1){const{data:r,error:n}=await pe.from("pages").select("*").eq("id",t).maybeSingle();if(n)throw n;if(!r)return null;if(e){const i=await Uf.getByPageId(t);return{...r,blocks:i}}return r},async create(t){const{data:e,error:r}=await pe.from("pages").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("pages").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("pages").delete().eq("id",t);if(e)throw e},async reorder(t){const e=t.map((r,n)=>({id:r,order_index:n}));for(const r of e)await pe.from("pages").update({order_index:r.order_index}).eq("id",r.id)}},Uf={async getByPageId(t){const{data:e,error:r}=await pe.from("blocks").select("*").eq("page_id",t).eq("is_visible",!0).order("order_index",{ascending:!0});if(r)throw r;return e||[]},async getById(t){const{data:e,error:r}=await pe.from("blocks").select("*").eq("id",t).maybeSingle();if(r)throw r;return e},async create(t){const{data:e,error:r}=await pe.from("blocks").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("blocks").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("blocks").delete().eq("id",t);if(e)throw e},async reorder(t){const e=t.map((r,n)=>({id:r,order_index:n}));for(const r of e)await pe.from("blocks").update({order_index:r.order_index}).eq("id",r.id)}},H5={async trackProgress(t){const{data:e,error:r}=await pe.functions.invoke("track-user-progress",{body:t});if(r)throw r;return e.data},async getUserProgress(t,e,r){const n=e==="mission"?"mission_id":"course_id",{data:i,error:s}=await pe.from("user_progress").select("*").eq("user_id",t).eq(n,r).order("created_at",{ascending:!1});if(s)throw s;return i||[]}},W5={async getStructure(t,e,r){const{data:n,error:i}=await pe.functions.invoke("page-structure-manager",{body:{parentType:t,parentId:e,includeBlocks:(r==null?void 0:r.includeBlocks)??!1,includeProgress:(r==null?void 0:r.includeProgress)??!1,userId:r==null?void 0:r.userId}});if(i)throw i;return n.data},async bulkCreatePages(t,e,r,n){const{data:i,error:s}=await pe.functions.invoke("page-builder-bulk-create",{body:{pages:r,userId:n,parentId:e,parentType:t}});if(s)throw s;return i.data}};function Kye(){const[t,e]=O.useState([]),[r,n]=O.useState(!1),[i,s]=O.useState(null),o=O.useCallback(async f=>{try{n(!0),s(null);const d=await qf.getAll(f);e(d)}catch(d){s(d instanceof Error?d.message:"Failed to fetch missions")}finally{n(!1)}},[]),l=O.useCallback(async f=>{try{s(null);const d=await qf.create(f);return e(p=>[d,...p]),d}catch(d){throw s(d instanceof Error?d.message:"Failed to create mission"),d}},[]),c=O.useCallback(async(f,d)=>{try{s(null);const p=await qf.update(f,d);return e(m=>m.map(x=>x.id===f?p:x)),p}catch(p){throw s(p instanceof Error?p.message:"Failed to update mission"),p}},[]),u=O.useCallback(async f=>{try{s(null),await qf.delete(f),e(d=>d.filter(p=>p.id!==f))}catch(d){throw s(d instanceof Error?d.message:"Failed to delete mission"),d}},[]);return O.useEffect(()=>{o()},[]),{missions:t,loading:r,error:i,fetchMissions:o,createMission:l,updateMission:c,deleteMission:u}}function Gye(){const[t,e]=O.useState([]),[r,n]=O.useState(!1),[i,s]=O.useState(null),o=O.useCallback(async f=>{try{n(!0),s(null);const d=await zf.getAll(f);e(d)}catch(d){s(d instanceof Error?d.message:"Failed to fetch courses")}finally{n(!1)}},[]),l=O.useCallback(async f=>{try{s(null);const d=await zf.create(f);return e(p=>[d,...p]),d}catch(d){throw s(d instanceof Error?d.message:"Failed to create course"),d}},[]),c=O.useCallback(async(f,d)=>{try{s(null);const p=await zf.update(f,d);return e(m=>m.map(x=>x.id===f?p:x)),p}catch(p){throw s(p instanceof Error?p.message:"Failed to update course"),p}},[]),u=O.useCallback(async f=>{try{s(null),await zf.delete(f),e(d=>d.filter(p=>p.id!==f))}catch(d){throw s(d instanceof Error?d.message:"Failed to delete course"),d}},[]);return O.useEffect(()=>{o()},[]),{courses:t,loading:r,error:i,fetchCourses:o,createCourse:l,updateCourse:c,deleteCourse:u}}function C8(t,e){const{user:r}=Ln(),[n,i]=O.useState(null),[s,o]=O.useState(null),[l,c]=O.useState(null),[u,f]=O.useState(!1),[d,p]=O.useState(!1),[m,x]=O.useState(!1),[y,v]=O.useState(!1),[b,w]=O.useState(null),[N,j]=O.useState(!1),k=O.useCallback(async($=!1)=>{try{v(!0),w(null);const F=await W5.getStructure(t,e,{includeBlocks:!0,includeProgress:$,userId:r==null?void 0:r.id});if(F.pages.length===0&&(r!=null&&r.id)&&!N){console.log("No pages found, auto-creating Page 1 (ONCE ONLY)"),j(!0);try{await new Promise(W=>setTimeout(W,100));const z=await W5.getStructure(t,e,{includeBlocks:!1,includeProgress:!1,userId:r.id});if(z.pages.length===0){console.log("Confirmed no pages exist, creating Page 1");const W=await YN.create({title:"Page 1",description:"",status:"draft",is_locked:!1,[t==="mission"?"mission_id":"course_id"]:e,order_index:0,unlock_conditions:{},page_config:{},created_by:r.id});F.pages=[W],console.log("Page 1 auto-created successfully:",W.id)}else console.log("Pages were created concurrently, using existing pages:",z.pages.length),F.pages=z.pages}catch(z){console.error("Failed to auto-create Page 1:",z)}finally{j(!1)}}i(F),F.pages.length>0&&!s&&(o(F.pages[0]),console.log("Set current page to:",F.pages[0].title))}catch(F){w(F instanceof Error?F.message:"Failed to load page structure")}finally{v(!1),j(!1)}},[t,e,r==null?void 0:r.id,N]),_=O.useCallback(async $=>{try{w(null);const F=await YN.create({...$,status:$.status||"draft",is_locked:$.is_locked||!1,[t==="mission"?"mission_id":"course_id"]:e,order_index:(n==null?void 0:n.pages.length)||0,unlock_conditions:{},page_config:{},created_by:(r==null?void 0:r.id)||""});return await k(),o(F),F}catch(F){throw w(F instanceof Error?F.message:"Failed to create page"),F}},[t,e,n==null?void 0:n.pages.length,r==null?void 0:r.id,k]),E=O.useCallback(async $=>{if(s)try{w(null);const F=await YN.update(s.id,$);return o(F),n&&i({...n,pages:n.pages.map(z=>z.id===s.id?F:z)}),F}catch(F){throw w(F instanceof Error?F.message:"Failed to update page"),F}},[s,n]),A=O.useCallback(async($,F={})=>{var z;if(!(!s||!(r!=null&&r.id)))try{w(null);const W=await Uf.create({page_id:s.id,block_type:$,order_index:((z=s.blocks)==null?void 0:z.length)||0,config:{},style:{},content:F,visibility_conditions:{},is_visible:!0,created_by:r.id}),K=[...s.blocks||[],W];return o({...s,blocks:K}),W}catch(W){throw w(W instanceof Error?W.message:"Failed to create block"),W}},[s,r==null?void 0:r.id]),T=O.useCallback(async($,F)=>{var z;if(s)try{w(null);const W=await Uf.update($,F),K=((z=s.blocks)==null?void 0:z.map(q=>q.id===$?W:q))||[];return o({...s,blocks:K}),(l==null?void 0:l.id)===$&&c(W),W}catch(W){throw w(W instanceof Error?W.message:"Failed to update block"),W}},[s,l]),M=O.useCallback(async $=>{var F;if(s)try{w(null),await Uf.delete($);const z=((F=s.blocks)==null?void 0:F.filter(W=>W.id!==$))||[];o({...s,blocks:z}),(l==null?void 0:l.id)===$&&c(null)}catch(z){throw w(z instanceof Error?z.message:"Failed to delete block"),z}},[s,l]),P=O.useCallback(async $=>{if(s)try{w(null),await Uf.reorder($);const F=$.map((z,W)=>{var q;const K=(q=s.blocks)==null?void 0:q.find(V=>V.id===z);return K?{...K,order_index:W}:null}).filter(Boolean);o({...s,blocks:F})}catch(F){throw w(F instanceof Error?F.message:"Failed to reorder blocks"),F}},[s]),R=O.useCallback($=>{o($),c(null)},[]),L=O.useCallback($=>{n!=null&&n.pages&&n.pages[$]&&R(n.pages[$])},[n==null?void 0:n.pages,R]);return O.useEffect(()=>{e&&k()},[e,k]),{structure:n,currentPage:s,selectedBlock:l,isEditing:u,isDragging:d,previewMode:m,loading:y,error:b,loadStructure:k,createPage:_,updatePage:E,navigateToPage:R,navigateToPageIndex:L,createBlock:A,updateBlock:T,deleteBlock:M,reorderBlocks:P,setSelectedBlock:c,setIsEditing:f,setIsDragging:p,setPreviewMode:x}}function A8(t,e){const{user:r}=Ln(),[n,i]=O.useState([]),[s,o]=O.useState(!1),[l,c]=O.useState(null),u=O.useCallback(async()=>{if(r!=null&&r.id)try{o(!0),c(null);const p=await H5.getUserProgress(r.id,t,e);i(p)}catch(p){c(p instanceof Error?p.message:"Failed to load progress")}finally{o(!1)}},[r==null?void 0:r.id,t,e]),f=O.useCallback(async p=>{if(r!=null&&r.id)try{c(null);const m=await H5.trackProgress({userId:r.id,[t==="mission"?"missionId":"courseId"]:e,...p});return i(x=>[m.progress,...x]),m}catch(m){throw c(m instanceof Error?m.message:"Failed to track progress"),m}},[r==null?void 0:r.id,t,e]),d=O.useMemo(()=>{const p=n.filter(w=>w.progress_type==="page_completed"),m=n.filter(w=>w.progress_type==="block_interacted"),x=n.filter(w=>w.progress_type==="quiz_completed"),y=n.reduce((w,N)=>w+N.time_spent_seconds,0),v=n.length>0?n.reduce((w,N)=>w+N.completion_percentage,0)/n.length:0,b=n.length>0?n.reduce((w,N)=>new Date(N.created_at)>new Date(w.created_at)?N:w):null;return{totalPages:new Set(n.map(w=>w.page_id).filter(Boolean)).size,completedPages:new Set(p.map(w=>w.page_id)).size,totalInteractions:m.length,completedQuizzes:x.length,totalTimeSpent:y,averageCompletion:Math.round(v*100)/100,lastActivity:b}},[n]);return O.useEffect(()=>{u()},[u]),{progress:n,progressMetrics:d,loading:s,error:l,loadProgress:u,trackProgress:f}}function fe({className:t,variant:e="default",size:r="default",children:n,...i}){const s={default:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 text-gray-700 focus:ring-gray-500",link:"bg-transparent underline text-blue-600 hover:text-blue-700"},o={default:"px-4 py-2 text-sm",sm:"px-3 py-1.5 text-sm",lg:"px-6 py-3 text-base"};return a.jsx("button",{className:ge("inline-flex items-center justify-center rounded-md font-medium transition-colors","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:pointer-events-none",s[e],o[r],t),...i,children:n})}const ct=Z.forwardRef(({className:t,...e},r)=>a.jsx("input",{ref:r,className:ge("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm","placeholder:text-gray-400","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","disabled:cursor-not-allowed disabled:opacity-50",t),...e}));ct.displayName="Input";function At({className:t,variant:e="default",children:r,...n}){const i={default:"bg-blue-100 text-blue-800 border-blue-200",secondary:"bg-gray-100 text-gray-800 border-gray-200",destructive:"bg-red-100 text-red-800 border-red-200",outline:"bg-transparent border-gray-300 text-gray-700"};return a.jsx("span",{className:ge("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border",i[e],t),...n,children:r})}function T8({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:s="Confirm",cancelText:o="Cancel",variant:l="default",isLoading:c=!1}){const u=async()=>{try{await r()}catch(f){console.error("Confirmation action failed:",f)}};return t?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:c?void 0:e}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${l==="destructive"?"bg-red-100":"bg-yellow-100"}`,children:a.jsx(Pl,{className:`w-5 h-5 ${l==="destructive"?"text-red-600":"text-yellow-600"}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n}),a.jsx("p",{className:"text-gray-600",children:i})]})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:e,disabled:c,children:o}),a.jsx(fe,{onClick:u,disabled:c,variant:l==="destructive"?"destructive":"default",className:"min-w-[100px]",children:c?a.jsx(i_,{className:"w-4 h-4 animate-spin"}):s})]})]})]}):null}function Yye(){const t=Ti(),{user:e}=Ln(),[r,n]=O.useState("wods"),[i,s]=O.useState(""),[o,l]=O.useState("all"),[c,u]=O.useState("closed"),[f,d]=O.useState(null),[p,m]=O.useState(!1);Z.useEffect(()=>{console.log("Modal state changed to:",c,"Selected item:",(f==null?void 0:f.title)||"none")},[c,f]);const{missions:x,loading:y,error:v,createMission:b,deleteMission:w}=Kye(),{courses:N,loading:j,error:k,createCourse:_,deleteCourse:E}=Gye(),A=r==="wods"?y:j,T=r==="wods"?v:k,P=(r==="wods"?x:N).filter(q=>{const V=q.title.toLowerCase().includes(i.toLowerCase())||(q.description||"").toLowerCase().includes(i.toLowerCase()),D=o==="all"||q.status===o;return V&&D}),R=async()=>{console.log("Create new clicked, creating directly and navigating to builder"),m(!0);try{if(r==="wods"){const q=await b({title:"Untitled WOD",description:"",status:"draft",thumbnail_url:"",estimated_duration_minutes:void 0,difficulty_level:void 0,tags:[],created_by:(e==null?void 0:e.id)||""});console.log("WOD created successfully:",q.id),t(`/training-zone/wods/${q.id}`)}else{const q=await _({title:"Untitled Block",description:"",status:"draft",thumbnail_url:"",estimated_duration_minutes:void 0,difficulty_level:void 0,tags:[],prerequisite_course_ids:[],created_by:(e==null?void 0:e.id)||""});console.log("Block created successfully:",q.id),t(`/training-zone/blocks/${q.id}`)}}catch(q){console.error("Failed to create new item:",q)}finally{m(!1)}},L=q=>{t(r==="wods"?`/training-zone/wods/${q.id}`:`/training-zone/blocks/${q.id}`)},$=q=>{console.log("Edit clicked for:",q.title,"Navigating directly to builder"),t(r==="wods"?`/training-zone/wods/${q.id}`:`/training-zone/blocks/${q.id}`)},F=q=>{console.log("Delete clicked for:",q.title,"Setting modal state to delete"),d(q),u("delete")},z=async()=>{if(!f)return;m(!0);const q=new AbortController,V=setTimeout(()=>{q.abort(),m(!1),console.error("Delete operation timed out")},15e3);try{r==="wods"?await w(f.id):await E(f.id),clearTimeout(V),u("closed"),d(null)}catch(D){clearTimeout(V),console.error("Failed to delete:",D)}finally{m(!1)}},W=q=>{switch(q){case"published":return"default";case"draft":return"secondary";case"archived":return"outline";default:return"secondary"}},K=q=>{switch(q){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return a.jsxs(pr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Training Zone"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage WODs (Workouts of the Day), Blocks, and Programs"})]}),a.jsx("div",{className:"flex items-center space-x-3",children:a.jsxs(fe,{onClick:R,className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsxs("span",{children:["Create ",r==="wods"?"WOD":"Block"]})]})})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsx("button",{onClick:()=>n("wods"),className:ge("py-2 px-1 border-b-2 font-medium text-sm transition-colors",r==="wods"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Bw,{className:"w-4 h-4"}),a.jsx("span",{children:"WODs"}),a.jsx(At,{variant:"outline",className:"ml-1",children:x.length})]})}),a.jsx("button",{onClick:()=>n("blocks"),className:ge("py-2 px-1 border-b-2 font-medium text-sm transition-colors",r==="blocks"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Zn,{className:"w-4 h-4"}),a.jsx("span",{children:"Blocks"}),a.jsx(At,{variant:"outline",className:"ml-1",children:N.length})]})}),a.jsx("button",{onClick:()=>n("programs"),className:ge("py-2 px-1 border-b-2 font-medium text-sm transition-colors",r==="programs"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Fl,{className:"w-4 h-4"}),a.jsx("span",{children:"Programs"}),a.jsx(At,{variant:"outline",className:"ml-1",children:"0"})]})})]})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"flex-1 max-w-md",children:a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx(ct,{type:"text",placeholder:`Search ${r}...`,value:i,onChange:q=>s(q.target.value),className:"pl-10"})]})}),a.jsxs("select",{value:o,onChange:q=>l(q.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"published",children:"Published"}),a.jsx("option",{value:"archived",children:"Archived"})]})]}),A?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):T?a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:a.jsxs("p",{className:"text-red-800",children:["Error: ",T]})}):P.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:r==="wods"?a.jsx(Bw,{className:"w-12 h-12 mx-auto"}):a.jsx(Zn,{className:"w-12 h-12 mx-auto"})}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",r," found"]}),a.jsx("p",{className:"text-gray-500 mb-6",children:i||o!=="all"?`No ${r} match your search criteria.`:`Get started by creating your first ${r==="wods"?"WOD":"block"}.`}),!i&&o==="all"&&a.jsxs(fe,{onClick:R,children:[a.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Create ",r==="wods"?"WOD":"Block"]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(q=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg hover:shadow-lg transition-shadow group relative",children:[a.jsxs("div",{className:"absolute top-4 right-4 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[a.jsx(fe,{variant:"outline",size:"sm",onClick:V=>{V.stopPropagation(),$(q)},className:"w-8 h-8 p-0",children:a.jsx(yo,{className:"w-3 h-3"})}),a.jsx(fe,{variant:"outline",size:"sm",onClick:V=>{V.stopPropagation(),F(q)},className:"w-8 h-8 p-0 text-red-600 border-red-200 hover:bg-red-50",children:a.jsx(ns,{className:"w-3 h-3"})})]}),a.jsxs("div",{onClick:()=>L(q),className:"p-6 cursor-pointer",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[r==="wods"?a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Bw,{className:"w-4 h-4 text-blue-600"})}):a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Zn,{className:"w-4 h-4 text-green-600"})}),a.jsx(At,{variant:W(q.status),children:q.status})]}),q.thumbnail_url&&a.jsx("img",{src:q.thumbnail_url,alt:"Thumbnail",className:"w-12 h-12 rounded-lg object-cover"})]}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:q.title}),q.description&&a.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:q.description}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[q.difficulty_level&&a.jsx("span",{className:ge("px-2 py-1 rounded-full text-xs font-medium",K(q.difficulty_level)),children:q.difficulty_level}),q.estimated_duration_minutes&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{className:"w-3 h-3"}),a.jsxs("span",{children:[q.estimated_duration_minutes,"min"]})]})]}),a.jsx("span",{className:"text-xs",children:new Date(q.updated_at).toLocaleDateString()})]})]})]},q.id))})]}),a.jsx(T8,{isOpen:c==="delete",onClose:()=>{u("closed"),d(null)},onConfirm:z,title:`Delete ${r==="wods"?"WOD":"Block"}`,message:`Are you sure you want to delete "${f==null?void 0:f.title}"? This action cannot be undone.`,confirmText:"Delete",variant:"destructive",isLoading:p})]})}const Xye={section_header:{type:"section_header",label:"Section Header",icon:"Heading",category:"foundational",description:"Create section headers with different levels",defaultContent:{title:"Section Title",level:2},defaultConfig:{},defaultStyle:{marginBottom:"1rem"},isInteractive:!1},rich_text:{type:"rich_text",label:"Rich Text",icon:"Type",category:"foundational",description:"Rich text editor with formatting options",defaultContent:{html:"<p>Enter your text here...</p>",text:"Enter your text here..."},defaultConfig:{},defaultStyle:{},isInteractive:!1},image:{type:"image",label:"Image",icon:"Image",category:"foundational",description:"Add images with captions",defaultContent:{src:"",alt:"Image",caption:""},defaultConfig:{},defaultStyle:{},isInteractive:!1},list:{type:"list",label:"List",icon:"List",category:"foundational",description:"Create ordered or unordered lists",defaultContent:{type:"unordered",items:[{id:"1",text:"First item"}]},defaultConfig:{},defaultStyle:{},isInteractive:!1},quote:{type:"quote",label:"Quote",icon:"Quote",category:"foundational",description:"Add inspirational quotes",defaultContent:{text:"Quote text",author:"",source:""},defaultConfig:{},defaultStyle:{},isInteractive:!1},divider:{type:"divider",label:"Divider",icon:"Minus",category:"foundational",description:"Add visual dividers between content",defaultContent:{},defaultConfig:{},defaultStyle:{margin:"2rem 0"},isInteractive:!1},video:{type:"video",label:"Video",icon:"Play",category:"embedded",description:"Embed videos with progress tracking",defaultContent:{url:"",controls:!0,autoplay:!1},defaultConfig:{},defaultStyle:{},isInteractive:!0},agent:{type:"agent",label:"AI Agent",icon:"Bot",category:"embedded",description:"Interactive AI agent conversations",defaultContent:{agent_id:"",agent_name:"AI Assistant",initial_message:"Hello! How can I help you?"},defaultConfig:{},defaultStyle:{},isInteractive:!0},document:{type:"document",label:"Document",icon:"FileText",category:"embedded",description:"Embed documents and guides",defaultContent:{document_id:"",title:"Document",display_mode:"embedded"},defaultConfig:{},defaultStyle:{},isInteractive:!0},prompt:{type:"prompt",label:"Prompt",icon:"MessageSquare",category:"embedded",description:"Reusable prompt templates",defaultContent:{prompt_id:"",title:"Prompt",show_copy_button:!0},defaultConfig:{},defaultStyle:{},isInteractive:!0},automation:{type:"automation",label:"Automation",icon:"Zap",category:"embedded",description:"Embed automation workflows and tools",defaultContent:{automation_id:"",automation_name:"Automation",display_mode:"embedded"},defaultConfig:{},defaultStyle:{},isInteractive:!0},quiz:{type:"quiz",label:"Quiz",icon:"HelpCircle",category:"interactive",description:"Create interactive quizzes",defaultContent:{title:"Quiz",questions:[{id:"1",question:"Sample question?",type:"multiple_choice",options:["Option 1","Option 2"],correct_answer:"Option 1",points:1}]},defaultConfig:{},defaultStyle:{},isInteractive:!0},user_submission:{type:"user_submission",label:"User Submission",icon:"Upload",category:"interactive",description:"Collect user submissions and files",defaultContent:{title:"Submit Your Work",submission_type:"text",instructions:"Please provide your submission below"},defaultConfig:{},defaultStyle:{},isInteractive:!0},accordion:{type:"accordion",label:"Accordion",icon:"ChevronDown",category:"interactive",description:"Collapsible content sections",defaultContent:{items:[{id:"1",title:"Section 1",content:"Content for section 1",is_open_by_default:!1}],allow_multiple_open:!0},defaultConfig:{},defaultStyle:{},isInteractive:!0}};var XN={exports:{}},JN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
--
 * LICENSE file in the root directory of this source tree.
 */var V5;function Jye(){if(V5)return JN;V5=1;var t=ad();function e(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function l(d,p){var m=p(),x=n({inst:{value:m,getSnapshot:p}}),y=x[0].inst,v=x[1];return s(function(){y.value=m,y.getSnapshot=p,c(y)&&v({inst:y})},[d,m,p]),i(function(){return c(y)&&v({inst:y}),d(function(){c(y)&&v({inst:y})})},[d]),o(m),m}function c(d){var p=d.getSnapshot;d=d.value;try{var m=p();return!r(d,m)}catch{return!0}}function u(d,p){return p()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return JN.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,JN}var K5;function P8(){return K5||(K5=1,XN.exports=Jye()),XN.exports}var M8=P8();function Hr(t){this.content=t}Hr.prototype={constructor:Hr,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,r){var n=r&&r!=t?this.remove(r):this,i=n.find(t),s=n.content.slice();return i==-1?s.push(r||t,e):(s[i+1]=e,r&&(s[i]=r)),new Hr(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var r=this.content.slice();return r.splice(e,2),new Hr(r)},addToStart:function(t,e){return new Hr([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var r=this.remove(t).content.slice();return r.push(t,e),new Hr(r)},addBefore:function(t,e,r){var n=this.remove(e),i=n.content.slice(),s=n.find(t);return i.splice(s==-1?i.length:s,0,e,r),new Hr(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Hr.from(t),t.size?new Hr(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Hr.from(t),t.size?new Hr(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Hr.from(t);for(var r=0;r<t.content.length;r+=2)e=e.remove(t.content[r]);return e},toObject:function(){var t={};return this.forEach(function(e,r){t[e]=r}),t},get size(){return this.content.length>>1}};Hr.from=function(t){if(t instanceof Hr)return t;var e=[];if(t)for(var r in t)e.push(r,t[r]);return new Hr(e)};function R8(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let i=t.child(n),s=e.child(n);if(i==s){r+=i.nodeSize;continue}if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)r++;return r}if(i.content.size||s.content.size){let o=R8(i.content,s.content,r+1);if(o!=null)return o}r+=i.nodeSize}}function I8(t,e,r,n){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:r,b:n};let o=t.child(--i),l=e.child(--s),c=o.nodeSize;if(o==l){r-=c,n-=c;continue}if(!o.sameMarkup(l))return{a:r,b:n};if(o.isText&&o.text!=l.text){let u=0,f=Math.min(o.text.length,l.text.length);for(;u<f&&o.text[o.text.length-u-1]==l.text[l.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(o.content.size||l.content.size){let u=I8(o.content,l.content,r-1,n-1);if(u)return u}r-=c,n-=c}}class Ne{constructor(e,r){if(this.content=e,this.size=r||0,r==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,r,n,i=0,s){for(let o=0,l=0;l<r;o++){let c=this.content[o],u=l+c.nodeSize;if(u>e&&n(c,i+l,s||null,o)!==!1&&c.content.size){let f=l+1;c.nodesBetween(Math.max(0,e-f),Math.min(c.content.size,r-f),n,i+f)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,r,n,i){let s="",o=!0;return this.nodesBetween(e,r,(l,c)=>{let u=l.isText?l.text.slice(Math.max(e,c)-c,r-c):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&n&&(o?o=!1:s+=n),s+=u},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let r=this.lastChild,n=e.firstChild,i=this.content.slice(),s=0;for(r.isText&&r.sameMarkup(n)&&(i[i.length-1]=r.withText(r.text+n.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new Ne(i,this.size+e.size)}cut(e,r=this.size){if(e==0&&r==this.size)return this;let n=[],i=0;if(r>e)for(let s=0,o=0;o<r;s++){let l=this.content[s],c=o+l.nodeSize;c>e&&((o<e||c>r)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,r-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,r-o-1))),n.push(l),i+=l.nodeSize),o=c}return new Ne(n,i)}cutByIndex(e,r){return e==r?Ne.empty:e==0&&r==this.content.length?this:new Ne(this.content.slice(e,r))}replaceChild(e,r){let n=this.content[e];if(n==r)return this;let i=this.content.slice(),s=this.size+r.nodeSize-n.nodeSize;return i[e]=r,new Ne(i,s)}addToStart(e){return new Ne([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ne(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(e.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let r=this.content[e];if(!r)throw new RangeError("Index "+e+" out of range for "+this);return r}maybeChild(e){return this.content[e]||null}forEach(e){for(let r=0,n=0;r<this.content.length;r++){let i=this.content[r];e(i,n,r),n+=i.nodeSize}}findDiffStart(e,r=0){return R8(this,e,r)}findDiffEnd(e,r=this.size,n=e.size){return I8(this,e,r,n)}findIndex(e){if(e==0)return Tg(0,e);if(e==this.size)return Tg(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=this.child(r),s=n+i.nodeSize;if(s>=e)return s==e?Tg(r+1,s):Tg(r,n);n=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,r){if(!r)return Ne.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ne(r.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ne.empty;let r,n=0;for(let i=0;i<e.length;i++){let s=e[i];n+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(r||(r=e.slice(0,i)),r[r.length-1]=s.withText(r[r.length-1].text+s.text)):r&&r.push(s)}return new Ne(r||e,n)}static from(e){if(!e)return Ne.empty;if(e instanceof Ne)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ne([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ne.empty=new Ne([],0);const QN={index:0,offset:0};function Tg(t,e){return QN.index=t,QN.offset=e,QN}function bv(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(e)!=r)return!1;if(r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!bv(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!bv(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let Tt=class A2{constructor(e,r){this.type=e,this.attrs=r}addToSet(e){let r,n=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))r||(r=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!n&&s.type.rank>this.type.rank&&(r||(r=e.slice(0,i)),r.push(this),n=!0),r&&r.push(s)}}return r||(r=e.slice()),n||r.push(this),r}removeFromSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return e.slice(0,r).concat(e.slice(r+1));return e}isInSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return!0;return!1}eq(e){return this==e||this.type==e.type&&bv(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=n.create(r.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,r){if(e==r)return!0;if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(r[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return A2.none;if(e instanceof A2)return[e];let r=e.slice();return r.sort((n,i)=>n.type.rank-i.type.rank),r}};Tt.none=[];class wv extends Error{}class Ie{constructor(e,r,n){this.content=e,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,r){let n=L8(this.content,e+this.openStart,r);return n&&new Ie(n,this.openStart,this.openEnd)}removeBetween(e,r){return new Ie(D8(this.content,e+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,r){if(!r)return Ie.empty;let n=r.openStart||0,i=r.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ie(Ne.fromJSON(e,r.content),n,i)}static maxOpen(e,r=!0){let n=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(r||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=e.lastChild;s&&!s.isLeaf&&(r||!s.type.spec.isolating);s=s.lastChild)i++;return new Ie(e,n,i)}}Ie.empty=new Ie(Ne.empty,0,0);function D8(t,e,r){let{index:n,offset:i}=t.findIndex(e),s=t.maybeChild(n),{index:o,offset:l}=t.findIndex(r);if(i==e||s.isText){if(l!=r&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(n,s.copy(D8(s.content,e-i-1,r-i-1)))}function L8(t,e,r,n){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return n&&!n.canReplace(i,i,r)?null:t.cut(0,e).append(r).append(t.cut(e));let l=L8(o.content,e-s-1,r,o);return l&&t.replaceChild(i,o.copy(l))}function Qye(t,e,r){if(r.openStart>t.depth)throw new wv("Inserted content deeper than insertion position");if(t.depth-r.openStart!=e.depth-r.openEnd)throw new wv("Inconsistent open depths");return $8(t,e,r,0)}function $8(t,e,r,n){let i=t.index(n),s=t.node(n);if(i==e.index(n)&&n<t.depth-r.openStart){let o=$8(t,e,r,n+1);return s.copy(s.content.replaceChild(i,o))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==n&&e.depth==n){let o=t.parent,l=o.content;return Dl(o,l.cut(0,t.parentOffset).append(r.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=Zye(r,t);return Dl(s,F8(t,o,l,e,n))}else return Dl(s,jv(t,e,n))}function B8(t,e){if(!e.type.compatibleContent(t.type))throw new wv("Cannot join "+e.type.name+" onto "+t.type.name)}function T2(t,e,r){let n=t.node(r);return B8(n,e.node(r)),n}function Il(t,e){let r=e.length-1;r>=0&&t.isText&&t.sameMarkup(e[r])?e[r]=t.withText(e[r].text+t.text):e.push(t)}function ah(t,e,r,n){let i=(e||t).node(r),s=0,o=e?e.index(r):i.childCount;t&&(s=t.index(r),t.depth>r?s++:t.textOffset&&(Il(t.nodeAfter,n),s++));for(let l=s;l<o;l++)Il(i.child(l),n);e&&e.depth==r&&e.textOffset&&Il(e.nodeBefore,n)}function Dl(t,e){return t.type.checkContent(e),t.copy(e)}function F8(t,e,r,n,i){let s=t.depth>i&&T2(t,e,i+1),o=n.depth>i&&T2(r,n,i+1),l=[];return ah(null,t,i,l),s&&o&&e.index(i)==r.index(i)?(B8(s,o),Il(Dl(s,F8(t,e,r,n,i+1)),l)):(s&&Il(Dl(s,jv(t,e,i+1)),l),ah(e,r,i,l),o&&Il(Dl(o,jv(r,n,i+1)),l)),ah(n,null,i,l),new Ne(l)}function jv(t,e,r){let n=[];if(ah(null,t,r,n),t.depth>r){let i=T2(t,e,r+1);Il(Dl(i,jv(t,e,r+1)),n)}return ah(e,null,r,n),new Ne(n)}function Zye(t,e){let r=e.depth-t.openStart,i=e.node(r).copy(t.content);for(let s=r-1;s>=0;s--)i=e.node(s).copy(Ne.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class lp{constructor(e,r,n){this.pos=e,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,r=this.index(this.depth);if(r==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(r);return n?e.child(r).cut(n):i}get nodeBefore(){let e=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(e).cut(0,r):e==0?null:this.parent.child(e-1)}posAtIndex(e,r){r=this.resolveDepth(r);let n=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let s=0;s<e;s++)i+=n.child(s).nodeSize;return i}marks(){let e=this.parent,r=this.index();if(e.content.size==0)return Tt.none;if(this.textOffset)return e.child(r).marks;let n=e.maybeChild(r-1),i=e.maybeChild(r);if(!n){let l=n;n=i,i=l}let s=n.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<n.length;s++)n[s].type.spec.inclusive===!1&&(!i||!n[s].isInSet(i.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(e){for(let r=this.depth;r>0;r--)if(this.start(r)<=e&&this.end(r)>=e)return r;return 0}blockRange(e=this,r){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!r||r(this.node(n))))return new Sv(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let r=1;r<=this.depth;r++)e+=(e?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return e+":"+this.parentOffset}static resolve(e,r){if(!(r>=0&&r<=e.content.size))throw new RangeError("Position "+r+" out of range");let n=[],i=0,s=r;for(let o=e;;){let{index:l,offset:c}=o.content.findIndex(s),u=s-c;if(n.push(o,l,i+c),!u||(o=o.child(l),o.isText))break;s=u-1,i+=c+1}return new lp(r,n,s)}static resolveCached(e,r){let n=G5.get(e);if(n)for(let s=0;s<n.elts.length;s++){let o=n.elts[s];if(o.pos==r)return o}else G5.set(e,n=new eve);let i=n.elts[n.i]=lp.resolve(e,r);return n.i=(n.i+1)%tve,i}}class eve{constructor(){this.elts=[],this.i=0}}const tve=12,G5=new WeakMap;class Sv{constructor(e,r,n){this.$from=e,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const rve=Object.create(null);let Na=class P2{constructor(e,r,n,i=Tt.none){this.type=e,this.attrs=r,this.marks=i,this.content=n||Ne.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,r,n,i=0){this.content.nodesBetween(e,r,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,r,n,i){return this.content.textBetween(e,r,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,r,n){return this.type==e&&bv(this.attrs,r||e.defaultAttrs||rve)&&Tt.sameSet(this.marks,n||Tt.none)}copy(e=null){return e==this.content?this:new P2(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new P2(this.type,this.attrs,this.content,e)}cut(e,r=this.content.size){return e==0&&r==this.content.size?this:this.copy(this.content.cut(e,r))}slice(e,r=this.content.size,n=!1){if(e==r)return Ie.empty;let i=this.resolve(e),s=this.resolve(r),o=n?0:i.sharedDepth(r),l=i.start(o),u=i.node(o).content.cut(i.pos-l,s.pos-l);return new Ie(u,i.depth-o,s.depth-o)}replace(e,r,n){return Qye(this.resolve(e),this.resolve(r),n)}nodeAt(e){for(let r=this;;){let{index:n,offset:i}=r.content.findIndex(e);if(r=r.maybeChild(n),!r)return null;if(i==e||r.isText)return r;e-=i+1}}childAfter(e){let{index:r,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(r),index:r,offset:n};let i=this.content.child(r-1);return{node:i,index:r-1,offset:n-i.nodeSize}}resolve(e){return lp.resolveCached(this,e)}resolveNoCache(e){return lp.resolve(this,e)}rangeHasMark(e,r,n){let i=!1;return r>e&&this.nodesBetween(e,r,s=>(n.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),q8(this.marks,e)}contentMatchAt(e){let r=this.type.contentMatch.matchFragment(this.content,0,e);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(e,r,n=Ne.empty,i=0,s=n.childCount){let o=this.contentMatchAt(e).matchFragment(n,i,s),l=o&&o.matchFragment(this.content,r);if(!l||!l.validEnd)return!1;for(let c=i;c<s;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0}canReplaceWith(e,r,n,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(n),o=s&&s.matchFragment(this.content,r);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Tt.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Tt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(r=>r.toJSON())),e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(e.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(r.text,n)}let i=Ne.fromJSON(e,r.content),s=e.nodeType(r.type).create(r.attrs,i,n);return s.type.checkAttrs(s.attrs),s}};Na.prototype.text=void 0;class Nv extends Na{constructor(e,r,n,i){if(super(e,r,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):q8(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,r){return this.text.slice(e,r)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Nv(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Nv(this.type,this.attrs,e,this.marks)}cut(e=0,r=this.text.length){return e==0&&r==this.text.length?this:this.withText(this.text.slice(e,r))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function q8(t,e){for(let r=t.length-1;r>=0;r--)e=t[r].type.name+"("+e+")";return e}class Kl{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,r){let n=new nve(e,r);if(n.next==null)return Kl.empty;let i=z8(n);n.next&&n.err("Unexpected trailing text");let s=uve(cve(i));return dve(s,n),s}matchType(e){for(let r=0;r<this.next.length;r++)if(this.next[r].type==e)return this.next[r].next;return null}matchFragment(e,r=0,n=e.childCount){let i=this;for(let s=r;i&&s<n;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:r}=this.next[e];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(e){for(let r=0;r<this.next.length;r++)for(let n=0;n<e.next.length;n++)if(this.next[r].type==e.next[n].type)return!0;return!1}fillBefore(e,r=!1,n=0){let i=[this];function s(o,l){let c=o.matchFragment(e,n);if(c&&(!r||c.validEnd))return Ne.from(l.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:f,next:d}=o.next[u];if(!(f.isText||f.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let p=s(d,l.concat(f));if(p)return p}}return null}return s(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}computeWrapping(e){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:c}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in r)&&(!i.type||c.validEnd)&&(n.push({match:l.contentMatch,type:l,via:i}),r[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function r(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&r(n.next[i].next)}return r(this),e.map((n,i)=>{let s=i+(n.validEnd?"*":" ")+" ";for(let o=0;o<n.next.length;o++)s+=(o?", ":"")+n.next[o].type.name+"->"+e.indexOf(n.next[o].next);return s}).join(`
`)}}Kl.empty=new Kl(!0);class nve{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function z8(t){let e=[];do e.push(ive(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function ive(t){let e=[];do e.push(sve(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function sve(t){let e=lve(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=ove(t,e);else break;return e}function Y5(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function ove(t,e){let r=Y5(t),n=r;return t.eat(",")&&(t.next!="}"?n=Y5(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function ave(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let s in r){let o=r[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function lve(t){if(t.eat("(")){let e=z8(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=ave(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function cve(t){let e=[[]];return i(s(t,0),r()),e;function r(){return e.push([])-1}function n(o,l,c){let u={term:c,to:l};return e[o].push(u),u}function i(o,l){o.forEach(c=>c.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((c,u)=>c.concat(s(u,l)),[]);if(o.type=="seq")for(let c=0;;c++){let u=s(o.exprs[c],l);if(c==o.exprs.length-1)return u;i(u,l=r())}else if(o.type=="star"){let c=r();return n(l,c),i(s(o.expr,c),c),[n(c)]}else if(o.type=="plus"){let c=r();return i(s(o.expr,l),c),i(s(o.expr,c),c),[n(c)]}else{if(o.type=="opt")return[n(l)].concat(s(o.expr,l));if(o.type=="range"){let c=l;for(let u=0;u<o.min;u++){let f=r();i(s(o.expr,c),f),c=f}if(o.max==-1)i(s(o.expr,c),c);else for(let u=o.min;u<o.max;u++){let f=r();n(c,f),i(s(o.expr,c),f),c=f}return[n(c)]}else{if(o.type=="name")return[n(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function U8(t,e){return e-t}function X5(t,e){let r=[];return n(e),r.sort(U8);function n(i){let s=t[i];if(s.length==1&&!s[0].term)return n(s[0].to);r.push(i);for(let o=0;o<s.length;o++){let{term:l,to:c}=s[o];!l&&r.indexOf(c)==-1&&n(c)}}}function uve(t){let e=Object.create(null);return r(X5(t,0));function r(n){let i=[];n.forEach(o=>{t[o].forEach(({term:l,to:c})=>{if(!l)return;let u;for(let f=0;f<i.length;f++)i[f][0]==l&&(u=i[f][1]);X5(t,c).forEach(f=>{u||i.push([l,u=[]]),u.indexOf(f)==-1&&u.push(f)})})});let s=e[n.join(",")]=new Kl(n.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(U8);s.next.push({type:i[o][0],next:e[l.join(",")]||r(l)})}return s}}function dve(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:c,next:u}=i.next[l];o.push(c.name),s&&!(c.isText||c.hasRequiredAttrs())&&(s=!1),n.indexOf(u)==-1&&n.push(u)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function H8(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function W8(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let s=t[n];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function V8(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function K8(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new hve(t,n,e[n]);return r}let J5=class G8{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=K8(e,n.attrs),this.defaultAttrs=H8(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Kl.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:W8(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Na(this,this.computeAttrs(e),Ne.from(r),Tt.setFrom(n))}createChecked(e=null,r,n){return r=Ne.from(r),this.checkContent(r),new Na(this,this.computeAttrs(e),r,Tt.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=Ne.from(r),r.size){let o=this.contentMatch.fillBefore(r);if(!o)return null;r=o.append(r)}let i=this.contentMatch.matchFragment(r),s=i&&i.fillBefore(Ne.empty,!0);return s?new Na(this,e,r.append(s),Tt.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){V8(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:Tt.none:e}static compile(e,r){let n=Object.create(null);e.forEach((s,o)=>n[s]=new G8(s,r,o));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function fve(t,e,r){let n=r.split("|");return i=>{let s=i===null?"null":typeof i;if(n.indexOf(s)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${s}`)}}class hve{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?fve(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class mx{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=K8(e,i.attrs),this.excluded=null;let s=H8(this.attrs);this.instance=s?new Tt(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Tt(this,W8(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((s,o)=>n[s]=new mx(s,i++,r,o)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){V8(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Y8{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=Hr.from(e.nodes),r.marks=Hr.from(e.marks||{}),this.nodes=J5.compile(this.spec.nodes,this),this.marks=mx.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=n[o]||(n[o]=Kl.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?Q5(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Q5(this,o.split(" "))}this.nodeFromJSON=i=>Na.fromJSON(this,i),this.markFromJSON=i=>Tt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof J5){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new Nv(n,n.defaultAttrs,e,Tt.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function Q5(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],s=t.marks[i],o=s;if(s)r.push(s);else for(let l in t.marks){let c=t.marks[l];(i=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(i)>-1)&&r.push(o=c)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function pve(t){return t.tag!=null}function mve(t){return t.style!=null}class ka{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(pve(i))this.tags.push(i);else if(mve(i)){let s=/[^=]*/.exec(i.style)[0];n.indexOf(s)<0&&n.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,r={}){let n=new e$(this,r,!1);return n.addAll(e,Tt.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new e$(this,r,!0);return n.addAll(e,Tt.none,r.from,r.to),Ie.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(vve(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||r.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,r,n,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!n.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=r))){if(o.getAttrs){let c=o.getAttrs(r);if(c===!1)continue;o.attrs=c||void 0}return o}}}static schemaRules(e){let r=[];function n(i){let s=i.priority==null?50:i.priority,o=0;for(;o<r.length;o++){let l=r[o];if((l.priority==null?50:l.priority)<s)break}r.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{n(o=t$(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{n(o=t$(o)),o.node||o.ignore||o.mark||(o.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ka(e,ka.schemaRules(e)))}}const X8={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},gve={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},J8={ol:!0,ul:!0},cp=1,M2=2,ey=4;function Z5(t,e,r){return e!=null?(e?cp:0)|(e==="full"?M2:0):t&&t.whitespace=="pre"?cp|M2:r&-5}class Pg{constructor(e,r,n,i,s,o){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=o,this.content=[],this.activeMarks=Tt.none,this.match=s||(o&ey?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ne.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&cp)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let r=Ne.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(Ne.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!X8.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class e${constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,s,o=Z5(null,r.preserveWhitespace,0)|(n?ey:0);i?s=new Pg(i.type,i.attrs,Tt.none,!0,r.topMatch||i.type.contentMatch,o):n?s=new Pg(null,null,Tt.none,!0,null,o):s=new Pg(e.schema.topNodeType,null,Tt.none,!0,null,o),this.nodes=[s],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,s=i.options&M2?"full":this.localPreserveWS||(i.options&cp)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(s)s!=="full"?n=n.replace(/\r?\n|\r/g," "):n=n.replace(/\r\n?/g,`
`);else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),r,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,r,n){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;J8.hasOwnProperty(o)&&this.parser.normalizeLists&&yve(e);let c=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,n));e:if(c?c.ignore:gve.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,r);else if(!c||c.skip||c.closeParent){c&&c.closeParent?this.open=Math.max(0,this.open-1):c&&c.skip.nodeType&&(e=c.skip);let u,f=this.needsBlock;if(X8.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),u=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,r);break e}let d=c&&c.skip?r:this.readStyles(e,r);d&&this.addAll(e,d),u&&this.sync(s),this.needsBlock=f}else{let u=this.readStyles(e,r);u&&this.addElementByRule(e,c,u,c.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,r){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),r)}ignoreFallback(e,r){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(e,r){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=n.getPropertyValue(s);if(o)for(let l=void 0;;){let c=this.parser.matchStyle(s,o,this,l);if(!c)break;if(c.ignore)return null;if(c.clearMark?r=r.filter(u=>!c.clearMark(u)):r=r.concat(this.parser.schema.marks[c.mark].create(c.attrs)),c.consuming===!1)l=c;else break}}return r}addElementByRule(e,r,n,i){let s,o;if(r.node)if(o=this.parser.schema.nodes[r.node],o.isLeaf)this.insertNode(o.create(r.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let c=this.enter(o,r.attrs||null,n,r.preserveWhitespace);c&&(s=!0,n=c)}else{let c=this.parser.schema.marks[r.mark];n=n.concat(c.create(r.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(r.getContent)this.findInside(e),r.getContent(e,this.parser.schema).forEach(c=>this.insertNode(c,n,!1));else{let c=e;typeof r.contentElement=="string"?c=e.querySelector(r.contentElement):typeof r.contentElement=="function"?c=r.contentElement(e):r.contentElement&&(c=r.contentElement),this.findAround(e,c,!0),this.addAll(c,n),this.findAround(e,c,!1)}s&&this.sync(l)&&this.open--}addAll(e,r,n,i){let s=n||0;for(let o=n?e.childNodes[n]:e.firstChild,l=i==null?null:e.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,r);this.findAtPoint(e,s)}findPlace(e,r,n){let i,s;for(let o=this.open,l=0;o>=0;o--){let c=this.nodes[o],u=c.findWrapping(e);if(u&&(!i||i.length>u.length+l)&&(i=u,s=c,!u.length))break;if(c.solid){if(n)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)r=this.enterInner(i[o],null,r,!1);return r}insertNode(e,r,n){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(r=this.enterInner(s,null,r))}let i=this.findPlace(e,r,n);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=Tt.none;for(let l of i.concat(e.marks))(s.type?s.type.allowsMarkType(l.type):r$(l.type,e.type))&&(o=l.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,r,n,i){let s=this.findPlace(e.create(r),n,!1);return s&&(s=this.enterInner(e,r,n,!0,i)),s}enterInner(e,r,n,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=Z5(e,s,o.options);o.options&ey&&o.content.length==0&&(l|=ey);let c=Tt.none;return n=n.filter(u=>(o.type?o.type.allowsMarkType(u.type):r$(u.type,e))?(c=u.addToSet(c),!1):!0),this.nodes.push(new Pg(e,r,c,i,null,l)),this.open++,n}closeExtra(e=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let r=this.open;r>=0;r--){if(this.nodes[r]==e)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=cp)}return!1}get currentPos(){this.closeExtra();let e=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;r&&e++}return e}findAtPoint(e,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(e,r,n){if(e!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&(this.find[r].pos=this.currentPos-(e.nodeValue.length-this.find[r].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let r=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(i?0:1),o=(l,c)=>{for(;l>=0;l--){let u=r[l];if(u==""){if(l==r.length-1||l==0)continue;for(;c>=s;c--)if(o(l-1,c))return!0;return!1}else{let f=c>0||c==0&&i?this.nodes[c].type:n&&c>=s?n.node(c-s).type:null;if(!f||f.name!=u&&!f.isInGroup(u))return!1;c--}}return!0};return o(r.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let r=e.depth;r>=0;r--){let n=e.node(r).contentMatchAt(e.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function yve(t){for(let e=t.firstChild,r=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&J8.hasOwnProperty(n)&&r?(r.appendChild(e),e=r):n=="li"?r=e:n&&(r=null)}}function vve(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function t$(t){let e={};for(let r in t)e[r]=t[r];return e}function r$(t,e){let r=e.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(t))continue;let s=[],o=l=>{s.push(l);for(let c=0;c<l.edgeCount;c++){let{type:u,next:f}=l.edge(c);if(u==e||s.indexOf(f)<0&&o(f))return!0}};if(o(i.contentMatch))return!0}}class uc{constructor(e,r){this.nodes=e,this.marks=r}serializeFragment(e,r={},n){n||(n=ZN(r).createDocumentFragment());let i=n,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,c=0;for(;l<s.length&&c<o.marks.length;){let u=o.marks[c];if(!this.marks[u.type.name]){c++;continue}if(!u.eq(s[l][0])||u.type.spec.spanning===!1)break;l++,c++}for(;l<s.length;)i=s.pop()[1];for(;c<o.marks.length;){let u=o.marks[c++],f=this.serializeMark(u,o.isInline,r);f&&(s.push([u,i]),i.appendChild(f.dom),i=f.contentDOM||f.dom)}}i.appendChild(this.serializeNodeInner(o,r))}),n}serializeNodeInner(e,r){let{dom:n,contentDOM:i}=ty(ZN(r),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,r,i)}return n}serializeNode(e,r={}){let n=this.serializeNodeInner(e,r);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,r);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(e,r,n={}){let i=this.marks[e.type.name];return i&&ty(ZN(n),i(e,r),null,e.attrs)}static renderSpec(e,r,n=null,i){return ty(e,r,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new uc(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let r=n$(e.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(e){return n$(e.marks)}}function n$(t){let e={};for(let r in t){let n=t[r].spec.toDOM;n&&(e[r]=n)}return e}function ZN(t){return t.document||window.document}const i$=new WeakMap;function xve(t){let e=i$.get(t);return e===void 0&&i$.set(t,e=bve(t)),e}function bve(t){let e=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)r(n[i]);else for(let i in n)r(n[i])}return r(t),e}function ty(t,e,r,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(s=xve(n))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(r=i.slice(0,o),i=i.slice(o+1));let l,c=r?t.createElementNS(r,i):t.createElement(i),u=e[1],f=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){f=2;for(let d in u)if(u[d]!=null){let p=d.indexOf(" ");p>0?c.setAttributeNS(d.slice(0,p),d.slice(p+1),u[d]):d=="style"&&c.style?c.style.cssText=u[d]:c.setAttribute(d,u[d])}}for(let d=f;d<e.length;d++){let p=e[d];if(p===0){if(d<e.length-1||d>f)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:m,contentDOM:x}=ty(t,p,r,n);if(c.appendChild(m),x){if(l)throw new RangeError("Multiple content holes");l=x}}}return{dom:c,contentDOM:l}}const Q8=65535,Z8=Math.pow(2,16);function wve(t,e){return t+e*Z8}function s$(t){return t&Q8}function jve(t){return(t-(t&Q8))/Z8}const eU=1,tU=2,ry=4,rU=8;class R2{constructor(e,r,n){this.pos=e,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&rU)>0}get deletedBefore(){return(this.delInfo&(eU|ry))>0}get deletedAfter(){return(this.delInfo&(tU|ry))>0}get deletedAcross(){return(this.delInfo&ry)>0}}class Jn{constructor(e,r=!1){if(this.ranges=e,this.inverted=r,!e.length&&Jn.empty)return Jn.empty}recover(e){let r=0,n=s$(e);if(!this.inverted)for(let i=0;i<n;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+r+jve(e)}mapResult(e,r=1){return this._map(e,r,!1)}map(e,r=1){return this._map(e,r,!0)}_map(e,r,n){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?i:0);if(c>e)break;let u=this.ranges[l+s],f=this.ranges[l+o],d=c+u;if(e<=d){let p=u?e==c?-1:e==d?1:r:r,m=c+i+(p<0?0:f);if(n)return m;let x=e==(r<0?c:d)?null:wve(l/3,e-c),y=e==c?tU:e==d?eU:ry;return(r<0?e!=c:e!=d)&&(y|=rU),new R2(m,y,x)}i+=f-u}return n?e+i:new R2(e+i,0,null)}touches(e,r){let n=0,i=s$(r),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?n:0);if(c>e)break;let u=this.ranges[l+s],f=c+u;if(e<=f&&l==i*3)return!0;n+=this.ranges[l+o]-u}return!1}forEach(e){let r=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),c=o+(this.inverted?0:s),u=this.ranges[i+r],f=this.ranges[i+n];e(l,l+u,c,c+f),s+=f-u}}invert(){return new Jn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Jn.empty:new Jn(e<0?[0,-e,0]:[0,0,e])}}Jn.empty=new Jn([]);class up{constructor(e,r,n=0,i=e?e.length:0){this.mirror=r,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||r)}get maps(){return this._maps}slice(e=0,r=this.maps.length){return new up(this._maps,this.mirror,e,r)}appendMap(e,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(e){for(let r=0,n=this._maps.length;r<e._maps.length;r++){let i=e.getMirror(r);this.appendMap(e._maps[r],i!=null&&i<r?n+i:void 0)}}getMirror(e){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==e)return this.mirror[r+(r%2?-1:1)]}}setMirror(e,r){this.mirror||(this.mirror=[]),this.mirror.push(e,r)}appendMappingInverted(e){for(let r=e.maps.length-1,n=this._maps.length+e._maps.length;r>=0;r--){let i=e.getMirror(r);this.appendMap(e._maps[r].invert(),i!=null&&i>r?n-i-1:void 0)}}invert(){let e=new up;return e.appendMappingInverted(this),e}map(e,r=1){if(this.mirror)return this._map(e,r,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,r);return e}mapResult(e,r=1){return this._map(e,r,!1)}_map(e,r,n){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(e,r);if(l.recover!=null){let c=this.getMirror(s);if(c!=null&&c>s&&c<this.to){s=c,e=this._maps[c].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return n?e:new R2(e,i,null)}}const ek=Object.create(null);class cn{getMap(){return Jn.empty}merge(e){return null}static fromJSON(e,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=ek[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in ek)throw new RangeError("Duplicate use of step JSON ID "+e);return ek[e]=r,r.prototype.jsonID=e,r}}class hr{constructor(e,r){this.doc=e,this.failed=r}static ok(e){return new hr(e,null)}static fail(e){return new hr(null,e)}static fromReplace(e,r,n,i){try{return hr.ok(e.replace(r,n,i))}catch(s){if(s instanceof wv)return hr.fail(s.message);throw s}}}function UE(t,e,r){let n=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(UE(s.content,e,s))),s.isInline&&(s=e(s,r,i)),n.push(s)}return Ne.fromArray(n)}class va extends cn{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),s=new Ie(UE(r.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),r.openStart,r.openEnd);return hr.fromReplace(e,this.from,this.to,s)}invert(){return new es(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new va(r.pos,n.pos,this.mark)}merge(e){return e instanceof va&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new va(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new va(r.from,r.to,e.markFromJSON(r.mark))}}cn.jsonID("addMark",va);class es extends cn{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=new Ie(UE(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),r.openStart,r.openEnd);return hr.fromReplace(e,this.from,this.to,n)}invert(){return new va(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new es(r.pos,n.pos,this.mark)}merge(e){return e instanceof es&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new es(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new es(r.from,r.to,e.markFromJSON(r.mark))}}cn.jsonID("removeMark",es);class xa extends cn{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return hr.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return hr.fromReplace(e,this.pos,this.pos+1,new Ie(Ne.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(n))return new xa(this.pos,r.marks[i]);return new xa(this.pos,this.mark)}}return new Gl(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new xa(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new xa(r.pos,e.markFromJSON(r.mark))}}cn.jsonID("addNodeMark",xa);class Gl extends cn{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return hr.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return hr.fromReplace(e,this.pos,this.pos+1,new Ie(Ne.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new xa(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Gl(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Gl(r.pos,e.markFromJSON(r.mark))}}cn.jsonID("removeNodeMark",Gl);class Rr extends cn{constructor(e,r,n,i=!1){super(),this.from=e,this.to=r,this.slice=n,this.structure=i}apply(e){return this.structure&&I2(e,this.from,this.to)?hr.fail("Structure replace would overwrite content"):hr.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Jn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Rr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new Rr(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Rr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let r=this.slice.size+e.slice.size==0?Ie.empty:new Ie(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Rr(this.from,this.to+(e.to-e.from),r,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let r=this.slice.size+e.slice.size==0?Ie.empty:new Ie(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Rr(e.from,this.to,r,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Rr(r.from,r.to,Ie.fromJSON(e,r.slice),!!r.structure)}}cn.jsonID("replace",Rr);class Dr extends cn{constructor(e,r,n,i,s,o,l=!1){super(),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(I2(e,this.from,this.gapFrom)||I2(e,this.gapTo,this.to)))return hr.fail("Structure gap-replace would overwrite content");let r=e.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return hr.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?hr.fromReplace(e,this.from,this.to,n):hr.fail("Content does not fit in gap")}getMap(){return new Jn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let r=this.gapTo-this.gapFrom;return new Dr(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||i<r.pos||s>n.pos?null:new Dr(r.pos,n.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Dr(r.from,r.to,r.gapFrom,r.gapTo,Ie.fromJSON(e,r.slice),r.insert,!!r.structure)}}cn.jsonID("replaceAround",Dr);function I2(t,e,r){let n=t.resolve(e),i=r-e,s=n.depth;for(;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0){let o=n.node(s).maybeChild(n.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Sve(t,e,r,n){let i=[],s=[],o,l;t.doc.nodesBetween(e,r,(c,u,f)=>{if(!c.isInline)return;let d=c.marks;if(!n.isInSet(d)&&f.type.allowsMarkType(n.type)){let p=Math.max(u,e),m=Math.min(u+c.nodeSize,r),x=n.addToSet(d);for(let y=0;y<d.length;y++)d[y].isInSet(x)||(o&&o.to==p&&o.mark.eq(d[y])?o.to=m:i.push(o=new es(p,m,d[y])));l&&l.to==p?l.to=m:s.push(l=new va(p,m,n))}}),i.forEach(c=>t.step(c)),s.forEach(c=>t.step(c))}function Nve(t,e,r,n){let i=[],s=0;t.doc.nodesBetween(e,r,(o,l)=>{if(!o.isInline)return;s++;let c=null;if(n instanceof mx){let u=o.marks,f;for(;f=n.isInSet(u);)(c||(c=[])).push(f),u=f.removeFromSet(u)}else n?n.isInSet(o.marks)&&(c=[n]):c=o.marks;if(c&&c.length){let u=Math.min(l+o.nodeSize,r);for(let f=0;f<c.length;f++){let d=c[f],p;for(let m=0;m<i.length;m++){let x=i[m];x.step==s-1&&d.eq(i[m].style)&&(p=x)}p?(p.to=u,p.step=s):i.push({style:d,from:Math.max(l,e),to:u,step:s})}}}),i.forEach(o=>t.step(new es(o.from,o.to,o.style)))}function HE(t,e,r,n=r.contentMatch,i=!0){let s=t.doc.nodeAt(e),o=[],l=e+1;for(let c=0;c<s.childCount;c++){let u=s.child(c),f=l+u.nodeSize,d=n.matchType(u.type);if(!d)o.push(new Rr(l,f,Ie.empty));else{n=d;for(let p=0;p<u.marks.length;p++)r.allowsMarkType(u.marks[p].type)||t.step(new es(l,f,u.marks[p]));if(i&&u.isText&&r.whitespace!="pre"){let p,m=/\r?\n|\r/g,x;for(;p=m.exec(u.text);)x||(x=new Ie(Ne.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),o.push(new Rr(l+p.index,l+p.index+p[0].length,x))}}l=f}if(!n.validEnd){let c=n.fillBefore(Ne.empty,!0);t.replace(l,l,new Ie(c,0,0))}for(let c=o.length-1;c>=0;c--)t.step(o[c])}function kve(t,e,r){return(e==0||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function Sd(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth;;--n){let i=t.$from.node(n),s=t.$from.index(n),o=t.$to.indexAfter(n);if(n<t.depth&&i.canReplace(s,o,r))return n;if(n==0||i.type.spec.isolating||!kve(i,s,o))break}return null}function _ve(t,e,r){let{$from:n,$to:i,depth:s}=e,o=n.before(s+1),l=i.after(s+1),c=o,u=l,f=Ne.empty,d=0;for(let x=s,y=!1;x>r;x--)y||n.index(x)>0?(y=!0,f=Ne.from(n.node(x).copy(f)),d++):c--;let p=Ne.empty,m=0;for(let x=s,y=!1;x>r;x--)y||i.after(x+1)<i.end(x)?(y=!0,p=Ne.from(i.node(x).copy(p)),m++):u++;t.step(new Dr(c,u,o,l,new Ie(f.append(p),d,m),f.size-d,!0))}function WE(t,e,r=null,n=t){let i=Ove(t,e),s=i&&Eve(n,e);return s?i.map(o$).concat({type:e,attrs:r}).concat(s.map(o$)):null}function o$(t){return{type:t,attrs:null}}function Ove(t,e){let{parent:r,startIndex:n,endIndex:i}=t,s=r.contentMatchAt(n).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return r.canReplaceWith(n,i,o)?s:null}function Eve(t,e){let{parent:r,startIndex:n,endIndex:i}=t,s=r.child(n),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let c=(o.length?o[o.length-1]:e).contentMatch;for(let u=n;c&&u<i;u++)c=c.matchType(r.child(u).type);return!c||!c.validEnd?null:o}function Cve(t,e,r){let n=Ne.empty;for(let o=r.length-1;o>=0;o--){if(n.size){let l=r[o].type.contentMatch.matchFragment(n);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ne.from(r[o].type.create(r[o].attrs,n))}let i=e.start,s=e.end;t.step(new Dr(i,s,i,s,new Ie(n,0,0),r.length,!0))}function Ave(t,e,r,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,r,(o,l)=>{let c=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(n,c)&&Tve(t.doc,t.mapping.slice(s).map(l),n)){let u=null;if(n.schema.linebreakReplacement){let m=n.whitespace=="pre",x=!!n.contentMatch.matchType(n.schema.linebreakReplacement);m&&!x?u=!1:!m&&x&&(u=!0)}u===!1&&iU(t,o,l,s),HE(t,t.mapping.slice(s).map(l,1),n,void 0,u===null);let f=t.mapping.slice(s),d=f.map(l,1),p=f.map(l+o.nodeSize,1);return t.step(new Dr(d,p,d+1,p-1,new Ie(Ne.from(n.create(c,null,o.marks)),0,0),1,!0)),u===!0&&nU(t,o,l,s),!1}})}function nU(t,e,r,n){e.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let c=t.mapping.slice(n).map(r+1+s+o.index);t.replaceWith(c,c+1,e.type.schema.linebreakReplacement.create())}}})}function iU(t,e,r,n){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(n).map(r+1+s);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function Tve(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function Pve(t,e,r,n,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");r||(r=s.type);let o=r.create(n,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!r.validContent(s.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new Dr(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new Ie(Ne.from(o),0,0),1,!0))}function ho(t,e,r=1,n){let i=t.resolve(e),s=i.depth-r,o=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,f=r-2;u>s;u--,f--){let d=i.node(u),p=i.index(u);if(d.type.spec.isolating)return!1;let m=d.content.cutByIndex(p,d.childCount),x=n&&n[f+1];x&&(m=m.replaceChild(0,x.type.create(x.attrs)));let y=n&&n[f]||d;if(!d.canReplace(p+1,d.childCount)||!y.type.validContent(m))return!1}let l=i.indexAfter(s),c=n&&n[0];return i.node(s).canReplaceWith(l,l,c?c.type:i.node(s+1).type)}function Mve(t,e,r=1,n){let i=t.doc.resolve(e),s=Ne.empty,o=Ne.empty;for(let l=i.depth,c=i.depth-r,u=r-1;l>c;l--,u--){s=Ne.from(i.node(l).copy(s));let f=n&&n[u];o=Ne.from(f?f.type.create(f.attrs,o):i.node(l).copy(o))}t.step(new Rr(e,e,new Ie(s.append(o),r,r),!0))}function Ha(t,e){let r=t.resolve(e),n=r.index();return sU(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function Rve(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==n?t.type.schema.nodes.text:s.type;if(r=r.matchType(o),!r||!t.type.allowsMarks(s.marks))return!1}return r.validEnd}function sU(t,e){return!!(t&&e&&!t.isLeaf&&Rve(t,e))}function gx(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let s,o,l=n.index(i);if(i==n.depth?(s=n.nodeBefore,o=n.nodeAfter):r>0?(s=n.node(i+1),l++,o=n.node(i).maybeChild(l)):(s=n.node(i).maybeChild(l-1),o=n.node(i+1)),s&&!s.isTextblock&&sU(s,o)&&n.node(i).canReplace(l,l+1))return e;if(i==0)break;e=r<0?n.before(i):n.after(i)}}function Ive(t,e,r){let n=null,{linebreakReplacement:i}=t.doc.type.schema,s=t.doc.resolve(e-r),o=s.node().type;if(i&&o.inlineContent){let f=o.whitespace=="pre",d=!!o.contentMatch.matchType(i);f&&!d?n=!1:!f&&d&&(n=!0)}let l=t.steps.length;if(n===!1){let f=t.doc.resolve(e+r);iU(t,f.node(),f.before(),l)}o.inlineContent&&HE(t,e+r-1,o,s.node().contentMatchAt(s.index()),n==null);let c=t.mapping.slice(l),u=c.map(e-r);if(t.step(new Rr(u,c.map(e+r,-1),Ie.empty,!0)),n===!0){let f=t.doc.resolve(u);nU(t,f.node(),f.before(),t.steps.length)}return t}function Dve(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let s=n.index(i);if(n.node(i).canReplaceWith(s,s,r))return n.before(i+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let s=n.indexAfter(i);if(n.node(i).canReplaceWith(s,s,r))return n.after(i+1);if(s<n.node(i).childCount)return null}return null}function oU(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let s=0;s<r.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(r.openStart==0&&r.size?2:1);s++)for(let o=n.depth;o>=0;o--){let l=o==n.depth?0:n.pos<=(n.start(o+1)+n.end(o+1))/2?-1:1,c=n.index(o)+(l>0?1:0),u=n.node(o),f=!1;if(s==1)f=u.canReplace(c,c,i);else{let d=u.contentMatchAt(c).findWrapping(i.firstChild.type);f=d&&u.canReplaceWith(c,c,d[0])}if(f)return l==0?n.pos:l<0?n.before(o+1):n.after(o+1)}return null}function yx(t,e,r=e,n=Ie.empty){if(e==r&&!n.size)return null;let i=t.resolve(e),s=t.resolve(r);return aU(i,s,n)?new Rr(e,r,n):new Lve(i,s,n).fit()}function aU(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}class Lve{constructor(e,r,n){this.$from=e,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ne.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Ne.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let s=this.placed,o=n.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let c=new Ie(s,o,l);return e>-1?new Dr(n.pos,e,this.$to.pos,this.$to.end(),c,r):c.size||n.pos!=this.$to.pos?new Rr(n.pos,i.pos,c):null}findFittable(){let e=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let s=r.firstChild;if(r.childCount>1&&(i=0),s.type.spec.isolating&&i<=n){e=n;break}r=s.content}for(let r=1;r<=2;r++)for(let n=r==1?e:this.unplaced.openStart;n>=0;n--){let i,s=null;n?(s=tk(this.unplaced.content,n-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:c,match:u}=this.frontier[l],f,d=null;if(r==1&&(o?u.matchType(o.type)||(d=u.fillBefore(Ne.from(o),!1)):s&&c.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:l,parent:s,inject:d};if(r==2&&o&&(f=u.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:l,parent:s,wrap:f};if(s&&u.matchType(s.type))break}}}openMore(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=tk(e,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Ie(e,r+1,Math.max(n,i.size+r>=e.size-n?r+1:0)),!0)}dropNode(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=tk(e,r);if(i.childCount<=1&&r>0){let s=e.size-r<=r+i.size;this.unplaced=new Ie(Hf(e,r-1,1),r-1,s?r-1:n)}else this.unplaced=new Ie(Hf(e,r,1),r,n)}placeNodes({sliceDepth:e,frontierDepth:r,parent:n,inject:i,wrap:s}){for(;this.depth>r;)this.closeFrontierNode();if(s)for(let y=0;y<s.length;y++)this.openFrontierNode(s[y]);let o=this.unplaced,l=n?n.content:o.content,c=o.openStart-e,u=0,f=[],{match:d,type:p}=this.frontier[r];if(i){for(let y=0;y<i.childCount;y++)f.push(i.child(y));d=d.matchFragment(i)}let m=l.size+e-(o.content.size-o.openEnd);for(;u<l.childCount;){let y=l.child(u),v=d.matchType(y.type);if(!v)break;u++,(u>1||c==0||y.content.size)&&(d=v,f.push(lU(y.mark(p.allowedMarks(y.marks)),u==1?c:0,u==l.childCount?m:-1)))}let x=u==l.childCount;x||(m=-1),this.placed=Wf(this.placed,r,Ne.from(f)),this.frontier[r].match=d,x&&m<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,v=l;y<m;y++){let b=v.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),v=b.content}this.unplaced=x?e==0?Ie.empty:new Ie(Hf(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new Ie(Hf(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],r;if(!e.type.isTextblock||!rk(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let r=Math.min(this.depth,e.depth);r>=0;r--){let{match:n,type:i}=this.frontier[r],s=r<e.depth&&e.end(r+1)==e.pos+(e.depth-(r+1)),o=rk(e,r,i,n,s);if(o){for(let l=r-1;l>=0;l--){let{match:c,type:u}=this.frontier[l],f=rk(e,l,u,c,!0);if(!f||f.childCount)continue e}return{depth:r,fit:o,move:s?e.doc.resolve(e.after(r+1)):e}}}}close(e){let r=this.findCloseLevel(e);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=Wf(this.placed,r.depth,r.fit)),e=r.move;for(let n=r.depth+1;n<=e.depth;n++){let i=e.node(n),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,r=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Wf(this.placed,this.depth,Ne.from(e.create(r,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ne.empty,!0);r.childCount&&(this.placed=Wf(this.placed,this.frontier.length,r))}}function Hf(t,e,r){return e==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(Hf(t.firstChild.content,e-1,r)))}function Wf(t,e,r){return e==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(Wf(t.lastChild.content,e-1,r)))}function tk(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function lU(t,e,r){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,lU(n.firstChild,e-1,n.childCount==1?r-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(Ne.empty,!0)))),t.copy(n)}function rk(t,e,r,n,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!r.compatibleContent(s.type))return null;let l=n.fillBefore(s.content,!0,o);return l&&!$ve(r,s.content,o)?l:null}function $ve(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function Bve(t){return t.spec.defining||t.spec.definingForContent}function Fve(t,e,r,n){if(!n.size)return t.deleteRange(e,r);let i=t.doc.resolve(e),s=t.doc.resolve(r);if(aU(i,s,n))return t.step(new Rr(e,r,n));let o=uU(i,t.doc.resolve(r));o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let p=i.depth,m=i.pos-1;p>0;p--,m--){let x=i.node(p).type.spec;if(x.defining||x.definingAsContext||x.isolating)break;o.indexOf(p)>-1?l=p:i.before(p)==m&&o.splice(1,0,-p)}let c=o.indexOf(l),u=[],f=n.openStart;for(let p=n.content,m=0;;m++){let x=p.firstChild;if(u.push(x),m==n.openStart)break;p=x.content}for(let p=f-1;p>=0;p--){let m=u[p],x=Bve(m.type);if(x&&!m.sameMarkup(i.node(Math.abs(l)-1)))f=p;else if(x||!m.type.isTextblock)break}for(let p=n.openStart;p>=0;p--){let m=(p+f+1)%(n.openStart+1),x=u[m];if(x)for(let y=0;y<o.length;y++){let v=o[(y+c)%o.length],b=!0;v<0&&(b=!1,v=-v);let w=i.node(v-1),N=i.index(v-1);if(w.canReplaceWith(N,N,x.type,x.marks))return t.replace(i.before(v),b?s.after(v):r,new Ie(cU(n.content,0,n.openStart,m),m,n.openEnd))}}let d=t.steps.length;for(let p=o.length-1;p>=0&&(t.replace(e,r,n),!(t.steps.length>d));p--){let m=o[p];m<0||(e=i.before(m),r=s.after(m))}}function cU(t,e,r,n,i){if(e<r){let s=t.firstChild;t=t.replaceChild(0,s.copy(cU(s.content,e+1,r,n,s)))}if(e>n){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(Ne.empty,!0))}return t}function qve(t,e,r,n){if(!n.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let i=Dve(t.doc,e,n.type);i!=null&&(e=r=i)}t.replaceRange(e,r,new Ie(Ne.from(n),0,0))}function zve(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),s=uU(n,i);for(let o=0;o<s.length;o++){let l=s[o],c=o==s.length-1;if(c&&l==0||n.node(l).type.contentMatch.validEnd)return t.delete(n.start(l),i.end(l));if(l>0&&(c||n.node(l-1).canReplace(n.index(l-1),i.indexAfter(l-1))))return t.delete(n.before(l),i.after(l))}for(let o=1;o<=n.depth&&o<=i.depth;o++)if(e-n.start(o)==n.depth-o&&r>n.end(o)&&i.end(o)-r!=i.depth-o&&n.start(o-1)==i.start(o-1)&&n.node(o-1).canReplace(n.index(o-1),i.index(o-1)))return t.delete(n.before(o),r);t.delete(e,r)}function uU(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&r.push(i)}return r}class wu extends cn{constructor(e,r,n){super(),this.pos=e,this.attr=r,this.value=n}apply(e){let r=e.nodeAt(this.pos);if(!r)return hr.fail("No node at attribute step's position");let n=Object.create(null);for(let s in r.attrs)n[s]=r.attrs[s];n[this.attr]=this.value;let i=r.type.create(n,null,r.marks);return hr.fromReplace(e,this.pos,this.pos+1,new Ie(Ne.from(i),0,r.isLeaf?0:1))}getMap(){return Jn.empty}invert(e){return new wu(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new wu(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new wu(r.pos,r.attr,r.value)}}cn.jsonID("attr",wu);class dp extends cn{constructor(e,r){super(),this.attr=e,this.value=r}apply(e){let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let n=e.type.create(r,e.content,e.marks);return hr.ok(n)}getMap(){return Jn.empty}invert(e){return new dp(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new dp(r.attr,r.value)}}cn.jsonID("docAttr",dp);let ed=class extends Error{};ed=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r};ed.prototype=Object.create(Error.prototype);ed.prototype.constructor=ed;ed.prototype.name="TransformError";class dU{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new up}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let r=this.maybeStep(e);if(r.failed)throw new ed(r.failed);return this}maybeStep(e){let r=e.apply(this.doc);return r.failed||this.addStep(e,r.doc),r}get docChanged(){return this.steps.length>0}addStep(e,r){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=r}replace(e,r=e,n=Ie.empty){let i=yx(this.doc,e,r,n);return i&&this.step(i),this}replaceWith(e,r,n){return this.replace(e,r,new Ie(Ne.from(n),0,0))}delete(e,r){return this.replace(e,r,Ie.empty)}insert(e,r){return this.replaceWith(e,e,r)}replaceRange(e,r,n){return Fve(this,e,r,n),this}replaceRangeWith(e,r,n){return qve(this,e,r,n),this}deleteRange(e,r){return zve(this,e,r),this}lift(e,r){return _ve(this,e,r),this}join(e,r=1){return Ive(this,e,r),this}wrap(e,r){return Cve(this,e,r),this}setBlockType(e,r=e,n,i=null){return Ave(this,e,r,n,i),this}setNodeMarkup(e,r,n=null,i){return Pve(this,e,r,n,i),this}setNodeAttribute(e,r,n){return this.step(new wu(e,r,n)),this}setDocAttribute(e,r){return this.step(new dp(e,r)),this}addNodeMark(e,r){return this.step(new xa(e,r)),this}removeNodeMark(e,r){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(r instanceof Tt)r.isInSet(n.marks)&&this.step(new Gl(e,r));else{let i=n.marks,s,o=[];for(;s=r.isInSet(i);)o.push(new Gl(e,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,r=1,n){return Mve(this,e,r,n),this}addMark(e,r,n){return Sve(this,e,r,n),this}removeMark(e,r,n){return Nve(this,e,r,n),this}clearIncompatible(e,r,n){return HE(this,e,r,n),this}}const nk=Object.create(null);class ot{constructor(e,r,n){this.$anchor=e,this.$head=r,this.ranges=n||[new Uve(e.min(r),e.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let r=0;r<e.length;r++)if(e[r].$from.pos!=e[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,r=Ie.empty){let n=r.content.lastChild,i=null;for(let l=0;l<r.openEnd;l++)i=n,n=n.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:c,$to:u}=o[l],f=e.mapping.slice(s);e.replaceRange(f.map(c.pos),f.map(u.pos),l?Ie.empty:r),l==0&&c$(e,s,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,r){let n=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],c=e.mapping.slice(n),u=c.map(o.pos),f=c.map(l.pos);s?e.deleteRange(u,f):(e.replaceRangeWith(u,f,r),c$(e,n,r.isInline?-1:1))}}static findFrom(e,r,n=!1){let i=e.parent.inlineContent?new et(e):su(e.node(0),e.parent,e.pos,e.index(),r,n);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=r<0?su(e.node(0),e.node(s),e.before(s+1),e.index(s),r,n):su(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,r,n);if(o)return o}return null}static near(e,r=1){return this.findFrom(e,r)||this.findFrom(e,-r)||new ri(e.node(0))}static atStart(e){return su(e,e,0,0,1)||new ri(e)}static atEnd(e){return su(e,e,e.content.size,e.childCount,-1)||new ri(e)}static fromJSON(e,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=nk[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in nk)throw new RangeError("Duplicate use of selection JSON ID "+e);return nk[e]=r,r.prototype.jsonID=e,r}getBookmark(){return et.between(this.$anchor,this.$head).getBookmark()}}ot.prototype.visible=!0;class Uve{constructor(e,r){this.$from=e,this.$to=r}}let a$=!1;function l$(t){!a$&&!t.parent.inlineContent&&(a$=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class et extends ot{constructor(e,r=e){l$(e),l$(r),super(e,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,r){let n=e.resolve(r.map(this.head));if(!n.parent.inlineContent)return ot.near(n);let i=e.resolve(r.map(this.anchor));return new et(i.parent.inlineContent?i:n,n)}replace(e,r=Ie.empty){if(super.replace(e,r),r==Ie.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof et&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new vx(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new et(e.resolve(r.anchor),e.resolve(r.head))}static create(e,r,n=r){let i=e.resolve(r);return new this(i,n==r?i:e.resolve(n))}static between(e,r,n){let i=e.pos-r.pos;if((!n||i)&&(n=i>=0?1:-1),!r.parent.inlineContent){let s=ot.findFrom(r,n,!0)||ot.findFrom(r,-n,!0);if(s)r=s.$head;else return ot.near(r,n)}return e.parent.inlineContent||(i==0?e=r:(e=(ot.findFrom(e,-n,!0)||ot.findFrom(e,n,!0)).$anchor,e.pos<r.pos!=i<0&&(e=r))),new et(e,r)}}ot.jsonID("text",et);class vx{constructor(e,r){this.anchor=e,this.head=r}map(e){return new vx(e.map(this.anchor),e.map(this.head))}resolve(e){return et.between(e.resolve(this.anchor),e.resolve(this.head))}}class He extends ot{constructor(e){let r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);super(e,n),this.node=r}map(e,r){let{deleted:n,pos:i}=r.mapResult(this.anchor),s=e.resolve(i);return n?ot.near(s):new He(s)}content(){return new Ie(Ne.from(this.node),0,0)}eq(e){return e instanceof He&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new VE(this.anchor)}static fromJSON(e,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new He(e.resolve(r.anchor))}static create(e,r){return new He(e.resolve(r))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}He.prototype.visible=!1;ot.jsonID("node",He);class VE{constructor(e){this.anchor=e}map(e){let{deleted:r,pos:n}=e.mapResult(this.anchor);return r?new vx(n,n):new VE(n)}resolve(e){let r=e.resolve(this.anchor),n=r.nodeAfter;return n&&He.isSelectable(n)?new He(r):ot.near(r)}}class ri extends ot{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,r=Ie.empty){if(r==Ie.empty){e.delete(0,e.doc.content.size);let n=ot.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,r)}toJSON(){return{type:"all"}}static fromJSON(e){return new ri(e)}map(e){return new ri(e)}eq(e){return e instanceof ri}getBookmark(){return Hve}}ot.jsonID("all",ri);const Hve={map(){return this},resolve(t){return new ri(t)}};function su(t,e,r,n,i,s=!1){if(e.inlineContent)return et.create(t,r);for(let o=n-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&He.isSelectable(l))return He.create(t,r-(i<0?l.nodeSize:0))}else{let c=su(t,l,r+i,i<0?l.childCount:0,i,s);if(c)return c}r+=l.nodeSize*i}return null}function c$(t,e,r){let n=t.steps.length-1;if(n<e)return;let i=t.steps[n];if(!(i instanceof Rr||i instanceof Dr))return;let s=t.mapping.maps[n],o;s.forEach((l,c,u,f)=>{o==null&&(o=f)}),t.setSelection(ot.near(t.doc.resolve(o),r))}const u$=1,d$=2,f$=4;class Wve extends dU{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|u$)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&u$)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=d$,this}ensureMarks(e){return Tt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&d$)>0}addStep(e,r){super.addStep(e,r),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,r=!0){let n=this.selection;return r&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Tt.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,r,n){let i=this.doc.type.schema;if(r==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=r),n=n??r,!e)return this.deleteRange(r,n);let s=this.storedMarks;if(!s){let o=this.doc.resolve(r);s=n==r?o.marks():o.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,i.text(e,s)),this.selection.empty||this.setSelection(ot.near(this.selection.$to)),this}}setMeta(e,r){return this.meta[typeof e=="string"?e:e.key]=r,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=f$,this}get scrolledIntoView(){return(this.updated&f$)>0}}function h$(t,e){return!e||!t?t:t.bind(e)}class Vf{constructor(e,r,n){this.name=e,this.init=h$(r.init,n),this.apply=h$(r.apply,n)}}const Vve=[new Vf("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Vf("selection",{init(t,e){return t.selection||ot.atStart(e.doc)},apply(t){return t.selection}}),new Vf("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new Vf("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class ik{constructor(e,r){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Vve.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Vf(n.key,n.spec.state,n))})}}class mu{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let r=[e],n=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let c=i?i[o].n:0,u=i?i[o].state:this,f=c<r.length&&l.spec.appendTransaction.call(l,c?r.slice(c):r,u,n);if(f&&n.filterTransaction(f,o)){if(f.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:n,n:r.length}:{state:this,n:0})}r.push(f),n=n.applyInner(f),s=!0}i&&(i[o]={state:n,n:r.length})}}if(!s)return{state:n,transactions:r}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new mu(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let s=n[i];r[s.name]=s.apply(e,this[s.name],this,r)}return r}get tr(){return new Wve(this)}static create(e){let r=new ik(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new mu(r);for(let i=0;i<r.fields.length;i++)n[r.fields[i].name]=r.fields[i].init(e,n);return n}reconfigure(e){let r=new ik(this.schema,e.plugins),n=r.fields,i=new mu(r);for(let s=0;s<n.length;s++){let o=n[s].name;i[o]=this.hasOwnProperty(o)?this[o]:n[s].init(e,i)}return i}toJSON(e){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],s=i.spec.state;s&&s.toJSON&&(r[n]=s.toJSON.call(i,this[i.key]))}return r}static fromJSON(e,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new ik(e.schema,e.plugins),s=new mu(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=Na.fromJSON(e.schema,r.doc);else if(o.name=="selection")s.selection=ot.fromJSON(s.doc,r.selection);else if(o.name=="storedMarks")r.storedMarks&&(s.storedMarks=r.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let l in n){let c=n[l],u=c.spec.state;if(c.key==o.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,l)){s[o.name]=u.fromJSON.call(c,e,r[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function fU(t,e,r){for(let n in t){let i=t[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=fU(i,e,{})),r[n]=i}return r}class nr{constructor(e){this.spec=e,this.props={},e.props&&fU(e.props,this,this.props),this.key=e.key?e.key.key:hU("plugin")}getState(e){return e[this.key]}}const sk=Object.create(null);function hU(t){return t in sk?t+"$"+ ++sk[t]:(sk[t]=0,t+"$")}class Fr{constructor(e="key"){this.key=hU(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Wr=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},td=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let D2=null;const no=function(t,e,r){let n=D2||(D2=document.createRange());return n.setEnd(t,r??t.nodeValue.length),n.setStart(t,e||0),n},Kve=function(){D2=null},Yl=function(t,e,r,n){return r&&(p$(t,e,r,n,-1)||p$(t,e,r,n,1))},Gve=/^(img|br|input|textarea|hr)$/i;function p$(t,e,r,n,i){for(var s;;){if(t==r&&e==n)return!0;if(e==(i<0?0:ki(t))){let o=t.parentNode;if(!o||o.nodeType!=1||Hp(t)||Gve.test(t.nodeName)||t.contentEditable=="false")return!1;e=Wr(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else t=o,e=i<0?ki(t):0}else return!1}}function ki(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Yve(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=ki(t)}else if(t.parentNode&&!Hp(t))e=Wr(t),t=t.parentNode;else return null}}function Xve(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Hp(t))e=Wr(t)+1,t=t.parentNode;else return null}}function Jve(t,e,r){for(let n=e==0,i=e==ki(t);n||i;){if(t==r)return!0;let s=Wr(t);if(t=t.parentNode,!t)return!1;n=n&&s==0,i=i&&s==ki(t)}}function Hp(t){let e;for(let r=t;r&&!(e=r.pmViewDesc);r=r.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const xx=function(t){return t.focusNode&&Yl(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Sl(t,e){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=e,r}function Qve(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Zve(t,e,r){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,r);if(n)return{node:n.offsetNode,offset:Math.min(ki(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,r);if(n)return{node:n.startContainer,offset:Math.min(ki(n.startContainer),n.startOffset)}}}const Ts=typeof navigator<"u"?navigator:null,m$=typeof document<"u"?document:null,Wa=Ts&&Ts.userAgent||"",L2=/Edge\/(\d+)/.exec(Wa),pU=/MSIE \d/.exec(Wa),$2=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Wa),Rn=!!(pU||$2||L2),_a=pU?document.documentMode:$2?+$2[1]:L2?+L2[1]:0,is=!Rn&&/gecko\/(\d+)/i.test(Wa);is&&+(/Firefox\/(\d+)/.exec(Wa)||[0,0])[1];const B2=!Rn&&/Chrome\/(\d+)/.exec(Wa),an=!!B2,mU=B2?+B2[1]:0,bn=!Rn&&!!Ts&&/Apple Computer/.test(Ts.vendor),rd=bn&&(/Mobile\/\w+/.test(Wa)||!!Ts&&Ts.maxTouchPoints>2),ji=rd||(Ts?/Mac/.test(Ts.platform):!1),e0e=Ts?/Win/.test(Ts.platform):!1,ao=/Android \d/.test(Wa),Wp=!!m$&&"webkitFontSmoothing"in m$.documentElement.style,t0e=Wp?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function r0e(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Xs(t,e){return typeof t=="number"?t:t[e]}function n0e(t){let e=t.getBoundingClientRect(),r=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*r,top:e.top,bottom:e.top+t.clientHeight*n}}function g$(t,e,r){let n=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=r||t.dom;o;){if(o.nodeType!=1){o=td(o);continue}let l=o,c=l==s.body,u=c?r0e(s):n0e(l),f=0,d=0;if(e.top<u.top+Xs(n,"top")?d=-(u.top-e.top+Xs(i,"top")):e.bottom>u.bottom-Xs(n,"bottom")&&(d=e.bottom-e.top>u.bottom-u.top?e.top+Xs(i,"top")-u.top:e.bottom-u.bottom+Xs(i,"bottom")),e.left<u.left+Xs(n,"left")?f=-(u.left-e.left+Xs(i,"left")):e.right>u.right-Xs(n,"right")&&(f=e.right-u.right+Xs(i,"right")),f||d)if(c)s.defaultView.scrollBy(f,d);else{let m=l.scrollLeft,x=l.scrollTop;d&&(l.scrollTop+=d),f&&(l.scrollLeft+=f);let y=l.scrollLeft-m,v=l.scrollTop-x;e={left:e.left-y,top:e.top-v,right:e.right-y,bottom:e.bottom-v}}let p=c?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(p))break;o=p=="absolute"?o.offsetParent:td(o)}}function i0e(t){let e=t.dom.getBoundingClientRect(),r=Math.max(0,e.top),n,i;for(let s=(e.left+e.right)/2,o=r+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(s,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let c=l.getBoundingClientRect();if(c.top>=r-20){n=l,i=c.top;break}}return{refDOM:n,refTop:i,stack:gU(t.dom)}}function gU(t){let e=[],r=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=r);n=td(n));return e}function s0e({refDOM:t,refTop:e,stack:r}){let n=t?t.getBoundingClientRect().top:0;yU(r,n==0?0:n-e)}function yU(t,e){for(let r=0;r<t.length;r++){let{dom:n,top:i,left:s}=t[r];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=s&&(n.scrollLeft=s)}}let Qc=null;function o0e(t){if(t.setActive)return t.setActive();if(Qc)return t.focus(Qc);let e=gU(t);t.focus(Qc==null?{get preventScroll(){return Qc={preventScroll:!0},!0}}:void 0),Qc||(Qc=!1,yU(e,0))}function vU(t,e){let r,n=2e8,i,s=0,o=e.top,l=e.top,c,u;for(let f=t.firstChild,d=0;f;f=f.nextSibling,d++){let p;if(f.nodeType==1)p=f.getClientRects();else if(f.nodeType==3)p=no(f).getClientRects();else continue;for(let m=0;m<p.length;m++){let x=p[m];if(x.top<=o&&x.bottom>=l){o=Math.max(x.bottom,o),l=Math.min(x.top,l);let y=x.left>e.left?x.left-e.left:x.right<e.left?e.left-x.right:0;if(y<n){r=f,n=y,i=y&&r.nodeType==3?{left:x.right<e.left?x.right:x.left,top:e.top}:e,f.nodeType==1&&y&&(s=d+(e.left>=(x.left+x.right)/2?1:0));continue}}else x.top>e.top&&!c&&x.left<=e.left&&x.right>=e.left&&(c=f,u={left:Math.max(x.left,Math.min(x.right,e.left)),top:x.top});!r&&(e.left>=x.right&&e.top>=x.top||e.left>=x.left&&e.top>=x.bottom)&&(s=d+1)}}return!r&&c&&(r=c,i=u,n=0),r&&r.nodeType==3?a0e(r,i):!r||n&&r.nodeType==1?{node:t,offset:s}:vU(r,i)}function a0e(t,e){let r=t.nodeValue.length,n=document.createRange();for(let i=0;i<r;i++){n.setEnd(t,i+1),n.setStart(t,i);let s=ia(n,1);if(s.top!=s.bottom&&KE(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function KE(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function l0e(t,e){let r=t.parentNode;return r&&/^li$/i.test(r.nodeName)&&e.left<t.getBoundingClientRect().left?r:t}function c0e(t,e,r){let{node:n,offset:i}=vU(e,r),s=-1;if(n.nodeType==1&&!n.firstChild){let o=n.getBoundingClientRect();s=o.left!=o.right&&r.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(n,i,s)}function u0e(t,e,r,n){let i=-1;for(let s=e,o=!1;s!=t.dom;){let l=t.docView.nearestDesc(s,!0),c;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((c=l.dom.getBoundingClientRect()).width||c.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&c.left>n.left||c.top>n.top?i=l.posBefore:(!o&&c.right<n.left||c.bottom<n.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?n.top<(c.top+c.bottom)/2:n.left<(c.left+c.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,r,-1)}function xU(t,e,r){let n=t.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-r.top)/(r.bottom-r.top))-2)),s=i;;){let o=t.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(KE(e,u))return xU(o,e,u)}}if((s=(s+1)%n)==i)break}return t}function d0e(t,e){let r=t.dom.ownerDocument,n,i=0,s=Zve(r,e.left,e.top);s&&({node:n,offset:i}=s);let o=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let u=t.dom.getBoundingClientRect();if(!KE(e,u)||(o=xU(t.dom,e,u),!o))return null}if(bn)for(let u=o;n&&u;u=td(u))u.draggable&&(n=void 0);if(o=l0e(o,e),n){if(is&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let f=n.childNodes[i],d;f.nodeName=="IMG"&&(d=f.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let u;Wp&&i&&n.nodeType==1&&(u=n.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,n==t.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(l=u0e(t,n,i,e))}l==null&&(l=c0e(t,o,e));let c=t.docView.nearestDesc(o,!0);return{pos:l,inside:c?c.posAtStart-c.border:-1}}function y$(t){return t.top<t.bottom||t.left<t.right}function ia(t,e){let r=t.getClientRects();if(r.length){let n=r[e<0?0:r.length-1];if(y$(n))return n}return Array.prototype.find.call(r,y$)||t.getBoundingClientRect()}const f0e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function bU(t,e,r){let{node:n,offset:i,atom:s}=t.docView.domFromPos(e,r<0?-1:1),o=Wp||is;if(n.nodeType==3)if(o&&(f0e.test(n.nodeValue)||(r<0?!i:i==n.nodeValue.length))){let c=ia(no(n,i,i),r);if(is&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let u=ia(no(n,i-1,i-1),-1);if(u.top==c.top){let f=ia(no(n,i,i+1),-1);if(f.top!=c.top)return Mf(f,f.left<u.left)}}return c}else{let c=i,u=i,f=r<0?1:-1;return r<0&&!i?(u++,f=-1):r>=0&&i==n.nodeValue.length?(c--,f=1):r<0?c--:u++,Mf(ia(no(n,c,u),f),f<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(r<0||i==ki(n))){let c=n.childNodes[i-1];if(c.nodeType==1)return ok(c.getBoundingClientRect(),!1)}if(s==null&&i<ki(n)){let c=n.childNodes[i];if(c.nodeType==1)return ok(c.getBoundingClientRect(),!0)}return ok(n.getBoundingClientRect(),r>=0)}if(s==null&&i&&(r<0||i==ki(n))){let c=n.childNodes[i-1],u=c.nodeType==3?no(c,ki(c)-(o?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(u)return Mf(ia(u,1),!1)}if(s==null&&i<ki(n)){let c=n.childNodes[i];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let u=c?c.nodeType==3?no(c,0,o?0:1):c.nodeType==1?c:null:null;if(u)return Mf(ia(u,-1),!0)}return Mf(ia(n.nodeType==3?no(n):n,-r),r>=0)}function Mf(t,e){if(t.width==0)return t;let r=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:r,right:r}}function ok(t,e){if(t.height==0)return t;let r=e?t.top:t.bottom;return{top:r,bottom:r,left:t.left,right:t.right}}function wU(t,e,r){let n=t.state,i=t.root.activeElement;n!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return r()}finally{n!=e&&t.updateState(n),i!=t.dom&&i&&i.focus()}}function h0e(t,e,r){let n=e.selection,i=r=="up"?n.$from:n.$to;return wU(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,r=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=bU(t,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let c;if(l.nodeType==1)c=l.getClientRects();else if(l.nodeType==3)c=no(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<c.length;u++){let f=c[u];if(f.bottom>f.top+1&&(r=="up"?o.top-f.top>(f.bottom-o.top)*2:f.bottom-o.bottom>(o.bottom-f.top)*2))return!1}}return!0})}const p0e=/[\u0590-\u08ac]/;function m0e(t,e,r){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,s=!i,o=i==n.parent.content.size,l=t.domSelection();return l?!p0e.test(n.parent.textContent)||!l.modify?r=="left"||r=="backward"?s:o:wU(t,e,()=>{let{focusNode:c,focusOffset:u,anchorNode:f,anchorOffset:d}=t.domSelectionRange(),p=l.caretBidiLevel;l.modify("move",r,"character");let m=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:x,focusOffset:y}=t.domSelectionRange(),v=x&&!m.contains(x.nodeType==1?x:x.parentNode)||c==x&&u==y;try{l.collapse(f,d),c&&(c!=f||u!=d)&&l.extend&&l.extend(c,u)}catch{}return p!=null&&(l.caretBidiLevel=p),v}):n.pos==n.start()||n.pos==n.end()}let v$=null,x$=null,b$=!1;function g0e(t,e,r){return v$==e&&x$==r?b$:(v$=e,x$=r,b$=r=="up"||r=="down"?h0e(t,e,r):m0e(t,e,r))}const Oi=0,w$=1,El=2,Ps=3;class Vp{constructor(e,r,n,i){this.parent=e,this.children=r,this.dom=n,this.contentDOM=i,this.dirty=Oi,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,r,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let r=0;r<this.children.length;r++)e+=this.children[r].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let r=0,n=this.posAtStart;;r++){let i=this.children[r];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,r,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let s,o;if(e==this.contentDOM)s=e.childNodes[r-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[r];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=r>Wr(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&r==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,r=!1){for(let n=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!r||s.node))if(n&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))n=!1;else return s}}getDesc(e){let r=e.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(e,r,n){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,r,n)}return-1}descAt(e){for(let r=0,n=0;r<this.children.length;r++){let i=this.children[r],s=n+i.size;if(n==e&&s!=n){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(e<s)return i.descAt(e-n-i.border);n=s}}domFromPos(e,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let s=0;n<this.children.length;n++){let o=this.children[n],l=s+o.size;if(l>e||o instanceof SU){i=e-s;break}s=l}if(i)return this.children[n].domFromPos(i-this.children[n].border,r);for(let s;n&&!(s=this.children[n-1]).size&&s instanceof jU&&s.side>=0;n--);if(r<=0){let s,o=!0;for(;s=n?this.children[n-1]:null,!(!s||s.dom.parentNode==this.contentDOM);n--,o=!1);return s&&r&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,r):{node:this.contentDOM,offset:s?Wr(s.dom)+1:0}}else{let s,o=!0;for(;s=n<this.children.length?this.children[n]:null,!(!s||s.dom.parentNode==this.contentDOM);n++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,r):{node:this.contentDOM,offset:s?Wr(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=n,l=0;;l++){let c=this.children[l],u=o+c.size;if(i==-1&&e<=u){let f=o+c.border;if(e>=f&&r<=u-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(e,r,f);e=o;for(let d=l;d>0;d--){let p=this.children[d-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){i=Wr(p.dom)+1;break}e-=p.size}i==-1&&(i=0)}if(i>-1&&(u>r||l==this.children.length-1)){r=u;for(let f=l+1;f<this.children.length;f++){let d=this.children[f];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=Wr(d.dom);break}r+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=u}return{node:this.contentDOM,from:e,to:r,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[e<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(e)}domAfterPos(e){let{node:r,offset:n}=this.domFromPos(e,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]}setSelection(e,r,n,i=!1){let s=Math.min(e,r),o=Math.max(e,r);for(let m=0,x=0;m<this.children.length;m++){let y=this.children[m],v=x+y.size;if(s>x&&o<v)return y.setSelection(e-x-y.border,r-x-y.border,n,i);x=v}let l=this.domFromPos(e,e?-1:1),c=r==e?l:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),f=n.domSelectionRange(),d=!1;if((is||bn)&&e==r){let{node:m,offset:x}=l;if(m.nodeType==3){if(d=!!(x&&m.nodeValue[x-1]==`
`),d&&x==m.nodeValue.length)for(let y=m,v;y;y=y.parentNode){if(v=y.nextSibling){v.nodeName=="BR"&&(l=c={node:v.parentNode,offset:Wr(v)+1});break}let b=y.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let y=m.childNodes[x-1];d=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(is&&f.focusNode&&f.focusNode!=c.node&&f.focusNode.nodeType==1){let m=f.focusNode.childNodes[f.focusOffset];m&&m.contentEditable=="false"&&(i=!0)}if(!(i||d&&bn)&&Yl(l.node,l.offset,f.anchorNode,f.anchorOffset)&&Yl(c.node,c.offset,f.focusNode,f.focusOffset))return;let p=!1;if((u.extend||e==r)&&!d){u.collapse(l.node,l.offset);try{e!=r&&u.extend(c.node,c.offset),p=!0}catch{}}if(!p){if(e>r){let x=l;l=c,c=x}let m=document.createRange();m.setEnd(c.node,c.offset),m.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,r){for(let n=0,i=0;i<this.children.length;i++){let s=this.children[i],o=n+s.size;if(n==o?e<=o&&r>=n:e<o&&r>n){let l=n+s.border,c=o-s.border;if(e>=l&&r<=c){this.dirty=e==n||r==o?El:w$,e==l&&r==c&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Ps:s.markDirty(e-l,r-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?El:Ps}n=o}this.dirty=El}markParentsDirty(){let e=1;for(let r=this.parent;r;r=r.parent,e++){let n=e==1?El:w$;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class jU extends Vp{constructor(e,r,n,i){let s,o=r.type.toDOM;if(typeof o=="function"&&(o=o(n,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!r.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=r,this.widget=r,s=this}matchesWidget(e){return this.dirty==Oi&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let r=this.widget.spec.stopEvent;return r?r(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class y0e extends Vp{constructor(e,r,n,i){super(e,[],r,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,r){return e!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Xl extends Vp{constructor(e,r,n,i,s){super(e,[],n,i),this.mark=r,this.spec=s}static create(e,r,n,i){let s=i.nodeViews[r.type.name],o=s&&s(r,i,n);return(!o||!o.dom)&&(o=uc.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new Xl(e,r,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Ps||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Ps&&this.mark.eq(e)}markDirty(e,r){if(super.markDirty(e,r),this.dirty!=Oi){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=Oi}}slice(e,r,n){let i=Xl.create(this.parent,this.mark,!0,n),s=this.children,o=this.size;r<o&&(s=q2(s,r,o,n)),e>0&&(s=q2(s,0,e,n));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Oa extends Vp{constructor(e,r,n,i,s,o,l,c,u){super(e,[],s,o),this.node=r,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=l}static create(e,r,n,i,s,o){let l=s.nodeViews[r.type.name],c,u=l&&l(r,s,()=>{if(!c)return o;if(c.parent)return c.parent.posBeforeChild(c)},n,i),f=u&&u.dom,d=u&&u.contentDOM;if(r.isText){if(!f)f=document.createTextNode(r.text);else if(f.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else f||({dom:f,contentDOM:d}=uc.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!d&&!r.isText&&f.nodeName!="BR"&&(f.hasAttribute("contenteditable")||(f.contentEditable="false"),r.type.spec.draggable&&(f.draggable=!0));let p=f;return f=_U(f,n,r),u?c=new v0e(e,r,n,i,f,d||null,p,u,s,o+1):r.isText?new bx(e,r,n,i,f,p,s):new Oa(e,r,n,i,f,d||null,p,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ne.empty)}return e}matchesNode(e,r,n){return this.dirty==Oi&&e.eq(this.node)&&kv(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,r){let n=this.node.inlineContent,i=r,s=e.composing?this.localCompositionInfo(e,r):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,c=new b0e(this,o&&o.node,e);S0e(this.node,this.innerDeco,(u,f,d)=>{u.spec.marks?c.syncToMarks(u.spec.marks,n,e):u.type.side>=0&&!d&&c.syncToMarks(f==this.node.childCount?Tt.none:this.node.child(f).marks,n,e),c.placeWidget(u,e,i)},(u,f,d,p)=>{c.syncToMarks(u.marks,n,e);let m;c.findNodeMatch(u,f,d,p)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(m=c.findIndexWithChild(s.node))>-1&&c.updateNodeAt(u,f,d,m,e)||c.updateNextNode(u,f,d,e,p,i)||c.addNode(u,f,d,e,i),i+=u.nodeSize}),c.syncToMarks([],n,e),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==El)&&(o&&this.protectLocalComposition(e,o),NU(this.contentDOM,this.children,e),rd&&N0e(this.dom))}localCompositionInfo(e,r){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof et)||n<r||i>r+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=k0e(this.node.content,o,n-r,i-r);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:r,pos:n,text:i}){if(this.getDesc(r))return;let s=r;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new y0e(this,s,r,i);e.input.compositionNodes.push(o),this.children=q2(this.children,n,n+i.length,e,o)}update(e,r,n,i){return this.dirty==Ps||!e.sameMarkup(this.node)?!1:(this.updateInner(e,r,n,i),!0)}updateInner(e,r,n,i){this.updateOuterDeco(r),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Oi}updateOuterDeco(e){if(kv(e,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=kU(this.dom,this.nodeDOM,F2(this.outerDeco,this.node,r),F2(e,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function j$(t,e,r,n,i){_U(n,e,t);let s=new Oa(void 0,t,e,r,n,n,n,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class bx extends Oa{constructor(e,r,n,i,s,o,l){super(e,r,n,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,r,n,i){return this.dirty==Ps||this.dirty!=Oi&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=Oi||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Oi,!0)}inParent(){let e=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,r,n){return e==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(e,r,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,r,n){let i=this.node.cut(e,r),s=document.createTextNode(i.text);return new bx(this.parent,i,this.outerDeco,this.innerDeco,s,s,n)}markDirty(e,r){super.markDirty(e,r),this.dom!=this.nodeDOM&&(e==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=Ps)}get domAtom(){return!1}isText(e){return this.node.text==e}}class SU extends Vp{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Oi&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class v0e extends Oa{constructor(e,r,n,i,s,o,l,c,u,f){super(e,r,n,i,s,o,l,u,f),this.spec=c}update(e,r,n,i){if(this.dirty==Ps)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,r,n);return s&&this.updateInner(e,r,n,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,r,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,r,n,i){this.spec.setSelection?this.spec.setSelection(e,r,n.root):super.setSelection(e,r,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function NU(t,e,r){let n=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==t){for(;l!=n;)n=S$(n),i=!0;n=n.nextSibling}else i=!0,t.insertBefore(l,n);if(o instanceof Xl){let c=n?n.previousSibling:t.lastChild;NU(o.contentDOM,o.children,r),n=c?c.nextSibling:t.firstChild}}for(;n;)n=S$(n),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}const lh=function(t){t&&(this.nodeName=t)};lh.prototype=Object.create(null);const Cl=[new lh];function F2(t,e,r){if(t.length==0)return Cl;let n=r?Cl[0]:new lh,i=[n];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&i.push(n=new lh(o.nodeName));for(let l in o){let c=o[l];c!=null&&(r&&i.length==1&&i.push(n=new lh(e.isInline?"span":"div")),l=="class"?n.class=(n.class?n.class+" ":"")+c:l=="style"?n.style=(n.style?n.style+";":"")+c:l!="nodeName"&&(n[l]=c))}}}return i}function kU(t,e,r,n){if(r==Cl&&n==Cl)return e;let i=e;for(let s=0;s<n.length;s++){let o=n[s],l=r[s];if(s){let c;l&&l.nodeName==o.nodeName&&i!=t&&(c=i.parentNode)&&c.nodeName.toLowerCase()==o.nodeName||(c=document.createElement(o.nodeName),c.pmIsDeco=!0,c.appendChild(i),l=Cl[0]),i=c}x0e(i,l||Cl[0],o)}return i}function x0e(t,e,r){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&t.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=e[n]&&t.setAttribute(n,r[n]);if(e.class!=r.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let s=0;s<n.length;s++)i.indexOf(n[s])==-1&&t.classList.remove(n[s]);for(let s=0;s<i.length;s++)n.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=r.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)t.style.removeProperty(i[1])}r.style&&(t.style.cssText+=r.style)}}function _U(t,e,r){return kU(t,t,Cl,F2(e,r,t.nodeType!=1))}function kv(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].type.eq(e[r].type))return!1;return!0}function S$(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class b0e{constructor(e,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=w0e(e.node.content,e)}destroyBetween(e,r){if(e!=r){for(let n=e;n<r;n++)this.top.children[n].destroy();this.top.children.splice(e,r-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,r,n){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=Oi,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let c=this.index;c<Math.min(this.index+3,this.top.children.length);c++){let u=this.top.children[c];if(u.matchesMark(e[s])&&!this.isLocked(u.dom)){l=c;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let c=Xl.create(this.top,e[s],r,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,s++}}findNodeMatch(e,r,n,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,r,n))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,c=Math.min(this.top.children.length,l+5);l<c;l++){let u=this.top.children[l];if(u.matchesNode(e,r,n)&&!this.preMatch.matched.has(u)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,r,n,i,s){let o=this.top.children[i];return o.dirty==Ps&&o.dom==o.contentDOM&&(o.dirty=El),o.update(e,r,n,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let r=e.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=r}}updateNextNode(e,r,n,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let c=this.top.children[l];if(c instanceof Oa){let u=this.preMatch.matched.get(c);if(u!=null&&u!=s)return!1;let f=c.dom,d,p=this.isLocked(f)&&!(e.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==e.text&&c.dirty!=Ps&&kv(r,c.outerDeco));if(!p&&c.update(e,r,n,i))return this.destroyBetween(this.index,l),c.dom!=f&&(this.changed=!0),this.index++,!0;if(!p&&(d=this.recreateWrapper(c,e,r,n,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=El,d.updateChildren(i,o+1),d.dirty=Oi),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,r,n,i,s,o){if(e.dirty||r.isAtom||!e.children.length||!e.node.content.eq(r.content)||!kv(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=Oa.create(this.top,r,n,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let c of l.children)c.parent=l}return e.destroy(),l}addNode(e,r,n,i,s){let o=Oa.create(this.top,e,r,n,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,r,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new jU(this.top,e,r,n);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],r=this.top;for(;e instanceof Xl;)r=e,e=r.children[r.children.length-1];(!e||!(e instanceof bx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((bn||an)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(e,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new SU(this.top,[],n,null);r!=this.top?r.children.push(i):r.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function w0e(t,e){let r=e,n=r.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(n){let u=r.children[n-1];if(u instanceof Xl)r=u,n=u.children.length;else{l=u,n--;break}}else{if(r==e)break e;n=r.parent.children.indexOf(r),r=r.parent}let c=l.node;if(c){if(c!=t.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function j0e(t,e){return t.type.side-e.type.side}function S0e(t,e,r,n){let i=e.locals(t),s=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let f=t.child(u);n(f,i,e.forChild(s,f),u),s+=f.nodeSize}return}let o=0,l=[],c=null;for(let u=0;;){let f,d;for(;o<i.length&&i[o].to==s;){let v=i[o++];v.widget&&(f?(d||(d=[f])).push(v):f=v)}if(f)if(d){d.sort(j0e);for(let v=0;v<d.length;v++)r(d[v],u,!!c)}else r(f,u,!!c);let p,m;if(c)m=-1,p=c,c=null;else if(u<t.childCount)m=u,p=t.child(u++);else break;for(let v=0;v<l.length;v++)l[v].to<=s&&l.splice(v--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let x=s+p.nodeSize;if(p.isText){let v=x;o<i.length&&i[o].from<v&&(v=i[o].from);for(let b=0;b<l.length;b++)l[b].to<v&&(v=l[b].to);v<x&&(c=p.cut(v-s),p=p.cut(0,v-s),x=v,m=-1)}else for(;o<i.length&&i[o].to<x;)o++;let y=p.isInline&&!p.isLeaf?l.filter(v=>!v.inline):l.slice();n(p,y,e.forChild(s,p),m),s=x}}function N0e(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function k0e(t,e,r,n){for(let i=0,s=0;i<t.childCount&&s<=n;){let o=t.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let c=o.text;for(;i<t.childCount;){let u=t.child(i++);if(s+=u.nodeSize,!u.isText)break;c+=u.text}if(s>=r){if(s>=n&&c.slice(n-e.length-l,n-l)==e)return n-e.length;let u=l<n?c.lastIndexOf(e,n-l-1):-1;if(u>=0&&u+e.length+l>=r)return l+u;if(r==n&&c.length>=n+e.length-l&&c.slice(n-l,n-l+e.length)==e)return n}}return-1}function q2(t,e,r,n,i){let s=[];for(let o=0,l=0;o<t.length;o++){let c=t[o],u=l,f=l+=c.size;u>=r||f<=e?s.push(c):(u<e&&s.push(c.slice(0,e-u,n)),i&&(s.push(i),i=void 0),f>r&&s.push(c.slice(r-u,c.size,n)))}return s}function GE(t,e=null){let r=t.domSelectionRange(),n=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),s=i&&i.size==0,o=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(o<0)return null;let l=n.resolve(o),c,u;if(xx(r)){for(c=o;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&He.isSelectable(d)&&i.parent&&!(d.isInline&&Jve(r.focusNode,r.focusOffset,i.dom))){let p=i.posBefore;u=new He(o==p?l:n.resolve(p))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let d=o,p=o;for(let m=0;m<r.rangeCount;m++){let x=r.getRangeAt(m);d=Math.min(d,t.docView.posFromDOM(x.startContainer,x.startOffset,1)),p=Math.max(p,t.docView.posFromDOM(x.endContainer,x.endOffset,-1))}if(d<0)return null;[c,o]=p==t.state.selection.anchor?[p,d]:[d,p],l=n.resolve(o)}else c=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(c<0)return null}let f=n.resolve(c);if(!u){let d=e=="pointer"||t.state.selection.head<l.pos&&!s?1:-1;u=YE(t,f,l,d)}return u}function OU(t){return t.editable?t.hasFocus():CU(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function po(t,e=!1){let r=t.state.selection;if(EU(t,r),!!OU(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&an){let n=t.domSelectionRange(),i=t.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&Yl(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)O0e(t);else{let{anchor:n,head:i}=r,s,o;N$&&!(r instanceof et)&&(r.$from.parent.inlineContent||(s=k$(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(o=k$(t,r.to))),t.docView.setSelection(n,i,t,e),N$&&(s&&_$(s),o&&_$(o)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&_0e(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const N$=bn||an&&mU<63;function k$(t,e){let{node:r,offset:n}=t.docView.domFromPos(e,0),i=n<r.childNodes.length?r.childNodes[n]:null,s=n?r.childNodes[n-1]:null;if(bn&&i&&i.contentEditable=="false")return ak(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return ak(i);if(s)return ak(s)}}function ak(t){return t.contentEditable="true",bn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function _$(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function _0e(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!OU(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function O0e(t){let e=t.domSelection(),r=document.createRange();if(!e)return;let n=t.cursorWrapper.dom,i=n.nodeName=="IMG";i?r.setStart(n.parentNode,Wr(n)+1):r.setStart(n,0),r.collapse(!0),e.removeAllRanges(),e.addRange(r),!i&&!t.state.selection.visible&&Rn&&_a<=11&&(n.disabled=!0,n.disabled=!1)}function EU(t,e){if(e instanceof He){let r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(O$(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else O$(t)}function O$(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function YE(t,e,r,n){return t.someProp("createSelectionBetween",i=>i(t,e,r))||et.between(e,r,n)}function E$(t){return t.editable&&!t.hasFocus()?!1:CU(t)}function CU(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function E0e(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),r=t.domSelectionRange();return Yl(e.node,e.offset,r.anchorNode,r.anchorOffset)}function z2(t,e){let{$anchor:r,$head:n}=t.selection,i=e>0?r.max(n):r.min(n),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&ot.findFrom(s,e)}function aa(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function C$(t,e,r){let n=t.state.selection;if(n instanceof et)if(r.indexOf("s")>-1){let{$head:i}=n,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return aa(t,new et(n.$anchor,o))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=z2(t.state,e);return i&&i instanceof He?aa(t,i):!1}else if(!(ji&&r.indexOf("m")>-1)){let i=n.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?He.isSelectable(s)?aa(t,new He(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):Wp?aa(t,new et(t.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(n instanceof He&&n.node.isInline)return aa(t,new et(e>0?n.$to:n.$from));{let i=z2(t.state,e);return i?aa(t,i):!1}}}function _v(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ch(t,e){let r=t.pmViewDesc;return r&&r.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Zc(t,e){return e<0?C0e(t):A0e(t)}function C0e(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i,s,o=!1;for(is&&r.nodeType==1&&n<_v(r)&&ch(r.childNodes[n],-1)&&(o=!0);;)if(n>0){if(r.nodeType!=1)break;{let l=r.childNodes[n-1];if(ch(l,-1))i=r,s=--n;else if(l.nodeType==3)r=l,n=r.nodeValue.length;else break}}else{if(AU(r))break;{let l=r.previousSibling;for(;l&&ch(l,-1);)i=r.parentNode,s=Wr(l),l=l.previousSibling;if(l)r=l,n=_v(r);else{if(r=r.parentNode,r==t.dom)break;n=0}}}o?U2(t,r,n):i&&U2(t,i,s)}function A0e(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i=_v(r),s,o;for(;;)if(n<i){if(r.nodeType!=1)break;let l=r.childNodes[n];if(ch(l,1))s=r,o=++n;else break}else{if(AU(r))break;{let l=r.nextSibling;for(;l&&ch(l,1);)s=l.parentNode,o=Wr(l)+1,l=l.nextSibling;if(l)r=l,n=0,i=_v(r);else{if(r=r.parentNode,r==t.dom)break;n=i=0}}}s&&U2(t,s,o)}function AU(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function T0e(t,e){for(;t&&e==t.childNodes.length&&!Hp(t);)e=Wr(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let r=t.childNodes[e];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=0}}function P0e(t,e){for(;t&&!e&&!Hp(t);)e=Wr(t),t=t.parentNode;for(;t&&e;){let r=t.childNodes[e-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=t.childNodes.length}}function U2(t,e,r){if(e.nodeType!=3){let s,o;(o=T0e(e,r))?(e=o,r=0):(s=P0e(e,r))&&(e=s,r=s.nodeValue.length)}let n=t.domSelection();if(!n)return;if(xx(n)){let s=document.createRange();s.setEnd(e,r),s.setStart(e,r),n.removeAllRanges(),n.addRange(s)}else n.extend&&n.extend(e,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&po(t)},50)}function A$(t,e){let r=t.state.doc.resolve(e);if(!(an||e0e)&&r.parent.inlineContent){let i=t.coordsAtPos(e);if(e>r.start()){let s=t.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<r.end()){let s=t.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function T$(t,e,r){let n=t.state.selection;if(n instanceof et&&!n.empty||r.indexOf("s")>-1||ji&&r.indexOf("m")>-1)return!1;let{$from:i,$to:s}=n;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=z2(t.state,e);if(o&&o instanceof He)return aa(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=n instanceof ri?ot.near(o,e):ot.findFrom(o,e);return l?aa(t,l):!1}return!1}function P$(t,e){if(!(t.state.selection instanceof et))return!0;let{$head:r,$anchor:n,empty:i}=t.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(r.pos-s.nodeSize,r.pos):o.delete(r.pos,r.pos+s.nodeSize),t.dispatch(o),!0}return!1}function M$(t,e,r){t.domObserver.stop(),e.contentEditable=r,t.domObserver.start()}function M0e(t){if(!bn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(e&&e.nodeType==1&&r==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;M$(t,n,"true"),setTimeout(()=>M$(t,n,"false"),20)}return!1}function R0e(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function I0e(t,e){let r=e.keyCode,n=R0e(e);if(r==8||ji&&r==72&&n=="c")return P$(t,-1)||Zc(t,-1);if(r==46&&!e.shiftKey||ji&&r==68&&n=="c")return P$(t,1)||Zc(t,1);if(r==13||r==27)return!0;if(r==37||ji&&r==66&&n=="c"){let i=r==37?A$(t,t.state.selection.from)=="ltr"?-1:1:-1;return C$(t,i,n)||Zc(t,i)}else if(r==39||ji&&r==70&&n=="c"){let i=r==39?A$(t,t.state.selection.from)=="ltr"?1:-1:1;return C$(t,i,n)||Zc(t,i)}else{if(r==38||ji&&r==80&&n=="c")return T$(t,-1,n)||Zc(t,-1);if(r==40||ji&&r==78&&n=="c")return M0e(t)||T$(t,1,n)||Zc(t,1);if(n==(ji?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function XE(t,e){t.someProp("transformCopied",m=>{e=m(e,t)});let r=[],{content:n,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,s--;let m=n.firstChild;r.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),n=m.content}let o=t.someProp("clipboardSerializer")||uc.fromSchema(t.state.schema),l=DU(),c=l.createElement("div");c.appendChild(o.serializeFragment(n,{document:l}));let u=c.firstChild,f,d=0;for(;u&&u.nodeType==1&&(f=IU[u.nodeName.toLowerCase()]);){for(let m=f.length-1;m>=0;m--){let x=l.createElement(f[m]);for(;c.firstChild;)x.appendChild(c.firstChild);c.appendChild(x),d++}u=c.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(r)}`);let p=t.someProp("clipboardTextSerializer",m=>m(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:c,text:p,slice:e}}function TU(t,e,r,n,i){let s=i.parent.type.spec.code,o,l;if(!r&&!e)return null;let c=e&&(n||s||!r);if(c){if(t.someProp("transformPastedText",p=>{e=p(e,s||n,t)}),s)return e?new Ie(Ne.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):Ie.empty;let d=t.someProp("clipboardTextParser",p=>p(e,i,n,t));if(d)l=d;else{let p=i.marks(),{schema:m}=t.state,x=uc.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let v=o.appendChild(document.createElement("p"));y&&v.appendChild(x.serializeNode(m.text(y,p)))})}}else t.someProp("transformPastedHTML",d=>{r=d(r,t)}),o=B0e(r),Wp&&F0e(o);let u=o&&o.querySelector("[data-pm-slice]"),f=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(f&&f[3])for(let d=+f[3];d>0;d--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||ka.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(c||f),context:i,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!D0e.test(p.parentNode.nodeName)?{ignore:!0}:null}})),f)l=q0e(R$(l,+f[1],+f[2]),f[4]);else if(l=Ie.maxOpen(L0e(l.content,i),!0),l.openStart||l.openEnd){let d=0,p=0;for(let m=l.content.firstChild;d<l.openStart&&!m.type.spec.isolating;d++,m=m.firstChild);for(let m=l.content.lastChild;p<l.openEnd&&!m.type.spec.isolating;p++,m=m.lastChild);l=R$(l,d,p)}return t.someProp("transformPasted",d=>{l=d(l,t)}),l}const D0e=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function L0e(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),s,o=[];if(t.forEach(l=>{if(!o)return;let c=i.findWrapping(l.type),u;if(!c)return o=null;if(u=o.length&&s.length&&MU(c,s,l,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=RU(o[o.length-1],s.length));let f=PU(l,c);o.push(f),i=i.matchType(f.type),s=c}}),o)return Ne.from(o)}return t}function PU(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,Ne.from(t));return t}function MU(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=MU(t,e,r,n.lastChild,i+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(Ne.from(PU(r,t,i+1))))}}function RU(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,RU(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(Ne.empty,!0);return t.copy(r.append(n))}function H2(t,e,r,n,i,s){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(s=0),i<n-1&&(l=H2(l,e,r,n,i+1,s)),i>=r&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(Ne.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function R$(t,e,r){return e<t.openStart&&(t=new Ie(H2(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new Ie(H2(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const IU={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let I$=null;function DU(){return I$||(I$=document.implementation.createHTMLDocument("title"))}let lk=null;function $0e(t){let e=window.trustedTypes;return e?(lk||(lk=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),lk.createHTML(t)):t}function B0e(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=DU().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&IU[n[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),r.innerHTML=$0e(t),i)for(let s=0;s<i.length;s++)r=r.querySelector(i[s])||r;return r}function F0e(t){let e=t.querySelectorAll(an?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==" "&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function q0e(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let l=n.length-2;l>=0;l-=2){let c=r.nodes[n[l]];if(!c||c.hasRequiredAttrs())break;i=Ne.from(c.create(n[l+1],i)),s++,o++}return new Ie(i,s,o)}const wn={},jn={},z0e={touchstart:!0,touchmove:!0};class U0e{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function H0e(t){for(let e in wn){let r=wn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{V0e(t,n)&&!JE(t,n)&&(t.editable||!(n.type in jn))&&r(t,n)},z0e[e]?{passive:!0}:void 0)}bn&&t.dom.addEventListener("input",()=>null),W2(t)}function ba(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function W0e(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function W2(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>JE(t,n))})}function JE(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function V0e(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function K0e(t,e){!JE(t,e)&&wn[e.type]&&(t.editable||!(e.type in jn))&&wn[e.type](t,e)}jn.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!$U(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ao&&an&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),rd&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,Sl(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||I0e(t,r)?r.preventDefault():ba(t,"key")};jn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};jn.keypress=(t,e)=>{let r=e;if($U(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||ji&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof et)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),s=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,n.$from.pos,n.$to.pos,i,s))&&t.dispatch(s()),r.preventDefault()}};function wx(t){return{left:t.clientX,top:t.clientY}}function G0e(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function QE(t,e,r,n,i){if(n==-1)return!1;let s=t.state.doc.resolve(n);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,l=>o>s.depth?l(t,r,s.nodeAfter,s.before(o),i,!0):l(t,r,s.node(o),s.before(o),i,!1)))return!0;return!1}function ju(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);n.setMeta("pointer",!0),t.dispatch(n)}function Y0e(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&He.isSelectable(n)?(ju(t,new He(r)),!0):!1}function X0e(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof He&&(n=r.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(He.isSelectable(l)){n&&r.$from.depth>0&&o>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?i=s.before(r.$from.depth):i=s.before(o);break}}return i!=null?(ju(t,He.create(t.state.doc,i)),!0):!1}function J0e(t,e,r,n,i){return QE(t,"handleClickOn",e,r,n)||t.someProp("handleClick",s=>s(t,e,n))||(i?X0e(t,r):Y0e(t,r))}function Q0e(t,e,r,n){return QE(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function Z0e(t,e,r,n){return QE(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||exe(t,r,n)}function exe(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(ju(t,et.create(n,0,n.content.size)),!0):!1;let i=n.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)ju(t,et.create(n,l+1,l+1+o.content.size));else if(He.isSelectable(o))ju(t,He.create(n,l));else continue;return!0}}function ZE(t){return Ov(t)}const LU=ji?"metaKey":"ctrlKey";wn.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=ZE(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&G0e(r,t.input.lastClick)&&!r[LU]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:s,button:r.button};let o=t.posAtCoords(wx(r));o&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new txe(t,o,r,!!n)):(s=="doubleClick"?Q0e:Z0e)(t,o.pos,o.inside,r)?r.preventDefault():ba(t,"pointer"))};class txe{constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[LU],this.allowDefault=n.shiftKey;let s,o;if(r.inside>-1)s=e.state.doc.nodeAt(r.inside),o=r.inside;else{let f=e.state.doc.resolve(r.pos);s=f.parent,o=f.depth?f.before():0}const l=i?null:n.target,c=l?e.docView.nearestDesc(l,!0):null;this.target=c&&c.dom.nodeType==1?c.dom:null;let{selection:u}=e.state;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof He&&u.from<=o&&u.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&is&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ba(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>po(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(wx(e))),this.updateAllowDefault(e),this.allowDefault||!r?ba(this.view,"pointer"):J0e(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||bn&&this.mightDrag&&!this.mightDrag.node.isAtom||an&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(ju(this.view,ot.near(this.view.state.doc.resolve(r.pos))),e.preventDefault()):ba(this.view,"pointer")}move(e){this.updateAllowDefault(e),ba(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}wn.touchstart=t=>{t.input.lastTouch=Date.now(),ZE(t),ba(t,"pointer")};wn.touchmove=t=>{t.input.lastTouch=Date.now(),ba(t,"pointer")};wn.contextmenu=t=>ZE(t);function $U(t,e){return t.composing?!0:bn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const rxe=ao?5e3:-1;jn.compositionstart=jn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof et&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||r.marks(),Ov(t,!0),t.markCursor=null;else if(Ov(t,!e.selection.empty),is&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,s=n.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}BU(t,rxe)};jn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,BU(t,20))};function BU(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Ov(t),e))}function FU(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=ixe());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function nxe(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=Yve(e.focusNode,e.focusOffset),n=Xve(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(r==s||n==s)return s;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let o=r.pmViewDesc;if(!(!o||!o.isText(r.nodeValue)))return n}}return r||n}function ixe(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Ov(t,e=!1){if(!(ao&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),FU(t),e||t.docView&&t.docView.dirty){let r=GE(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function sxe(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const fp=Rn&&_a<15||rd&&t0e<604;wn.copy=jn.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let s=fp?null:r.clipboardData,o=n.content(),{dom:l,text:c}=XE(t,o);s?(r.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",c)):sxe(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function oxe(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function axe(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?hp(t,n.value,null,i,e):hp(t,n.textContent,n.innerHTML,i,e)},50)}function hp(t,e,r,n,i){let s=TU(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",c=>c(t,i,s||Ie.empty)))return!0;if(!s)return!1;let o=oxe(s),l=o?t.state.tr.replaceSelectionWith(o,n):t.state.tr.replaceSelection(s);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function qU(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}jn.paste=(t,e)=>{let r=e;if(t.composing&&!ao)return;let n=fp?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&hp(t,qU(n),n.getData("text/html"),i,r)?r.preventDefault():axe(t,r)};class zU{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const lxe=ji?"altKey":"ctrlKey";function UU(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[lxe]}wn.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(wx(r)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof He?i.to-1:i.to))){if(n&&n.mightDrag)o=He.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let d=t.docView.nearestDesc(r.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(o=He.create(t.state.doc,d.posBefore))}}let l=(o||t.state.selection).content(),{dom:c,text:u,slice:f}=XE(t,l);(!r.dataTransfer.files.length||!an||mU>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(fp?"Text":"text/html",c.innerHTML),r.dataTransfer.effectAllowed="copyMove",fp||r.dataTransfer.setData("text/plain",u),t.dragging=new zU(f,UU(t,r),o)};wn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};jn.dragover=jn.dragenter=(t,e)=>e.preventDefault();jn.drop=(t,e)=>{let r=e,n=t.dragging;if(t.dragging=null,!r.dataTransfer)return;let i=t.posAtCoords(wx(r));if(!i)return;let s=t.state.doc.resolve(i.pos),o=n&&n.slice;o?t.someProp("transformPasted",x=>{o=x(o,t)}):o=TU(t,qU(r.dataTransfer),fp?null:r.dataTransfer.getData("text/html"),!1,s);let l=!!(n&&UU(t,r));if(t.someProp("handleDrop",x=>x(t,r,o||Ie.empty,l))){r.preventDefault();return}if(!o)return;r.preventDefault();let c=o?oU(t.state.doc,s.pos,o):s.pos;c==null&&(c=s.pos);let u=t.state.tr;if(l){let{node:x}=n;x?x.replace(u):u.deleteSelection()}let f=u.mapping.map(c),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=u.doc;if(d?u.replaceRangeWith(f,f,o.content.firstChild):u.replaceRange(f,f,o),u.doc.eq(p))return;let m=u.doc.resolve(f);if(d&&He.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new He(m));else{let x=u.mapping.map(c);u.mapping.maps[u.mapping.maps.length-1].forEach((y,v,b,w)=>x=w),u.setSelection(YE(t,m,u.doc.resolve(x)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};wn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&po(t)},20))};wn.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};wn.beforeinput=(t,e)=>{if(an&&ao&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Sl(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in jn)wn[t]=jn[t];function pp(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class Ev{constructor(e,r){this.toDOM=e,this.spec=r||Ll,this.side=this.spec.side||0}map(e,r,n,i){let{pos:s,deleted:o}=e.mapResult(r.from+i,this.side<0?-1:1);return o?null:new vn(s-n,s-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Ev&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&pp(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ea{constructor(e,r){this.attrs=e,this.spec=r||Ll}map(e,r,n,i){let s=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,o=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return s>=o?null:new vn(s,o,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof Ea&&pp(this.attrs,e.attrs)&&pp(this.spec,e.spec)}static is(e){return e.type instanceof Ea}destroy(){}}class eC{constructor(e,r){this.attrs=e,this.spec=r||Ll}map(e,r,n,i){let s=e.mapResult(r.from+i,1);if(s.deleted)return null;let o=e.mapResult(r.to+i,-1);return o.deleted||o.pos<=s.pos?null:new vn(s.pos-n,o.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),s;return i==r.from&&!(s=e.child(n)).isText&&i+s.nodeSize==r.to}eq(e){return this==e||e instanceof eC&&pp(this.attrs,e.attrs)&&pp(this.spec,e.spec)}destroy(){}}class vn{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new vn(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new vn(e,e,new Ev(r,n))}static inline(e,r,n,i){return new vn(e,r,new Ea(n,i))}static node(e,r,n,i){return new vn(e,r,new eC(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ea}get widget(){return this.type instanceof Ev}}const ou=[],Ll={};class Qt{constructor(e,r){this.local=e.length?e:ou,this.children=r.length?r:ou}static create(e,r){return r.length?Cv(r,e,0,Ll):sn}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=r&&l.to>=e&&(!s||s(l.spec))&&n.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<r&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,r-l,n,i+l,s)}}map(e,r,n){return this==sn||e.maps.length==0?this:this.mapInner(e,r,0,0,n||Ll)}mapInner(e,r,n,i,s){let o;for(let l=0;l<this.local.length;l++){let c=this.local[l].map(e,n,i);c&&c.type.valid(r,c)?(o||(o=[])).push(c):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?cxe(this.children,o||[],e,r,n,i,s):o?new Qt(o.sort($l),ou):sn}add(e,r){return r.length?this==sn?Qt.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,s=0;e.forEach((l,c)=>{let u=c+n,f;if(f=WU(r,l,u)){for(i||(i=this.children.slice());s<i.length&&i[s]<c;)s+=3;i[s]==c?i[s+2]=i[s+2].addInner(l,f,u+1):i.splice(s,0,c,c+l.nodeSize,Cv(f,l,u+1,Ll)),s+=3}});let o=HU(s?VU(r):r,-n);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Qt(o.length?this.local.concat(o).sort($l):this.local,i||this.children)}remove(e){return e.length==0||this==sn?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let s=0;s<n.length;s+=3){let o,l=n[s]+r,c=n[s+1]+r;for(let f=0,d;f<e.length;f++)(d=e[f])&&d.from>l&&d.to<c&&(e[f]=null,(o||(o=[])).push(d));if(!o)continue;n==this.children&&(n=this.children.slice());let u=n[s+2].removeInner(o,l+1);u!=sn?n[s+2]=u:(n.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,r)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new Qt(i,n):sn}forChild(e,r){if(this==sn)return this;if(r.isLeaf)return Qt.empty;let n,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(n=this.children[l+2]);break}let s=e+1,o=s+r.content.size;for(let l=0;l<this.local.length;l++){let c=this.local[l];if(c.from<o&&c.to>s&&c.type instanceof Ea){let u=Math.max(s,c.from)-s,f=Math.min(o,c.to)-s;u<f&&(i||(i=[])).push(c.copy(u,f))}}if(i){let l=new Qt(i.sort($l),ou);return n?new pa([l,n]):l}return n||sn}eq(e){if(this==e)return!0;if(!(e instanceof Qt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return tC(this.localsInner(e))}localsInner(e){if(this==sn)return ou;if(e.inlineContent||!this.local.some(Ea.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Ea||r.push(this.local[n]);return r}forEachSet(e){e(this)}}Qt.empty=new Qt([],[]);Qt.removeOverlap=tC;const sn=Qt.empty;class pa{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,Ll));return pa.from(n)}forChild(e,r){if(r.isLeaf)return Qt.empty;let n=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,r);s!=sn&&(s instanceof pa?n=n.concat(s.members):n.push(s))}return pa.from(n)}eq(e){if(!(e instanceof pa)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!r)r=s;else{n&&(r=r.slice(),n=!1);for(let o=0;o<s.length;o++)r.push(s[o])}}return r?tC(n?r:r.sort($l)):ou}static from(e){switch(e.length){case 0:return sn;case 1:return e[0];default:return new pa(e.every(r=>r instanceof Qt)?e:e.reduce((r,n)=>r.concat(n instanceof Qt?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function cxe(t,e,r,n,i,s,o){let l=t.slice();for(let u=0,f=s;u<r.maps.length;u++){let d=0;r.maps[u].forEach((p,m,x,y)=>{let v=y-x-(m-p);for(let b=0;b<l.length;b+=3){let w=l[b+1];if(w<0||p>w+f-d)continue;let N=l[b]+f-d;m>=N?l[b+1]=p<=N?-2:-1:p>=f&&v&&(l[b]+=v,l[b+1]+=v)}d+=v}),f=r.maps[u].map(f,-1)}let c=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){c=!0,l[u+1]=-1;continue}let f=r.map(t[u]+s),d=f-i;if(d<0||d>=n.content.size){c=!0;continue}let p=r.map(t[u+1]+s,-1),m=p-i,{index:x,offset:y}=n.content.findIndex(d),v=n.maybeChild(x);if(v&&y==d&&y+v.nodeSize==m){let b=l[u+2].mapInner(r,v,f+1,t[u]+s+1,o);b!=sn?(l[u]=d,l[u+1]=m,l[u+2]=b):(l[u+1]=-2,c=!0)}else c=!0}if(c){let u=uxe(l,t,e,r,i,s,o),f=Cv(u,n,0,o);e=f.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,p=0;d<f.children.length;d+=3){let m=f.children[d];for(;p<l.length&&l[p]<m;)p+=3;l.splice(p,0,f.children[d],f.children[d+1],f.children[d+2])}}return new Qt(e.sort($l),l)}function HU(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new vn(i.from+e,i.to+e,i.type))}return r}function uxe(t,e,r,n,i,s,o){function l(c,u){for(let f=0;f<c.local.length;f++){let d=c.local[f].map(n,i,u);d?r.push(d):o.onRemove&&o.onRemove(c.local[f].spec)}for(let f=0;f<c.children.length;f+=3)l(c.children[f+2],c.children[f]+u+1)}for(let c=0;c<t.length;c+=3)t[c+1]==-1&&l(t[c+2],e[c]+s+1);return r}function WU(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>r&&o.to<n&&((i||(i=[])).push(o),t[s]=null);return i}function VU(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function Cv(t,e,r,n){let i=[],s=!1;e.forEach((l,c)=>{let u=WU(t,l,c+r);if(u){s=!0;let f=Cv(u,l,r+c+1,n);f!=sn&&i.push(c,c+l.nodeSize,f)}});let o=HU(s?VU(t):t,-r).sort($l);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(n.onRemove&&n.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Qt(o,i):sn}function $l(t,e){return t.from-e.from||t.to-e.to}function tC(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let s=e[i];if(s.from==n.from){s.to!=n.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,n.to),D$(e,i+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,s.from),D$(e,i,n.copy(s.from,n.to)));break}}}return e}function D$(t,e,r){for(;e<t.length&&$l(r,t[e])>0;)e++;t.splice(e,0,r)}function ck(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=sn&&e.push(n)}),t.cursorWrapper&&e.push(Qt.create(t.state.doc,[t.cursorWrapper.deco])),pa.from(e)}const dxe={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},fxe=Rn&&_a<=11;class hxe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class pxe{constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new hxe,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);Rn&&_a<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),fxe&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,dxe)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(E$(this.view)){if(this.suppressingSelectionUpdates)return po(this.view);if(Rn&&_a<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Yl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let s=e.focusNode;s;s=td(s))r.add(s);for(let s=e.anchorNode;s;s=td(s))if(r.has(s)){n=s;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&E$(e)&&!this.ignoreSelectionChange(n),s=-1,o=-1,l=!1,c=[];if(e.editable)for(let f=0;f<r.length;f++){let d=this.registerMutation(r[f],c);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(l=!0))}if(is&&c.length){let f=c.filter(d=>d.nodeName=="BR");if(f.length==2){let[d,p]=f;d.parentNode&&d.parentNode.parentNode==p.parentNode?p.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let p of f){let m=p.parentNode;m&&m.nodeName=="LI"&&(!d||yxe(e,d)!=m)&&p.remove()}}}let u=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&xx(n)&&(u=GE(e))&&u.eq(ot.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,po(e),this.currentSelection.set(n),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),mxe(e)),this.handleDOMChange(s,o,l,c),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||po(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let f=0;f<e.addedNodes.length;f++){let d=e.addedNodes[f];r.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Rn&&_a<=11&&e.addedNodes.length)for(let f=0;f<e.addedNodes.length;f++){let{previousSibling:d,nextSibling:p}=e.addedNodes[f];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(s=p)}let o=i&&i.parentNode==e.target?Wr(i)+1:0,l=n.localPosFromDOM(e.target,o,-1),c=s&&s.parentNode==e.target?Wr(s):e.target.childNodes.length,u=n.localPosFromDOM(e.target,c,1);return{from:l,to:u}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let L$=new WeakMap,$$=!1;function mxe(t){if(!L$.has(t)&&(L$.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=is,$$)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),$$=!0}}function B$(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Yl(o.node,o.offset,i,s)&&([r,n,i,s]=[i,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}}function gxe(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return B$(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?B$(t,r):null}function yxe(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function vxe(t,e,r){let{node:n,fromOffset:i,toOffset:s,from:o,to:l}=t.docView.parseRange(e,r),c=t.domSelectionRange(),u,f=c.anchorNode;if(f&&t.dom.contains(f.nodeType==1?f:f.parentNode)&&(u=[{node:f,offset:c.anchorOffset}],xx(c)||u.push({node:c.focusNode,offset:c.focusOffset})),an&&t.input.lastKeyCode===8)for(let v=s;v>i;v--){let b=n.childNodes[v-1],w=b.pmViewDesc;if(b.nodeName=="BR"&&!w){s=v;break}if(!w||w.size)break}let d=t.state.doc,p=t.someProp("domParser")||ka.fromSchema(t.state.schema),m=d.resolve(o),x=null,y=p.parse(n,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:i,to:s,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:xxe,context:m});if(u&&u[0].pos!=null){let v=u[0].pos,b=u[1]&&u[1].pos;b==null&&(b=v),x={anchor:v+o,head:b+o}}return{doc:y,sel:x,from:o,to:l}}function xxe(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(bn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||bn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const bxe=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function wxe(t,e,r,n,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let A=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,T=GE(t,A);if(T&&!t.state.selection.eq(T)){if(an&&ao&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",P=>P(t,Sl(13,"Enter"))))return;let M=t.state.tr.setSelection(T);A=="pointer"?M.setMeta("pointer",!0):A=="key"&&M.scrollIntoView(),s&&M.setMeta("composition",s),t.dispatch(M)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(r);e=o.before(l+1),r=t.state.doc.resolve(r).after(l+1);let c=t.state.selection,u=vxe(t,e,r),f=t.state.doc,d=f.slice(u.from,u.to),p,m;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(p=t.state.selection.to,m="end"):(p=t.state.selection.from,m="start"),t.input.lastKeyCode=null;let x=Nxe(d.content,u.doc.content,u.from,p,m);if(x&&t.input.domChangeCount++,(rd&&t.input.lastIOSEnter>Date.now()-225||ao)&&i.some(A=>A.nodeType==1&&!bxe.test(A.nodeName))&&(!x||x.endA>=x.endB)&&t.someProp("handleKeyDown",A=>A(t,Sl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!x)if(n&&c instanceof et&&!c.empty&&c.$head.sameParent(c.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))x={start:c.from,endA:c.to,endB:c.to};else{if(u.sel){let A=F$(t,t.state.doc,u.sel);if(A&&!A.eq(t.state.selection)){let T=t.state.tr.setSelection(A);s&&T.setMeta("composition",s),t.dispatch(T)}}return}t.state.selection.from<t.state.selection.to&&x.start==x.endB&&t.state.selection instanceof et&&(x.start>t.state.selection.from&&x.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?x.start=t.state.selection.from:x.endA<t.state.selection.to&&x.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(x.endB+=t.state.selection.to-x.endA,x.endA=t.state.selection.to)),Rn&&_a<=11&&x.endB==x.start+1&&x.endA==x.start&&x.start>u.from&&u.doc.textBetween(x.start-u.from-1,x.start-u.from+1)=="  "&&(x.start--,x.endA--,x.endB--);let y=u.doc.resolveNoCache(x.start-u.from),v=u.doc.resolveNoCache(x.endB-u.from),b=f.resolve(x.start),w=y.sameParent(v)&&y.parent.inlineContent&&b.end()>=x.endA,N;if((rd&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(A=>A.nodeName=="DIV"||A.nodeName=="P"))||!w&&y.pos<u.doc.content.size&&(!y.sameParent(v)||!y.parent.inlineContent)&&!/\S/.test(u.doc.textBetween(y.pos,v.pos,"",""))&&(N=ot.findFrom(u.doc.resolve(y.pos+1),1,!0))&&N.head>y.pos)&&t.someProp("handleKeyDown",A=>A(t,Sl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>x.start&&Sxe(f,x.start,x.endA,y,v)&&t.someProp("handleKeyDown",A=>A(t,Sl(8,"Backspace")))){ao&&an&&t.domObserver.suppressSelectionUpdates();return}an&&x.endB==x.start&&(t.input.lastChromeDelete=Date.now()),ao&&!w&&y.start()!=v.start()&&v.parentOffset==0&&y.depth==v.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==x.endA&&(x.endB-=2,v=u.doc.resolveNoCache(x.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(A){return A(t,Sl(13,"Enter"))})},20));let j=x.start,k=x.endA,_=A=>{let T=A||t.state.tr.replace(j,k,u.doc.slice(x.start-u.from,x.endB-u.from));if(u.sel){let M=F$(t,T.doc,u.sel);M&&!(an&&t.composing&&M.empty&&(x.start!=x.endB||t.input.lastChromeDelete<Date.now()-100)&&(M.head==j||M.head==T.mapping.map(k)-1)||Rn&&M.empty&&M.head==j)&&T.setSelection(M)}return s&&T.setMeta("composition",s),T.scrollIntoView()},E;if(w){if(y.pos==v.pos){Rn&&_a<=11&&y.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>po(t),20));let A=_(t.state.tr.delete(j,k)),T=f.resolve(x.start).marksAcross(f.resolve(x.endA));T&&A.ensureMarks(T),t.dispatch(A)}else if(x.endA==x.endB&&(E=jxe(y.parent.content.cut(y.parentOffset,v.parentOffset),b.parent.content.cut(b.parentOffset,x.endA-b.start())))){let A=_(t.state.tr);E.type=="add"?A.addMark(j,k,E.mark):A.removeMark(j,k,E.mark),t.dispatch(A)}else if(y.parent.child(y.index()).isText&&y.index()==v.index()-(v.textOffset?0:1)){let A=y.parent.textBetween(y.parentOffset,v.parentOffset),T=()=>_(t.state.tr.insertText(A,j,k));t.someProp("handleTextInput",M=>M(t,j,k,A,T))||t.dispatch(T())}}else t.dispatch(_())}function F$(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:YE(t,e.resolve(r.anchor),e.resolve(r.head))}function jxe(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,s=n,o,l,c;for(let f=0;f<n.length;f++)i=n[f].removeFromSet(i);for(let f=0;f<r.length;f++)s=r[f].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",c=f=>f.mark(l.addToSet(f.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",c=f=>f.mark(l.removeFromSet(f.marks));else return null;let u=[];for(let f=0;f<e.childCount;f++)u.push(c(e.child(f)));if(Ne.from(u).eq(t))return{mark:l,type:o}}function Sxe(t,e,r,n,i){if(r-e<=i.pos-n.pos||uk(n,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(!n.parent.isTextblock){let l=s.nodeAfter;return l!=null&&r==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(uk(s,!0,!0));return!o.parent.isTextblock||o.pos>r||uk(o,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(o.parent.content)}function uk(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let s=t.node(n).maybeChild(t.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function Nxe(t,e,r,n,i){let s=t.findDiffStart(e,r);if(s==null)return null;let{a:o,b:l}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let c=Math.max(0,s-Math.min(o,l));n-=o+c-s}if(o<s&&t.size<e.size){let c=n<=s&&n>=o?s-n:0;s-=c,s&&s<e.size&&q$(e.textBetween(s-1,s+1))&&(s+=c?1:-1),l=s+(l-o),o=s}else if(l<s){let c=n<=s&&n>=l?s-n:0;s-=c,s&&s<t.size&&q$(t.textBetween(s-1,s+1))&&(s+=c?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function q$(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class KU{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new U0e,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(V$),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=H$(this),U$(this),this.nodeViews=W$(this),this.docView=j$(this.state.doc,z$(this),ck(this),this.dom,this),this.domObserver=new pxe(this,(n,i,s,o)=>wxe(this,n,i,s,o)),this.domObserver.start(),H0e(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&W2(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach(V$),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(FU(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(l||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let m=W$(this);_xe(m,this.nodeViews)&&(this.nodeViews=m,s=!0)}(l||r.handleDOMEvents!=this._props.handleDOMEvents)&&W2(this),this.editable=H$(this),U$(this);let c=ck(this),u=z$(this),f=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,u,c);(d||!e.selection.eq(i.selection))&&(o=!0);let p=f=="preserve"&&o&&this.dom.style.overflowAnchor==null&&i0e(this);if(o){this.domObserver.stop();let m=d&&(Rn||an)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&kxe(i.selection,e.selection);if(d){let x=an?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=nxe(this)),(s||!this.docView.update(e.doc,u,c,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=j$(e.doc,u,c,this.dom,this)),x&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&E0e(this))?po(this,m):(EU(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),f=="reset"?this.dom.scrollTop=0:f=="to selection"?this.scrollToSelection():p&&s0e(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof He){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&g$(this,r.getBoundingClientRect(),e)}else g$(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let s=n.from+(this.state.doc.content.size-r.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==n.node&&(i=s)}this.dragging=new zU(e.slice,e.move,i<0?void 0:He.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=r?r(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=r?r(l):l))return i}}hasFocus(){if(Rn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&o0e(this.dom),po(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return d0e(this,e)}coordsAtPos(e,r=1){return bU(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return g0e(this,r||this.state,e)}pasteHTML(e,r){return hp(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return hp(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return XE(this,e)}destroy(){this.docView&&(W0e(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ck(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Kve())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return K0e(this,e)}domSelectionRange(){let e=this.domSelection();return e?bn&&this.root.nodeType===11&&Qve(this.dom.ownerDocument)==this.dom&&gxe(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}KU.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function z$(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[vn.node(0,t.state.doc.content.size,e)]}function U$(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:vn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function H$(t){return!t.someProp("editable",e=>e(t.state)===!1)}function kxe(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function W$(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function _xe(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function V$(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ta={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Av={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Oxe=typeof navigator<"u"&&/Mac/.test(navigator.platform),Exe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Vr=0;Vr<10;Vr++)Ta[48+Vr]=Ta[96+Vr]=String(Vr);for(var Vr=1;Vr<=24;Vr++)Ta[Vr+111]="F"+Vr;for(var Vr=65;Vr<=90;Vr++)Ta[Vr]=String.fromCharCode(Vr+32),Av[Vr]=String.fromCharCode(Vr);for(var dk in Ta)Av.hasOwnProperty(dk)||(Av[dk]=Ta[dk]);function Cxe(t){var e=Oxe&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Exe&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Av:Ta)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const Axe=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Txe=typeof navigator<"u"&&/Win/.test(navigator.platform);function Pxe(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,s,o;for(let l=0;l<e.length-1;l++){let c=e[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))i=!0;else if(/^s(hift)?$/i.test(c))s=!0;else if(/^mod$/i.test(c))Axe?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),o&&(r="Meta-"+r),s&&(r="Shift-"+r),r}function Mxe(t){let e=Object.create(null);for(let r in t)e[Pxe(r)]=t[r];return e}function fk(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function Rxe(t){return new nr({props:{handleKeyDown:GU(t)}})}function GU(t){let e=Mxe(t);return function(r,n){let i=Cxe(n),s,o=e[fk(i,n)];if(o&&o(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let l=e[fk(i,n,!1)];if(l&&l(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(Txe&&n.ctrlKey&&n.altKey)&&(s=Ta[n.keyCode])&&s!=i){let l=e[fk(s,n)];if(l&&l(r.state,r.dispatch,r))return!0}}return!1}}const rC=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function YU(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const XU=(t,e,r)=>{let n=YU(t,r);if(!n)return!1;let i=nC(n);if(!i){let o=n.blockRange(),l=o&&Sd(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(s7(t,i,e,-1))return!0;if(n.parent.content.size==0&&(nd(s,"end")||He.isSelectable(s)))for(let o=n.depth;;o--){let l=yx(t.doc,n.before(o),n.after(o),Ie.empty);if(l&&l.slice.size<l.to-l.from){if(e){let c=t.tr.step(l);c.setSelection(nd(s,"end")?ot.findFrom(c.doc.resolve(c.mapping.map(i.pos,-1)),-1):He.create(c.doc,i.pos-s.nodeSize)),e(c.scrollIntoView())}return!0}if(o==1||n.node(o-1).childCount>1)break}return s.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},Ixe=(t,e,r)=>{let n=YU(t,r);if(!n)return!1;let i=nC(n);return i?JU(t,i,e):!1},Dxe=(t,e,r)=>{let n=ZU(t,r);if(!n)return!1;let i=iC(n);return i?JU(t,i,e):!1};function JU(t,e,r){let n=e.nodeBefore,i=n,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let f=i.lastChild;if(!f)return!1;i=f}let o=e.nodeAfter,l=o,c=e.pos+1;for(;!l.isTextblock;c++){if(l.type.spec.isolating)return!1;let f=l.firstChild;if(!f)return!1;l=f}let u=yx(t.doc,s,c,Ie.empty);if(!u||u.from!=s||u instanceof Rr&&u.slice.size>=c-s)return!1;if(r){let f=t.tr.step(u);f.setSelection(et.create(f.doc,s)),r(f.scrollIntoView())}return!0}function nd(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const QU=(t,e,r)=>{let{$head:n,empty:i}=t.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;s=nC(n)}let o=s&&s.nodeBefore;return!o||!He.isSelectable(o)?!1:(e&&e(t.tr.setSelection(He.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function nC(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function ZU(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const e7=(t,e,r)=>{let n=ZU(t,r);if(!n)return!1;let i=iC(n);if(!i)return!1;let s=i.nodeAfter;if(s7(t,i,e,1))return!0;if(n.parent.content.size==0&&(nd(s,"start")||He.isSelectable(s))){let o=yx(t.doc,n.before(),n.after(),Ie.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(nd(s,"start")?ot.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):He.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},t7=(t,e,r)=>{let{$head:n,empty:i}=t.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;s=iC(n)}let o=s&&s.nodeAfter;return!o||!He.isSelectable(o)?!1:(e&&e(t.tr.setSelection(He.create(t.doc,s.pos)).scrollIntoView()),!0)};function iC(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const Lxe=(t,e)=>{let r=t.selection,n=r instanceof He,i;if(n){if(r.node.isTextblock||!Ha(t.doc,r.from))return!1;i=r.from}else if(i=gx(t.doc,r.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);n&&s.setSelection(He.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},$xe=(t,e)=>{let r=t.selection,n;if(r instanceof He){if(r.node.isTextblock||!Ha(t.doc,r.to))return!1;n=r.to}else if(n=gx(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},Bxe=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),s=i&&Sd(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},r7=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function sC(t){for(let e=0;e<t.edgeCount;e++){let{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const Fxe=(t,e)=>{let{$head:r,$anchor:n}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),s=r.indexAfter(-1),o=sC(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=r.after(),c=t.tr.replaceWith(l,l,o.createAndFill());c.setSelection(ot.near(c.doc.resolve(l),1)),e(c.scrollIntoView())}return!0},n7=(t,e)=>{let r=t.selection,{$from:n,$to:i}=r;if(r instanceof ri||n.parent.inlineContent||i.parent.inlineContent)return!1;let s=sC(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,l=t.tr.insert(o,s.createAndFill());l.setSelection(et.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},i7=(t,e)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let s=r.before();if(ho(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let n=r.blockRange(),i=n&&Sd(n);return i==null?!1:(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)};function qxe(t){return(e,r)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof He&&e.selection.node.isBlock)return!n.parentOffset||!ho(e.doc,n.pos)?!1:(r&&r(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let s=[],o,l,c=!1,u=!1;for(let m=n.depth;;m--)if(n.node(m).isBlock){c=n.end(m)==n.pos+(n.depth-m),u=n.start(m)==n.pos-(n.depth-m),l=sC(n.node(m-1).contentMatchAt(n.indexAfter(m-1))),s.unshift(c&&l?{type:l}:null),o=m;break}else{if(m==1)return!1;s.unshift(null)}let f=e.tr;(e.selection instanceof et||e.selection instanceof ri)&&f.deleteSelection();let d=f.mapping.map(n.pos),p=ho(f.doc,d,s.length,s);if(p||(s[0]=l?{type:l}:null,p=ho(f.doc,d,s.length,s)),!p)return!1;if(f.split(d,s.length,s),!c&&u&&n.node(o).type!=l){let m=f.mapping.map(n.before(o)),x=f.doc.resolve(m);l&&n.node(o-1).canReplaceWith(x.index(),x.index()+1,l)&&f.setNodeMarkup(f.mapping.map(n.before(o)),l)}return r&&r(f.scrollIntoView()),!0}}const zxe=qxe(),Uxe=(t,e)=>{let{$from:r,to:n}=t.selection,i,s=r.sharedDepth(n);return s==0?!1:(i=r.before(s),e&&e(t.tr.setSelection(He.create(t.doc,i))),!0)};function Hxe(t,e,r){let n=e.nodeBefore,i=e.nodeAfter,s=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(s-1,s)?(r&&r(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Ha(t.doc,e.pos))?!1:(r&&r(t.tr.join(e.pos).scrollIntoView()),!0)}function s7(t,e,r,n){let i=e.nodeBefore,s=e.nodeAfter,o,l,c=i.type.spec.isolating||s.type.spec.isolating;if(!c&&Hxe(t,e,r))return!0;let u=!c&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(r){let m=e.pos+s.nodeSize,x=Ne.empty;for(let b=o.length-1;b>=0;b--)x=Ne.from(o[b].create(null,x));x=Ne.from(i.copy(x));let y=t.tr.step(new Dr(e.pos-1,m,e.pos,m,new Ie(x,1,0),o.length,!0)),v=y.doc.resolve(m+2*o.length);v.nodeAfter&&v.nodeAfter.type==i.type&&Ha(y.doc,v.pos)&&y.join(v.pos),r(y.scrollIntoView())}return!0}let f=s.type.spec.isolating||n>0&&c?null:ot.findFrom(e,1),d=f&&f.$from.blockRange(f.$to),p=d&&Sd(d);if(p!=null&&p>=e.depth)return r&&r(t.tr.lift(d,p).scrollIntoView()),!0;if(u&&nd(s,"start",!0)&&nd(i,"end")){let m=i,x=[];for(;x.push(m),!m.isTextblock;)m=m.lastChild;let y=s,v=1;for(;!y.isTextblock;y=y.firstChild)v++;if(m.canReplace(m.childCount,m.childCount,y.content)){if(r){let b=Ne.empty;for(let N=x.length-1;N>=0;N--)b=Ne.from(x[N].copy(b));let w=t.tr.step(new Dr(e.pos-x.length,e.pos+s.nodeSize,e.pos+v,e.pos+s.nodeSize-v,new Ie(b,x.length,0),0,!0));r(w.scrollIntoView())}return!0}}return!1}function o7(t){return function(e,r){let n=e.selection,i=t<0?n.$from:n.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(r&&r(e.tr.setSelection(et.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const Wxe=o7(-1),Vxe=o7(1);function Kxe(t,e=null){return function(r,n){let{$from:i,$to:s}=r.selection,o=i.blockRange(s),l=o&&WE(o,t,e);return l?(n&&n(r.tr.wrap(o,l).scrollIntoView()),!0):!1}}function K$(t,e=null){return function(r,n){let i=!1;for(let s=0;s<r.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=r.selection.ranges[s];r.doc.nodesBetween(o,l,(c,u)=>{if(i)return!1;if(!(!c.isTextblock||c.hasMarkup(t,e)))if(c.type==t)i=!0;else{let f=r.doc.resolve(u),d=f.index();i=f.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(n){let s=r.tr;for(let o=0;o<r.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:c}}=r.selection.ranges[o];s.setBlockType(l,c,t,e)}n(s.scrollIntoView())}return!0}}function oC(...t){return function(e,r,n){for(let i=0;i<t.length;i++)if(t[i](e,r,n))return!0;return!1}}oC(rC,XU,QU);oC(rC,e7,t7);oC(r7,n7,i7,zxe);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Gxe(t,e=null){return function(r,n){let{$from:i,$to:s}=r.selection,o=i.blockRange(s);if(!o)return!1;let l=n?r.tr:null;return Yxe(l,o,t,e)?(n&&n(l.scrollIntoView()),!0):!1}}function Yxe(t,e,r,n=null){let i=!1,s=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(r)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let c=o.resolve(e.start-2);s=new Sv(c,c,e.depth),e.endIndex<e.parent.childCount&&(e=new Sv(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=WE(s,r,n,e);return l?(t&&Xxe(t,e,l,i,r),!0):!1}function Xxe(t,e,r,n,i){let s=Ne.empty;for(let f=r.length-1;f>=0;f--)s=Ne.from(r[f].type.create(r[f].attrs,s));t.step(new Dr(e.start-(n?2:0),e.end,e.start,e.end,new Ie(s,0,0),r.length,!0));let o=0;for(let f=0;f<r.length;f++)r[f].type==i&&(o=f+1);let l=r.length-o,c=e.start+r.length-(n?2:0),u=e.parent;for(let f=e.startIndex,d=e.endIndex,p=!0;f<d;f++,p=!1)!p&&ho(t.doc,c,l)&&(t.split(c,l),c+=2*l),c+=u.child(f).nodeSize;return t}function Jxe(t){return function(e,r){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return s?r?n.node(s.depth-1).type==t?Qxe(e,r,t,s):Zxe(e,r,s):!0:!1}}function Qxe(t,e,r,n){let i=t.tr,s=n.end,o=n.$to.end(n.depth);s<o&&(i.step(new Dr(s-1,o,s,o,new Ie(Ne.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new Sv(i.doc.resolve(n.$from.pos),i.doc.resolve(o),n.depth));const l=Sd(n);if(l==null)return!1;i.lift(n,l);let c=i.doc.resolve(i.mapping.map(s,-1)-1);return Ha(i.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&i.join(c.pos),e(i.scrollIntoView()),!0}function Zxe(t,e,r){let n=t.tr,i=r.parent;for(let m=r.end,x=r.endIndex-1,y=r.startIndex;x>y;x--)m-=i.child(x).nodeSize,n.delete(m-1,m+1);let s=n.doc.resolve(r.start),o=s.nodeAfter;if(n.mapping.map(r.end)!=r.start+s.nodeAfter.nodeSize)return!1;let l=r.startIndex==0,c=r.endIndex==i.childCount,u=s.node(-1),f=s.index(-1);if(!u.canReplace(f+(l?0:1),f+1,o.content.append(c?Ne.empty:Ne.from(i))))return!1;let d=s.pos,p=d+o.nodeSize;return n.step(new Dr(d-(l?1:0),p+(c?1:0),d+1,p-1,new Ie((l?Ne.empty:Ne.from(i.copy(Ne.empty))).append(c?Ne.empty:Ne.from(i.copy(Ne.empty))),l?0:1,c?0:1),l?0:1)),e(n.scrollIntoView()),!0}function ebe(t){return function(e,r){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,c=l.child(o-1);if(c.type!=t)return!1;if(r){let u=c.lastChild&&c.lastChild.type==l.type,f=Ne.from(u?t.create():null),d=new Ie(Ne.from(t.create(null,Ne.from(l.type.create(null,f)))),u?3:1,0),p=s.start,m=s.end;r(e.tr.step(new Dr(p-(u?3:1),m,p,m,d,1,!0)).scrollIntoView())}return!0}}var tbe=Object.defineProperty,a7=(t,e)=>{for(var r in e)tbe(t,r,{get:e[r],enumerable:!0})};function jx(t){const{state:e,transaction:r}=t;let{selection:n}=r,{doc:i}=r,{storedMarks:s}=r;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,s=r.storedMarks,r}}}var Sx=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:n}=e,{tr:i}=r,s=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([o,l])=>[o,(...u)=>{const f=l(...u)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:s}=n,o=[],l=!!t,c=t||i.tr,u=()=>(!l&&e&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),o.every(d=>d===!0)),f={...Object.fromEntries(Object.entries(r).map(([d,p])=>[d,(...x)=>{const y=this.buildProps(c,e),v=p(...x)(y);return o.push(v),f}])),run:u};return f}createCan(t){const{rawCommands:e,state:r}=this,n=!1,i=t||r.tr,s=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(e).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:s}=n,o={tr:t,editor:n,view:s,state:jx({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(o)]))}};return o}},rbe=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(n=>n.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(n=>n!==e):delete this.callbacks[t]),this}once(t,e){const r=(...n)=>{this.off(t,r),e.apply(this,n)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}};function l7(t,e){const r=new dU(t);return e.forEach(n=>{n.steps.forEach(i=>{r.step(i)})}),r}var c7=t=>{const e=t.childNodes;for(let r=e.length-1;r>=0;r-=1){const n=e[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&c7(n)}return t};function Mg(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(e,"text/html").body;return c7(r)}function mp(t,e,r){if(t instanceof Na||t instanceof Ne)return t;r={slice:!0,parseOptions:{},...r};const n=typeof t=="object"&&t!==null,i=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return Ne.fromArray(t.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(t);return r.errorOnInvalidContent&&o.check(),o}catch(s){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),mp("",e,r)}if(i){if(r.errorOnInvalidContent){let o=!1,l="";const c=new Y8({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?ka.fromSchema(c).parseSlice(Mg(t),r.parseOptions):ka.fromSchema(c).parse(Mg(t),r.parseOptions),r.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=ka.fromSchema(e);return r.slice?s.parseSlice(Mg(t),r.parseOptions).content:s.parse(Mg(t),r.parseOptions)}return mp("",e,r)}function V2(t,e,r={},n={}){return mp(t,e,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}function nbe(t){for(let e=0;e<t.edgeCount;e+=1){const{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function ibe(t,e,r){const n=[];return t.nodesBetween(e.from,e.to,(i,s)=>{r(i)&&n.push({node:i,pos:s})}),n}function sbe(t,e){for(let r=t.depth;r>0;r-=1){const n=t.node(r);if(e(n))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:n}}}function Nx(t){return e=>sbe(e.$from,t)}function Ue(t,e,r){return t.config[e]===void 0&&t.parent?Ue(t.parent,e,r):typeof t.config[e]=="function"?t.config[e].bind({...r,parent:t.parent?Ue(t.parent,e,r):null}):t.config[e]}function aC(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},n=Ue(e,"addExtensions",r);return n?[e,...aC(n())]:e}).flat(10)}function lC(t,e){const r=uc.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(r),i.innerHTML}function u7(t){return typeof t=="function"}function St(t,e=void 0,...r){return u7(t)?e?t.bind(e)(...r):t(...r):t}function obe(t={}){return Object.keys(t).length===0&&t.constructor===Object}function gp(t){const e=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),n=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:r,markExtensions:n}}function d7(t){const e=[],{nodeExtensions:r,markExtensions:n}=gp(t),i=[...r,...n],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:i},c=Ue(o,"addGlobalAttributes",l);if(!c)return;c().forEach(f=>{f.types.forEach(d=>{Object.entries(f.attributes).forEach(([p,m])=>{e.push({type:d,name:p,attribute:{...s,...m}})})})})}),i.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},c=Ue(o,"addAttributes",l);if(!c)return;const u=c();Object.entries(u).forEach(([f,d])=>{const p={...s,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:o.name,name:f,attribute:p})})}),e}function ur(...t){return t.filter(e=>!!e).reduce((e,r)=>{const n={...e};return Object.entries(r).forEach(([i,s])=>{if(!n[i]){n[i]=s;return}if(i==="class"){const l=s?String(s).split(" "):[],c=n[i]?n[i].split(" "):[],u=l.filter(f=>!c.includes(f));n[i]=[...c,...u].join(" ")}else if(i==="style"){const l=s?s.split(";").map(f=>f.trim()).filter(Boolean):[],c=n[i]?n[i].split(";").map(f=>f.trim()).filter(Boolean):[],u=new Map;c.forEach(f=>{const[d,p]=f.split(":").map(m=>m.trim());u.set(d,p)}),l.forEach(f=>{const[d,p]=f.split(":").map(m=>m.trim());u.set(d,p)}),n[i]=Array.from(u.entries()).map(([f,d])=>`${f}: ${d}`).join("; ")}else n[i]=s}),n},{})}function Tv(t,e){return e.filter(r=>r.type===t.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(t.attrs)||{}:{[r.name]:t.attrs[r.name]}).reduce((r,n)=>ur(r,n),{})}function abe(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function G$(t,e){return"style"in t?t:{...t,getAttrs:r=>{const n=t.getAttrs?t.getAttrs(r):t.attrs;if(n===!1)return!1;const i=e.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(r):abe(r.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...n,...i}}}}function Y$(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>e==="attrs"&&obe(r)?!1:r!=null))}function lbe(t,e){var r;const n=d7(t),{nodeExtensions:i,markExtensions:s}=gp(t),o=(r=i.find(u=>Ue(u,"topNode")))==null?void 0:r.name,l=Object.fromEntries(i.map(u=>{const f=n.filter(b=>b.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},p=t.reduce((b,w)=>{const N=Ue(w,"extendNodeSchema",d);return{...b,...N?N(u):{}}},{}),m=Y$({...p,content:St(Ue(u,"content",d)),marks:St(Ue(u,"marks",d)),group:St(Ue(u,"group",d)),inline:St(Ue(u,"inline",d)),atom:St(Ue(u,"atom",d)),selectable:St(Ue(u,"selectable",d)),draggable:St(Ue(u,"draggable",d)),code:St(Ue(u,"code",d)),whitespace:St(Ue(u,"whitespace",d)),linebreakReplacement:St(Ue(u,"linebreakReplacement",d)),defining:St(Ue(u,"defining",d)),isolating:St(Ue(u,"isolating",d)),attrs:Object.fromEntries(f.map(b=>{var w,N;return[b.name,{default:(w=b==null?void 0:b.attribute)==null?void 0:w.default,validate:(N=b==null?void 0:b.attribute)==null?void 0:N.validate}]}))}),x=St(Ue(u,"parseHTML",d));x&&(m.parseDOM=x.map(b=>G$(b,f)));const y=Ue(u,"renderHTML",d);y&&(m.toDOM=b=>y({node:b,HTMLAttributes:Tv(b,f)}));const v=Ue(u,"renderText",d);return v&&(m.toText=v),[u.name,m]})),c=Object.fromEntries(s.map(u=>{const f=n.filter(v=>v.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},p=t.reduce((v,b)=>{const w=Ue(b,"extendMarkSchema",d);return{...v,...w?w(u):{}}},{}),m=Y$({...p,inclusive:St(Ue(u,"inclusive",d)),excludes:St(Ue(u,"excludes",d)),group:St(Ue(u,"group",d)),spanning:St(Ue(u,"spanning",d)),code:St(Ue(u,"code",d)),attrs:Object.fromEntries(f.map(v=>{var b,w;return[v.name,{default:(b=v==null?void 0:v.attribute)==null?void 0:b.default,validate:(w=v==null?void 0:v.attribute)==null?void 0:w.validate}]}))}),x=St(Ue(u,"parseHTML",d));x&&(m.parseDOM=x.map(v=>G$(v,f)));const y=Ue(u,"renderHTML",d);return y&&(m.toDOM=v=>y({mark:v,HTMLAttributes:Tv(v,f)})),[u.name,m]}));return new Y8({topNode:o,nodes:l,marks:c})}function cbe(t){const e=t.filter((r,n)=>t.indexOf(r)!==n);return Array.from(new Set(e))}function cC(t){return t.sort((r,n)=>{const i=Ue(r,"priority")||100,s=Ue(n,"priority")||100;return i>s?-1:i<s?1:0})}function f7(t){const e=cC(aC(t)),r=cbe(e.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function h7(t,e,r){const{from:n,to:i}=e,{blockSeparator:s=`
--
`));return o.replaceSelectionWith(this.type.create({language:s},c)),o.selection.$from.parent.type!==this.type&&o.setSelection(et.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),N1e=li.create({name:"doc",topNode:!0,content:"block+"}),k1e=li.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",ur(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=n.extensionManager,c=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:f})=>{if(f&&c&&o){const d=c.filter(p=>l.includes(p.type.name));u.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),_1e=li.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,ur(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>G2({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),O1e=li.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",ur(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!Uwe(e,e.schema.nodes[this.name]))return!1;const{selection:r}=e,{$to:n}=r,i=t();return x7(r)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:s,dispatch:o})=>{var l;if(o){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(et.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(He.create(s.doc,c.pos)):s.setSelection(et.create(s.doc,c.pos));else{const f=(l=c.parent.type.contentMatch.defaultType)==null?void 0:l.create();f&&(s.insert(u,f),s.setSelection(et.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[zwe({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),E1e=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,C1e=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,A1e=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,T1e=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,P1e=Va.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[id({find:E1e,type:this.type}),id({find:A1e,type:this.type})]},addPasteRules(){return[Jl({find:C1e,type:this.type}),Jl({find:T1e,type:this.type})]}});const M1e="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",R1e="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",X2="numeric",J2="ascii",Q2="alpha",uh="asciinumeric",Kf="alphanumeric",Z2="domain",B7="emoji",I1e="scheme",D1e="slashscheme",xk="whitespace";function L1e(t,e){return t in e||(e[t]=[]),e[t]}function Tl(t,e,r){e[X2]&&(e[uh]=!0,e[Kf]=!0),e[J2]&&(e[uh]=!0,e[Q2]=!0),e[uh]&&(e[Kf]=!0),e[Q2]&&(e[Kf]=!0),e[Kf]&&(e[Z2]=!0),e[B7]&&(e[Z2]=!0);for(const n in e){const i=L1e(n,r);i.indexOf(t)<0&&i.push(t)}}function $1e(t,e){const r={};for(const n in e)e[n].indexOf(t)>=0&&(r[n]=!0);return r}function Pn(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Pn.groups={};Pn.prototype={accepts(){return!!this.t},go(t){const e=this,r=e.j[t];if(r)return r;for(let n=0;n<e.jr.length;n++){const i=e.jr[n][0],s=e.jr[n][1];if(s&&i.test(t))return s}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,r,n){for(let i=0;i<t.length;i++)this.tt(t[i],e,r,n)},tr(t,e,r,n){n=n||Pn.groups;let i;return e&&e.j?i=e:(i=new Pn(e),r&&n&&Tl(e,r,n)),this.jr.push([t,i]),i},ts(t,e,r,n){let i=this;const s=t.length;if(!s)return i;for(let o=0;o<s-1;o++)i=i.tt(t[o]);return i.tt(t[s-1],e,r,n)},tt(t,e,r,n){n=n||Pn.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const s=e;let o,l=i.go(t);if(l?(o=new Pn,Object.assign(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new Pn,s){if(n)if(o.t&&typeof o.t=="string"){const c=Object.assign($1e(o.t,n),r);Tl(s,c,n)}else r&&Tl(s,r,n);o.t=s}return i.j[t]=o,o}};const at=(t,e,r,n,i)=>t.ta(e,r,n,i),er=(t,e,r,n,i)=>t.tr(e,r,n,i),i6=(t,e,r,n,i)=>t.ts(e,r,n,i),Ee=(t,e,r,n,i)=>t.tt(e,r,n,i),eo="WORD",eO="UWORD",F7="ASCIINUMERICAL",q7="ALPHANUMERICAL",yp="LOCALHOST",tO="TLD",rO="UTLD",iy="SCHEME",lu="SLASH_SCHEME",mC="NUM",nO="WS",gC="NL",dh="OPENBRACE",fh="CLOSEBRACE",Dv="OPENBRACKET",Lv="CLOSEBRACKET",$v="OPENPAREN",Bv="CLOSEPAREN",Fv="OPENANGLEBRACKET",qv="CLOSEANGLEBRACKET",zv="FULLWIDTHLEFTPAREN",Uv="FULLWIDTHRIGHTPAREN",Hv="LEFTCORNERBRACKET",Wv="RIGHTCORNERBRACKET",Vv="LEFTWHITECORNERBRACKET",Kv="RIGHTWHITECORNERBRACKET",Gv="FULLWIDTHLESSTHAN",Yv="FULLWIDTHGREATERTHAN",Xv="AMPERSAND",Jv="APOSTROPHE",Qv="ASTERISK",la="AT",Zv="BACKSLASH",e0="BACKTICK",t0="CARET",ma="COLON",yC="COMMA",r0="DOLLAR",xs="DOT",n0="EQUALS",vC="EXCLAMATION",bi="HYPHEN",hh="PERCENT",i0="PIPE",s0="PLUS",o0="POUND",ph="QUERY",xC="QUOTE",z7="FULLWIDTHMIDDLEDOT",bC="SEMI",bs="SLASH",mh="TILDE",a0="UNDERSCORE",U7="EMOJI",l0="SYM";var H7=Object.freeze({__proto__:null,ALPHANUMERICAL:q7,AMPERSAND:Xv,APOSTROPHE:Jv,ASCIINUMERICAL:F7,ASTERISK:Qv,AT:la,BACKSLASH:Zv,BACKTICK:e0,CARET:t0,CLOSEANGLEBRACKET:qv,CLOSEBRACE:fh,CLOSEBRACKET:Lv,CLOSEPAREN:Bv,COLON:ma,COMMA:yC,DOLLAR:r0,DOT:xs,EMOJI:U7,EQUALS:n0,EXCLAMATION:vC,FULLWIDTHGREATERTHAN:Yv,FULLWIDTHLEFTPAREN:zv,FULLWIDTHLESSTHAN:Gv,FULLWIDTHMIDDLEDOT:z7,FULLWIDTHRIGHTPAREN:Uv,HYPHEN:bi,LEFTCORNERBRACKET:Hv,LEFTWHITECORNERBRACKET:Vv,LOCALHOST:yp,NL:gC,NUM:mC,OPENANGLEBRACKET:Fv,OPENBRACE:dh,OPENBRACKET:Dv,OPENPAREN:$v,PERCENT:hh,PIPE:i0,PLUS:s0,POUND:o0,QUERY:ph,QUOTE:xC,RIGHTCORNERBRACKET:Wv,RIGHTWHITECORNERBRACKET:Kv,SCHEME:iy,SEMI:bC,SLASH:bs,SLASH_SCHEME:lu,SYM:l0,TILDE:mh,TLD:tO,UNDERSCORE:a0,UTLD:rO,UWORD:eO,WORD:eo,WS:nO});const Js=/[a-z]/,Rf=new RegExp("\\p{L}","u"),bk=new RegExp("\\p{Emoji}","u"),Qs=/\d/,wk=/\s/,s6="\r",jk=`
`,B1e="️",F1e="‍",Sk="￼";let Lg=null,$g=null;function q1e(t=[]){const e={};Pn.groups=e;const r=new Pn;Lg==null&&(Lg=o6(M1e)),$g==null&&($g=o6(R1e)),Ee(r,"'",Jv),Ee(r,"{",dh),Ee(r,"}",fh),Ee(r,"[",Dv),Ee(r,"]",Lv),Ee(r,"(",$v),Ee(r,")",Bv),Ee(r,"<",Fv),Ee(r,">",qv),Ee(r,"（",zv),Ee(r,"）",Uv),Ee(r,"「",Hv),Ee(r,"」",Wv),Ee(r,"『",Vv),Ee(r,"』",Kv),Ee(r,"＜",Gv),Ee(r,"＞",Yv),Ee(r,"&",Xv),Ee(r,"*",Qv),Ee(r,"@",la),Ee(r,"`",e0),Ee(r,"^",t0),Ee(r,":",ma),Ee(r,",",yC),Ee(r,"$",r0),Ee(r,".",xs),Ee(r,"=",n0),Ee(r,"!",vC),Ee(r,"-",bi),Ee(r,"%",hh),Ee(r,"|",i0),Ee(r,"+",s0),Ee(r,"#",o0),Ee(r,"?",ph),Ee(r,'"',xC),Ee(r,"/",bs),Ee(r,";",bC),Ee(r,"~",mh),Ee(r,"_",a0),Ee(r,"\\",Zv),Ee(r,"・",z7);const n=er(r,Qs,mC,{[X2]:!0});er(n,Qs,n);const i=er(n,Js,F7,{[uh]:!0}),s=er(n,Rf,q7,{[Kf]:!0}),o=er(r,Js,eo,{[J2]:!0});er(o,Qs,i),er(o,Js,o),er(i,Qs,i),er(i,Js,i);const l=er(r,Rf,eO,{[Q2]:!0});er(l,Js),er(l,Qs,s),er(l,Rf,l),er(s,Qs,s),er(s,Js),er(s,Rf,s);const c=Ee(r,jk,gC,{[xk]:!0}),u=Ee(r,s6,nO,{[xk]:!0}),f=er(r,wk,nO,{[xk]:!0});Ee(r,Sk,f),Ee(u,jk,c),Ee(u,Sk,f),er(u,wk,f),Ee(f,s6),Ee(f,jk),er(f,wk,f),Ee(f,Sk,f);const d=er(r,bk,U7,{[B7]:!0});Ee(d,"#"),er(d,bk,d),Ee(d,B1e,d);const p=Ee(d,F1e);Ee(p,"#"),er(p,bk,d);const m=[[Js,o],[Qs,i]],x=[[Js,null],[Rf,l],[Qs,s]];for(let y=0;y<Lg.length;y++)ta(r,Lg[y],tO,eo,m);for(let y=0;y<$g.length;y++)ta(r,$g[y],rO,eO,x);Tl(tO,{tld:!0,ascii:!0},e),Tl(rO,{utld:!0,alpha:!0},e),ta(r,"file",iy,eo,m),ta(r,"mailto",iy,eo,m),ta(r,"http",lu,eo,m),ta(r,"https",lu,eo,m),ta(r,"ftp",lu,eo,m),ta(r,"ftps",lu,eo,m),Tl(iy,{scheme:!0,ascii:!0},e),Tl(lu,{slashscheme:!0,ascii:!0},e),t=t.sort((y,v)=>y[0]>v[0]?1:-1);for(let y=0;y<t.length;y++){const v=t[y][0],w=t[y][1]?{[I1e]:!0}:{[D1e]:!0};v.indexOf("-")>=0?w[Z2]=!0:Js.test(v)?Qs.test(v)?w[uh]=!0:w[J2]=!0:w[X2]=!0,i6(r,v,v,w)}return i6(r,"localhost",yp,{ascii:!0}),r.jd=new Pn(l0),{start:r,tokens:Object.assign({groups:e},H7)}}function W7(t,e){const r=z1e(e.replace(/[A-Z]/g,l=>l.toLowerCase())),n=r.length,i=[];let s=0,o=0;for(;o<n;){let l=t,c=null,u=0,f=null,d=-1,p=-1;for(;o<n&&(c=l.go(r[o]));)l=c,l.accepts()?(d=0,p=0,f=l):d>=0&&(d+=r[o].length,p++),u+=r[o].length,s+=r[o].length,o++;s-=d,o-=p,u-=d,i.push({t:f.t,v:e.slice(s-u,s),s:s-u,e:s})}return i}function z1e(t){const e=[],r=t.length;let n=0;for(;n<r;){let i=t.charCodeAt(n),s,o=i<55296||i>56319||n+1===r||(s=t.charCodeAt(n+1))<56320||s>57343?t[n]:t.slice(n,n+2);e.push(o),n+=o.length}return e}function ta(t,e,r,n,i){let s;const o=e.length;for(let l=0;l<o-1;l++){const c=e[l];t.j[c]?s=t.j[c]:(s=new Pn(n),s.jr=i.slice(),t.j[c]=s),t=s}return s=new Pn(r),s.jr=i.slice(),t.j[e[o-1]]=s,s}function o6(t){const e=[],r=[];let n=0,i="0123456789";for(;n<t.length;){let s=0;for(;i.indexOf(t[n+s])>=0;)s++;if(s>0){e.push(r.join(""));for(let o=parseInt(t.substring(n,n+s),10);o>0;o--)r.pop();n+=s}else r.push(t[n]),n++}return e}const vp={defaultProtocol:"http",events:null,format:a6,formatHref:a6,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function wC(t,e=null){let r=Object.assign({},vp);t&&(r=Object.assign(r,t instanceof wC?t.o:t));const n=r.ignoreTags,i=[];for(let s=0;s<n.length;s++)i.push(n[s].toUpperCase());this.o=r,e&&(this.defaultRender=e),this.ignoreTags=i}wC.prototype={o:vp,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,r){const n=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=r.t in i?i[r.t]:vp[t],typeof i=="function"&&n&&(i=i(e,r))):typeof i=="function"&&n&&(i=i(e,r.t,r)),i)},getObj(t,e,r){let n=this.o[t];return typeof n=="function"&&e!=null&&(n=n(e,r.t,r)),n},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function a6(t){return t}function V7(t,e){this.t="token",this.v=t,this.tk=e}V7.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),r=t.get("truncate",e,this),n=t.get("format",e,this);return r&&n.length>r?n.substring(0,r)+"…":n},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=vp.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,r=this.toHref(t.get("defaultProtocol")),n=t.get("formatHref",r,this),i=t.get("tagName",r,e),s=this.toFormattedString(t),o={},l=t.get("className",r,e),c=t.get("target",r,e),u=t.get("rel",r,e),f=t.getObj("attributes",r,e),d=t.getObj("events",r,e);return o.href=n,l&&(o.class=l),c&&(o.target=c),u&&(o.rel=u),f&&Object.assign(o,f),{tagName:i,attributes:o,content:s,eventListeners:d}}};function Ex(t,e){class r extends V7{constructor(i,s){super(i,s),this.t=t}}for(const n in e)r.prototype[n]=e[n];return r.t=t,r}const l6=Ex("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),c6=Ex("text"),U1e=Ex("nl"),Bg=Ex("url",{isLink:!0,toHref(t=vp.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==yp&&t[1].t===ma}}),xi=t=>new Pn(t);function H1e({groups:t}){const e=t.domain.concat([Xv,Qv,la,Zv,e0,t0,r0,n0,bi,mC,hh,i0,s0,o0,bs,l0,mh,a0]),r=[Jv,ma,yC,xs,vC,hh,ph,xC,bC,Fv,qv,dh,fh,Lv,Dv,$v,Bv,zv,Uv,Hv,Wv,Vv,Kv,Gv,Yv],n=[Xv,Jv,Qv,Zv,e0,t0,r0,n0,bi,dh,fh,hh,i0,s0,o0,ph,bs,l0,mh,a0],i=xi(),s=Ee(i,mh);at(s,n,s),at(s,t.domain,s);const o=xi(),l=xi(),c=xi();at(i,t.domain,o),at(i,t.scheme,l),at(i,t.slashscheme,c),at(o,n,s),at(o,t.domain,o);const u=Ee(o,la);Ee(s,la,u),Ee(l,la,u),Ee(c,la,u);const f=Ee(s,xs);at(f,n,s),at(f,t.domain,s);const d=xi();at(u,t.domain,d),at(d,t.domain,d);const p=Ee(d,xs);at(p,t.domain,d);const m=xi(l6);at(p,t.tld,m),at(p,t.utld,m),Ee(u,yp,m);const x=Ee(d,bi);Ee(x,bi,x),at(x,t.domain,d),at(m,t.domain,d),Ee(m,xs,p),Ee(m,bi,x);const y=Ee(m,ma);at(y,t.numeric,l6);const v=Ee(o,bi),b=Ee(o,xs);Ee(v,bi,v),at(v,t.domain,o),at(b,n,s),at(b,t.domain,o);const w=xi(Bg);at(b,t.tld,w),at(b,t.utld,w),at(w,t.domain,o),at(w,n,s),Ee(w,xs,b),Ee(w,bi,v),Ee(w,la,u);const N=Ee(w,ma),j=xi(Bg);at(N,t.numeric,j);const k=xi(Bg),_=xi();at(k,e,k),at(k,r,_),at(_,e,k),at(_,r,_),Ee(w,bs,k),Ee(j,bs,k);const E=Ee(l,ma),A=Ee(c,ma),T=Ee(A,bs),M=Ee(T,bs);at(l,t.domain,o),Ee(l,xs,b),Ee(l,bi,v),at(c,t.domain,o),Ee(c,xs,b),Ee(c,bi,v),at(E,t.domain,k),Ee(E,bs,k),Ee(E,ph,k),at(M,t.domain,k),at(M,e,k),Ee(M,bs,k);const P=[[dh,fh],[Dv,Lv],[$v,Bv],[Fv,qv],[zv,Uv],[Hv,Wv],[Vv,Kv],[Gv,Yv]];for(let R=0;R<P.length;R++){const[L,$]=P[R],F=Ee(k,L);Ee(_,L,F),Ee(F,$,k);const z=xi(Bg);at(F,e,z);const W=xi();at(F,r),at(z,e,z),at(z,r,W),at(W,e,z),at(W,r,W),Ee(z,$,k),Ee(W,$,k)}return Ee(i,yp,w),Ee(i,gC,U1e),{start:i,tokens:H7}}function W1e(t,e,r){let n=r.length,i=0,s=[],o=[];for(;i<n;){let l=t,c=null,u=null,f=0,d=null,p=-1;for(;i<n&&!(c=l.go(r[i].t));)o.push(r[i++]);for(;i<n&&(u=c||l.go(r[i].t));)c=null,l=u,l.accepts()?(p=0,d=l):p>=0&&p++,i++,f++;if(p<0)i-=f,i<n&&(o.push(r[i]),i++);else{o.length>0&&(s.push(Nk(c6,e,o)),o=[]),i-=p,f-=p;const m=d.t,x=r.slice(i-f,i);s.push(Nk(m,e,x))}}return o.length>0&&s.push(Nk(c6,e,o)),s}function Nk(t,e,r){const n=r[0].s,i=r[r.length-1].e,s=e.slice(n,i);return new t(s,r)}const V1e=typeof console<"u"&&console&&console.warn||(()=>{}),K1e="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",zt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function G1e(){return Pn.groups={},zt.scanner=null,zt.parser=null,zt.tokenQueue=[],zt.pluginQueue=[],zt.customSchemes=[],zt.initialized=!1,zt}function u6(t,e=!1){if(zt.initialized&&V1e(`linkifyjs: already initialized - will not register custom scheme "${t}" ${K1e}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);zt.customSchemes.push([t,e])}function Y1e(){zt.scanner=q1e(zt.customSchemes);for(let t=0;t<zt.tokenQueue.length;t++)zt.tokenQueue[t][1]({scanner:zt.scanner});zt.parser=H1e(zt.scanner.tokens);for(let t=0;t<zt.pluginQueue.length;t++)zt.pluginQueue[t][1]({scanner:zt.scanner,parser:zt.parser});return zt.initialized=!0,zt}function jC(t){return zt.initialized||Y1e(),W1e(zt.parser.start,t,W7(zt.scanner.start,t))}jC.scan=W7;function K7(t,e=null,r=null){if(e&&typeof e=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);r=e,e=null}const n=new wC(r),i=jC(t),s=[];for(let o=0;o<i.length;o++){const l=i[o];l.isLink&&(!e||l.t===e)&&n.check(l)&&s.push(l.toFormattedObject(n))}return s}var SC="[\0-   ᠎ -\u2029 　]",X1e=new RegExp(SC),J1e=new RegExp(`${SC}$`),Q1e=new RegExp(SC,"g");function Z1e(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function eje(t){return new nr({key:new Fr("autolink"),appendTransaction:(e,r,n)=>{const i=e.some(u=>u.docChanged)&&!r.doc.eq(n.doc),s=e.some(u=>u.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=n,l=l7(r.doc,[...e]);if(y7(l).forEach(({newRange:u})=>{const f=ibe(n.doc,u,m=>m.isTextblock);let d,p;if(f.length>1)d=f[0],p=n.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ");else if(f.length){const m=n.doc.textBetween(u.from,u.to," "," ");if(!J1e.test(m))return;d=f[0],p=n.doc.textBetween(d.pos,u.to,void 0," ")}if(d&&p){const m=p.split(X1e).filter(Boolean);if(m.length<=0)return!1;const x=m[m.length-1],y=d.pos+p.lastIndexOf(x);if(!x)return!1;const v=jC(x).map(b=>b.toObject(t.defaultProtocol));if(!Z1e(v))return!1;v.filter(b=>b.isLink).map(b=>({...b,from:y+b.start+1,to:y+b.end+1})).filter(b=>n.schema.marks.code?!n.doc.rangeHasMark(b.from,b.to,n.schema.marks.code):!0).filter(b=>t.validate(b.value)).filter(b=>t.shouldAutoLink(b.value)).forEach(b=>{fC(b.from,b.to,n.doc).some(w=>w.mark.type===t.type)||o.addMark(b.from,b.to,t.type.create({href:b.href}))})}}),!!o.steps.length)return o}})}function tje(t){return new nr({key:new Fr("handleClickLink"),props:{handleClick:(e,r,n)=>{var i,s;if(n.button!==0||!e.editable)return!1;let o=null;if(n.target instanceof HTMLAnchorElement)o=n.target;else{let f=n.target;const d=[];for(;f.nodeName!=="DIV";)d.push(f),f=f.parentNode;o=d.find(p=>p.nodeName==="A")}if(!o)return!1;const l=g7(e.state,t.type.name),c=(i=o==null?void 0:o.href)!=null?i:l.href,u=(s=o==null?void 0:o.target)!=null?s:l.target;return t.enableClickSelection&&t.editor.commands.extendMarkRange(t.type.name),o&&c?(window.open(c,u),!0):!1}}})}function rje(t){return new nr({key:new Fr("handlePasteLink"),props:{handlePaste:(e,r,n)=>{const{state:i}=e,{selection:s}=i,{empty:o}=s;if(o)return!1;let l="";n.content.forEach(u=>{l+=u.textContent});const c=K7(l,{defaultProtocol:t.defaultProtocol}).find(u=>u.isLink&&u.value===l);return!l||!c?!1:t.editor.commands.setMark(t.type,{href:c.href})}}})}function pl(t,e){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{const i=typeof n=="string"?n:n.scheme;i&&r.push(i)}),!t||t.replace(Q1e,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var NC=Va.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){u6(t);return}u6(t.scheme,t.optionalSlashes)})},onDestroy(){G1e()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!pl(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:r=>!!pl(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!pl(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ur(this.options.HTMLAttributes,t),0]:["a",ur(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>{const{href:r}=t;return this.options.isAllowedUri(r,{defaultValidate:n=>!!pl(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:r}=t||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!pl(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Jl({find:t=>{const e=[];if(t){const{protocols:r,defaultProtocol:n}=this.options,i=K7(t).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:o=>!!pl(o,r),protocols:r,defaultProtocol:n}));i.length&&i.forEach(s=>e.push({text:s.value,data:{href:s.href},index:s.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:r}=this.options;return this.options.autolink&&t.push(eje({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!pl(i,e),protocols:e,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(tje({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(rje({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}}),nje=Object.defineProperty,ije=(t,e)=>{for(var r in e)nje(t,r,{get:e[r],enumerable:!0})},sje="listItem",d6="textStyle",f6=/^\s*([-+*])\s$/,G7=li.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(sje,this.editor.getAttributes(d6)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=sd({find:f6,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=sd({find:f6,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(d6),editor:this.editor})),[t]}}),Y7=li.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",ur(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),oje={};ije(oje,{findListItemPos:()=>Gp,getNextListDepth:()=>kC,handleBackspace:()=>iO,handleDelete:()=>sO,hasListBefore:()=>X7,hasListItemAfter:()=>aje,hasListItemBefore:()=>J7,listItemHasSubList:()=>Q7,nextListIsDeeper:()=>Z7,nextListIsHigher:()=>e9});var Gp=(t,e)=>{const{$from:r}=e.selection,n=gr(t,e.schema);let i=null,s=r.depth,o=r.pos,l=null;for(;s>0&&l===null;)i=r.node(s),i.type===n?l=s:(s-=1,o-=1);return l===null?null:{$pos:e.doc.resolve(o),depth:l}},kC=(t,e)=>{const r=Gp(t,e);if(!r)return!1;const[,n]=pbe(e,t,r.$pos.pos+4);return n},X7=(t,e,r)=>{const{$anchor:n}=t.selection,i=Math.max(0,n.pos-2),s=t.doc.resolve(i).node();return!(!s||!r.includes(s.type.name))},J7=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-2);return!(i.index()===0||((r=i.nodeBefore)==null?void 0:r.type.name)!==t)},Q7=(t,e,r)=>{if(!r)return!1;const n=gr(t,e.schema);let i=!1;return r.descendants(s=>{s.type===n&&(i=!0)}),i},iO=(t,e,r)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Pa(t.state,e)&&X7(t.state,e,r)){const{$anchor:l}=t.state.selection,c=t.state.doc.resolve(l.before()-1),u=[];c.node().descendants((p,m)=>{p.type.name===e&&u.push({node:p,pos:m})});const f=u.at(-1);if(!f)return!1;const d=t.state.doc.resolve(c.start()+f.pos+1);return t.chain().cut({from:l.start()-1,to:l.end()+1},d.end()).joinForward().run()}if(!Pa(t.state,e)||!vbe(t.state))return!1;const n=Gp(e,t.state);if(!n)return!1;const s=t.state.doc.resolve(n.$pos.pos-2).node(n.depth),o=Q7(e,t.state,s);return J7(e,t.state)&&!o?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},Z7=(t,e)=>{const r=kC(t,e),n=Gp(t,e);return!n||!r?!1:r>n.depth},e9=(t,e)=>{const r=kC(t,e),n=Gp(t,e);return!n||!r?!1:r<n.depth},sO=(t,e)=>{if(!Pa(t.state,e)||!ybe(t.state,e))return!1;const{selection:r}=t.state,{$from:n,$to:i}=r;return!r.empty&&n.sameParent(i)?!1:Z7(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():e9(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},aje=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((r=i.nodeAfter)==null?void 0:r.type.name)!==t)},t9=Ct.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&sO(t,r)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&sO(t,r)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&iO(t,r,n)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&iO(t,r,n)&&(e=!0)}),e}}}}),lje="listItem",h6="textStyle",p6=/^(\d+)\.\s$/,r9=li.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...r}=t;return e===1?["ol",ur(this.options.HTMLAttributes,r),0]:["ol",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(lje,this.editor.getAttributes(h6)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=sd({find:p6,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=sd({find:p6,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(h6)}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}}),cje=/^\s*(\[([( |x])?\])\s$/,uje=li.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",ur(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:n})=>{const i=document.createElement("li"),s=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),c=document.createElement("div"),u=f=>{var d,p;l.ariaLabel=((p=(d=this.options.a11y)==null?void 0:d.checkboxLabel)==null?void 0:p.call(d,f,l.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};return u(t),s.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",f=>f.preventDefault()),l.addEventListener("change",f=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:d}=f.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const m=r();if(typeof m!="number")return!1;const x=p.doc.nodeAt(m);return p.setNodeMarkup(m,void 0,{...x==null?void 0:x.attrs,checked:d}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,d)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,d])=>{i.setAttribute(f,d)}),i.dataset.checked=t.attrs.checked,l.checked=t.attrs.checked,s.append(l,o),i.append(s,c),Object.entries(e).forEach(([f,d])=>{i.setAttribute(f,d)}),{dom:i,contentDOM:c,update:f=>f.type!==this.type?!1:(i.dataset.checked=f.attrs.checked,l.checked=f.attrs.checked,u(f),!0)}}},addInputRules(){return[sd({find:cje,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),dje=li.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",ur(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Ct.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(G7.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(Y7.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(t9.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(r9.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(uje.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(dje.configure(this.options.taskList)),t}});var fje=li.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),hje=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,pje=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,mje=Va.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[id({find:hje,type:this.type})]},addPasteRules(){return[Jl({find:pje,type:this.type})]}}),gje=li.create({name:"text",group:"inline"}),yje=Va.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function vje(t={}){return new nr({view(e){return new xje(e,t)}})}class xje{constructor(e,r){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,n,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(r){let d=e.nodeBefore,p=e.nodeAfter;if(d||p){let m=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(m){let x=m.getBoundingClientRect(),y=d?x.bottom:x.top;d&&p&&(y=(y+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*l;n={left:x.left,right:x.right,top:y-v,bottom:y+v}}}}if(!n){let d=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*o;n={left:d.left-p,right:d.left+p,top:d.top,bottom:d.bottom}}let c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,f;if(!c||c==document.body&&getComputedStyle(c).position=="static")u=-pageXOffset,f=-pageYOffset;else{let d=c.getBoundingClientRect(),p=d.width/c.offsetWidth,m=d.height/c.offsetHeight;u=d.left-c.scrollLeft*p,f=d.top-c.scrollTop*m}this.element.style.left=(n.left-u)/o+"px",this.element.style.top=(n.top-f)/l+"px",this.element.style.width=(n.right-n.left)/o+"px",this.element.style.height=(n.bottom-n.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=n&&n.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,r,e):i;if(r&&!s){let o=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=oU(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class rr extends ot{constructor(e){super(e,e)}map(e,r){let n=e.resolve(r.map(this.head));return rr.valid(n)?new rr(n):ot.near(n)}content(){return Ie.empty}eq(e){return e instanceof rr&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new rr(e.resolve(r.pos))}getBookmark(){return new _C(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!bje(e)||!wje(e))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let i=r.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,r,n=!1){e:for(;;){if(!n&&rr.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(r>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(r>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=r;let c=e.doc.resolve(i);if(rr.valid(c))return c}for(;;){let o=r>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!He.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*r),n=!1;continue e}break}s=o,i+=r;let l=e.doc.resolve(i);if(rr.valid(l))return l}return null}}}rr.prototype.visible=!1;rr.findFrom=rr.findGapCursorFrom;ot.jsonID("gapcursor",rr);class _C{constructor(e){this.pos=e}map(e){return new _C(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return rr.valid(r)?new rr(r):ot.near(r)}}function bje(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),n=t.node(e);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function wje(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),n=t.node(e);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function jje(){return new nr({props:{decorations:_je,createSelectionBetween(t,e,r){return e.pos==r.pos&&rr.valid(r)?new rr(r):null},handleClick:Nje,handleKeyDown:Sje,handleDOMEvents:{beforeinput:kje}}})}const Sje=GU({ArrowLeft:Fg("horiz",-1),ArrowRight:Fg("horiz",1),ArrowUp:Fg("vert",-1),ArrowDown:Fg("vert",1)});function Fg(t,e){const r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,s){let o=n.selection,l=e>0?o.$to:o.$from,c=o.empty;if(o instanceof et){if(!s.endOfTextblock(r)||l.depth==0)return!1;c=!1,l=n.doc.resolve(e>0?l.after():l.before())}let u=rr.findGapCursorFrom(l,e,c);return u?(i&&i(n.tr.setSelection(new rr(u))),!0):!1}}function Nje(t,e,r){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!rr.valid(n))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&He.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new rr(n))),!0)}function kje(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof rr))return!1;let{$from:r}=t.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let i=Ne.empty;for(let o=n.length-1;o>=0;o--)i=Ne.from(n[o].createAndFill(null,i));let s=t.state.tr.replace(r.pos,r.pos,new Ie(i,0,0));return s.setSelection(et.near(s.doc.resolve(r.pos+1))),t.dispatch(s),!1}function _je(t){if(!(t.selection instanceof rr))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Qt.create(t.doc,[vn.widget(t.selection.head,e,{key:"gapcursor"})])}var c0=200,Lr=function(){};Lr.prototype.append=function(e){return e.length?(e=Lr.from(e),!this.length&&e||e.length<c0&&this.leafAppend(e)||this.length<c0&&e.leafPrepend(this)||this.appendInner(e)):this};Lr.prototype.prepend=function(e){return e.length?Lr.from(e).append(this):this};Lr.prototype.appendInner=function(e){return new Oje(this,e)};Lr.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?Lr.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};Lr.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Lr.prototype.forEach=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(e,r,n,0):this.forEachInvertedInner(e,r,n,0)};Lr.prototype.map=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},r,n),i};Lr.from=function(e){return e instanceof Lr?e:e&&e.length?new n9(e):Lr.empty};var n9=function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var c=s;c<o;c++)if(i(this.values[c],l+c)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var c=s-1;c>=o;c--)if(i(this.values[c],l+c)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=c0)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=c0)return new e(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e}(Lr);Lr.empty=new n9([]);var Oje=function(t){function e(r,n){t.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(n,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(n,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(n,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(n,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(n,i):n>=s?this.right.slice(n-s,i-s):this.left.slice(n,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(Lr);const Eje=500;class Zi{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,s;r&&(i=this.remapping(n,this.items.length),s=i.maps.length);let o=e.tr,l,c,u=[],f=[];return this.items.forEach((d,p)=>{if(!d.step){i||(i=this.remapping(n,p+1),s=i.maps.length),s--,f.push(d);return}if(i){f.push(new ra(d.map));let m=d.step.map(i.slice(s)),x;m&&o.maybeStep(m).doc&&(x=o.mapping.maps[o.mapping.maps.length-1],u.push(new ra(x,void 0,void 0,u.length+f.length))),s--,x&&i.appendMap(x,s)}else o.maybeStep(d.step);if(d.selection)return l=i?d.selection.map(i.slice(s)):d.selection,c=new Zi(this.items.slice(0,n).append(f.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:o,selection:l}}addTransform(e,r,n,i){let s=[],o=this.eventCount,l=this.items,c=!i&&l.length?l.get(l.length-1):null;for(let f=0;f<e.steps.length;f++){let d=e.steps[f].invert(e.docs[f]),p=new ra(e.mapping.maps[f],d,r),m;(m=c&&c.merge(p))&&(p=m,f?s.pop():l=l.slice(0,l.length-1)),s.push(p),r&&(o++,r=void 0),i||(c=p)}let u=o-n.depth;return u>Aje&&(l=Cje(l,u),o-=u),new Zi(l.append(s),o)}remapping(e,r){let n=new up;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,o)},e,r),n}addMaps(e){return this.eventCount==0?this:new Zi(this.items.append(e.map(r=>new ra(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-r),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(p=>{p.selection&&l--},i);let c=r;this.items.forEach(p=>{let m=s.getMirror(--c);if(m==null)return;o=Math.min(o,m);let x=s.maps[m];if(p.step){let y=e.steps[m].invert(e.docs[m]),v=p.selection&&p.selection.map(s.slice(c+1,m));v&&l++,n.push(new ra(x,y,v))}else n.push(new ra(x))},i);let u=[];for(let p=r;p<o;p++)u.push(new ra(s.maps[p]));let f=this.items.slice(0,i).append(u).append(n),d=new Zi(f,l);return d.emptyItemCount()>Eje&&(d=d.compress(this.items.length-n.length)),d}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),n=r.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let c=o.step.map(r.slice(n)),u=c&&c.getMap();if(n--,u&&r.appendMap(u,n),c){let f=o.selection&&o.selection.map(r.slice(n));f&&s++;let d=new ra(u.invert(),c,f),p,m=i.length-1;(p=i.length&&i[m].merge(d))?i[m]=p:i.push(d)}}else o.map&&n--},this.items.length,0),new Zi(Lr.from(i.reverse()),s)}}Zi.empty=new Zi(Lr.empty,0);function Cje(t,e){let r;return t.forEach((n,i)=>{if(n.selection&&e--==0)return r=i,!1}),t.slice(r)}let ra=class i9{constructor(e,r,n,i){this.map=e,this.step=r,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new i9(r.getMap().invert(),r,this.selection)}}};class ca{constructor(e,r,n,i,s){this.done=e,this.undone=r,this.prevRanges=n,this.prevTime=i,this.prevComposition=s}}const Aje=20;function Tje(t,e,r,n){let i=r.getMeta(Bl),s;if(i)return i.historyState;r.getMeta(Rje)&&(t=new ca(t.done,t.undone,null,0,-1));let o=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(o&&o.getMeta(Bl))return o.getMeta(Bl).redo?new ca(t.done.addTransform(r,void 0,n,sy(e)),t.undone,m6(r.mapping.maps),t.prevTime,t.prevComposition):new ca(t.done,t.undone.addTransform(r,void 0,n,sy(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=r.getMeta("composition"),c=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(r.time||0)-n.newGroupDelay||!Pje(r,t.prevRanges)),u=o?kk(t.prevRanges,r.mapping):m6(r.mapping.maps);return new ca(t.done.addTransform(r,c?e.selection.getBookmark():void 0,n,sy(e)),Zi.empty,u,r.time,l??t.prevComposition)}else return(s=r.getMeta("rebased"))?new ca(t.done.rebased(r,s),t.undone.rebased(r,s),kk(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new ca(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),kk(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function Pje(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((n,i)=>{for(let s=0;s<e.length;s+=2)n<=e[s+1]&&i>=e[s]&&(r=!0)}),r}function m6(t){let e=[];for(let r=t.length-1;r>=0&&e.length==0;r--)t[r].forEach((n,i,s,o)=>e.push(s,o));return e}function kk(t,e){if(!t)return null;let r=[];for(let n=0;n<t.length;n+=2){let i=e.map(t[n],1),s=e.map(t[n+1],-1);i<=s&&r.push(i,s)}return r}function Mje(t,e,r){let n=sy(e),i=Bl.get(e).spec.config,s=(r?t.undone:t.done).popEvent(e,n);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(r?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,n),c=new ca(r?l:s.remaining,r?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(Bl,{redo:r,historyState:c})}let _k=!1,g6=null;function sy(t){let e=t.plugins;if(g6!=e){_k=!1,g6=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){_k=!0;break}}return _k}const Bl=new Fr("history"),Rje=new Fr("closeHistory");function Ije(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new nr({key:Bl,state:{init(){return new ca(Zi.empty,Zi.empty,null,0,-1)},apply(e,r,n){return Tje(r,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let n=r.inputType,i=n=="historyUndo"?o9:n=="historyRedo"?a9:null;return i?(r.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function s9(t,e){return(r,n)=>{let i=Bl.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(n){let s=Mje(i,r,t);s&&n(e?s.scrollIntoView():s)}return!0}}const o9=s9(!1,!0),a9=s9(!0,!0);Ct.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,r=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let t=!1;return[new nr({key:new Fr("characterCount"),appendTransaction:(e,r,n)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const s=this.storage.characters({node:n.doc});if(s>i){const o=s-i,l=0,c=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(l,c);return t=!0,u}t=!0},filterTransaction:(e,r)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const i=this.storage.characters({node:r.doc}),s=this.storage.characters({node:e.doc});if(s<=n||i>n&&s>n&&s<=i)return!0;if(i>n&&s>n&&s>i||!e.getMeta("paste"))return!1;const l=e.selection.$head.pos,c=s-n,u=l-c,f=l;return e.deleteRange(u,f),!(this.storage.characters({node:e.doc})>n)}})]}});var Dje=Ct.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[vje(this.options)]}});Ct.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new nr({key:new Fr("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:i}=e,s=[];if(!r||!n)return Qt.create(t,[]);let o=0;this.options.mode==="deepest"&&t.descendants((c,u)=>{if(c.isText)return;if(!(i>=u&&i<=u+c.nodeSize-1))return!1;o+=1});let l=0;return t.descendants((c,u)=>{if(c.isText||!(i>=u&&i<=u+c.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&o-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";s.push(vn.node(u,u+c.nodeSize,{class:this.options.className}))}),Qt.create(t,s)}}})]}});var Lje=Ct.create({name:"gapCursor",addProseMirrorPlugins(){return[jje()]},extendNodeSchema(t){var e;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=St(Ue(t,"allowGapCursor",r)))!=null?e:null}}}),u0=Ct.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new nr({key:new Fr("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,i=[];if(!r)return null;const s=this.editor.isEmpty;return t.descendants((o,l)=>{const c=n>=l&&n<=l+o.nodeSize,u=!o.isLeaf&&_x(o);if((c||!this.options.showOnlyCurrent)&&u){const f=[this.options.emptyNodeClass];s&&f.push(this.options.emptyEditorClass);const d=vn.node(l,l+o.nodeSize,{class:f.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:l,hasAnchor:c}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),Qt.create(t,i)}}})]}});Ct.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new nr({key:new Fr("selection"),props:{decorations(r){return r.selection.empty||t.isFocused||!t.isEditable||x7(r.selection)||t.view.dragging?null:Qt.create(r.doc,[vn.inline(r.selection.from,r.selection.to,{class:e.className})])}}})]}});function y6({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var $je=Ct.create({name:"trailingNode",addOptions(){return{node:"paragraph",notAfter:[]}},addProseMirrorPlugins(){const t=new Fr(this.name),e=Object.entries(this.editor.schema.nodes).map(([,r])=>r).filter(r=>(this.options.notAfter||[]).concat(this.options.node).includes(r.name));return[new nr({key:t,appendTransaction:(r,n,i)=>{const{doc:s,tr:o,schema:l}=i,c=t.getState(i),u=s.content.size,f=l.nodes[this.options.node];if(c)return o.insert(u,f.create())},state:{init:(r,n)=>{const i=n.tr.doc.lastChild;return!y6({node:i,types:e})},apply:(r,n)=>{if(!r.docChanged)return n;const i=r.doc.lastChild;return!y6({node:i,types:e})}}})]}}),Bje=Ct.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>o9(t,e),redo:()=>({state:t,dispatch:e})=>a9(t,e)}},addProseMirrorPlugins(){return[Ije(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Fje=Ct.create({name:"starterKit",addExtensions(){var t,e,r,n;const i=[];return this.options.bold!==!1&&i.push(y1e.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(f1e.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(G7.configure(this.options.bulletList)),this.options.code!==!1&&i.push(b1e.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(S1e.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(N1e.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(Dje.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Lje.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(k1e.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(_1e.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Bje.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(O1e.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(P1e.configure(this.options.italic)),this.options.listItem!==!1&&i.push(Y7.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(t9.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(NC.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(r9.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(fje.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(mje.configure(this.options.strike)),this.options.text!==!1&&i.push(gje.configure(this.options.text)),this.options.underline!==!1&&i.push(yje.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&i.push($je.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),d0=Fje,qje=t=>{if(!t.children.length)return;const e=t.querySelectorAll("span");e&&e.forEach(r=>{var n,i;const s=r.getAttribute("style"),o=(i=(n=r.parentElement)==null?void 0:n.closest("span"))==null?void 0:i.getAttribute("style");r.setAttribute("style",`${o};${s}`)})},xp=Va.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&qje(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(r,n)=>{if(r.isTextblock)return!0;r.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(s=>!!s))||t.removeMark(n,n+r.nodeSize,this.type)}),!0}}}}),zje=Ct.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),bp=Ct.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),Uje=Ct.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),Hje=Ct.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),Wje=Ct.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});Ct.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(zje.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(bp.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(Uje.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(Hje.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(Wje.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(xp.configure(this.options.textStyle)),t}});var Vje=t=>ir({find:/--$/,replace:t??"—"}),Kje=t=>ir({find:/\.\.\.$/,replace:t??"…"}),Gje=t=>ir({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:t??"“"}),Yje=t=>ir({find:/"$/,replace:t??"”"}),Xje=t=>ir({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:t??"‘"}),Jje=t=>ir({find:/'$/,replace:t??"’"}),Qje=t=>ir({find:/<-$/,replace:t??"←"}),Zje=t=>ir({find:/->$/,replace:t??"→"}),eSe=t=>ir({find:/\(c\)$/,replace:t??"©"}),tSe=t=>ir({find:/\(tm\)$/,replace:t??"™"}),rSe=t=>ir({find:/\(sm\)$/,replace:t??"℠"}),nSe=t=>ir({find:/\(r\)$/,replace:t??"®"}),iSe=t=>ir({find:/(?:^|\s)(1\/2)\s$/,replace:t??"½"}),sSe=t=>ir({find:/\+\/-$/,replace:t??"±"}),oSe=t=>ir({find:/!=$/,replace:t??"≠"}),aSe=t=>ir({find:/<<$/,replace:t??"«"}),lSe=t=>ir({find:/>>$/,replace:t??"»"}),cSe=t=>ir({find:/\d+\s?([*x])\s?\d+$/,replace:t??"×"}),uSe=t=>ir({find:/\^2$/,replace:t??"²"}),dSe=t=>ir({find:/\^3$/,replace:t??"³"}),fSe=t=>ir({find:/(?:^|\s)(1\/4)\s$/,replace:t??"¼"}),hSe=t=>ir({find:/(?:^|\s)(3\/4)\s$/,replace:t??"¾"}),f0=Ct.create({name:"typography",addOptions(){return{closeDoubleQuote:"”",closeSingleQuote:"’",copyright:"©",ellipsis:"…",emDash:"—",laquo:"«",leftArrow:"←",multiplication:"×",notEqual:"≠",oneHalf:"½",oneQuarter:"¼",openDoubleQuote:"“",openSingleQuote:"‘",plusMinus:"±",raquo:"»",registeredTrademark:"®",rightArrow:"→",servicemark:"℠",superscriptThree:"³",superscriptTwo:"²",threeQuarters:"¾",trademark:"™"}},addInputRules(){const t=[];return this.options.emDash!==!1&&t.push(Vje(this.options.emDash)),this.options.ellipsis!==!1&&t.push(Kje(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&t.push(Gje(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&t.push(Yje(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&t.push(Xje(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&t.push(Jje(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&t.push(Qje(this.options.leftArrow)),this.options.rightArrow!==!1&&t.push(Zje(this.options.rightArrow)),this.options.copyright!==!1&&t.push(eSe(this.options.copyright)),this.options.trademark!==!1&&t.push(tSe(this.options.trademark)),this.options.servicemark!==!1&&t.push(rSe(this.options.servicemark)),this.options.registeredTrademark!==!1&&t.push(nSe(this.options.registeredTrademark)),this.options.oneHalf!==!1&&t.push(iSe(this.options.oneHalf)),this.options.plusMinus!==!1&&t.push(sSe(this.options.plusMinus)),this.options.notEqual!==!1&&t.push(oSe(this.options.notEqual)),this.options.laquo!==!1&&t.push(aSe(this.options.laquo)),this.options.raquo!==!1&&t.push(lSe(this.options.raquo)),this.options.multiplication!==!1&&t.push(cSe(this.options.multiplication)),this.options.superscriptTwo!==!1&&t.push(uSe(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&t.push(dSe(this.options.superscriptThree)),this.options.oneQuarter!==!1&&t.push(fSe(this.options.oneQuarter)),this.options.threeQuarters!==!1&&t.push(hSe(this.options.threeQuarters)),t}});function pSe({block:t,isSelected:e=!1,isEditing:r=!1,onSelect:n,onEdit:i,children:s,className:o}){const l=f=>{f.stopPropagation(),r&&n&&n()},c=f=>{f.stopPropagation(),r&&i&&i()},u=f=>{const d={};return Object.entries(f).forEach(([p,m])=>{if(m!=null&&m!==""){const x=p.replace(/-([a-z])/g,(y,v)=>v.toUpperCase());d[x]=String(m)}}),d};return t.is_visible?a.jsxs("div",{className:ge("relative group transition-all duration-200",r&&"cursor-pointer hover:outline hover:outline-2 hover:outline-blue-200",e&&"outline outline-2 outline-blue-500 outline-offset-1",o),style:u(t.style||{}),onClick:l,onDoubleClick:c,"data-block-id":t.id,"data-block-type":t.block_type,children:[s,r&&a.jsx("div",{className:"absolute inset-0 bg-transparent group-hover:bg-blue-50/20 transition-colors",children:e&&a.jsx("div",{className:"absolute -top-6 left-0 bg-blue-500 text-white text-xs px-2 py-1 rounded text-nowrap z-10",children:t.block_type.replace("_"," ").toUpperCase()})})]}):null}function Mi(t){return Z.forwardRef((e,r)=>{const{block:n,isSelected:i,isEditing:s,onSelect:o,onEdit:l,className:c,...u}=e,f={block:n,...u};return a.jsx("div",{ref:r,children:a.jsx(pSe,{block:n,isSelected:i,isEditing:s,onSelect:o,onEdit:l,className:c,children:a.jsx(t,{...f})})})})}function v6(t,[e,r]){return Math.min(r,Math.max(e,t))}function Jt(t,e,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t==null||t(i),r===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function Yp(t,e=[]){let r=[];function n(s,o){const l=O.createContext(o),c=r.length;r=[...r,o];const u=d=>{var b;const{scope:p,children:m,...x}=d,y=((b=p==null?void 0:p[t])==null?void 0:b[c])||l,v=O.useMemo(()=>x,Object.values(x));return a.jsx(y.Provider,{value:v,children:m})};u.displayName=s+"Provider";function f(d,p){var y;const m=((y=p==null?void 0:p[t])==null?void 0:y[c])||l,x=O.useContext(m);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[u,f]}const i=()=>{const s=r.map(o=>O.createContext(o));return function(l){const c=(l==null?void 0:l[t])||s;return O.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return i.scopeName=t,[n,mSe(i,...e)]}function mSe(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const d=c(s)[`__scope${u}`];return{...l,...d}},{});return O.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}function x6(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function l9(...t){return e=>{let r=!1;const n=t.map(i=>{const s=x6(i,e);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let i=0;i<n.length;i++){const s=n[i];typeof s=="function"?s():x6(t[i],null)}}}}function yr(...t){return O.useCallback(l9(...t),t)}function h0(t){const e=gSe(t),r=O.forwardRef((n,i)=>{const{children:s,...o}=n,l=O.Children.toArray(s),c=l.find(vSe);if(c){const u=c.props.children,f=l.map(d=>d===c?O.Children.count(u)>1?O.Children.only(null):O.isValidElement(u)?u.props.children:null:d);return a.jsx(e,{...o,ref:i,children:O.isValidElement(u)?O.cloneElement(u,void 0,f):null})}return a.jsx(e,{...o,ref:i,children:s})});return r.displayName=`${t}.Slot`,r}function gSe(t){const e=O.forwardRef((r,n)=>{const{children:i,...s}=r;if(O.isValidElement(i)){const o=bSe(i),l=xSe(s,i.props);return i.type!==O.Fragment&&(l.ref=n?l9(n,o):o),O.cloneElement(i,l)}return O.Children.count(i)>1?O.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var ySe=Symbol("radix.slottable");function vSe(t){return O.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===ySe}function xSe(t,e){const r={...e};for(const n in e){const i=t[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...l)=>{s(...l),i(...l)}:i&&(r[n]=i):n==="style"?r[n]={...i,...s}:n==="className"&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...t,...r}}function bSe(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function wSe(t){const e=t+"CollectionProvider",[r,n]=Yp(e),[i,s]=r(e,{collectionRef:{current:null},itemMap:new Map}),o=y=>{const{scope:v,children:b}=y,w=Z.useRef(null),N=Z.useRef(new Map).current;return a.jsx(i,{scope:v,itemMap:N,collectionRef:w,children:b})};o.displayName=e;const l=t+"CollectionSlot",c=h0(l),u=Z.forwardRef((y,v)=>{const{scope:b,children:w}=y,N=s(l,b),j=yr(v,N.collectionRef);return a.jsx(c,{ref:j,children:w})});u.displayName=l;const f=t+"CollectionItemSlot",d="data-radix-collection-item",p=h0(f),m=Z.forwardRef((y,v)=>{const{scope:b,children:w,...N}=y,j=Z.useRef(null),k=yr(v,j),_=s(f,b);return Z.useEffect(()=>(_.itemMap.set(j,{ref:j,...N}),()=>void _.itemMap.delete(j))),a.jsx(p,{[d]:"",ref:k,children:w})});m.displayName=f;function x(y){const v=s(t+"CollectionConsumer",y);return Z.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const N=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((_,E)=>N.indexOf(_.ref.current)-N.indexOf(E.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},x,n]}var jSe=O.createContext(void 0);function SSe(t){const e=O.useContext(jSe);return t||e||"ltr"}var NSe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$t=NSe.reduce((t,e)=>{const r=h0(`Primitive.${e}`),n=O.forwardRef((i,s)=>{const{asChild:o,...l}=i,c=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function kSe(t,e){t&&js.flushSync(()=>t.dispatchEvent(e))}function wo(t){const e=O.useRef(t);return O.useEffect(()=>{e.current=t}),O.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function _Se(t,e=globalThis==null?void 0:globalThis.document){const r=wo(t);O.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var OSe="DismissableLayer",oO="dismissableLayer.update",ESe="dismissableLayer.pointerDownOutside",CSe="dismissableLayer.focusOutside",b6,c9=O.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),u9=O.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:l,...c}=t,u=O.useContext(c9),[f,d]=O.useState(null),p=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=O.useState({}),x=yr(e,E=>d(E)),y=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=y.indexOf(v),w=f?y.indexOf(f):-1,N=u.layersWithOutsidePointerEventsDisabled.size>0,j=w>=b,k=PSe(E=>{const A=E.target,T=[...u.branches].some(M=>M.contains(A));!j||T||(i==null||i(E),o==null||o(E),E.defaultPrevented||l==null||l())},p),_=MSe(E=>{const A=E.target;[...u.branches].some(M=>M.contains(A))||(s==null||s(E),o==null||o(E),E.defaultPrevented||l==null||l())},p);return _Se(E=>{w===u.layers.size-1&&(n==null||n(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},p),O.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(b6=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),w6(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=b6)}},[f,p,r,u]),O.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),w6())},[f,u]),O.useEffect(()=>{const E=()=>m({});return document.addEventListener(oO,E),()=>document.removeEventListener(oO,E)},[]),a.jsx($t.div,{...c,ref:x,style:{pointerEvents:N?j?"auto":"none":void 0,...t.style},onFocusCapture:Jt(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Jt(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Jt(t.onPointerDownCapture,k.onPointerDownCapture)})});u9.displayName=OSe;var ASe="DismissableLayerBranch",TSe=O.forwardRef((t,e)=>{const r=O.useContext(c9),n=O.useRef(null),i=yr(e,n);return O.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),a.jsx($t.div,{...t,ref:i})});TSe.displayName=ASe;function PSe(t,e=globalThis==null?void 0:globalThis.document){const r=wo(t),n=O.useRef(!1),i=O.useRef(()=>{});return O.useEffect(()=>{const s=l=>{if(l.target&&!n.current){let c=function(){d9(ESe,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=c,e.addEventListener("click",i.current,{once:!0})):c()}else e.removeEventListener("click",i.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function MSe(t,e=globalThis==null?void 0:globalThis.document){const r=wo(t),n=O.useRef(!1);return O.useEffect(()=>{const i=s=>{s.target&&!n.current&&d9(CSe,r,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function w6(){const t=new CustomEvent(oO);document.dispatchEvent(t)}function d9(t,e,r,{discrete:n}){const i=r.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&i.addEventListener(t,e,{once:!0}),n?kSe(i,s):i.dispatchEvent(s)}var Ok=0;function RSe(){O.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??j6()),document.body.insertAdjacentElement("beforeend",t[1]??j6()),Ok++,()=>{Ok===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Ok--}},[])}function j6(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ek="focusScope.autoFocusOnMount",Ck="focusScope.autoFocusOnUnmount",S6={bubbles:!1,cancelable:!0},ISe="FocusScope",f9=O.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=t,[l,c]=O.useState(null),u=wo(i),f=wo(s),d=O.useRef(null),p=yr(e,y=>c(y)),m=O.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;O.useEffect(()=>{if(n){let y=function(N){if(m.paused||!l)return;const j=N.target;l.contains(j)?d.current=j:sa(d.current,{select:!0})},v=function(N){if(m.paused||!l)return;const j=N.relatedTarget;j!==null&&(l.contains(j)||sa(d.current,{select:!0}))},b=function(N){if(document.activeElement===document.body)for(const k of N)k.removedNodes.length>0&&sa(l)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return l&&w.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[n,l,m.paused]),O.useEffect(()=>{if(l){k6.add(m);const y=document.activeElement;if(!l.contains(y)){const b=new CustomEvent(Ek,S6);l.addEventListener(Ek,u),l.dispatchEvent(b),b.defaultPrevented||(DSe(qSe(h9(l)),{select:!0}),document.activeElement===y&&sa(l))}return()=>{l.removeEventListener(Ek,u),setTimeout(()=>{const b=new CustomEvent(Ck,S6);l.addEventListener(Ck,f),l.dispatchEvent(b),b.defaultPrevented||sa(y??document.body,{select:!0}),l.removeEventListener(Ck,f),k6.remove(m)},0)}}},[l,u,f,m]);const x=O.useCallback(y=>{if(!r&&!n||m.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[N,j]=LSe(w);N&&j?!y.shiftKey&&b===j?(y.preventDefault(),r&&sa(N,{select:!0})):y.shiftKey&&b===N&&(y.preventDefault(),r&&sa(j,{select:!0})):b===w&&y.preventDefault()}},[r,n,m.paused]);return a.jsx($t.div,{tabIndex:-1,...o,ref:p,onKeyDown:x})});f9.displayName=ISe;function DSe(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(sa(n,{select:e}),document.activeElement!==r)return}function LSe(t){const e=h9(t),r=N6(e,t),n=N6(e.reverse(),t);return[r,n]}function h9(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function N6(t,e){for(const r of t)if(!$Se(r,{upTo:e}))return r}function $Se(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function BSe(t){return t instanceof HTMLInputElement&&"select"in t}function sa(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&BSe(t)&&e&&t.select()}}var k6=FSe();function FSe(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=_6(t,e),t.unshift(e)},remove(e){var r;t=_6(t,e),(r=t[0])==null||r.resume()}}}function _6(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function qSe(t){return t.filter(e=>e.tagName!=="A")}var Sn=globalThis!=null&&globalThis.document?O.useLayoutEffect:()=>{},zSe=eB[" useId ".trim().toString()]||(()=>{}),USe=0;function OC(t){const[e,r]=O.useState(zSe());return Sn(()=>{r(n=>n??String(USe++))},[t]),e?`radix-${e}`:""}const HSe=["top","right","bottom","left"],Ma=Math.min,Yn=Math.max,p0=Math.round,qg=Math.floor,_s=t=>({x:t,y:t}),WSe={left:"right",right:"left",bottom:"top",top:"bottom"},VSe={start:"end",end:"start"};function aO(t,e,r){return Yn(t,Ma(e,r))}function jo(t,e){return typeof t=="function"?t(e):t}function So(t){return t.split("-")[0]}function Nd(t){return t.split("-")[1]}function EC(t){return t==="x"?"y":"x"}function CC(t){return t==="y"?"height":"width"}function Ra(t){return["top","bottom"].includes(So(t))?"y":"x"}function AC(t){return EC(Ra(t))}function KSe(t,e,r){r===void 0&&(r=!1);const n=Nd(t),i=AC(t),s=CC(i);let o=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=m0(o)),[o,m0(o)]}function GSe(t){const e=m0(t);return[lO(t),e,lO(e)]}function lO(t){return t.replace(/start|end/g,e=>VSe[e])}function YSe(t,e,r){const n=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?i:n:e?n:i;case"left":case"right":return e?s:o;default:return[]}}function XSe(t,e,r,n){const i=Nd(t);let s=YSe(So(t),r==="start",n);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(lO)))),s}function m0(t){return t.replace(/left|right|bottom|top/g,e=>WSe[e])}function JSe(t){return{top:0,right:0,bottom:0,left:0,...t}}function p9(t){return typeof t!="number"?JSe(t):{top:t,right:t,bottom:t,left:t}}function g0(t){const{x:e,y:r,width:n,height:i}=t;return{width:n,height:i,top:r,left:e,right:e+n,bottom:r+i,x:e,y:r}}function O6(t,e,r){let{reference:n,floating:i}=t;const s=Ra(e),o=AC(e),l=CC(o),c=So(e),u=s==="y",f=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,p=n[l]/2-i[l]/2;let m;switch(c){case"top":m={x:f,y:n.y-i.height};break;case"bottom":m={x:f,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:d};break;case"left":m={x:n.x-i.width,y:d};break;default:m={x:n.x,y:n.y}}switch(Nd(e)){case"start":m[o]-=p*(r&&u?-1:1);break;case"end":m[o]+=p*(r&&u?-1:1);break}return m}const QSe=async(t,e,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:o}=r,l=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:f,y:d}=O6(u,n,c),p=n,m={},x=0;for(let y=0;y<l.length;y++){const{name:v,fn:b}=l[y],{x:w,y:N,data:j,reset:k}=await b({x:f,y:d,initialPlacement:n,placement:p,strategy:i,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});f=w??f,d=N??d,m={...m,[v]:{...m[v],...j}},k&&x<=50&&(x++,typeof k=="object"&&(k.placement&&(p=k.placement),k.rects&&(u=k.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):k.rects),{x:f,y:d}=O6(u,p,c)),y=-1)}return{x:f,y:d,placement:p,strategy:i,middlewareData:m}};async function wp(t,e){var r;e===void 0&&(e={});const{x:n,y:i,platform:s,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:p=!1,padding:m=0}=jo(e,t),x=p9(m),v=l[p?d==="floating"?"reference":"floating":d],b=g0(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(v)))==null||r?v:v.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:u,rootBoundary:f,strategy:c})),w=d==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,N=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),j=await(s.isElement==null?void 0:s.isElement(N))?await(s.getScale==null?void 0:s.getScale(N))||{x:1,y:1}:{x:1,y:1},k=g0(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:N,strategy:c}):w);return{top:(b.top-k.top+x.top)/j.y,bottom:(k.bottom-b.bottom+x.bottom)/j.y,left:(b.left-k.left+x.left)/j.x,right:(k.right-b.right+x.right)/j.x}}const ZSe=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:i,rects:s,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:f=0}=jo(t,e)||{};if(u==null)return{};const d=p9(f),p={x:r,y:n},m=AC(i),x=CC(m),y=await o.getDimensions(u),v=m==="y",b=v?"top":"left",w=v?"bottom":"right",N=v?"clientHeight":"clientWidth",j=s.reference[x]+s.reference[m]-p[m]-s.floating[x],k=p[m]-s.reference[m],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let E=_?_[N]:0;(!E||!await(o.isElement==null?void 0:o.isElement(_)))&&(E=l.floating[N]||s.floating[x]);const A=j/2-k/2,T=E/2-y[x]/2-1,M=Ma(d[b],T),P=Ma(d[w],T),R=M,L=E-y[x]-P,$=E/2-y[x]/2+A,F=aO(R,$,L),z=!c.arrow&&Nd(i)!=null&&$!==F&&s.reference[x]/2-($<R?M:P)-y[x]/2<0,W=z?$<R?$-R:$-L:0;return{[m]:p[m]+W,data:{[m]:F,centerOffset:$-F-W,...z&&{alignmentOffset:W}},reset:z}}}),eNe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:i,middlewareData:s,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:y=!0,...v}=jo(t,e);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const b=So(i),w=Ra(l),N=So(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(u.floating)),k=p||(N||!y?[m0(l)]:GSe(l)),_=x!=="none";!p&&_&&k.push(...XSe(l,y,x,j));const E=[l,...k],A=await wp(e,v),T=[];let M=((n=s.flip)==null?void 0:n.overflows)||[];if(f&&T.push(A[b]),d){const $=KSe(i,o,j);T.push(A[$[0]],A[$[1]])}if(M=[...M,{placement:i,overflows:T}],!T.every($=>$<=0)){var P,R;const $=(((P=s.flip)==null?void 0:P.index)||0)+1,F=E[$];if(F)return{data:{index:$,overflows:M},reset:{placement:F}};let z=(R=M.filter(W=>W.overflows[0]<=0).sort((W,K)=>W.overflows[1]-K.overflows[1])[0])==null?void 0:R.placement;if(!z)switch(m){case"bestFit":{var L;const W=(L=M.filter(K=>{if(_){const q=Ra(K.placement);return q===w||q==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(q=>q>0).reduce((q,V)=>q+V,0)]).sort((K,q)=>K[1]-q[1])[0])==null?void 0:L[0];W&&(z=W);break}case"initialPlacement":z=l;break}if(i!==z)return{reset:{placement:z}}}return{}}}};function E6(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function C6(t){return HSe.some(e=>t[e]>=0)}const tNe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...i}=jo(t,e);switch(n){case"referenceHidden":{const s=await wp(e,{...i,elementContext:"reference"}),o=E6(s,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:C6(o)}}}case"escaped":{const s=await wp(e,{...i,altBoundary:!0}),o=E6(s,r.floating);return{data:{escapedOffsets:o,escaped:C6(o)}}}default:return{}}}}};async function rNe(t,e){const{placement:r,platform:n,elements:i}=t,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),o=So(r),l=Nd(r),c=Ra(r)==="y",u=["left","top"].includes(o)?-1:1,f=s&&c?-1:1,d=jo(e,t);let{mainAxis:p,crossAxis:m,alignmentAxis:x}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return l&&typeof x=="number"&&(m=l==="end"?x*-1:x),c?{x:m*f,y:p*u}:{x:p*u,y:m*f}}const nNe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:i,y:s,placement:o,middlewareData:l}=e,c=await rNe(e,t);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:i+c.x,y:s+c.y,data:{...c,placement:o}}}}},iNe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:l={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=jo(t,e),u={x:r,y:n},f=await wp(e,c),d=Ra(So(i)),p=EC(d);let m=u[p],x=u[d];if(s){const v=p==="y"?"top":"left",b=p==="y"?"bottom":"right",w=m+f[v],N=m-f[b];m=aO(w,m,N)}if(o){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=x+f[v],N=x-f[b];x=aO(w,x,N)}const y=l.fn({...e,[p]:m,[d]:x});return{...y,data:{x:y.x-r,y:y.y-n,enabled:{[p]:s,[d]:o}}}}}},sNe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:i,rects:s,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=jo(t,e),f={x:r,y:n},d=Ra(i),p=EC(d);let m=f[p],x=f[d];const y=jo(l,e),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(c){const N=p==="y"?"height":"width",j=s.reference[p]-s.floating[N]+v.mainAxis,k=s.reference[p]+s.reference[N]-v.mainAxis;m<j?m=j:m>k&&(m=k)}if(u){var b,w;const N=p==="y"?"width":"height",j=["top","left"].includes(So(i)),k=s.reference[d]-s.floating[N]+(j&&((b=o.offset)==null?void 0:b[d])||0)+(j?0:v.crossAxis),_=s.reference[d]+s.reference[N]+(j?0:((w=o.offset)==null?void 0:w[d])||0)-(j?v.crossAxis:0);x<k?x=k:x>_&&(x=_)}return{[p]:m,[d]:x}}}},oNe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:i,rects:s,platform:o,elements:l}=e,{apply:c=()=>{},...u}=jo(t,e),f=await wp(e,u),d=So(i),p=Nd(i),m=Ra(i)==="y",{width:x,height:y}=s.floating;let v,b;d==="top"||d==="bottom"?(v=d,b=p===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(b=d,v=p==="end"?"top":"bottom");const w=y-f.top-f.bottom,N=x-f.left-f.right,j=Ma(y-f[v],w),k=Ma(x-f[b],N),_=!e.middlewareData.shift;let E=j,A=k;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(A=N),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(E=w),_&&!p){const M=Yn(f.left,0),P=Yn(f.right,0),R=Yn(f.top,0),L=Yn(f.bottom,0);m?A=x-2*(M!==0||P!==0?M+P:Yn(f.left,f.right)):E=y-2*(R!==0||L!==0?R+L:Yn(f.top,f.bottom))}await c({...e,availableWidth:A,availableHeight:E});const T=await o.getDimensions(l.floating);return x!==T.width||y!==T.height?{reset:{rects:!0}}:{}}}};function Cx(){return typeof window<"u"}function kd(t){return m9(t)?(t.nodeName||"").toLowerCase():"#document"}function ni(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ls(t){var e;return(e=(m9(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function m9(t){return Cx()?t instanceof Node||t instanceof ni(t).Node:!1}function ss(t){return Cx()?t instanceof Element||t instanceof ni(t).Element:!1}function Ms(t){return Cx()?t instanceof HTMLElement||t instanceof ni(t).HTMLElement:!1}function A6(t){return!Cx()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof ni(t).ShadowRoot}function Xp(t){const{overflow:e,overflowX:r,overflowY:n,display:i}=as(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(i)}function aNe(t){return["table","td","th"].includes(kd(t))}function Ax(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function TC(t){const e=PC(),r=ss(t)?as(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function lNe(t){let e=Ia(t);for(;Ms(e)&&!od(e);){if(TC(e))return e;if(Ax(e))return null;e=Ia(e)}return null}function PC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function od(t){return["html","body","#document"].includes(kd(t))}function as(t){return ni(t).getComputedStyle(t)}function Tx(t){return ss(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ia(t){if(kd(t)==="html")return t;const e=t.assignedSlot||t.parentNode||A6(t)&&t.host||Ls(t);return A6(e)?e.host:e}function g9(t){const e=Ia(t);return od(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ms(e)&&Xp(e)?e:g9(e)}function jp(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const i=g9(t),s=i===((n=t.ownerDocument)==null?void 0:n.body),o=ni(i);if(s){const l=cO(o);return e.concat(o,o.visualViewport||[],Xp(i)?i:[],l&&r?jp(l):[])}return e.concat(i,jp(i,[],r))}function cO(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function y9(t){const e=as(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=Ms(t),s=i?t.offsetWidth:r,o=i?t.offsetHeight:n,l=p0(r)!==s||p0(n)!==o;return l&&(r=s,n=o),{width:r,height:n,$:l}}function MC(t){return ss(t)?t:t.contextElement}function Su(t){const e=MC(t);if(!Ms(e))return _s(1);const r=e.getBoundingClientRect(),{width:n,height:i,$:s}=y9(e);let o=(s?p0(r.width):r.width)/n,l=(s?p0(r.height):r.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const cNe=_s(0);function v9(t){const e=ni(t);return!PC()||!e.visualViewport?cNe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function uNe(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==ni(t)?!1:e}function Ql(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const i=t.getBoundingClientRect(),s=MC(t);let o=_s(1);e&&(n?ss(n)&&(o=Su(n)):o=Su(t));const l=uNe(s,r,n)?v9(s):_s(0);let c=(i.left+l.x)/o.x,u=(i.top+l.y)/o.y,f=i.width/o.x,d=i.height/o.y;if(s){const p=ni(s),m=n&&ss(n)?ni(n):n;let x=p,y=cO(x);for(;y&&n&&m!==x;){const v=Su(y),b=y.getBoundingClientRect(),w=as(y),N=b.left+(y.clientLeft+parseFloat(w.paddingLeft))*v.x,j=b.top+(y.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,u*=v.y,f*=v.x,d*=v.y,c+=N,u+=j,x=ni(y),y=cO(x)}}return g0({width:f,height:d,x:c,y:u})}function RC(t,e){const r=Tx(t).scrollLeft;return e?e.left+r:Ql(Ls(t)).left+r}function x9(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),i=n.left+e.scrollLeft-(r?0:RC(t,n)),s=n.top+e.scrollTop;return{x:i,y:s}}function dNe(t){let{elements:e,rect:r,offsetParent:n,strategy:i}=t;const s=i==="fixed",o=Ls(n),l=e?Ax(e.floating):!1;if(n===o||l&&s)return r;let c={scrollLeft:0,scrollTop:0},u=_s(1);const f=_s(0),d=Ms(n);if((d||!d&&!s)&&((kd(n)!=="body"||Xp(o))&&(c=Tx(n)),Ms(n))){const m=Ql(n);u=Su(n),f.x=m.x+n.clientLeft,f.y=m.y+n.clientTop}const p=o&&!d&&!s?x9(o,c,!0):_s(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+f.x+p.x,y:r.y*u.y-c.scrollTop*u.y+f.y+p.y}}function fNe(t){return Array.from(t.getClientRects())}function hNe(t){const e=Ls(t),r=Tx(t),n=t.ownerDocument.body,i=Yn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Yn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+RC(t);const l=-r.scrollTop;return as(n).direction==="rtl"&&(o+=Yn(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:o,y:l}}function pNe(t,e){const r=ni(t),n=Ls(t),i=r.visualViewport;let s=n.clientWidth,o=n.clientHeight,l=0,c=0;if(i){s=i.width,o=i.height;const u=PC();(!u||u&&e==="fixed")&&(l=i.offsetLeft,c=i.offsetTop)}return{width:s,height:o,x:l,y:c}}function mNe(t,e){const r=Ql(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,s=Ms(t)?Su(t):_s(1),o=t.clientWidth*s.x,l=t.clientHeight*s.y,c=i*s.x,u=n*s.y;return{width:o,height:l,x:c,y:u}}function T6(t,e,r){let n;if(e==="viewport")n=pNe(t,r);else if(e==="document")n=hNe(Ls(t));else if(ss(e))n=mNe(e,r);else{const i=v9(t);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return g0(n)}function b9(t,e){const r=Ia(t);return r===e||!ss(r)||od(r)?!1:as(r).position==="fixed"||b9(r,e)}function gNe(t,e){const r=e.get(t);if(r)return r;let n=jp(t,[],!1).filter(l=>ss(l)&&kd(l)!=="body"),i=null;const s=as(t).position==="fixed";let o=s?Ia(t):t;for(;ss(o)&&!od(o);){const l=as(o),c=TC(o);!c&&l.position==="fixed"&&(i=null),(s?!c&&!i:!c&&l.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Xp(o)&&!c&&b9(t,o))?n=n.filter(f=>f!==o):i=l,o=Ia(o)}return e.set(t,n),n}function yNe(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t;const o=[...r==="clippingAncestors"?Ax(e)?[]:gNe(e,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,f)=>{const d=T6(e,f,i);return u.top=Yn(d.top,u.top),u.right=Ma(d.right,u.right),u.bottom=Ma(d.bottom,u.bottom),u.left=Yn(d.left,u.left),u},T6(e,l,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function vNe(t){const{width:e,height:r}=y9(t);return{width:e,height:r}}function xNe(t,e,r){const n=Ms(e),i=Ls(e),s=r==="fixed",o=Ql(t,!0,s,e);let l={scrollLeft:0,scrollTop:0};const c=_s(0);if(n||!n&&!s)if((kd(e)!=="body"||Xp(i))&&(l=Tx(e)),n){const p=Ql(e,!0,s,e);c.x=p.x+e.clientLeft,c.y=p.y+e.clientTop}else i&&(c.x=RC(i));const u=i&&!n&&!s?x9(i,l):_s(0),f=o.left+l.scrollLeft-c.x-u.x,d=o.top+l.scrollTop-c.y-u.y;return{x:f,y:d,width:o.width,height:o.height}}function Ak(t){return as(t).position==="static"}function P6(t,e){if(!Ms(t)||as(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return Ls(t)===r&&(r=r.ownerDocument.body),r}function w9(t,e){const r=ni(t);if(Ax(t))return r;if(!Ms(t)){let i=Ia(t);for(;i&&!od(i);){if(ss(i)&&!Ak(i))return i;i=Ia(i)}return r}let n=P6(t,e);for(;n&&aNe(n)&&Ak(n);)n=P6(n,e);return n&&od(n)&&Ak(n)&&!TC(n)?r:n||lNe(t)||r}const bNe=async function(t){const e=this.getOffsetParent||w9,r=this.getDimensions,n=await r(t.floating);return{reference:xNe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function wNe(t){return as(t).direction==="rtl"}const jNe={convertOffsetParentRelativeRectToViewportRelativeRect:dNe,getDocumentElement:Ls,getClippingRect:yNe,getOffsetParent:w9,getElementRects:bNe,getClientRects:fNe,getDimensions:vNe,getScale:Su,isElement:ss,isRTL:wNe};function j9(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function SNe(t,e){let r=null,n;const i=Ls(t);function s(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),s();const u=t.getBoundingClientRect(),{left:f,top:d,width:p,height:m}=u;if(l||e(),!p||!m)return;const x=qg(d),y=qg(i.clientWidth-(f+p)),v=qg(i.clientHeight-(d+m)),b=qg(f),N={rootMargin:-x+"px "+-y+"px "+-v+"px "+-b+"px",threshold:Yn(0,Ma(1,c))||1};let j=!0;function k(_){const E=_[0].intersectionRatio;if(E!==c){if(!j)return o();E?o(!1,E):n=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!j9(u,t.getBoundingClientRect())&&o(),j=!1}try{r=new IntersectionObserver(k,{...N,root:i.ownerDocument})}catch{r=new IntersectionObserver(k,N)}r.observe(t)}return o(!0),s}function NNe(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=MC(t),f=i||s?[...u?jp(u):[],...jp(e)]:[];f.forEach(b=>{i&&b.addEventListener("scroll",r,{passive:!0}),s&&b.addEventListener("resize",r)});const d=u&&l?SNe(u,r):null;let p=-1,m=null;o&&(m=new ResizeObserver(b=>{let[w]=b;w&&w.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var N;(N=m)==null||N.observe(e)})),r()}),u&&!c&&m.observe(u),m.observe(e));let x,y=c?Ql(t):null;c&&v();function v(){const b=Ql(t);y&&!j9(y,b)&&r(),y=b,x=requestAnimationFrame(v)}return r(),()=>{var b;f.forEach(w=>{i&&w.removeEventListener("scroll",r),s&&w.removeEventListener("resize",r)}),d==null||d(),(b=m)==null||b.disconnect(),m=null,c&&cancelAnimationFrame(x)}}const kNe=nNe,_Ne=iNe,ONe=eNe,ENe=oNe,CNe=tNe,M6=ZSe,ANe=sNe,TNe=(t,e,r)=>{const n=new Map,i={platform:jNe,...r},s={...i.platform,_c:n};return QSe(t,e,{...i,platform:s})};var oy=typeof document<"u"?O.useLayoutEffect:O.useEffect;function y0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!y0(t[n],e[n]))return!1;return!0}if(i=Object.keys(t),r=i.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,i[n]))return!1;for(n=r;n--!==0;){const s=i[n];if(!(s==="_owner"&&t.$$typeof)&&!y0(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function S9(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function R6(t,e){const r=S9(t);return Math.round(e*r)/r}function Tk(t){const e=O.useRef(t);return oy(()=>{e.current=t}),e}function PNe(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[f,d]=O.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[p,m]=O.useState(n);y0(p,n)||m(n);const[x,y]=O.useState(null),[v,b]=O.useState(null),w=O.useCallback(K=>{K!==_.current&&(_.current=K,y(K))},[]),N=O.useCallback(K=>{K!==E.current&&(E.current=K,b(K))},[]),j=s||x,k=o||v,_=O.useRef(null),E=O.useRef(null),A=O.useRef(f),T=c!=null,M=Tk(c),P=Tk(i),R=Tk(u),L=O.useCallback(()=>{if(!_.current||!E.current)return;const K={placement:e,strategy:r,middleware:p};P.current&&(K.platform=P.current),TNe(_.current,E.current,K).then(q=>{const V={...q,isPositioned:R.current!==!1};$.current&&!y0(A.current,V)&&(A.current=V,js.flushSync(()=>{d(V)}))})},[p,e,r,P,R]);oy(()=>{u===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,d(K=>({...K,isPositioned:!1})))},[u]);const $=O.useRef(!1);oy(()=>($.current=!0,()=>{$.current=!1}),[]),oy(()=>{if(j&&(_.current=j),k&&(E.current=k),j&&k){if(M.current)return M.current(j,k,L);L()}},[j,k,L,M,T]);const F=O.useMemo(()=>({reference:_,floating:E,setReference:w,setFloating:N}),[w,N]),z=O.useMemo(()=>({reference:j,floating:k}),[j,k]),W=O.useMemo(()=>{const K={position:r,left:0,top:0};if(!z.floating)return K;const q=R6(z.floating,f.x),V=R6(z.floating,f.y);return l?{...K,transform:"translate("+q+"px, "+V+"px)",...S9(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:q,top:V}},[r,l,z.floating,f.x,f.y]);return O.useMemo(()=>({...f,update:L,refs:F,elements:z,floatingStyles:W}),[f,L,F,z,W])}const MNe=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:i}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?M6({element:n.current,padding:i}).fn(r):{}:n?M6({element:n,padding:i}).fn(r):{}}}},RNe=(t,e)=>({...kNe(t),options:[t,e]}),INe=(t,e)=>({..._Ne(t),options:[t,e]}),DNe=(t,e)=>({...ANe(t),options:[t,e]}),LNe=(t,e)=>({...ONe(t),options:[t,e]}),$Ne=(t,e)=>({...ENe(t),options:[t,e]}),BNe=(t,e)=>({...CNe(t),options:[t,e]}),FNe=(t,e)=>({...MNe(t),options:[t,e]});var qNe="Arrow",N9=O.forwardRef((t,e)=>{const{children:r,width:n=10,height:i=5,...s}=t;return a.jsx($t.svg,{...s,ref:e,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});N9.displayName=qNe;var zNe=N9;function IC(t){const[e,r]=O.useState(void 0);return Sn(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,l;if("borderBoxSize"in s){const c=s.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;r({width:o,height:l})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var DC="Popper",[k9,_9]=Yp(DC),[UNe,O9]=k9(DC),E9=t=>{const{__scopePopper:e,children:r}=t,[n,i]=O.useState(null);return a.jsx(UNe,{scope:e,anchor:n,onAnchorChange:i,children:r})};E9.displayName=DC;var C9="PopperAnchor",A9=O.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...i}=t,s=O9(C9,r),o=O.useRef(null),l=yr(e,o);return O.useEffect(()=>{s.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:a.jsx($t.div,{...i,ref:l})});A9.displayName=C9;var LC="PopperContent",[HNe,WNe]=k9(LC),T9=O.forwardRef((t,e)=>{var Y,re,J,ne,te,se;const{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:s="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:m="optimized",onPlaced:x,...y}=t,v=O9(LC,r),[b,w]=O.useState(null),N=yr(e,ve=>w(ve)),[j,k]=O.useState(null),_=IC(j),E=(_==null?void 0:_.width)??0,A=(_==null?void 0:_.height)??0,T=n+(s!=="center"?"-"+s:""),M=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},P=Array.isArray(u)?u:[u],R=P.length>0,L={padding:M,boundary:P.filter(KNe),altBoundary:R},{refs:$,floatingStyles:F,placement:z,isPositioned:W,middlewareData:K}=PNe({strategy:"fixed",placement:T,whileElementsMounted:(...ve)=>NNe(...ve,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[RNe({mainAxis:i+A,alignmentAxis:o}),c&&INe({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?DNe():void 0,...L}),c&&LNe({...L}),$Ne({...L,apply:({elements:ve,rects:ie,availableWidth:ye,availableHeight:Te})=>{const{width:Le,height:ue}=ie.reference,he=ve.floating.style;he.setProperty("--radix-popper-available-width",`${ye}px`),he.setProperty("--radix-popper-available-height",`${Te}px`),he.setProperty("--radix-popper-anchor-width",`${Le}px`),he.setProperty("--radix-popper-anchor-height",`${ue}px`)}}),j&&FNe({element:j,padding:l}),GNe({arrowWidth:E,arrowHeight:A}),p&&BNe({strategy:"referenceHidden",...L})]}),[q,V]=R9(z),D=wo(x);Sn(()=>{W&&(D==null||D())},[W,D]);const U=(Y=K.arrow)==null?void 0:Y.x,G=(re=K.arrow)==null?void 0:re.y,ee=((J=K.arrow)==null?void 0:J.centerOffset)!==0,[Q,H]=O.useState();return Sn(()=>{b&&H(window.getComputedStyle(b).zIndex)},[b]),a.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...F,transform:W?F.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Q,"--radix-popper-transform-origin":[(ne=K.transformOrigin)==null?void 0:ne.x,(te=K.transformOrigin)==null?void 0:te.y].join(" "),...((se=K.hide)==null?void 0:se.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(HNe,{scope:r,placedSide:q,onArrowChange:k,arrowX:U,arrowY:G,shouldHideArrow:ee,children:a.jsx($t.div,{"data-side":q,"data-align":V,...y,ref:N,style:{...y.style,animation:W?void 0:"none"}})})})});T9.displayName=LC;var P9="PopperArrow",VNe={top:"bottom",right:"left",bottom:"top",left:"right"},M9=O.forwardRef(function(e,r){const{__scopePopper:n,...i}=e,s=WNe(P9,n),o=VNe[s.placedSide];return a.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:a.jsx(zNe,{...i,ref:r,style:{...i.style,display:"block"}})})});M9.displayName=P9;function KNe(t){return t!==null}var GNe=t=>({name:"transformOrigin",options:t,fn(e){var v,b,w;const{placement:r,rects:n,middlewareData:i}=e,o=((v=i.arrow)==null?void 0:v.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,f]=R9(r),d={start:"0%",center:"50%",end:"100%"}[f],p=(((b=i.arrow)==null?void 0:b.x)??0)+l/2,m=(((w=i.arrow)==null?void 0:w.y)??0)+c/2;let x="",y="";return u==="bottom"?(x=o?d:`${p}px`,y=`${-c}px`):u==="top"?(x=o?d:`${p}px`,y=`${n.floating.height+c}px`):u==="right"?(x=`${-c}px`,y=o?d:`${m}px`):u==="left"&&(x=`${n.floating.width+c}px`,y=o?d:`${m}px`),{data:{x,y}}}});function R9(t){const[e,r="center"]=t.split("-");return[e,r]}var YNe=E9,XNe=A9,JNe=T9,QNe=M9,ZNe="Portal",I9=O.forwardRef((t,e)=>{var l;const{container:r,...n}=t,[i,s]=O.useState(!1);Sn(()=>s(!0),[]);const o=r||i&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?tB.createPortal(a.jsx($t.div,{...n,ref:e}),o):null});I9.displayName=ZNe;function v0({prop:t,defaultProp:e,onChange:r=()=>{}}){const[n,i]=eke({defaultProp:e,onChange:r}),s=t!==void 0,o=s?t:n,l=wo(r),c=O.useCallback(u=>{if(s){const d=typeof u=="function"?u(t):u;d!==t&&l(d)}else i(u)},[s,t,i,l]);return[o,c]}function eke({defaultProp:t,onChange:e}){const r=O.useState(t),[n]=r,i=O.useRef(n),s=wo(e);return O.useEffect(()=>{i.current!==n&&(s(n),i.current=n)},[n,i,s]),r}function $C(t){const e=O.useRef({value:t,previous:t});return O.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var tke="VisuallyHidden",D9=O.forwardRef((t,e)=>a.jsx($t.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));D9.displayName=tke;var rke=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},eu=new WeakMap,zg=new WeakMap,Ug={},Pk=0,L9=function(t){return t&&(t.host||L9(t.parentNode))},nke=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=L9(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},ike=function(t,e,r,n){var i=nke(e,Array.isArray(t)?t:[t]);Ug[r]||(Ug[r]=new WeakMap);var s=Ug[r],o=[],l=new Set,c=new Set(i),u=function(d){!d||l.has(d)||(l.add(d),u(d.parentNode))};i.forEach(u);var f=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(p){if(l.has(p))f(p);else try{var m=p.getAttribute(n),x=m!==null&&m!=="false",y=(eu.get(p)||0)+1,v=(s.get(p)||0)+1;eu.set(p,y),s.set(p,v),o.push(p),y===1&&x&&zg.set(p,!0),v===1&&p.setAttribute(r,"true"),x||p.setAttribute(n,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return f(e),l.clear(),Pk++,function(){o.forEach(function(d){var p=eu.get(d)-1,m=s.get(d)-1;eu.set(d,p),s.set(d,m),p||(zg.has(d)||d.removeAttribute(n),zg.delete(d)),m||d.removeAttribute(r)}),Pk--,Pk||(eu=new WeakMap,eu=new WeakMap,zg=new WeakMap,Ug={})}},ske=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),i=rke(t);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),ike(n,i,r,"aria-hidden")):function(){return null}},ws=function(){return ws=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ws.apply(this,arguments)};function $9(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function oke(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var ay="right-scroll-bar-position",ly="width-before-scroll-bar",ake="with-scroll-bars-hidden",lke="--removed-body-scroll-bar-size";function Mk(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function cke(t,e){var r=O.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=e,r.facade}var uke=typeof window<"u"?O.useLayoutEffect:O.useEffect,I6=new WeakMap;function dke(t,e){var r=cke(null,function(n){return t.forEach(function(i){return Mk(i,n)})});return uke(function(){var n=I6.get(r);if(n){var i=new Set(n),s=new Set(t),o=r.current;i.forEach(function(l){s.has(l)||Mk(l,null)}),s.forEach(function(l){i.has(l)||Mk(l,o)})}I6.set(r,t)},[t]),r}function fke(t){return t}function hke(t,e){e===void 0&&(e=fke);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(s){var o=e(s,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(s){for(n=!0;r.length;){var o=r;r=[],o.forEach(s)}r={push:function(l){return s(l)},filter:function(){return r}}},assignMedium:function(s){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(s),o=r}var c=function(){var f=o;o=[],f.forEach(s)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(f){o.push(f),u()},filter:function(f){return o=o.filter(f),r}}}};return i}function pke(t){t===void 0&&(t={});var e=hke(null);return e.options=ws({async:!0,ssr:!1},t),e}var B9=function(t){var e=t.sideCar,r=$9(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return O.createElement(n,ws({},r))};B9.isSideCarExport=!0;function mke(t,e){return t.useMedium(e),B9}var F9=pke(),Rk=function(){},Px=O.forwardRef(function(t,e){var r=O.useRef(null),n=O.useState({onScrollCapture:Rk,onWheelCapture:Rk,onTouchMoveCapture:Rk}),i=n[0],s=n[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,f=t.enabled,d=t.shards,p=t.sideCar,m=t.noIsolation,x=t.inert,y=t.allowPinchZoom,v=t.as,b=v===void 0?"div":v,w=t.gapMode,N=$9(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=p,k=dke([r,e]),_=ws(ws({},N),i);return O.createElement(O.Fragment,null,f&&O.createElement(j,{sideCar:F9,removeScrollBar:u,shards:d,noIsolation:m,inert:x,setCallbacks:s,allowPinchZoom:!!y,lockRef:r,gapMode:w}),o?O.cloneElement(O.Children.only(l),ws(ws({},_),{ref:k})):O.createElement(b,ws({},_,{className:c,ref:k}),l))});Px.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Px.classNames={fullWidth:ly,zeroRight:ay};var gke=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function yke(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=gke();return e&&t.setAttribute("nonce",e),t}function vke(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function xke(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var bke=function(){var t=0,e=null;return{add:function(r){t==0&&(e=yke())&&(vke(e,r),xke(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},wke=function(){var t=bke();return function(e,r){O.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},q9=function(){var t=wke(),e=function(r){var n=r.styles,i=r.dynamic;return t(n,i),null};return e},jke={left:0,top:0,right:0,gap:0},Ik=function(t){return parseInt(t||"",10)||0},Ske=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[Ik(r),Ik(n),Ik(i)]},Nke=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return jke;var e=Ske(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},kke=q9(),Nu="data-scroll-locked",_ke=function(t,e,r,n){var i=t.left,s=t.top,o=t.right,l=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(ake,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Nu,`] {
--
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},$ke=0,ru=[];function Bke(t){var e=O.useRef([]),r=O.useRef([0,0]),n=O.useRef(),i=O.useState($ke++)[0],s=O.useState(q9)[0],o=O.useRef(t);O.useEffect(function(){o.current=t},[t]),O.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var y=oke([t.lockRef.current],(t.shards||[]).map(B6),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var l=O.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!o.current.allowPinchZoom;var b=Wg(y),w=r.current,N="deltaX"in y?y.deltaX:w[0]-b[0],j="deltaY"in y?y.deltaY:w[1]-b[1],k,_=y.target,E=Math.abs(N)>Math.abs(j)?"h":"v";if("touches"in y&&E==="h"&&_.type==="range")return!1;var A=L6(E,_);if(!A)return!0;if(A?k=E:(k=E==="v"?"h":"v",A=L6(E,_)),!A)return!1;if(!n.current&&"changedTouches"in y&&(N||j)&&(n.current=k),!k)return!0;var T=n.current||k;return Ike(T,v,y,T==="h"?N:j)},[]),c=O.useCallback(function(y){var v=y;if(!(!ru.length||ru[ru.length-1]!==s)){var b="deltaY"in v?$6(v):Wg(v),w=e.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&Dke(k.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var N=(o.current.shards||[]).map(B6).filter(Boolean).filter(function(k){return k.contains(v.target)}),j=N.length>0?l(v,N[0]):!o.current.noIsolation;j&&v.cancelable&&v.preventDefault()}}},[]),u=O.useCallback(function(y,v,b,w){var N={name:y,delta:v,target:b,should:w,shadowParent:Fke(b)};e.current.push(N),setTimeout(function(){e.current=e.current.filter(function(j){return j!==N})},1)},[]),f=O.useCallback(function(y){r.current=Wg(y),n.current=void 0},[]),d=O.useCallback(function(y){u(y.type,$6(y),y.target,l(y,t.lockRef.current))},[]),p=O.useCallback(function(y){u(y.type,Wg(y),y.target,l(y,t.lockRef.current))},[]);O.useEffect(function(){return ru.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,tu),document.addEventListener("touchmove",c,tu),document.addEventListener("touchstart",f,tu),function(){ru=ru.filter(function(y){return y!==s}),document.removeEventListener("wheel",c,tu),document.removeEventListener("touchmove",c,tu),document.removeEventListener("touchstart",f,tu)}},[]);var m=t.removeScrollBar,x=t.inert;return O.createElement(O.Fragment,null,x?O.createElement(s,{styles:Lke(i)}):null,m?O.createElement(Eke,{gapMode:t.gapMode}):null)}function Fke(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const qke=mke(F9,Bke);var W9=O.forwardRef(function(t,e){return O.createElement(Px,ws({},t,{ref:e,sideCar:qke}))});W9.classNames=Px.classNames;var zke=[" ","Enter","ArrowUp","ArrowDown"],Uke=[" ","Enter"],Jp="Select",[Mx,Rx,Hke]=wSe(Jp),[_d,EEe]=Yp(Jp,[Hke,_9]),Ix=_9(),[Wke,Ka]=_d(Jp),[Vke,Kke]=_d(Jp),V9=t=>{const{__scopeSelect:e,children:r,open:n,defaultOpen:i,onOpenChange:s,value:o,defaultValue:l,onValueChange:c,dir:u,name:f,autoComplete:d,disabled:p,required:m,form:x}=t,y=Ix(e),[v,b]=O.useState(null),[w,N]=O.useState(null),[j,k]=O.useState(!1),_=SSe(u),[E=!1,A]=v0({prop:n,defaultProp:i,onChange:s}),[T,M]=v0({prop:o,defaultProp:l,onChange:c}),P=O.useRef(null),R=v?x||!!v.closest("form"):!0,[L,$]=O.useState(new Set),F=Array.from(L).map(z=>z.props.value).join(";");return a.jsx(YNe,{...y,children:a.jsxs(Wke,{required:m,scope:e,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:N,valueNodeHasChildren:j,onValueNodeHasChildrenChange:k,contentId:OC(),value:T,onValueChange:M,open:E,onOpenChange:A,dir:_,triggerPointerDownPosRef:P,disabled:p,children:[a.jsx(Mx.Provider,{scope:e,children:a.jsx(Vke,{scope:t.__scopeSelect,onNativeOptionAdd:O.useCallback(z=>{$(W=>new Set(W).add(z))},[]),onNativeOptionRemove:O.useCallback(z=>{$(W=>{const K=new Set(W);return K.delete(z),K})},[]),children:r})}),R?a.jsxs(yH,{"aria-hidden":!0,required:m,tabIndex:-1,name:f,autoComplete:d,value:T,onChange:z=>M(z.target.value),disabled:p,form:x,children:[T===void 0?a.jsx("option",{value:""}):null,Array.from(L)]},F):null]})})};V9.displayName=Jp;var K9="SelectTrigger",G9=O.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:n=!1,...i}=t,s=Ix(r),o=Ka(K9,r),l=o.disabled||n,c=yr(e,o.onTriggerChange),u=Rx(r),f=O.useRef("touch"),[d,p,m]=vH(y=>{const v=u().filter(N=>!N.disabled),b=v.find(N=>N.value===o.value),w=xH(v,y,b);w!==void 0&&o.onValueChange(w.value)}),x=y=>{l||(o.onOpenChange(!0),m()),y&&(o.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return a.jsx(XNe,{asChild:!0,...s,children:a.jsx($t.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":gH(o.value)?"":void 0,...i,ref:c,onClick:Jt(i.onClick,y=>{y.currentTarget.focus(),f.current!=="mouse"&&x(y)}),onPointerDown:Jt(i.onPointerDown,y=>{f.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(x(y),y.preventDefault())}),onKeyDown:Jt(i.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&p(y.key),!(v&&y.key===" ")&&zke.includes(y.key)&&(x(),y.preventDefault())})})})});G9.displayName=K9;var Y9="SelectValue",X9=O.forwardRef((t,e)=>{const{__scopeSelect:r,className:n,style:i,children:s,placeholder:o="",...l}=t,c=Ka(Y9,r),{onValueNodeHasChildrenChange:u}=c,f=s!==void 0,d=yr(e,c.onValueNodeChange);return Sn(()=>{u(f)},[u,f]),a.jsx($t.span,{...l,ref:d,style:{pointerEvents:"none"},children:gH(c.value)?a.jsx(a.Fragment,{children:o}):s})});X9.displayName=Y9;var Gke="SelectIcon",J9=O.forwardRef((t,e)=>{const{__scopeSelect:r,children:n,...i}=t;return a.jsx($t.span,{"aria-hidden":!0,...i,ref:e,children:n||"▼"})});J9.displayName=Gke;var Yke="SelectPortal",Q9=t=>a.jsx(I9,{asChild:!0,...t});Q9.displayName=Yke;var Zl="SelectContent",Z9=O.forwardRef((t,e)=>{const r=Ka(Zl,t.__scopeSelect),[n,i]=O.useState();if(Sn(()=>{i(new DocumentFragment)},[]),!r.open){const s=n;return s?js.createPortal(a.jsx(eH,{scope:t.__scopeSelect,children:a.jsx(Mx.Slot,{scope:t.__scopeSelect,children:a.jsx("div",{children:t.children})})}),s):null}return a.jsx(tH,{...t,ref:e})});Z9.displayName=Zl;var Gi=10,[eH,Ga]=_d(Zl),Xke="SelectContentImpl",Jke=h0("SelectContent.RemoveScroll"),tH=O.forwardRef((t,e)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:p,collisionPadding:m,sticky:x,hideWhenDetached:y,avoidCollisions:v,...b}=t,w=Ka(Zl,r),[N,j]=O.useState(null),[k,_]=O.useState(null),E=yr(e,Y=>j(Y)),[A,T]=O.useState(null),[M,P]=O.useState(null),R=Rx(r),[L,$]=O.useState(!1),F=O.useRef(!1);O.useEffect(()=>{if(N)return ske(N)},[N]),RSe();const z=O.useCallback(Y=>{const[re,...J]=R().map(se=>se.ref.current),[ne]=J.slice(-1),te=document.activeElement;for(const se of Y)if(se===te||(se==null||se.scrollIntoView({block:"nearest"}),se===re&&k&&(k.scrollTop=0),se===ne&&k&&(k.scrollTop=k.scrollHeight),se==null||se.focus(),document.activeElement!==te))return},[R,k]),W=O.useCallback(()=>z([A,N]),[z,A,N]);O.useEffect(()=>{L&&W()},[L,W]);const{onOpenChange:K,triggerPointerDownPosRef:q}=w;O.useEffect(()=>{if(N){let Y={x:0,y:0};const re=ne=>{var te,se;Y={x:Math.abs(Math.round(ne.pageX)-(((te=q.current)==null?void 0:te.x)??0)),y:Math.abs(Math.round(ne.pageY)-(((se=q.current)==null?void 0:se.y)??0))}},J=ne=>{Y.x<=10&&Y.y<=10?ne.preventDefault():N.contains(ne.target)||K(!1),document.removeEventListener("pointermove",re),q.current=null};return q.current!==null&&(document.addEventListener("pointermove",re),document.addEventListener("pointerup",J,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",re),document.removeEventListener("pointerup",J,{capture:!0})}}},[N,K,q]),O.useEffect(()=>{const Y=()=>K(!1);return window.addEventListener("blur",Y),window.addEventListener("resize",Y),()=>{window.removeEventListener("blur",Y),window.removeEventListener("resize",Y)}},[K]);const[V,D]=vH(Y=>{const re=R().filter(te=>!te.disabled),J=re.find(te=>te.ref.current===document.activeElement),ne=xH(re,Y,J);ne&&setTimeout(()=>ne.ref.current.focus())}),U=O.useCallback((Y,re,J)=>{const ne=!F.current&&!J;(w.value!==void 0&&w.value===re||ne)&&(T(Y),ne&&(F.current=!0))},[w.value]),G=O.useCallback(()=>N==null?void 0:N.focus(),[N]),ee=O.useCallback((Y,re,J)=>{const ne=!F.current&&!J;(w.value!==void 0&&w.value===re||ne)&&P(Y)},[w.value]),Q=n==="popper"?dO:rH,H=Q===dO?{side:l,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:p,collisionPadding:m,sticky:x,hideWhenDetached:y,avoidCollisions:v}:{};return a.jsx(eH,{scope:r,content:N,viewport:k,onViewportChange:_,itemRefCallback:U,selectedItem:A,onItemLeave:G,itemTextRefCallback:ee,focusSelectedItem:W,selectedItemText:M,position:n,isPositioned:L,searchRef:V,children:a.jsx(W9,{as:Jke,allowPinchZoom:!0,children:a.jsx(f9,{asChild:!0,trapped:w.open,onMountAutoFocus:Y=>{Y.preventDefault()},onUnmountAutoFocus:Jt(i,Y=>{var re;(re=w.trigger)==null||re.focus({preventScroll:!0}),Y.preventDefault()}),children:a.jsx(u9,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:Y=>Y.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:a.jsx(Q,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Y=>Y.preventDefault(),...b,...H,onPlaced:()=>$(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:Jt(b.onKeyDown,Y=>{const re=Y.ctrlKey||Y.altKey||Y.metaKey;if(Y.key==="Tab"&&Y.preventDefault(),!re&&Y.key.length===1&&D(Y.key),["ArrowUp","ArrowDown","Home","End"].includes(Y.key)){let ne=R().filter(te=>!te.disabled).map(te=>te.ref.current);if(["ArrowUp","End"].includes(Y.key)&&(ne=ne.slice().reverse()),["ArrowUp","ArrowDown"].includes(Y.key)){const te=Y.target,se=ne.indexOf(te);ne=ne.slice(se+1)}setTimeout(()=>z(ne)),Y.preventDefault()}})})})})})})});tH.displayName=Xke;var Qke="SelectItemAlignedPosition",rH=O.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:n,...i}=t,s=Ka(Zl,r),o=Ga(Zl,r),[l,c]=O.useState(null),[u,f]=O.useState(null),d=yr(e,E=>f(E)),p=Rx(r),m=O.useRef(!1),x=O.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=o,N=O.useCallback(()=>{if(s.trigger&&s.valueNode&&l&&u&&y&&v&&b){const E=s.trigger.getBoundingClientRect(),A=u.getBoundingClientRect(),T=s.valueNode.getBoundingClientRect(),M=b.getBoundingClientRect();if(s.dir!=="rtl"){const te=M.left-A.left,se=T.left-te,ve=E.left-se,ie=E.width+ve,ye=Math.max(ie,A.width),Te=window.innerWidth-Gi,Le=v6(se,[Gi,Math.max(Gi,Te-ye)]);l.style.minWidth=ie+"px",l.style.left=Le+"px"}else{const te=A.right-M.right,se=window.innerWidth-T.right-te,ve=window.innerWidth-E.right-se,ie=E.width+ve,ye=Math.max(ie,A.width),Te=window.innerWidth-Gi,Le=v6(se,[Gi,Math.max(Gi,Te-ye)]);l.style.minWidth=ie+"px",l.style.right=Le+"px"}const P=p(),R=window.innerHeight-Gi*2,L=y.scrollHeight,$=window.getComputedStyle(u),F=parseInt($.borderTopWidth,10),z=parseInt($.paddingTop,10),W=parseInt($.borderBottomWidth,10),K=parseInt($.paddingBottom,10),q=F+z+L+K+W,V=Math.min(v.offsetHeight*5,q),D=window.getComputedStyle(y),U=parseInt(D.paddingTop,10),G=parseInt(D.paddingBottom,10),ee=E.top+E.height/2-Gi,Q=R-ee,H=v.offsetHeight/2,Y=v.offsetTop+H,re=F+z+Y,J=q-re;if(re<=ee){const te=P.length>0&&v===P[P.length-1].ref.current;l.style.bottom="0px";const se=u.clientHeight-y.offsetTop-y.offsetHeight,ve=Math.max(Q,H+(te?G:0)+se+W),ie=re+ve;l.style.height=ie+"px"}else{const te=P.length>0&&v===P[0].ref.current;l.style.top="0px";const ve=Math.max(ee,F+y.offsetTop+(te?U:0)+H)+J;l.style.height=ve+"px",y.scrollTop=re-ee+y.offsetTop}l.style.margin=`${Gi}px 0`,l.style.minHeight=V+"px",l.style.maxHeight=R+"px",n==null||n(),requestAnimationFrame(()=>m.current=!0)}},[p,s.trigger,s.valueNode,l,u,y,v,b,s.dir,n]);Sn(()=>N(),[N]);const[j,k]=O.useState();Sn(()=>{u&&k(window.getComputedStyle(u).zIndex)},[u]);const _=O.useCallback(E=>{E&&x.current===!0&&(N(),w==null||w(),x.current=!1)},[N,w]);return a.jsx(e_e,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:_,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:a.jsx($t.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});rH.displayName=Qke;var Zke="SelectPopperPosition",dO=O.forwardRef((t,e)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=Gi,...s}=t,o=Ix(r);return a.jsx(JNe,{...o,...s,ref:e,align:n,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});dO.displayName=Zke;var[e_e,BC]=_d(Zl,{}),fO="SelectViewport",nH=O.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:n,...i}=t,s=Ga(fO,r),o=BC(fO,r),l=yr(e,s.onViewportChange),c=O.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),a.jsx(Mx.Slot,{scope:r,children:a.jsx($t.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Jt(i.onScroll,u=>{const f=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&d){const m=Math.abs(c.current-f.scrollTop);if(m>0){const x=window.innerHeight-Gi*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(y,v);if(b<x){const w=b+m,N=Math.min(x,w),j=w-N;d.style.height=N+"px",d.style.bottom==="0px"&&(f.scrollTop=j>0?j:0,d.style.justifyContent="flex-end")}}}c.current=f.scrollTop})})})]})});nH.displayName=fO;var iH="SelectGroup",[t_e,r_e]=_d(iH),n_e=O.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,i=OC();return a.jsx(t_e,{scope:r,id:i,children:a.jsx($t.div,{role:"group","aria-labelledby":i,...n,ref:e})})});n_e.displayName=iH;var sH="SelectLabel",oH=O.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,i=r_e(sH,r);return a.jsx($t.div,{id:i.id,...n,ref:e})});oH.displayName=sH;var x0="SelectItem",[i_e,aH]=_d(x0),lH=O.forwardRef((t,e)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:s,...o}=t,l=Ka(x0,r),c=Ga(x0,r),u=l.value===n,[f,d]=O.useState(s??""),[p,m]=O.useState(!1),x=yr(e,w=>{var N;return(N=c.itemRefCallback)==null?void 0:N.call(c,w,n,i)}),y=OC(),v=O.useRef("touch"),b=()=>{i||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(i_e,{scope:r,value:n,disabled:i,textId:y,isSelected:u,onItemTextChange:O.useCallback(w=>{d(N=>N||((w==null?void 0:w.textContent)??"").trim())},[]),children:a.jsx(Mx.ItemSlot,{scope:r,value:n,disabled:i,textValue:f,children:a.jsx($t.div,{role:"option","aria-labelledby":y,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:x,onFocus:Jt(o.onFocus,()=>m(!0)),onBlur:Jt(o.onBlur,()=>m(!1)),onClick:Jt(o.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:Jt(o.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:Jt(o.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Jt(o.onPointerMove,w=>{var N;v.current=w.pointerType,i?(N=c.onItemLeave)==null||N.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Jt(o.onPointerLeave,w=>{var N;w.currentTarget===document.activeElement&&((N=c.onItemLeave)==null||N.call(c))}),onKeyDown:Jt(o.onKeyDown,w=>{var j;((j=c.searchRef)==null?void 0:j.current)!==""&&w.key===" "||(Uke.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});lH.displayName=x0;var Gf="SelectItemText",cH=O.forwardRef((t,e)=>{const{__scopeSelect:r,className:n,style:i,...s}=t,o=Ka(Gf,r),l=Ga(Gf,r),c=aH(Gf,r),u=Kke(Gf,r),[f,d]=O.useState(null),p=yr(e,b=>d(b),c.onItemTextChange,b=>{var w;return(w=l.itemTextRefCallback)==null?void 0:w.call(l,b,c.value,c.disabled)}),m=f==null?void 0:f.textContent,x=O.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=u;return Sn(()=>(y(x),()=>v(x)),[y,v,x]),a.jsxs(a.Fragment,{children:[a.jsx($t.span,{id:c.textId,...s,ref:p}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?js.createPortal(s.children,o.valueNode):null]})});cH.displayName=Gf;var uH="SelectItemIndicator",dH=O.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t;return aH(uH,r).isSelected?a.jsx($t.span,{"aria-hidden":!0,...n,ref:e}):null});dH.displayName=uH;var hO="SelectScrollUpButton",fH=O.forwardRef((t,e)=>{const r=Ga(hO,t.__scopeSelect),n=BC(hO,t.__scopeSelect),[i,s]=O.useState(!1),o=yr(e,n.onScrollButtonChange);return Sn(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollTop>0;s(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),i?a.jsx(pH,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});fH.displayName=hO;var pO="SelectScrollDownButton",hH=O.forwardRef((t,e)=>{const r=Ga(pO,t.__scopeSelect),n=BC(pO,t.__scopeSelect),[i,s]=O.useState(!1),o=yr(e,n.onScrollButtonChange);return Sn(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<u;s(f)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),i?a.jsx(pH,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});hH.displayName=pO;var pH=O.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=t,s=Ga("SelectScrollButton",r),o=O.useRef(null),l=Rx(r),c=O.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return O.useEffect(()=>()=>c(),[c]),Sn(()=>{var f;const u=l().find(d=>d.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[l]),a.jsx($t.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:Jt(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:Jt(i.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:Jt(i.onPointerLeave,()=>{c()})})}),s_e="SelectSeparator",mH=O.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t;return a.jsx($t.div,{"aria-hidden":!0,...n,ref:e})});mH.displayName=s_e;var mO="SelectArrow",o_e=O.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,i=Ix(r),s=Ka(mO,r),o=Ga(mO,r);return s.open&&o.position==="popper"?a.jsx(QNe,{...i,...n,ref:e}):null});o_e.displayName=mO;function gH(t){return t===""||t===void 0}var yH=O.forwardRef((t,e)=>{const{value:r,...n}=t,i=O.useRef(null),s=yr(e,i),o=$C(r);return O.useEffect(()=>{const l=i.current,c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==r&&f){const d=new Event("change",{bubbles:!0});f.call(l,r),l.dispatchEvent(d)}},[o,r]),a.jsx(D9,{asChild:!0,children:a.jsx("select",{...n,ref:s,defaultValue:r})})});yH.displayName="BubbleSelect";function vH(t){const e=wo(t),r=O.useRef(""),n=O.useRef(0),i=O.useCallback(o=>{const l=r.current+o;e(l),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),s=O.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return O.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,s]}function xH(t,e,r){const i=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=r?t.indexOf(r):-1;let o=a_e(t,Math.max(s,0));i.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return c!==r?c:void 0}function a_e(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var l_e=V9,bH=G9,c_e=X9,u_e=J9,d_e=Q9,wH=Z9,f_e=nH,jH=oH,SH=lH,h_e=cH,p_e=dH,NH=fH,kH=hH,_H=mH;const ec=l_e,tc=c_e,Da=O.forwardRef(({className:t,children:e,...r},n)=>a.jsxs(bH,{ref:n,className:ge("flex h-10 w-full items-center justify-between rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:[e,a.jsx(u_e,{asChild:!0,children:a.jsx(mo,{className:"h-4 w-4 opacity-50"})})]}));Da.displayName=bH.displayName;const OH=O.forwardRef(({className:t,...e},r)=>a.jsx(NH,{ref:r,className:ge("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(CO,{className:"h-4 w-4"})}));OH.displayName=NH.displayName;const EH=O.forwardRef(({className:t,...e},r)=>a.jsx(kH,{ref:r,className:ge("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(mo,{className:"h-4 w-4"})}));EH.displayName=kH.displayName;const La=O.forwardRef(({className:t,children:e,position:r="popper",...n},i)=>a.jsx(d_e,{children:a.jsxs(wH,{ref:i,className:ge("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white text-gray-900 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[a.jsx(OH,{}),a.jsx(f_e,{className:ge("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(EH,{})]})}));La.displayName=wH.displayName;const m_e=O.forwardRef(({className:t,...e},r)=>a.jsx(jH,{ref:r,className:ge("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));m_e.displayName=jH.displayName;const kt=O.forwardRef(({className:t,children:e,...r},n)=>a.jsxs(SH,{ref:n,className:ge("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(p_e,{children:a.jsx(ko,{className:"h-4 w-4"})})}),a.jsx(h_e,{children:e})]}));kt.displayName=SH.displayName;const g_e=O.forwardRef(({className:t,...e},r)=>a.jsx(_H,{ref:r,className:ge("-mx-1 my-1 h-px bg-gray-200",t),...e}));g_e.displayName=_H.displayName;function y_e({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n}){const i=t.content,{title:s="",subtitle:o,level:l=2}=i||{},[c,u]=O.useState(l),f=Rv({extensions:[d0.configure({heading:!1,paragraph:!1}),xp,bp,f0,u0.configure({placeholder:"Enter section title..."})],content:`<p>${s}</p>`,editable:e&&r,onUpdate:({editor:b})=>{if(n&&e){const w=b.getText();n({...i,title:w,level:c})}}}),d=Rv({extensions:[d0.configure({heading:!1}),xp,bp,f0,u0.configure({placeholder:"Optional subtitle..."})],content:`<p>${o||""}</p>`,editable:e&&r,onUpdate:({editor:b})=>{if(n&&e){const w=b.getText().trim();n({...i,title:(f==null?void 0:f.getText())||s,subtitle:w||void 0,level:c})}}});O.useEffect(()=>{f&&f.getText()!==s&&f.commands.setContent(`<p>${s}</p>`)},[f,s]),O.useEffect(()=>{d&&d.getText()!==(o||"")&&d.commands.setContent(`<p>${o||""}</p>`)},[d,o]),O.useEffect(()=>{f==null||f.setEditable(e&&r),d==null||d.setEditable(e&&r)},[f,d,e,r]);const p=b=>{b==null||b.chain().focus().toggleBold().run()},m=b=>{b==null||b.chain().focus().toggleItalic().run()},x=b=>{const w=parseInt(b);u(w),n&&n({...i,title:(f==null?void 0:f.getText())||s,subtitle:(d==null?void 0:d.getText().trim())||void 0,level:w})},y={1:"text-4xl font-bold",2:"text-3xl font-bold",3:"text-2xl font-semibold",4:"text-xl font-semibold",5:"text-lg font-medium",6:"text-base font-medium"},v=`h${c}`;return a.jsxs("div",{className:ge("space-y-3",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg p-3"),children:[e&&r&&a.jsxs("div",{className:"mb-4 p-3 border border-gray-200 rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Heading Level:"}),a.jsxs(ec,{value:c.toString(),onValueChange:x,children:[a.jsx(Da,{className:"w-32",children:a.jsx(tc,{})}),a.jsxs(La,{children:[a.jsx(kt,{value:"1",children:"H1 - Largest"}),a.jsx(kt,{value:"2",children:"H2 - Large"}),a.jsx(kt,{value:"3",children:"H3 - Medium"}),a.jsx(kt,{value:"4",children:"H4 - Small"}),a.jsx(kt,{value:"5",children:"H5 - Smaller"}),a.jsx(kt,{value:"6",children:"H6 - Smallest"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[a.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Title:"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>p(f),className:ge("h-8 w-8 p-0",(f==null?void 0:f.isActive("bold"))&&"bg-gray-200"),children:a.jsx(my,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>m(f),className:ge("h-8 w-8 p-0",(f==null?void 0:f.isActive("italic"))&&"bg-gray-200"),children:a.jsx(vy,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Subtitle:"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>p(d),className:ge("h-8 w-8 p-0",(d==null?void 0:d.isActive("bold"))&&"bg-gray-200"),children:a.jsx(my,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>m(d),className:ge("h-8 w-8 p-0",(d==null?void 0:d.isActive("italic"))&&"bg-gray-200"),children:a.jsx(vy,{className:"w-4 h-4"})})]})]}),a.jsx("div",{className:ge(y[c],"text-gray-900 leading-tight"),children:e&&r?a.jsx(Mv,{editor:f}):a.jsx(v,{className:ge(y[c],"text-gray-900 leading-tight"),children:s})}),(o||e&&r)&&a.jsx("div",{className:"text-gray-600 leading-relaxed",children:e&&r?a.jsx(Mv,{editor:d}):o?a.jsx("p",{className:"text-gray-600 leading-relaxed",children:o}):null}),e&&r&&!(f!=null&&f.getText().trim())&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none opacity-50",children:a.jsx("p",{className:"text-gray-400 text-sm",children:"Click to add section title..."})})]})}const v_e=Mi(y_e);var CH=Ct.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(r=>e.updateAttributes(r,{textAlign:t})).every(r=>r):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).every(e=>e),toggleTextAlign:t=>({editor:e,commands:r})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?r.unsetTextAlign():r.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});function x_e({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n}){const i=t.content,{html:s="<p>Enter your text here...</p>",text:o="Enter your text here..."}=i||{},l=Rv({extensions:[d0.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),xp,bp,CH.configure({types:["heading","paragraph"]}),NC.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 hover:text-blue-800 underline"}}),f0,u0.configure({placeholder:"Start typing your content here..."})],content:s,editable:e&&r,onUpdate:({editor:v})=>{if(n&&e){const b=v.getHTML(),w=v.getText();n({html:b,text:w})}}});O.useEffect(()=>{l&&l.getHTML()!==s&&l.commands.setContent(s)},[l,s]),O.useEffect(()=>{l&&l.setEditable(e&&r)},[l,e,r]);const c=O.useCallback(()=>{l==null||l.chain().focus().toggleBold().run()},[l]),u=O.useCallback(()=>{l==null||l.chain().focus().toggleItalic().run()},[l]),f=O.useCallback(()=>{l==null||l.chain().focus().toggleUnderline().run()},[l]),d=O.useCallback(()=>{l==null||l.chain().focus().toggleStrike().run()},[l]),p=O.useCallback(v=>{l==null||l.chain().focus().setTextAlign(v).run()},[l]),m=O.useCallback(()=>{l==null||l.chain().focus().toggleBulletList().run()},[l]),x=O.useCallback(()=>{l==null||l.chain().focus().toggleOrderedList().run()},[l]),y=O.useCallback(()=>{const v=l==null?void 0:l.getAttributes("link").href,b=window.prompt("URL",v);if(b!==null){if(b===""){l==null||l.chain().focus().extendMarkRange("link").unsetLink().run();return}l==null||l.chain().focus().extendMarkRange("link").setLink({href:b}).run()}},[l]);return l?a.jsxs("div",{className:ge("relative",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg"),children:[e&&r&&a.jsxs("div",{className:"mb-4 p-2 border border-gray-200 rounded-lg bg-gray-50 flex flex-wrap gap-1",children:[a.jsx(fe,{variant:"ghost",size:"sm",onClick:c,className:ge("h-8 w-8 p-0",l.isActive("bold")&&"bg-gray-200"),children:a.jsx(my,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:u,className:ge("h-8 w-8 p-0",l.isActive("italic")&&"bg-gray-200"),children:a.jsx(vy,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:f,className:ge("h-8 w-8 p-0",l.isActive("underline")&&"bg-gray-200"),children:a.jsx(qB,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:d,className:ge("h-8 w-8 p-0",l.isActive("strike")&&"bg-gray-200"),children:a.jsx(BB,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>p("left"),className:ge("h-8 w-8 p-0",l.isActive({textAlign:"left"})&&"bg-gray-200"),children:a.jsx(PB,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>p("center"),className:ge("h-8 w-8 p-0",l.isActive({textAlign:"center"})&&"bg-gray-200"),children:a.jsx(TB,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>p("right"),className:ge("h-8 w-8 p-0",l.isActive({textAlign:"right"})&&"bg-gray-200"),children:a.jsx(MB,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:m,className:ge("h-8 w-8 p-0",l.isActive("bulletList")&&"bg-gray-200"),children:a.jsx(rs,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:x,className:ge("h-8 w-8 p-0",l.isActive("orderedList")&&"bg-gray-200"),children:a.jsx(MO,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:y,className:ge("h-8 w-8 p-0",l.isActive("link")&&"bg-gray-200"),children:a.jsx(E0,{className:"w-4 h-4"})})]}),a.jsx("div",{className:ge("prose prose-gray max-w-none focus:outline-none",e&&r&&"min-h-[100px]"),children:a.jsx(Mv,{editor:l})}),e&&r&&l.getText().length===0&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:a.jsx("p",{className:"text-gray-400 text-sm",children:"Click to start typing..."})})]}):a.jsxs("div",{className:"prose prose-gray max-w-none animate-pulse",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})}const b_e=Mi(x_e);function w_e({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n}){const i=t.content,{src:s="",alt:o="",caption:l,width:c,height:u}=i||{},[f,d]=O.useState(!1),[p,m]=O.useState(!!s),[x,y]=O.useState(!1),[v,b]=O.useState(!1),[w,N]=O.useState(l||""),[j,k]=O.useState(o||""),[_,E]=O.useState(!1),A=O.useRef(null),T=()=>{m(!1),d(!1)},M=()=>{d(!0),m(!1)},P=()=>{var z;(z=A.current)==null||z.click()},R=async z=>{var K;const W=(K=z.target.files)==null?void 0:K[0];if(W){if(!W.type.startsWith("image/")){alert("Please select an image file");return}if(W.size>5*1024*1024){alert("Image size must be less than 5MB");return}try{y(!0),d(!1);const q=await new Promise((Q,H)=>{const Y=new FileReader;Y.onloadend=()=>Q(Y.result),Y.onerror=H,Y.readAsDataURL(W)}),{data:V,error:D}=await pe.functions.invoke("enhanced-file-upload",{body:{fileData:q,fileName:W.name,fileType:W.type,folder:"page-builder/images"}});if(D)throw console.error("Upload error:",D),new Error(D.message||"Failed to upload image");if(V!=null&&V.error)throw new Error(V.error.message||"Failed to upload image");const G=V.data.publicUrl,ee={...i,src:G,alt:o||W.name.split(".")[0],width:void 0,height:void 0};n==null||n(ee),m(!0)}catch(q){console.error("Error uploading image:",q),alert(`Failed to upload image: ${q.message}`)}finally{y(!1),A.current&&(A.current.value="")}}},L=async()=>{const z=prompt("Enter image URL:");if(z)try{m(!0),d(!1);const W={...i,src:z,alt:o||"Image from URL"};n==null||n(W)}catch(W){console.error("Error setting image URL:",W),d(!0),m(!1)}},$=()=>{const z={...i,caption:w.trim()||void 0,alt:j.trim()||o};n==null||n(z),b(!1)},F=()=>{N(l||""),k(o||""),b(!1)};return s?f?a.jsx("div",{className:"flex items-center justify-center min-h-48 bg-red-50 border-2 border-dashed border-red-300 rounded-lg",children:a.jsxs("div",{className:"text-center p-8",children:[a.jsx("div",{className:"text-red-400 mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),a.jsx("h4",{className:"text-lg font-medium text-red-800 mb-2",children:"Failed to load image"}),a.jsx("p",{className:"text-red-600 text-sm mb-4 break-all max-w-md",children:s}),e&&a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[a.jsxs(fe,{onClick:P,size:"sm",className:"flex items-center space-x-2",children:[a.jsx(Ir,{className:"w-4 h-4"}),a.jsx("span",{children:"Upload New"})]}),a.jsxs(fe,{onClick:L,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[a.jsx(Os,{className:"w-4 h-4"}),a.jsx("span",{children:"Try URL"})]})]})]})}):a.jsxs("figure",{className:ge("space-y-4 relative group",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg p-3"),children:[r&&e&&a.jsxs("div",{className:"absolute -top-2 -right-2 z-10 flex space-x-2",children:[a.jsx(fe,{onClick:()=>b(!v),size:"sm",variant:"outline",className:"h-8 w-8 p-0 bg-white border-gray-300 hover:bg-gray-50 shadow-lg",title:"Edit caption and alt text",children:a.jsx(yo,{className:"w-4 h-4"})}),a.jsx(fe,{onClick:P,size:"sm",variant:"outline",className:"h-8 w-8 p-0 bg-white border-gray-300 hover:bg-gray-50 shadow-lg",title:"Replace image",children:a.jsx(Ir,{className:"w-4 h-4"})})]}),v&&e&&a.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 shadow-lg space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alt Text (for accessibility)"}),a.jsx(ct,{value:j,onChange:z=>k(z.target.value),placeholder:"Describe the image for screen readers",className:"text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caption (optional)"}),a.jsx(ct,{value:w,onChange:z=>N(z.target.value),placeholder:"Add a caption for the image",className:"text-sm"})]}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(fe,{onClick:F,size:"sm",variant:"outline",children:"Cancel"}),a.jsxs(fe,{onClick:$,size:"sm",className:"flex items-center space-x-1",children:[a.jsx(ko,{className:"w-4 h-4"}),a.jsx("span",{children:"Save"})]})]})]}),a.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[(p||x)&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 rounded-lg z-10",children:a.jsxs("div",{className:"text-center",children:[a.jsx(i_,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:x?"Uploading...":"Loading..."})]})}),a.jsx("img",{src:s,alt:o,onLoad:T,onError:M,onClick:()=>!e&&E(!0),className:ge("max-w-full h-auto",!e&&"cursor-pointer hover:opacity-90 transition-opacity",(p||x)&&"opacity-0"),style:{width:c||"auto",height:u||"auto"}}),!e&&a.jsx("button",{onClick:()=>E(!0),className:"absolute top-3 right-3 bg-black bg-opacity-50 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"View fullscreen",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),l&&a.jsx("figcaption",{className:"text-sm text-gray-600 text-center italic px-4",children:l}),a.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:R,className:"hidden"}),_&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"relative max-w-full max-h-full",children:[a.jsx("button",{onClick:()=>E(!1),className:"absolute -top-12 right-0 text-white hover:text-gray-300 text-2xl font-bold z-10",children:"×"}),a.jsx("img",{src:s,alt:o,className:"max-w-full max-h-full object-contain"}),l&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 text-white p-4 text-center",children:a.jsx("p",{className:"text-lg",children:l})})]})})]}):e?a.jsx("div",{className:"flex items-center justify-center min-h-48 bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 transition-colors",children:a.jsxs("div",{className:"text-center p-8",children:[a.jsx(Eu,{className:"w-16 h-16 text-gray-400 mx-auto mb-6"}),a.jsx("h4",{className:"text-xl font-medium text-gray-900 mb-3",children:"Add Image"}),a.jsx("p",{className:"text-gray-600 text-sm mb-6 max-w-sm",children:"Upload an image file or provide a URL to display in this block."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[a.jsx(fe,{onClick:P,disabled:x,className:"flex items-center space-x-2",children:x?a.jsxs(a.Fragment,{children:[a.jsx(i_,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ir,{className:"w-4 h-4"}),a.jsx("span",{children:"Upload Image"})]})}),a.jsxs(fe,{onClick:L,variant:"outline",className:"flex items-center space-x-2",children:[a.jsx(Os,{className:"w-4 h-4"}),a.jsx("span",{children:"From URL"})]})]}),a.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:R,className:"hidden"})]})}):a.jsx("div",{className:"flex items-center justify-center h-48 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Eu,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"No image selected"})]})})}const j_e=Mi(w_e);function S_e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return O.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const Dx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Od(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function FC(t){return"nodeType"in t}function Nn(t){var e,r;return t?Od(t)?t:FC(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function qC(t){const{Document:e}=Nn(t);return t instanceof e}function Qp(t){return Od(t)?!1:t instanceof Nn(t).HTMLElement}function AH(t){return t instanceof Nn(t).SVGElement}function Ed(t){return t?Od(t)?t.document:FC(t)?qC(t)?t:Qp(t)||AH(t)?t.ownerDocument:document:document:document}const ls=Dx?O.useLayoutEffect:O.useEffect;function Lx(t){const e=O.useRef(t);return ls(()=>{e.current=t}),O.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function N_e(){const t=O.useRef(null),e=O.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=O.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function Sp(t,e){e===void 0&&(e=[t]);const r=O.useRef(t);return ls(()=>{r.current!==t&&(r.current=t)},e),r}function Zp(t,e){const r=O.useRef();return O.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function b0(t){const e=Lx(t),r=O.useRef(null),n=O.useCallback(i=>{i!==r.current&&(e==null||e(i,r.current)),r.current=i},[]);return[r,n]}function w0(t){const e=O.useRef();return O.useEffect(()=>{e.current=t},[t]),e.current}let Dk={};function em(t,e){return O.useMemo(()=>{if(e)return e;const r=Dk[t]==null?0:Dk[t]+1;return Dk[t]=r,t+"-"+r},[t,e])}function TH(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((s,o)=>{const l=Object.entries(o);for(const[c,u]of l){const f=s[c];f!=null&&(s[c]=f+t*u)}return s},{...e})}}const ku=TH(1),j0=TH(-1);function k_e(t){return"clientX"in t&&"clientY"in t}function $x(t){if(!t)return!1;const{KeyboardEvent:e}=Nn(t.target);return e&&t instanceof e}function __e(t){if(!t)return!1;const{TouchEvent:e}=Nn(t.target);return e&&t instanceof e}function S0(t){if(__e(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return k_e(t)?{x:t.clientX,y:t.clientY}:null}const Rs=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[Rs.Translate.toString(t),Rs.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),F6="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function O_e(t){return t.matches(F6)?t:t.querySelector(F6)}const E_e={display:"none"};function C_e(t){let{id:e,value:r}=t;return Z.createElement("div",{id:e,style:E_e},r)}function A_e(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Z.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function T_e(){const[t,e]=O.useState("");return{announce:O.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const PH=O.createContext(null);function P_e(t){const e=O.useContext(PH);O.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function M_e(){const[t]=O.useState(()=>new Set),e=O.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[O.useCallback(n=>{let{type:i,event:s}=n;t.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[t]),e]}const R_e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},I_e={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function D_e(t){let{announcements:e=I_e,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=R_e}=t;const{announce:s,announcement:o}=T_e(),l=em("DndLiveRegion"),[c,u]=O.useState(!1);if(O.useEffect(()=>{u(!0)},[]),P_e(O.useMemo(()=>({onDragStart(d){let{active:p}=d;s(e.onDragStart({active:p}))},onDragMove(d){let{active:p,over:m}=d;e.onDragMove&&s(e.onDragMove({active:p,over:m}))},onDragOver(d){let{active:p,over:m}=d;s(e.onDragOver({active:p,over:m}))},onDragEnd(d){let{active:p,over:m}=d;s(e.onDragEnd({active:p,over:m}))},onDragCancel(d){let{active:p,over:m}=d;s(e.onDragCancel({active:p,over:m}))}}),[s,e])),!c)return null;const f=Z.createElement(Z.Fragment,null,Z.createElement(C_e,{id:n,value:i.draggable}),Z.createElement(A_e,{id:l,announcement:o}));return r?js.createPortal(f,r):f}var Sr;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Sr||(Sr={}));function N0(){}function Bx(t,e){return O.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function Fx(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return O.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const cs=Object.freeze({x:0,y:0});function L_e(t,e){const r=S0(t);if(!r)return"0 0";const n={x:(r.x-e.left)/e.width*100,y:(r.y-e.top)/e.height*100};return n.x+"% "+n.y+"%"}function $_e(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function B_e(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function F_e(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),s=Math.min(e.top+e.height,t.top+t.height),o=i-n,l=s-r;if(n<i&&r<s){const c=e.width*e.height,u=t.width*t.height,f=o*l,d=f/(c+u-f);return Number(d.toFixed(4))}return 0}const q_e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const s of n){const{id:o}=s,l=r.get(o);if(l){const c=F_e(l,e);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort($_e)};function z_e(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function MH(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:cs}function U_e(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...r})}}const H_e=U_e(1);function RH(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function W_e(t,e,r){const n=RH(e);if(!n)return t;const{scaleX:i,scaleY:s,x:o,y:l}=n,c=t.left-o-(1-i)*parseFloat(r),u=t.top-l-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),f=i?t.width/i:t.width,d=s?t.height/s:t.height;return{width:f,height:d,top:u,right:c+f,bottom:u+d,left:c}}const V_e={ignoreTransform:!1};function Cd(t,e){e===void 0&&(e=V_e);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:f}=Nn(t).getComputedStyle(t);u&&(r=W_e(r,u,f))}const{top:n,left:i,width:s,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:s,height:o,bottom:l,right:c}}function q6(t){return Cd(t,{ignoreTransform:!0})}function K_e(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function G_e(t,e){return e===void 0&&(e=Nn(t).getComputedStyle(t)),e.position==="fixed"}function Y_e(t,e){e===void 0&&(e=Nn(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=e[i];return typeof s=="string"?r.test(s):!1})}function zC(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(qC(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Qp(i)||AH(i)||r.includes(i))return r;const s=Nn(t).getComputedStyle(i);return i!==t&&Y_e(i,s)&&r.push(i),G_e(i,s)?r:n(i.parentNode)}return t?n(t):r}function IH(t){const[e]=zC(t,1);return e??null}function Lk(t){return!Dx||!t?null:Od(t)?t:FC(t)?qC(t)||t===Ed(t).scrollingElement?window:Qp(t)?t:null:null}function DH(t){return Od(t)?t.scrollX:t.scrollLeft}function LH(t){return Od(t)?t.scrollY:t.scrollTop}function gO(t){return{x:DH(t),y:LH(t)}}var Pr;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Pr||(Pr={}));function $H(t){return!Dx||!t?!1:t===document.scrollingElement}function BH(t){const e={x:0,y:0},r=$H(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,s=t.scrollLeft<=e.x,o=t.scrollTop>=n.y,l=t.scrollLeft>=n.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:n,minScroll:e}}const X_e={x:.2,y:.2};function J_e(t,e,r,n,i){let{top:s,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=X_e);const{isTop:u,isBottom:f,isLeft:d,isRight:p}=BH(t),m={x:0,y:0},x={x:0,y:0},y={height:e.height*i.y,width:e.width*i.x};return!u&&s<=e.top+y.height?(m.y=Pr.Backward,x.y=n*Math.abs((e.top+y.height-s)/y.height)):!f&&c>=e.bottom-y.height&&(m.y=Pr.Forward,x.y=n*Math.abs((e.bottom-y.height-c)/y.height)),!p&&l>=e.right-y.width?(m.x=Pr.Forward,x.x=n*Math.abs((e.right-y.width-l)/y.width)):!d&&o<=e.left+y.width&&(m.x=Pr.Backward,x.x=n*Math.abs((e.left+y.width-o)/y.width)),{direction:m,speed:x}}function Q_e(t){if(t===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function FH(t){return t.reduce((e,r)=>ku(e,gO(r)),cs)}function Z_e(t){return t.reduce((e,r)=>e+DH(r),0)}function e2e(t){return t.reduce((e,r)=>e+LH(r),0)}function qH(t,e){if(e===void 0&&(e=Cd),!t)return;const{top:r,left:n,bottom:i,right:s}=e(t);IH(t)&&(i<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const t2e=[["x",["left","right"],Z_e],["y",["top","bottom"],e2e]];class UC{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=zC(r),i=FH(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,o,l]of t2e)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),f=i[s]-u;return this.rect[c]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class gh{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function r2e(t){const{EventTarget:e}=Nn(t);return t instanceof e?t:Ed(t)}function $k(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var Si;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Si||(Si={}));function z6(t){t.preventDefault()}function n2e(t){t.stopPropagation()}var vt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(vt||(vt={}));const zH={start:[vt.Space,vt.Enter],cancel:[vt.Esc],end:[vt.Space,vt.Enter,vt.Tab]},i2e=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case vt.Right:return{...r,x:r.x+25};case vt.Left:return{...r,x:r.x-25};case vt.Down:return{...r,y:r.y+25};case vt.Up:return{...r,y:r.y-25}}};class UH{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new gh(Ed(r)),this.windowListeners=new gh(Nn(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Si.Resize,this.handleCancel),this.windowListeners.add(Si.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Si.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&qH(n),r(cs)}handleKeyDown(e){if($x(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:s=zH,coordinateGetter:o=i2e,scrollBehavior:l="smooth"}=i,{code:c}=e;if(s.end.includes(c)){this.handleEnd(e);return}if(s.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=n.current,f=u?{x:u.left,y:u.top}:cs;this.referenceCoordinates||(this.referenceCoordinates=f);const d=o(e,{active:r,context:n.current,currentCoordinates:f});if(d){const p=j0(d,f),m={x:0,y:0},{scrollableAncestors:x}=n.current;for(const y of x){const v=e.code,{isTop:b,isRight:w,isLeft:N,isBottom:j,maxScroll:k,minScroll:_}=BH(y),E=Q_e(y),A={x:Math.min(v===vt.Right?E.right-E.width/2:E.right,Math.max(v===vt.Right?E.left:E.left+E.width/2,d.x)),y:Math.min(v===vt.Down?E.bottom-E.height/2:E.bottom,Math.max(v===vt.Down?E.top:E.top+E.height/2,d.y))},T=v===vt.Right&&!w||v===vt.Left&&!N,M=v===vt.Down&&!j||v===vt.Up&&!b;if(T&&A.x!==d.x){const P=y.scrollLeft+p.x,R=v===vt.Right&&P<=k.x||v===vt.Left&&P>=_.x;if(R&&!p.y){y.scrollTo({left:P,behavior:l});return}R?m.x=y.scrollLeft-P:m.x=v===vt.Right?y.scrollLeft-k.x:y.scrollLeft-_.x,m.x&&y.scrollBy({left:-m.x,behavior:l});break}else if(M&&A.y!==d.y){const P=y.scrollTop+p.y,R=v===vt.Down&&P<=k.y||v===vt.Up&&P>=_.y;if(R&&!p.x){y.scrollTo({top:P,behavior:l});return}R?m.y=y.scrollTop-P:m.y=v===vt.Down?y.scrollTop-k.y:y.scrollTop-_.y,m.y&&y.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(e,ku(j0(d,this.referenceCoordinates),m))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}UH.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=zH,onActivation:i}=e,{active:s}=r;const{code:o}=t.nativeEvent;if(n.start.includes(o)){const l=s.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),i==null||i({event:t.nativeEvent}),!0)}return!1}}];function U6(t){return!!(t&&"distance"in t)}function H6(t){return!!(t&&"delay"in t)}class HC{constructor(e,r,n){var i;n===void 0&&(n=r2e(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:s}=e,{target:o}=s;this.props=e,this.events=r,this.document=Ed(o),this.documentListeners=new gh(this.document),this.listeners=new gh(n),this.windowListeners=new gh(Nn(o)),this.initialCoordinates=(i=S0(s))!=null?i:cs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Si.Resize,this.handleCancel),this.windowListeners.add(Si.DragStart,z6),this.windowListeners.add(Si.VisibilityChange,this.handleCancel),this.windowListeners.add(Si.ContextMenu,z6),this.documentListeners.add(Si.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(H6(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(U6(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Si.Click,n2e,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Si.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(r=S0(e))!=null?r:cs,u=j0(i,c);if(!n&&l){if(U6(l)){if(l.tolerance!=null&&$k(u,l.tolerance))return this.handleCancel();if($k(u,l.distance))return this.handleStart()}if(H6(l)&&$k(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===vt.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const s2e={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ad extends HC{constructor(e){const{event:r}=e,n=Ed(r.target);super(e,s2e,n)}}Ad.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const o2e={move:{name:"mousemove"},end:{name:"mouseup"}};var yO;(function(t){t[t.RightClick=2]="RightClick"})(yO||(yO={}));class a2e extends HC{constructor(e){super(e,o2e,Ed(e.event.target))}}a2e.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===yO.RightClick?!1:(n==null||n({event:r}),!0)}}];const Bk={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class l2e extends HC{constructor(e){super(e,Bk)}static setup(){return window.addEventListener(Bk.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Bk.move.name,e)};function e(){}}}l2e.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var yh;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(yh||(yh={}));var k0;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(k0||(k0={}));function c2e(t){let{acceleration:e,activator:r=yh.Pointer,canScroll:n,draggingRect:i,enabled:s,interval:o=5,order:l=k0.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:f,delta:d,threshold:p}=t;const m=d2e({delta:d,disabled:!s}),[x,y]=N_e(),v=O.useRef({x:0,y:0}),b=O.useRef({x:0,y:0}),w=O.useMemo(()=>{switch(r){case yh.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case yh.DraggableRect:return i}},[r,i,c]),N=O.useRef(null),j=O.useCallback(()=>{const _=N.current;if(!_)return;const E=v.current.x*b.current.x,A=v.current.y*b.current.y;_.scrollBy(E,A)},[]),k=O.useMemo(()=>l===k0.TreeOrder?[...u].reverse():u,[l,u]);O.useEffect(()=>{if(!s||!u.length||!w){y();return}for(const _ of k){if((n==null?void 0:n(_))===!1)continue;const E=u.indexOf(_),A=f[E];if(!A)continue;const{direction:T,speed:M}=J_e(_,A,w,e,p);for(const P of["x","y"])m[P][T[P]]||(M[P]=0,T[P]=0);if(M.x>0||M.y>0){y(),N.current=_,x(j,o),v.current=M,b.current=T;return}}v.current={x:0,y:0},b.current={x:0,y:0},y()},[e,j,n,y,s,o,JSON.stringify(w),JSON.stringify(m),x,u,k,f,JSON.stringify(p)])}const u2e={x:{[Pr.Backward]:!1,[Pr.Forward]:!1},y:{[Pr.Backward]:!1,[Pr.Forward]:!1}};function d2e(t){let{delta:e,disabled:r}=t;const n=w0(e);return Zp(i=>{if(r||!n||!i)return u2e;const s={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[Pr.Backward]:i.x[Pr.Backward]||s.x===-1,[Pr.Forward]:i.x[Pr.Forward]||s.x===1},y:{[Pr.Backward]:i.y[Pr.Backward]||s.y===-1,[Pr.Forward]:i.y[Pr.Forward]||s.y===1}}},[r,e,n])}function f2e(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return Zp(i=>{var s;return e==null?null:(s=n??i)!=null?s:null},[n,e])}function h2e(t,e){return O.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,s=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,n)}));return[...r,...s]},[]),[t,e])}var Np;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Np||(Np={}));var vO;(function(t){t.Optimized="optimized"})(vO||(vO={}));const W6=new Map;function p2e(t,e){let{dragging:r,dependencies:n,config:i}=e;const[s,o]=O.useState(null),{frequency:l,measure:c,strategy:u}=i,f=O.useRef(t),d=v(),p=Sp(d),m=O.useCallback(function(b){b===void 0&&(b=[]),!p.current&&o(w=>w===null?b:w.concat(b.filter(N=>!w.includes(N))))},[p]),x=O.useRef(null),y=Zp(b=>{if(d&&!r)return W6;if(!b||b===W6||f.current!==t||s!=null){const w=new Map;for(let N of t){if(!N)continue;if(s&&s.length>0&&!s.includes(N.id)&&N.rect.current){w.set(N.id,N.rect.current);continue}const j=N.node.current,k=j?new UC(c(j),j):null;N.rect.current=k,k&&w.set(N.id,k)}return w}return b},[t,s,r,d,c]);return O.useEffect(()=>{f.current=t},[t]),O.useEffect(()=>{d||m()},[r,d]),O.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),O.useEffect(()=>{d||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{m(),x.current=null},l))},[l,d,m,...n]),{droppableRects:y,measureDroppableContainers:m,measuringScheduled:s!=null};function v(){switch(u){case Np.Always:return!1;case Np.BeforeDragging:return r;default:return!r}}}function WC(t,e){return Zp(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function m2e(t,e){return WC(t,e)}function g2e(t){let{callback:e,disabled:r}=t;const n=Lx(e),i=O.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(n)},[n,r]);return O.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function qx(t){let{callback:e,disabled:r}=t;const n=Lx(e),i=O.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(n)},[r]);return O.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function y2e(t){return new UC(Cd(t),t)}function V6(t,e,r){e===void 0&&(e=y2e);const[n,i]=O.useState(null);function s(){i(c=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=c??r)!=null?u:null}const f=e(t);return JSON.stringify(c)===JSON.stringify(f)?c:f})}const o=g2e({callback(c){if(t)for(const u of c){const{type:f,target:d}=u;if(f==="childList"&&d instanceof HTMLElement&&d.contains(t)){s();break}}}}),l=qx({callback:s});return ls(()=>{s(),t?(l==null||l.observe(t),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[t]),n}function v2e(t){const e=WC(t);return MH(t,e)}const K6=[];function x2e(t){const e=O.useRef(t),r=Zp(n=>t?n&&n!==K6&&t&&e.current&&t.parentNode===e.current.parentNode?n:zC(t):K6,[t]);return O.useEffect(()=>{e.current=t},[t]),r}function b2e(t){const[e,r]=O.useState(null),n=O.useRef(t),i=O.useCallback(s=>{const o=Lk(s.target);o&&r(l=>l?(l.set(o,gO(o)),new Map(l)):null)},[]);return O.useEffect(()=>{const s=n.current;if(t!==s){o(s);const l=t.map(c=>{const u=Lk(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,gO(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=t}return()=>{o(t),o(s)};function o(l){l.forEach(c=>{const u=Lk(c);u==null||u.removeEventListener("scroll",i)})}},[i,t]),O.useMemo(()=>t.length?e?Array.from(e.values()).reduce((s,o)=>ku(s,o),cs):FH(t):cs,[t,e])}function G6(t,e){e===void 0&&(e=[]);const r=O.useRef(null);return O.useEffect(()=>{r.current=null},e),O.useEffect(()=>{const n=t!==cs;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?j0(t,r.current):cs}function w2e(t){O.useEffect(()=>{if(!Dx)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r==null||r()}},t.map(e=>{let{sensor:r}=e;return r}))}function j2e(t,e){return O.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:s}=n;return r[i]=o=>{s(o,e)},r},{}),[t,e])}function HH(t){return O.useMemo(()=>t?K_e(t):null,[t])}const Y6=[];function S2e(t,e){e===void 0&&(e=Cd);const[r]=t,n=HH(r?Nn(r):null),[i,s]=O.useState(Y6);function o(){s(()=>t.length?t.map(c=>$H(c)?n:new UC(e(c),c)):Y6)}const l=qx({callback:o});return ls(()=>{l==null||l.disconnect(),o(),t.forEach(c=>l==null?void 0:l.observe(c))},[t]),i}function WH(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Qp(e)?e:t}function N2e(t){let{measure:e}=t;const[r,n]=O.useState(null),i=O.useCallback(u=>{for(const{target:f}of u)if(Qp(f)){n(d=>{const p=e(f);return d?{...d,width:p.width,height:p.height}:p});break}},[e]),s=qx({callback:i}),o=O.useCallback(u=>{const f=WH(u);s==null||s.disconnect(),f&&(s==null||s.observe(f)),n(f?e(f):null)},[e,s]),[l,c]=b0(o);return O.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const k2e=[{sensor:Ad,options:{}},{sensor:UH,options:{}}],_2e={current:{}},cy={draggable:{measure:q6},droppable:{measure:q6,strategy:Np.WhileDragging,frequency:vO.Optimized},dragOverlay:{measure:Cd}};class vh extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const O2e={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new vh,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:N0},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:cy,measureDroppableContainers:N0,windowRect:null,measuringScheduled:!1},VH={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:N0,draggableNodes:new Map,over:null,measureDroppableContainers:N0},tm=O.createContext(VH),KH=O.createContext(O2e);function E2e(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new vh}}}function C2e(t,e){switch(e.type){case Sr.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Sr.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Sr.DragEnd:case Sr.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Sr.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new vh(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Sr.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,s=t.droppable.containers.get(r);if(!s||n!==s.key)return t;const o=new vh(t.droppable.containers);return o.set(r,{...s,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case Sr.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const s=new vh(t.droppable.containers);return s.delete(r),{...t,droppable:{...t.droppable,containers:s}}}default:return t}}function A2e(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=O.useContext(tm),s=w0(n),o=w0(r==null?void 0:r.id);return O.useEffect(()=>{if(!e&&!n&&s&&o!=null){if(!$x(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const f of[c.current,u.current]){if(!f)continue;const d=O_e(f);if(d){d.focus();break}}})}},[n,e,i,o,s]),null}function GH(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,s)=>s({transform:i,...n}),r):r}function T2e(t){return O.useMemo(()=>({draggable:{...cy.draggable,...t==null?void 0:t.draggable},droppable:{...cy.droppable,...t==null?void 0:t.droppable},dragOverlay:{...cy.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function P2e(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const s=O.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;ls(()=>{if(!o&&!l||!e){s.current=!1;return}if(s.current||!n)return;const u=e==null?void 0:e.node.current;if(!u||u.isConnected===!1)return;const f=r(u),d=MH(f,n);if(o||(d.x=0),l||(d.y=0),s.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const p=IH(u);p&&p.scrollBy({top:d.y,left:d.x})}},[e,o,l,n,r])}const zx=O.createContext({...cs,scaleX:1,scaleY:1});var ua;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(ua||(ua={}));const Ux=O.memo(function(e){var r,n,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:f=k2e,collisionDetection:d=q_e,measuring:p,modifiers:m,...x}=e;const y=O.useReducer(C2e,void 0,E2e),[v,b]=y,[w,N]=M_e(),[j,k]=O.useState(ua.Uninitialized),_=j===ua.Initialized,{draggable:{active:E,nodes:A,translate:T},droppable:{containers:M}}=v,P=E!=null?A.get(E):null,R=O.useRef({initial:null,translated:null}),L=O.useMemo(()=>{var Kt;return E!=null?{id:E,data:(Kt=P==null?void 0:P.data)!=null?Kt:_2e,rect:R}:null},[E,P]),$=O.useRef(null),[F,z]=O.useState(null),[W,K]=O.useState(null),q=Sp(x,Object.values(x)),V=em("DndDescribedBy",o),D=O.useMemo(()=>M.getEnabled(),[M]),U=T2e(p),{droppableRects:G,measureDroppableContainers:ee,measuringScheduled:Q}=p2e(D,{dragging:_,dependencies:[T.x,T.y],config:U.droppable}),H=f2e(A,E),Y=O.useMemo(()=>W?S0(W):null,[W]),re=To(),J=m2e(H,U.draggable.measure);P2e({activeNode:E!=null?A.get(E):null,config:re.layoutShiftCompensation,initialRect:J,measure:U.draggable.measure});const ne=V6(H,U.draggable.measure,J),te=V6(H?H.parentElement:null),se=O.useRef({activatorEvent:null,active:null,activeNode:H,collisionRect:null,collisions:null,droppableRects:G,draggableNodes:A,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ve=M.getNodeFor((r=se.current.over)==null?void 0:r.id),ie=N2e({measure:U.dragOverlay.measure}),ye=(n=ie.nodeRef.current)!=null?n:H,Te=_?(i=ie.rect)!=null?i:ne:null,Le=!!(ie.nodeRef.current&&ie.rect),ue=v2e(Le?null:ne),he=HH(ye?Nn(ye):null),we=x2e(_?ve??H:null),Oe=S2e(we),be=GH(m,{transform:{x:T.x-ue.x,y:T.y-ue.y,scaleX:1,scaleY:1},activatorEvent:W,active:L,activeNodeRect:ne,containerNodeRect:te,draggingNodeRect:Te,over:se.current.over,overlayNodeRect:ie.rect,scrollableAncestors:we,scrollableAncestorRects:Oe,windowRect:he}),We=Y?ku(Y,T):null,Je=b2e(we),Ye=G6(Je),Ae=G6(Je,[ne]),Me=ku(be,Ye),Re=Te?H_e(Te,be):null,sr=L&&Re?d({active:L,collisionRect:Re,droppableRects:G,droppableContainers:D,pointerCoordinates:We}):null,ut=B_e(sr,"id"),[wt,ci]=O.useState(null),dc=Le?be:ku(be,Ae),fc=z_e(dc,(s=wt==null?void 0:wt.rect)!=null?s:null,ne),Md=O.useRef(null),hc=O.useCallback((Kt,Yr)=>{let{sensor:Xr,options:Ri}=Yr;if($.current==null)return;const un=A.get($.current);if(!un)return;const Jr=Kt.nativeEvent,kn=new Xr({active:$.current,activeNode:un,event:Jr,options:Ri,context:se,onAbort(Gt){if(!A.get(Gt))return;const{onDragAbort:Qr}=q.current,Ii={id:Gt};Qr==null||Qr(Ii),w({type:"onDragAbort",event:Ii})},onPending(Gt,ui,Qr,Ii){if(!A.get(Gt))return;const{onDragPending:fs}=q.current,Bn={id:Gt,constraint:ui,initialCoordinates:Qr,offset:Ii};fs==null||fs(Bn),w({type:"onDragPending",event:Bn})},onStart(Gt){const ui=$.current;if(ui==null)return;const Qr=A.get(ui);if(!Qr)return;const{onDragStart:Ii}=q.current,Di={activatorEvent:Jr,active:{id:ui,data:Qr.data,rect:R}};js.unstable_batchedUpdates(()=>{Ii==null||Ii(Di),k(ua.Initializing),b({type:Sr.DragStart,initialCoordinates:Gt,active:ui}),w({type:"onDragStart",event:Di}),z(Md.current),K(Jr)})},onMove(Gt){b({type:Sr.DragMove,coordinates:Gt})},onEnd:$s(Sr.DragEnd),onCancel:$s(Sr.DragCancel)});Md.current=kn;function $s(Gt){return async function(){const{active:Qr,collisions:Ii,over:Di,scrollAdjustedTranslate:fs}=se.current;let Bn=null;if(Qr&&fs){const{cancelDrop:Bs}=q.current;Bn={activatorEvent:Jr,active:Qr,collisions:Ii,delta:fs,over:Di},Gt===Sr.DragEnd&&typeof Bs=="function"&&await Promise.resolve(Bs(Bn))&&(Gt=Sr.DragCancel)}$.current=null,js.unstable_batchedUpdates(()=>{b({type:Gt}),k(ua.Uninitialized),ci(null),z(null),K(null),Md.current=null;const Bs=Gt===Sr.DragEnd?"onDragEnd":"onDragCancel";if(Bn){const Ld=q.current[Bs];Ld==null||Ld(Bn),w({type:Bs,event:Bn})}})}}},[A]),Rd=O.useCallback((Kt,Yr)=>(Xr,Ri)=>{const un=Xr.nativeEvent,Jr=A.get(Ri);if($.current!==null||!Jr||un.dndKit||un.defaultPrevented)return;const kn={active:Jr};Kt(Xr,Yr.options,kn)===!0&&(un.dndKit={capturedBy:Yr.sensor},$.current=Ri,hc(Xr,Yr))},[A,hc]),pc=h2e(f,Rd);w2e(f),ls(()=>{ne&&j===ua.Initializing&&k(ua.Initialized)},[ne,j]),O.useEffect(()=>{const{onDragMove:Kt}=q.current,{active:Yr,activatorEvent:Xr,collisions:Ri,over:un}=se.current;if(!Yr||!Xr)return;const Jr={active:Yr,activatorEvent:Xr,collisions:Ri,delta:{x:Me.x,y:Me.y},over:un};js.unstable_batchedUpdates(()=>{Kt==null||Kt(Jr),w({type:"onDragMove",event:Jr})})},[Me.x,Me.y]),O.useEffect(()=>{const{active:Kt,activatorEvent:Yr,collisions:Xr,droppableContainers:Ri,scrollAdjustedTranslate:un}=se.current;if(!Kt||$.current==null||!Yr||!un)return;const{onDragOver:Jr}=q.current,kn=Ri.get(ut),$s=kn&&kn.rect.current?{id:kn.id,rect:kn.rect.current,data:kn.data,disabled:kn.disabled}:null,Gt={active:Kt,activatorEvent:Yr,collisions:Xr,delta:{x:un.x,y:un.y},over:$s};js.unstable_batchedUpdates(()=>{ci($s),Jr==null||Jr(Gt),w({type:"onDragOver",event:Gt})})},[ut]),ls(()=>{se.current={activatorEvent:W,active:L,activeNode:H,collisionRect:Re,collisions:sr,droppableRects:G,draggableNodes:A,draggingNode:ye,draggingNodeRect:Te,droppableContainers:M,over:wt,scrollableAncestors:we,scrollAdjustedTranslate:Me},R.current={initial:Te,translated:Re}},[L,H,sr,Re,A,ye,Te,G,M,wt,we,Me]),c2e({...re,delta:T,draggingRect:Re,pointerCoordinates:We,scrollableAncestors:we,scrollableAncestorRects:Oe});const Id=O.useMemo(()=>({active:L,activeNode:H,activeNodeRect:ne,activatorEvent:W,collisions:sr,containerNodeRect:te,dragOverlay:ie,draggableNodes:A,droppableContainers:M,droppableRects:G,over:wt,measureDroppableContainers:ee,scrollableAncestors:we,scrollableAncestorRects:Oe,measuringConfiguration:U,measuringScheduled:Q,windowRect:he}),[L,H,ne,W,sr,te,ie,A,M,G,wt,ee,we,Oe,U,Q,he]),Dd=O.useMemo(()=>({activatorEvent:W,activators:pc,active:L,activeNodeRect:ne,ariaDescribedById:{draggable:V},dispatch:b,draggableNodes:A,over:wt,measureDroppableContainers:ee}),[W,pc,L,ne,b,V,A,wt,ee]);return Z.createElement(PH.Provider,{value:N},Z.createElement(tm.Provider,{value:Dd},Z.createElement(KH.Provider,{value:Id},Z.createElement(zx.Provider,{value:fc},u)),Z.createElement(A2e,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Z.createElement(D_e,{...l,hiddenTextDescribedById:V}));function To(){const Kt=(F==null?void 0:F.autoScrollEnabled)===!1,Yr=typeof c=="object"?c.enabled===!1:c===!1,Xr=_&&!Kt&&!Yr;return typeof c=="object"?{...c,enabled:Xr}:{enabled:Xr}}}),M2e=O.createContext(null),X6="button",R2e="Draggable";function I2e(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const s=em(R2e),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:f,draggableNodes:d,over:p}=O.useContext(tm),{role:m=X6,roleDescription:x="draggable",tabIndex:y=0}=i??{},v=(c==null?void 0:c.id)===e,b=O.useContext(v?zx:M2e),[w,N]=b0(),[j,k]=b0(),_=j2e(o,e),E=Sp(r);ls(()=>(d.set(e,{id:e,key:s,node:w,activatorNode:j,data:E}),()=>{const T=d.get(e);T&&T.key===s&&d.delete(e)}),[d,e]);const A=O.useMemo(()=>({role:m,tabIndex:y,"aria-disabled":n,"aria-pressed":v&&m===X6?!0:void 0,"aria-roledescription":x,"aria-describedby":f.draggable}),[n,m,y,v,x,f.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:A,isDragging:v,listeners:n?void 0:_,node:w,over:p,setNodeRef:N,setActivatorNodeRef:k,transform:b}}function YH(){return O.useContext(KH)}const D2e="Droppable",L2e={timeout:25};function $2e(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const s=em(D2e),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=O.useContext(tm),f=O.useRef({disabled:r}),d=O.useRef(!1),p=O.useRef(null),m=O.useRef(null),{disabled:x,updateMeasurementsFor:y,timeout:v}={...L2e,...i},b=Sp(y??n),w=O.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),m.current=null},v)},[v]),N=qx({callback:w,disabled:x||!o}),j=O.useCallback((A,T)=>{N&&(T&&(N.unobserve(T),d.current=!1),A&&N.observe(A))},[N]),[k,_]=b0(j),E=Sp(e);return O.useEffect(()=>{!N||!k.current||(N.disconnect(),d.current=!1,N.observe(k.current))},[k,N]),O.useEffect(()=>(l({type:Sr.RegisterDroppable,element:{id:n,key:s,disabled:r,node:k,rect:p,data:E}}),()=>l({type:Sr.UnregisterDroppable,key:s,id:n})),[n]),O.useEffect(()=>{r!==f.current.disabled&&(l({type:Sr.SetDroppableDisabled,id:n,key:s,disabled:r}),f.current.disabled=r)},[n,s,r,l]),{active:o,rect:p,isOver:(c==null?void 0:c.id)===n,node:k,over:c,setNodeRef:_}}function B2e(t){let{animation:e,children:r}=t;const[n,i]=O.useState(null),[s,o]=O.useState(null),l=w0(r);return!r&&!n&&l&&i(l),ls(()=>{if(!s)return;const c=n==null?void 0:n.key,u=n==null?void 0:n.props.id;if(c==null||u==null){i(null);return}Promise.resolve(e(u,s)).then(()=>{i(null)})},[e,n,s]),Z.createElement(Z.Fragment,null,r,n?O.cloneElement(n,{ref:o}):null)}const F2e={x:0,y:0,scaleX:1,scaleY:1};function q2e(t){let{children:e}=t;return Z.createElement(tm.Provider,{value:VH},Z.createElement(zx.Provider,{value:F2e},e))}const z2e={position:"fixed",touchAction:"none"},U2e=t=>$x(t)?"transform 250ms ease":void 0,H2e=O.forwardRef((t,e)=>{let{as:r,activatorEvent:n,adjustScale:i,children:s,className:o,rect:l,style:c,transform:u,transition:f=U2e}=t;if(!l)return null;const d=i?u:{...u,scaleX:1,scaleY:1},p={...z2e,width:l.width,height:l.height,top:l.top,left:l.left,transform:Rs.Transform.toString(d),transformOrigin:i&&n?L_e(n,l):void 0,transition:typeof f=="function"?f(n):f,...c};return Z.createElement(r,{className:o,style:p,ref:e},s)}),W2e=t=>e=>{let{active:r,dragOverlay:n}=e;const i={},{styles:s,className:o}=t;if(s!=null&&s.active)for(const[l,c]of Object.entries(s.active))c!==void 0&&(i[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,c));if(s!=null&&s.dragOverlay)for(const[l,c]of Object.entries(s.dragOverlay))c!==void 0&&n.node.style.setProperty(l,c);return o!=null&&o.active&&r.node.classList.add(o.active),o!=null&&o.dragOverlay&&n.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(i))r.node.style.setProperty(c,u);o!=null&&o.active&&r.node.classList.remove(o.active)}},V2e=t=>{let{transform:{initial:e,final:r}}=t;return[{transform:Rs.Transform.toString(e)},{transform:Rs.Transform.toString(r)}]},K2e={duration:250,easing:"ease",keyframes:V2e,sideEffects:W2e({styles:{active:{opacity:"0"}}})};function G2e(t){let{config:e,draggableNodes:r,droppableContainers:n,measuringConfiguration:i}=t;return Lx((s,o)=>{if(e===null)return;const l=r.get(s);if(!l)return;const c=l.node.current;if(!c)return;const u=WH(o);if(!u)return;const{transform:f}=Nn(o).getComputedStyle(o),d=RH(f);if(!d)return;const p=typeof e=="function"?e:Y2e(e);return qH(c,i.draggable.measure),p({active:{id:s,data:l.data,node:c,rect:i.draggable.measure(c)},draggableNodes:r,dragOverlay:{node:o,rect:i.dragOverlay.measure(u)},droppableContainers:n,measuringConfiguration:i,transform:d})})}function Y2e(t){const{duration:e,easing:r,sideEffects:n,keyframes:i}={...K2e,...t};return s=>{let{active:o,dragOverlay:l,transform:c,...u}=s;if(!e)return;const f={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},d={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/l.rect.height:1},p={x:c.x-f.x,y:c.y-f.y,...d},m=i({...u,active:o,dragOverlay:l,transform:{initial:c,final:p}}),[x]=m,y=m[m.length-1];if(JSON.stringify(x)===JSON.stringify(y))return;const v=n==null?void 0:n({active:o,dragOverlay:l,...u}),b=l.node.animate(m,{duration:e,easing:r,fill:"forwards"});return new Promise(w=>{b.onfinish=()=>{v==null||v(),w()}})}}let J6=0;function X2e(t){return O.useMemo(()=>{if(t!=null)return J6++,J6},[t])}const VC=Z.memo(t=>{let{adjustScale:e=!1,children:r,dropAnimation:n,style:i,transition:s,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=t;const{activatorEvent:f,active:d,activeNodeRect:p,containerNodeRect:m,draggableNodes:x,droppableContainers:y,dragOverlay:v,over:b,measuringConfiguration:w,scrollableAncestors:N,scrollableAncestorRects:j,windowRect:k}=YH(),_=O.useContext(zx),E=X2e(d==null?void 0:d.id),A=GH(o,{activatorEvent:f,active:d,activeNodeRect:p,containerNodeRect:m,draggingNodeRect:v.rect,over:b,overlayNodeRect:v.rect,scrollableAncestors:N,scrollableAncestorRects:j,transform:_,windowRect:k}),T=WC(p),M=G2e({config:n,draggableNodes:x,droppableContainers:y,measuringConfiguration:w}),P=T?v.setRef:void 0;return Z.createElement(q2e,null,Z.createElement(B2e,{animation:M},d&&E?Z.createElement(H2e,{key:E,id:d.id,ref:P,as:l,activatorEvent:f,adjustScale:e,className:c,transition:s,rect:T,style:{zIndex:u,...i},transform:A},r):null))});function Td(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function J2e(t,e){return t.reduce((r,n,i)=>{const s=e.get(n);return s&&(r[i]=s),r},Array(t.length))}function Vg(t){return t!==null&&t>=0}function Q2e(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Z2e(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const XH=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const s=Td(e,n,r),o=e[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Kg={scaleX:1,scaleY:1},Hx=t=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:s,overIndex:o}=t;const l=(e=s[r])!=null?e:n;if(!l)return null;if(i===r){const u=s[o];return u?{x:0,y:r<o?u.top+u.height-(l.top+l.height):u.top-l.top,...Kg}:null}const c=eOe(s,i,r);return i>r&&i<=o?{x:0,y:-l.height-c,...Kg}:i<r&&i>=o?{x:0,y:l.height+c,...Kg}:{x:0,y:0,...Kg}};function eOe(t,e,r){const n=t[e],i=t[e-1],s=t[e+1];return n?r<e?i?n.top-(i.top+i.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const JH="Sortable",QH=Z.createContext({activeIndex:-1,containerId:JH,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:XH,disabled:{draggable:!1,droppable:!1}});function Wx(t){let{children:e,id:r,items:n,strategy:i=XH,disabled:s=!1}=t;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:f}=YH(),d=em(JH,r),p=l.rect!==null,m=O.useMemo(()=>n.map(_=>typeof _=="object"&&"id"in _?_.id:_),[n]),x=o!=null,y=o?m.indexOf(o.id):-1,v=u?m.indexOf(u.id):-1,b=O.useRef(m),w=!Q2e(m,b.current),N=v!==-1&&y===-1||w,j=Z2e(s);ls(()=>{w&&x&&f(m)},[w,m,x,f]),O.useEffect(()=>{b.current=m},[m]);const k=O.useMemo(()=>({activeIndex:y,containerId:d,disabled:j,disableTransforms:N,items:m,overIndex:v,useDragOverlay:p,sortedRects:J2e(m,c),strategy:i}),[y,d,j.draggable,j.droppable,N,m,v,c,p,i]);return Z.createElement(QH.Provider,{value:k},e)}const tOe=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return Td(r,n,i).indexOf(e)},rOe=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=t;return!u||!n||l!==s&&i===o?!1:r?!0:o!==i&&e===c},nOe={duration:200,easing:"ease"},ZH="transform",iOe=Rs.Transition.toString({property:ZH,duration:0,easing:"linear"}),sOe={roleDescription:"sortable"};function oOe(t){let{disabled:e,index:r,node:n,rect:i}=t;const[s,o]=O.useState(null),l=O.useRef(r);return ls(()=>{if(!e&&r!==l.current&&n.current){const c=i.current;if(c){const u=Cd(n.current,{ignoreTransform:!0}),f={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(f.x||f.y)&&o(f)}}r!==l.current&&(l.current=r)},[e,r,n,i]),O.useEffect(()=>{s&&o(null)},[s]),s}function KC(t){let{animateLayoutChanges:e=rOe,attributes:r,disabled:n,data:i,getNewIndex:s=tOe,id:o,strategy:l,resizeObserverConfig:c,transition:u=nOe}=t;const{items:f,containerId:d,activeIndex:p,disabled:m,disableTransforms:x,sortedRects:y,overIndex:v,useDragOverlay:b,strategy:w}=O.useContext(QH),N=aOe(n,m),j=f.indexOf(o),k=O.useMemo(()=>({sortable:{containerId:d,index:j,items:f},...i}),[d,i,j,f]),_=O.useMemo(()=>f.slice(f.indexOf(o)),[f,o]),{rect:E,node:A,isOver:T,setNodeRef:M}=$2e({id:o,data:k,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:_,...c}}),{active:P,activatorEvent:R,activeNodeRect:L,attributes:$,setNodeRef:F,listeners:z,isDragging:W,over:K,setActivatorNodeRef:q,transform:V}=I2e({id:o,data:k,attributes:{...sOe,...r},disabled:N.draggable}),D=S_e(M,F),U=!!P,G=U&&!x&&Vg(p)&&Vg(v),ee=!b&&W,Q=ee&&G?V:null,Y=G?Q??(l??w)({rects:y,activeNodeRect:L,activeIndex:p,overIndex:v,index:j}):null,re=Vg(p)&&Vg(v)?s({id:o,items:f,activeIndex:p,overIndex:v}):j,J=P==null?void 0:P.id,ne=O.useRef({activeId:J,items:f,newIndex:re,containerId:d}),te=f!==ne.current.items,se=e({active:P,containerId:d,isDragging:W,isSorting:U,id:o,index:j,items:f,newIndex:ne.current.newIndex,previousItems:ne.current.items,previousContainerId:ne.current.containerId,transition:u,wasDragging:ne.current.activeId!=null}),ve=oOe({disabled:!se,index:j,node:A,rect:E});return O.useEffect(()=>{U&&ne.current.newIndex!==re&&(ne.current.newIndex=re),d!==ne.current.containerId&&(ne.current.containerId=d),f!==ne.current.items&&(ne.current.items=f)},[U,re,d,f]),O.useEffect(()=>{if(J===ne.current.activeId)return;if(J!=null&&ne.current.activeId==null){ne.current.activeId=J;return}const ye=setTimeout(()=>{ne.current.activeId=J},50);return()=>clearTimeout(ye)},[J]),{active:P,activeIndex:p,attributes:$,data:k,rect:E,index:j,newIndex:re,items:f,isOver:T,isSorting:U,isDragging:W,listeners:z,node:A,overIndex:v,over:K,setNodeRef:D,setActivatorNodeRef:q,setDroppableNodeRef:M,setDraggableNodeRef:F,transform:ve??Y,transition:ie()};function ie(){if(ve||te&&ne.current.newIndex===j)return iOe;if(!(ee&&!$x(R)||!u)&&(U||se))return Rs.Transition.toString({...u,property:ZH})}}function aOe(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t==null?void 0:t.draggable)!=null?r:e.draggable,droppable:(n=t==null?void 0:t.droppable)!=null?n:e.droppable}}vt.Down,vt.Right,vt.Up,vt.Left;function lOe({item:t,isEditing:e,onUpdate:r,onDelete:n}){const[i,s]=O.useState(t.text),[o,l]=O.useState(!1),{attributes:c,listeners:u,setNodeRef:f,transform:d,transition:p,isDragging:m}=KC({id:t.id}),x={transform:Rs.Transform.toString(d),transition:p},y=()=>{i.trim()&&r(t.id,i.trim()),l(!1)},v=()=>{s(t.text),l(!1)},b=w=>{w.key==="Enter"?(w.preventDefault(),y()):w.key==="Escape"&&v()};return a.jsxs("li",{ref:f,style:x,className:ge("flex items-center group relative py-2 px-1 rounded transition-colors",m&&"opacity-50",e&&"hover:bg-gray-50"),children:[e&&a.jsx("button",{...c,...u,className:"opacity-0 group-hover:opacity-100 mr-2 p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:"Drag to reorder",children:a.jsx(DB,{className:"w-4 h-4"})}),a.jsx("div",{className:"flex-1 min-w-0",children:o&&e?a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ct,{value:i,onChange:w=>s(w.target.value),onKeyDown:b,className:"text-sm",autoFocus:!0,placeholder:"Enter list item text..."}),a.jsx(fe,{onClick:y,size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-green-600 hover:text-green-700 hover:bg-green-50",children:a.jsx(ko,{className:"w-4 h-4"})}),a.jsx(fe,{onClick:v,size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:a.jsx($r,{className:"w-4 h-4"})})]}):a.jsxs("div",{className:"flex items-center justify-between group",children:[a.jsx("span",{className:"text-gray-700 leading-relaxed break-words",children:t.html?a.jsx("span",{dangerouslySetInnerHTML:{__html:t.html}}):t.text}),e&&a.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center space-x-1 ml-2",children:[a.jsx(fe,{onClick:()=>l(!0),size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Edit item",children:a.jsx(yo,{className:"w-3 h-3"})}),a.jsx(fe,{onClick:()=>n(t.id),size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete item",children:a.jsx(RO,{className:"w-3 h-3"})})]})]})})]})}function cOe({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n}){var w;const i=t.content,{type:s="unordered",items:o=[]}=i||{},[l,c]=O.useState(null),u=Fx(Bx(Ad,{activationConstraint:{distance:8}})),f=O.useCallback(N=>{n&&n({...i,...N})},[i,n]),d=()=>{const j={id:`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:"New item"};f({items:[...o,j]})},p=(N,j)=>{const k=o.map(_=>_.id===N?{..._,text:j}:_);f({items:k})},m=N=>{const j=o.filter(k=>k.id!==N);f({items:j})},x=()=>{f({type:s==="ordered"?"unordered":"ordered"})},y=N=>{const{active:j,over:k}=N;if(k&&j.id!==k.id){const _=o.findIndex(A=>A.id===j.id),E=o.findIndex(A=>A.id===k.id);if(_!==-1&&E!==-1){const A=Td(o,_,E);f({items:A})}}c(null)},v=s==="ordered"?"ol":"ul",b=ge("space-y-1 pl-6",s==="ordered"?"list-decimal":"list-disc");return o.length===0&&!e?a.jsx("div",{className:"text-gray-400 italic py-4",children:"No list items"}):a.jsxs("div",{className:ge("space-y-3",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg p-3"),children:[e&&r&&a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(fe,{onClick:x,size:"sm",variant:"outline",className:"flex items-center space-x-2",children:s==="ordered"?a.jsxs(a.Fragment,{children:[a.jsx(MO,{className:"w-4 h-4"}),a.jsx("span",{children:"Numbered"})]}):a.jsxs(a.Fragment,{children:[a.jsx(rs,{className:"w-4 h-4"}),a.jsx("span",{children:"Bulleted"})]})}),a.jsxs("span",{className:"text-sm text-gray-500",children:[o.length," ",o.length===1?"item":"items"]})]}),a.jsxs(fe,{onClick:d,size:"sm",className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add Item"})]})]}),o.length>0&&a.jsxs(Ux,{sensors:u,onDragStart:N=>c(N.active.id),onDragEnd:y,children:[a.jsx(v,{className:b,children:a.jsx(Wx,{items:o.map(N=>N.id),strategy:Hx,children:o.map(N=>a.jsx(lOe,{item:N,isEditing:e&&r,onUpdate:p,onDelete:m},N.id))})}),a.jsx(VC,{children:l?a.jsx("div",{className:"bg-white border border-gray-300 rounded px-3 py-2 shadow-lg",children:(w=o.find(N=>N.id===l))==null?void 0:w.text}):null})]}),o.length===0&&e&&r&&a.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(rs,{className:"w-8 h-8 text-gray-400 mx-auto mb-3"}),a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"No list items yet"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Add your first list item to get started"}),a.jsxs(fe,{onClick:d,size:"sm",className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add First Item"})]})]})]})}const uOe=Mi(cOe),Ai=O.forwardRef(({className:t,...e},r)=>a.jsx("textarea",{className:ge("flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));Ai.displayName="Textarea";function dOe({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n}){const i=t.content,{text:s="",author:o="",source:l=""}=i||{},[c,u]=O.useState(s),[f,d]=O.useState(o||""),[p,m]=O.useState(l||""),[x,y]=O.useState(!1);O.useEffect(()=>{u(s),d(o||""),m(l||"")},[s,o,l]);const v=()=>{c.trim()&&n&&n({text:c.trim(),author:f.trim()||void 0,source:p.trim()||void 0}),y(!1)},b=()=>{u(s),d(o||""),m(l||""),y(!1)},w=j=>{j.key==="Escape"&&b()},N=j=>{j.key==="Enter"?(j.preventDefault(),v()):j.key==="Escape"&&b()};return!s&&!e?a.jsx("div",{className:"text-gray-400 italic py-4",children:"No quote text"}):a.jsxs("div",{className:ge("relative",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg p-3"),children:[x&&e&&r?a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quote Text *"}),a.jsx(Ai,{value:c,onChange:j=>u(j.target.value),onKeyDown:w,placeholder:"Enter the quote text here...",className:"min-h-[100px] resize-none",autoFocus:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(zB,{className:"w-4 h-4 inline mr-1"}),"Author (Optional)"]}),a.jsx(ct,{value:f,onChange:j=>d(j.target.value),onKeyDown:N,placeholder:"e.g., Albert Einstein",className:"text-sm"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(E0,{className:"w-4 h-4 inline mr-1"}),"Source (Optional)"]}),a.jsx(ct,{value:p,onChange:j=>m(j.target.value),onKeyDown:N,placeholder:"e.g., Theory of Relativity",className:"text-sm"})]})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200",children:[a.jsxs(fe,{onClick:b,size:"sm",variant:"outline",className:"flex items-center space-x-2",children:[a.jsx($r,{className:"w-4 h-4"}),a.jsx("span",{children:"Cancel"})]}),a.jsxs(fe,{onClick:v,size:"sm",disabled:!c.trim(),className:"flex items-center space-x-2",children:[a.jsx(ko,{className:"w-4 h-4"}),a.jsx("span",{children:"Save Quote"})]})]})]})}):a.jsxs("blockquote",{className:"relative border-l-4 border-blue-500 bg-blue-50 py-4 px-6 my-6 group",children:[e&&r&&a.jsx(fe,{onClick:()=>y(!0),size:"sm",variant:"outline",className:"absolute -top-2 -right-2 opacity-0 group-hover:opacity-100 transition-opacity bg-white border-gray-300 hover:bg-gray-50 shadow-lg h-8 w-8 p-0",title:"Edit quote",children:a.jsx(yo,{className:"w-4 h-4"})}),a.jsxs("div",{className:"relative",children:[a.jsx("svg",{className:"absolute top-0 left-0 transform -translate-x-2 -translate-y-2 h-8 w-8 text-blue-500",fill:"currentColor",viewBox:"0 0 32 32",children:a.jsx("path",{d:"M9.352 4c4.456 0 8.064 3.84 8.064 8.352 0 4.448-3.608 8.064-8.064 8.064a7.12 7.12 0 01-.448-.032c1.216-1.344 1.888-3.136 1.888-5.12 0-3.584-2.848-6.464-6.464-6.464a7.12 7.12 0 01-.448.032c1.216 1.344 1.888 3.136 1.888 5.12 0 3.584-2.848 6.464-6.464 6.464v-1.6c2.752 0 4.864-2.112 4.864-4.864 0-2.688-2.176-4.864-4.864-4.864V4h10.048z"})}),a.jsx("div",{className:"pl-6",children:s?a.jsx("p",{className:"text-gray-800 text-lg leading-relaxed italic whitespace-pre-wrap",children:s}):a.jsx("p",{className:"text-gray-400 text-lg leading-relaxed italic",children:"Click to add quote text..."})}),(o||l)&&a.jsx("footer",{className:"mt-4 pl-6",children:a.jsxs("cite",{className:"text-gray-600 text-sm not-italic",children:[o&&a.jsx("span",{className:"font-medium",children:o}),o&&l&&a.jsx("span",{className:"mx-1",children:"•"}),l&&a.jsx("span",{children:l})]})})]})]}),!s&&e&&r&&!x&&a.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>y(!0),children:[a.jsx(xy,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Add an Inspirational Quote"}),a.jsx("p",{className:"text-gray-500 mb-4 max-w-sm mx-auto",children:"Share wisdom, motivation, or insights with a beautifully formatted quote block."}),a.jsxs(fe,{onClick:j=>{j.stopPropagation(),y(!0)},className:"flex items-center space-x-2",children:[a.jsx(xy,{className:"w-4 h-4"}),a.jsx("span",{children:"Add Quote"})]})]})]})}const fOe=Mi(dOe);function hOe({block:t}){return a.jsx("div",{className:"flex items-center justify-center my-8",children:a.jsx("hr",{className:"flex-grow border-t border-gray-300"})})}const pOe=Mi(hOe);function mOe({onSelect:t,selectedContentType:e="video",allowedTypes:r=["video","document","prompt","automation","ai_agent"],multiSelect:n=!1}){const[i,s]=O.useState(e),[o,l]=O.useState("grid"),[c,u]=O.useState(""),[f,d]=O.useState("updated_at"),[p,m]=O.useState("desc"),[x,y]=O.useState([]),[v,b]=O.useState(""),[w,N]=O.useState(!1),[j,k]=O.useState([]),[_,E]=O.useState(0),[A,T]=O.useState(0),[M,P]=O.useState([]),[R,L]=O.useState(!1),[$,F]=O.useState([]),z=20,W={video:{icon:si,label:"Videos",color:"text-red-600"},document:{icon:Ot,label:"Documents",color:"text-blue-600"},prompt:{icon:Gr,label:"Prompts",color:"text-green-600"},automation:{icon:Ei,label:"Automations",color:"text-yellow-600"},ai_agent:{icon:Kr,label:"AI Agents",color:"text-purple-600"}},K=H=>({video:"videos",document:"documents",prompt:"prompts",automation:"automations",ai_agent:"ai_agents"})[H]||H,q=async(H=!1)=>{var Y;N(!0);try{const re=H?0:A,{data:J,error:ne}=await pe.functions.invoke("content-repository-manager",{body:{action:"list",contentType:K(i),searchQuery:c,filters:{tags:x,difficulty:v},sortBy:f,sortOrder:p,limit:z,offset:re}});if(ne){console.error("Failed to fetch content:",ne);return}const te=J.data;k(H||re===0?te.items||[]:se=>[...se,...te.items||[]]),E(((Y=te.pagination)==null?void 0:Y.total)||0),H&&T(0)}catch(re){console.error("Error fetching content:",re)}finally{N(!1)}},V=()=>{const H=A+z;T(H),q(!1)};O.useEffect(()=>{q(!0)},[i,c,x,v,f,p]);const D=H=>{if(n){const Y=M.includes(H.id)?M.filter(re=>re!==H.id):[...M,H.id];P(Y)}else t(H)},U=H=>{y(Y=>Y.includes(H)?Y.filter(re=>re!==H):[...Y,H])},G=W[i],ee=G.icon,Q=A+z<_;return a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"border-b border-gray-200 px-4 py-3",children:a.jsx("div",{className:"flex flex-wrap gap-1",children:r.map(H=>{const Y=W[H],re=Y.icon;return a.jsxs("button",{onClick:()=>{s(H),u(""),y([]),T(0)},className:ge("flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200",i===H?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[a.jsx(re,{className:"w-4 h-4"}),a.jsx("span",{children:Y.label})]},H)})})}),a.jsxs("div",{className:"border-b border-gray-200 px-4 py-3 space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx(ct,{placeholder:`Search ${G.label.toLowerCase()}...`,value:c,onChange:H=>u(H.target.value),className:"pl-10 pr-10"}),c&&a.jsx("button",{onClick:()=>u(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:"×"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>L(!R),className:ge("flex items-center space-x-2",R&&"bg-gray-100"),children:[a.jsx(Ep,{className:"w-4 h-4"}),a.jsx("span",{children:"Filters"}),(x.length>0||v)&&a.jsx(At,{variant:"secondary",className:"text-xs",children:x.length+(v?1:0)})]}),a.jsxs("select",{value:`${f}-${p}`,onChange:H=>{const[Y,re]=H.target.value.split("-");d(Y),m(re)},className:"text-sm border border-gray-300 rounded-md px-3 py-1.5 bg-white",children:[a.jsx("option",{value:"updated_at-desc",children:"Recently Updated"}),a.jsx("option",{value:"created_at-desc",children:"Newest First"}),a.jsx("option",{value:"title-asc",children:"A-Z"}),a.jsx("option",{value:"title-desc",children:"Z-A"})]})]}),a.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>l("grid"),className:ge("p-1.5 rounded-md transition-colors",o==="grid"?"bg-white shadow-sm":"hover:bg-gray-200"),children:a.jsx(dd,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>l("list"),className:ge("p-1.5 rounded-md transition-colors",o==="list"?"bg-white shadow-sm":"hover:bg-gray-200"),children:a.jsx(rs,{className:"w-4 h-4"})})]})]}),R&&a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["beginner","intermediate","advanced"].map(H=>a.jsx("button",{onClick:()=>b(v===H?"":H),className:ge("px-3 py-1.5 text-sm rounded-full border transition-colors",v===H?"bg-blue-100 border-blue-300 text-blue-700":"border-gray-300 text-gray-600 hover:border-gray-400"),children:H.charAt(0).toUpperCase()+H.slice(1)},H))})]}),$.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:$.slice(0,10).map(H=>a.jsx("button",{onClick:()=>U(H),className:ge("px-3 py-1.5 text-sm rounded-full border transition-colors",x.includes(H)?"bg-blue-100 border-blue-300 text-blue-700":"border-gray-300 text-gray-600 hover:border-gray-400"),children:H},H))})]}),(x.length>0||v)&&a.jsx("div",{className:"flex justify-end",children:a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>{y([]),b("")},children:"Clear All Filters"})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:w&&j.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-48",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsxs("p",{className:"text-gray-600",children:["Loading ",G.label.toLowerCase(),"..."]})]}):j.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center",children:[a.jsx(ee,{className:ge("w-12 h-12 mb-4",G.color)}),a.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:["No ",G.label.toLowerCase()," found"]}),a.jsx("p",{className:"text-gray-500 text-sm",children:c||x.length>0||v?"Try adjusting your search or filters":`No ${G.label.toLowerCase()} available yet`})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:ge(o==="grid"?"grid grid-cols-2 gap-4":"space-y-3"),children:j.map(H=>a.jsx("div",{onClick:()=>D(H),className:ge("border border-gray-200 rounded-lg transition-all duration-200 cursor-pointer hover:shadow-md",M.includes(H.id)&&"border-blue-500 bg-blue-50",o==="grid"?"p-4":"p-3 flex items-center space-x-4"),children:o==="grid"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg mb-3 flex items-center justify-center overflow-hidden",children:H.thumbnail_url||H.file_url?a.jsx("img",{src:H.thumbnail_url||H.file_url,alt:H.title,className:"w-full h-full object-cover"}):a.jsx(ee,{className:ge("w-8 h-8",G.color)})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 text-sm line-clamp-2 mb-1",children:H.title}),H.description&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-2",children:H.description}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(go,{className:"w-3 h-3"}),a.jsx("span",{children:new Date(H.updated_at).toLocaleDateString()})]}),H.status&&a.jsx(At,{variant:H.status==="published"?"default":"secondary",className:"text-xs",children:H.status})]}),H.tags&&H.tags.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[H.tags.slice(0,2).map(Y=>a.jsx(At,{variant:"outline",className:"text-xs",children:Y},Y)),H.tags.length>2&&a.jsxs("span",{className:"text-xs text-gray-500",children:["+",H.tags.length-2]})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0 overflow-hidden",children:H.thumbnail_url||H.file_url?a.jsx("img",{src:H.thumbnail_url||H.file_url,alt:H.title,className:"w-full h-full object-cover"}):a.jsx(ee,{className:ge("w-5 h-5",G.color)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:H.title}),H.description&&a.jsx("p",{className:"text-xs text-gray-600 truncate mt-1",children:H.description})]}),H.status&&a.jsx(At,{variant:H.status==="published"?"default":"secondary",className:"text-xs ml-2 flex-shrink-0",children:H.status})]}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("div",{className:"flex items-center space-x-3 text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(go,{className:"w-3 h-3"}),a.jsx("span",{children:new Date(H.updated_at).toLocaleDateString()})]}),H.difficulty_level&&a.jsx(At,{variant:"outline",className:"text-xs",children:H.difficulty_level})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(ii,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(Os,{className:"w-4 h-4"})})]})]})]})]})},H.id))}),Q&&a.jsx("div",{className:"flex justify-center mt-6",children:a.jsx(fe,{variant:"outline",onClick:V,disabled:w,className:"flex items-center space-x-2",children:w?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):a.jsx("span",{children:"Load More"})})})]})}),a.jsxs("div",{className:"border-t border-gray-200 px-4 py-3 text-xs text-gray-500",children:["Showing ",j.length," of ",_," ",G.label.toLowerCase(),n&&M.length>0&&a.jsxs("span",{className:"ml-2",children:["• ",M.length," selected"]})]})]})}function GC({isOpen:t,onClose:e,onSelect:r,contentType:n="video",allowedTypes:i=["video","document","prompt","automation","ai_agent"],title:s="Select Content",description:o="Choose content from your library",multiSelect:l=!1}){const[c,u]=O.useState([]);O.useEffect(()=>{t||u([])},[t]);const f=p=>{l?u(m=>m.find(y=>y.id===p.id)?m.filter(y=>y.id!==p.id):[...m,p]):(r(p),e())},d=()=>{c.length>0&&(r(l?c:c[0]),e())};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s}),o&&a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:o})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-2",children:a.jsx($r,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(mOe,{onSelect:f,selectedContentType:n,allowedTypes:i,multiSelect:l})}),a.jsx("div",{className:"border-t border-gray-200 px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-gray-500",children:l&&c.length>0&&a.jsxs("span",{children:[c.length," item",c.length!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(fe,{variant:"outline",onClick:e,children:"Cancel"}),l&&a.jsxs(fe,{onClick:d,disabled:c.length===0,children:["Select ",c.length>0?`(${c.length})`:""]})]})]})})]})}):null}async function ml(t,e={}){const{search:r,status:n="published",limit:i=20,offset:s=0,sortBy:o="updated_at",sortOrder:l="desc"}=e;let c=pe.from("content_items").select("*").eq("content_type",t);n!=="all"&&(c=c.eq("status",n)),r!=null&&r.trim()&&(c=c.or(`title.ilike.%${r}%,description.ilike.%${r}%`)),c=c.order(o,{ascending:l==="asc"}),c=c.range(s,s+i-1);const{data:u,error:f,count:d}=await c;if(f)throw console.error("Error fetching content items:",f),f;if(!u||u.length===0)return{items:[],total:d||0};let p;const m=u.map(b=>b.id);switch(t){case"ai_agent":p=pe.from("ai_agents").select("content_item_id, agent_name, short_description").in("content_item_id",m);break;case"video":p=pe.from("videos").select("content_item_id, video_platform, duration_seconds").in("content_item_id",m);break;case"document":p=pe.from("documents").select("content_item_id, word_count, reading_time_minutes").in("content_item_id",m);break;case"prompt":p=pe.from("prompts").select("content_item_id, prompt_category, usage_count").in("content_item_id",m);break;case"automation":p=pe.from("automations").select("content_item_id, required_tools").in("content_item_id",m);break}const{data:x,error:y}=await p;return y&&console.error("Error fetching metadata:",y),{items:u.map(b=>{const w=x==null?void 0:x.find(N=>N.content_item_id===b.id);return{...b,metadata:w?{...w,content_item_id:void 0}:void 0}}),total:d||0}}const gOe={async getAIAgents(t){return ml("ai_agent",t)},async getVideos(t){return ml("video",t)},async getDocuments(t){return ml("document",t)},async getPrompts(t){return ml("prompt",t)},async getAutomations(t){return ml("automation",t)},async getContentByType(t,e){return ml(t,e)},async getContentById(t,e){const{data:r,error:n}=await pe.from("content_items").select("*").eq("id",e).eq("content_type",t).maybeSingle();if(n)throw console.error("Error fetching content item:",n),n;if(!r)return null;let i;switch(t){case"ai_agent":i=pe.from("ai_agents").select("agent_name, short_description").eq("content_item_id",e).maybeSingle();break;case"video":i=pe.from("videos").select("video_platform, duration_seconds").eq("content_item_id",e).maybeSingle();break;case"document":i=pe.from("documents").select("word_count, reading_time_minutes").eq("content_item_id",e).maybeSingle();break;case"prompt":i=pe.from("prompts").select("prompt_category, usage_count").eq("content_item_id",e).maybeSingle();break;case"automation":i=pe.from("automations").select("required_tools").eq("content_item_id",e).maybeSingle();break}const{data:s}=await i||{data:null};return{...r,metadata:s||void 0}},async searchAllContent(t,e){const{contentTypes:r=["ai_agent","video","document","prompt","automation"],status:n="published",limit:i=5}=e||{},s=await Promise.all(r.map(async l=>{const{items:c}=await ml(l,{search:t,status:n,limit:i,sortBy:"updated_at",sortOrder:"desc"});return{type:l,items:c}})),o={};return s.forEach(({type:l,items:c})=>{o[l]=c}),o}},uy={formatDuration(t){if(!t)return"Unknown duration";const e=Math.floor(t/3600),r=Math.floor(t%3600/60),n=t%60;return e>0?`${e}:${r.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${r}:${n.toString().padStart(2,"0")}`},formatReadingTime(t){return t?t<1?"< 1 min read":`${t} min read`:"Unknown reading time"},formatWordCount(t){return t?t<1e3?`${t} words`:`${(t/1e3).toFixed(1)}k words`:"Unknown length"},getContentTypeInfo(t){return{ai_agent:{label:"AI Agent",icon:"Bot",color:"#3B82F6"},video:{label:"Video",icon:"Play",color:"#EF4444"},document:{label:"Document",icon:"FileText",color:"#10B981"},prompt:{label:"Prompt",icon:"MessageSquare",color:"#8B5CF6"},automation:{label:"Automation",icon:"Zap",color:"#F59E0B"}}[t]||{label:t,icon:"File",color:"#6B7280"}},generatePreviewText(t){const{content_type:e,metadata:r,description:n}=t;if(n&&n.length>100)return n.substring(0,100)+"...";if(n)return n;switch(e){case"ai_agent":return(r==null?void 0:r.short_description)||"AI agent for automated conversations and assistance";case"video":const i=r==null?void 0:r.duration_seconds,s=(r==null?void 0:r.video_platform)||"video";return`${s.charAt(0).toUpperCase()+s.slice(1)} - ${uy.formatDuration(i)}`;case"document":const o=r==null?void 0:r.word_count,l=r==null?void 0:r.reading_time_minutes;return`${uy.formatWordCount(o)} • ${uy.formatReadingTime(l)}`;case"prompt":const c=r==null?void 0:r.prompt_category,u=(r==null?void 0:r.usage_count)||0;return`${c?c+" • ":""}Used ${u} times`;case"automation":const f=r==null?void 0:r.required_tools;return f&&f.length>0?`Requires: ${f.slice(0,2).join(", ")}${f.length>2?`+${f.length-2} more`:""}`:"Process automation workflow";default:return"Content item"}}},gl={video:{label:"Videos",icon:({className:t})=>a.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M2 6a2 2 0 012-2h6l2 2h6a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"})}),color:"#EF4444",bgColor:"#FEF2F2",description:"Video content and tutorials",extensions:["mp4","avi","mov","wmv"]},document:{label:"Documents",icon:({className:t})=>a.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-5L9 2H4z",clipRule:"evenodd"})}),color:"#10B981",bgColor:"#ECFDF5",description:"PDFs, guides and documentation",extensions:["pdf","doc","docx"]},ai_agent:{label:"AI Agents",icon:({className:t})=>a.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),color:"#3B82F6",bgColor:"#EFF6FF",description:"Interactive AI assistants",extensions:[]},prompt:{label:"Prompts",icon:({className:t})=>a.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z",clipRule:"evenodd"})}),color:"#8B5CF6",bgColor:"#F3E8FF",description:"Reusable prompt templates",extensions:[]},automation:{label:"Automations",icon:({className:t})=>a.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.477.859h4z"})}),color:"#F59E0B",bgColor:"#FFFBEB",description:"Workflow automations",extensions:[]}};function yOe({onSelect:t,onUpload:e,allowUpload:r=!1,multiSelect:n=!1,className:i}){const[s,o]=O.useState("folders"),[l,c]=O.useState(null),[u,f]=O.useState(["Content Repository"]),[d,p]=O.useState([]),[m,x]=O.useState(!1),[y,v]=O.useState(null),[b,w]=O.useState("tiles"),[N,j]=O.useState(""),[k,_]=O.useState("updated_at"),[E,A]=O.useState("desc"),[T,M]=O.useState([]),[P,R]=O.useState(!1),[L,$]=O.useState(!1),F=Object.entries(gl).map(([H,Y])=>({id:H,name:Y.label,contentType:H,itemCount:0,lastModified:new Date().toISOString(),color:Y.color,icon:Y.icon})),z=O.useCallback(async H=>{if(H){x(!0),v(null);try{const{items:Y}=await gOe.getContentByType(H,{search:N,status:"all",sortBy:k==="content_type"?"title":k,sortOrder:E,limit:50});p(Y)}catch(Y){console.error("Error fetching content:",Y),v("Failed to load content. Please try again."),p([])}finally{x(!1)}}},[N,k,E]),W=H=>{c(H.contentType),o("content"),f(["Content Repository",H.name]),z(H.contentType)},K=()=>{s==="content"&&(o("folders"),c(null),f(["Content Repository"]),p([]),M([]))},q=async()=>{l&&($(!0),await z(l),$(!1))},V=H=>{n?M(Y=>Y.includes(H.id)?Y.filter(J=>J!==H.id):[...Y,H.id]):t==null||t(H)},D=Z.useMemo(()=>{let H=[...d];if(N.trim()){const Y=N.toLowerCase();H=H.filter(re=>{var J;return re.title.toLowerCase().includes(Y)||((J=re.description)==null?void 0:J.toLowerCase().includes(Y))})}return H},[d,N]),U=()=>a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4",children:[a.jsx(PO,{className:"w-4 h-4"}),u.map((H,Y)=>a.jsxs(Z.Fragment,{children:[Y>0&&a.jsx(jh,{className:"w-4 h-4"}),a.jsx("span",{className:ge(Y===u.length-1?"text-gray-900 font-medium":"hover:text-gray-900 cursor-pointer"),onClick:Y===0?K:void 0,children:H})]},Y))]}),G=()=>{var H;return a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[s==="content"&&a.jsxs(fe,{variant:"outline",size:"sm",onClick:K,className:"flex items-center space-x-2",children:[a.jsx(lo,{className:"w-4 h-4"}),a.jsx("span",{children:"Back"})]}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx(ct,{placeholder:`Search ${s==="folders"?"content":(H=gl[l])==null?void 0:H.label.toLowerCase()}...`,value:N,onChange:Y=>j(Y.target.value),className:"pl-10"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[s==="content"&&a.jsxs(fe,{variant:"outline",size:"sm",onClick:q,disabled:L,className:"flex items-center space-x-2",children:[a.jsx(IO,{className:ge("w-4 h-4",L&&"animate-spin")}),a.jsx("span",{children:"Refresh"})]}),r&&l&&a.jsxs(fe,{size:"sm",className:"flex items-center space-x-2",style:{backgroundColor:gl[l].color},children:[a.jsx(Ir,{className:"w-4 h-4"}),a.jsx("span",{children:"Upload"})]}),a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>w("tiles"),className:ge("p-2 rounded-md transition-colors",b==="tiles"?"bg-white shadow-sm":"hover:bg-gray-200"),title:"Tile view",children:a.jsx(dd,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>w("list"),className:ge("p-2 rounded-md transition-colors",b==="list"?"bg-white shadow-sm":"hover:bg-gray-200"),title:"List view",children:a.jsx(rs,{className:"w-4 h-4"})})]})]})]})},ee=()=>a.jsx("div",{className:ge("grid gap-6",b==="tiles"?"grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"grid-cols-1"),children:F.map(H=>{const Y=H.icon;return a.jsxs("div",{onClick:()=>W(H),className:ge("group relative border border-gray-200 rounded-xl transition-all duration-200 cursor-pointer hover:shadow-lg hover:border-gray-300",b==="tiles"?"p-6 text-center":"p-4 flex items-center space-x-4"),style:{backgroundColor:H.color+"08"},children:[a.jsx("div",{className:ge("flex items-center justify-center rounded-lg transition-transform group-hover:scale-110",b==="tiles"?"w-16 h-16 mx-auto mb-4":"w-12 h-12 flex-shrink-0"),style:{backgroundColor:H.color+"20"},children:a.jsx(Y,{className:"w-8 h-8",style:{color:H.color}})}),a.jsxs("div",{className:ge(b==="list"&&"flex-1"),children:[a.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-gray-700 transition-colors",children:H.name}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:gl[H.contentType].description}),a.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-2 text-xs text-gray-500",children:[a.jsxs("span",{children:[H.itemCount," items"]}),a.jsx("span",{children:"•"}),a.jsx("span",{children:"Updated today"})]})]})]},H.id)})}),Q=()=>{var H;if(m)return a.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[a.jsx(cr,{size:"lg"}),a.jsxs("p",{className:"text-gray-600 mt-4",children:["Loading ",(H=gl[l])==null?void 0:H.label.toLowerCase(),"..."]})]});if(y)return a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"text-red-500 mb-4",children:a.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Content"}),a.jsx("p",{className:"text-gray-600 mb-4",children:y}),a.jsx(fe,{onClick:q,children:"Try Again"})]});if(D.length===0){const Y=gl[l];return a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"mb-4",style:{color:Y.color},children:a.jsx(Y.icon,{className:"w-12 h-12 mx-auto"})}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",Y.label.toLowerCase()," found"]}),a.jsx("p",{className:"text-gray-600 mb-6",children:N?`No ${Y.label.toLowerCase()} match your search"${N}"`:`Start by uploading your first ${Y.label.toLowerCase().slice(0,-1)}`}),r&&a.jsxs(fe,{className:"flex items-center space-x-2",style:{backgroundColor:Y.color},children:[a.jsx(Ir,{className:"w-4 h-4"}),a.jsxs("span",{children:["Upload ",Y.label.slice(0,-1)]})]})]})}return a.jsx("div",{className:ge("grid gap-4",b==="tiles"?"grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"grid-cols-1"),children:D.map(Y=>{const re=T.includes(Y.id),J=gl[l];return a.jsx("div",{onClick:()=>V(Y),className:ge("group border border-gray-200 rounded-lg transition-all duration-200 cursor-pointer hover:shadow-md",re&&"border-blue-500 bg-blue-50",b==="tiles"?"p-4":"p-3 flex items-center space-x-4"),children:b==="tiles"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg mb-3 flex items-center justify-center overflow-hidden",children:Y.thumbnail_url?a.jsx("img",{src:Y.thumbnail_url,alt:Y.title,className:"w-full h-full object-cover"}):a.jsx(J.icon,{className:"w-8 h-8",style:{color:J.color}})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 line-clamp-2 mb-1",children:Y.title}),Y.description&&a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:Y.description}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[a.jsx("span",{children:new Date(Y.updated_at).toLocaleDateString()}),a.jsx(At,{variant:Y.status==="published"?"default":"secondary",className:"text-xs",children:Y.status})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(J.icon,{className:"w-5 h-5",style:{color:J.color}})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:Y.title}),Y.description&&a.jsx("p",{className:"text-sm text-gray-600 truncate",children:Y.description})]}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[a.jsx(At,{variant:Y.status==="published"?"default":"secondary",className:"text-xs",children:Y.status}),a.jsx("span",{children:new Date(Y.updated_at).toLocaleDateString()})]})]})},Y.id)})})};return a.jsxs("div",{className:ge("h-full flex flex-col bg-white",i),children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[U(),G()]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s==="folders"?ee():Q()}),n&&T.length>0&&a.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-sm text-gray-700",children:[T.length," item",T.length!==1?"s":""," selected"]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>M([]),children:"Clear Selection"}),a.jsx(fe,{size:"sm",onClick:()=>{const H=D.filter(Y=>T.includes(Y.id));t==null||t(H[0])},children:"Use Selected"})]})]})})]})}const Q6={video:UB,document:Ot,ai_agent:Kr,prompt:Gr,automation:Ei};function eW({isOpen:t,onClose:e,onSelect:r,contentType:n,allowedTypes:i,title:s="Select Content",description:o="Choose content from your library",multiSelect:l=!1,allowUpload:c=!1,className:u}){const[f,d]=O.useState([]),[p,m]=O.useState(!1),[x,y]=O.useState(!1);if(!t)return null;const v=_=>{if(l){const E=f.find(A=>A.id===_.id);d(E?A=>A.filter(T=>T.id!==_.id):A=>[...A,_])}else r(_),e()},b=()=>{f.length>0&&(r(l?f:f[0]),e())},w=_=>{console.log("Files to upload:",_),m(!1)},N=_=>{_.preventDefault(),y(!0)},j=_=>{_.preventDefault(),y(!1)},k=_=>{_.preventDefault(),y(!1);const E=Array.from(_.dataTransfer.files);E.length>0&&w(E)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:ge("bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[85vh] flex flex-col overflow-hidden",u),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:n&&Q6[n]?Z.createElement(Q6[n],{className:"w-6 h-6 text-white"}):a.jsx(Ot,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s}),o&&a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:o})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[c&&a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>m(!p),className:ge("flex items-center space-x-2",p&&"bg-blue-50 border-blue-300 text-blue-700"),children:[a.jsx(Ir,{className:"w-4 h-4"}),a.jsx("span",{children:"Upload"})]}),a.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx($r,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"flex-1 overflow-hidden relative",children:p?a.jsx("div",{className:ge("h-full flex items-center justify-center border-2 border-dashed border-gray-300 m-6 rounded-xl transition-colors",x&&"border-blue-500 bg-blue-50"),onDragOver:N,onDragLeave:j,onDrop:k,children:a.jsxs("div",{className:"text-center p-8",children:[a.jsx(Ir,{className:"w-16 h-16 mx-auto mb-6 text-gray-400"}),a.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Upload New Content"}),a.jsx("p",{className:"text-gray-600 mb-6 max-w-md",children:"Drag and drop your files here, or click to browse and select files from your computer."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(fe,{className:"flex items-center space-x-2",children:[a.jsx(Ir,{className:"w-4 h-4"}),a.jsx("span",{children:"Choose Files"})]}),n&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Supported formats: ",vOe(n).join(", ")]})]})]})}):a.jsx(yOe,{onSelect:v,multiSelect:l,allowUpload:!1,className:"h-full"})}),a.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[l&&f.length>0&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:f.length}),a.jsxs("span",{className:"text-sm text-gray-700",children:[f.length," item",f.length!==1?"s":""," selected"]})]}),p&&a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>m(!1),children:"Back to Library"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(fe,{variant:"outline",onClick:e,children:"Cancel"}),l&&f.length>0&&!p&&a.jsx(fe,{onClick:b,className:"flex items-center space-x-2",children:a.jsxs("span",{children:["Select (",f.length,")"]})})]})]})})]})})}function vOe(t){return{video:["MP4","AVI","MOV","WMV","MKV"],document:["PDF","DOC","DOCX","TXT"],ai_agent:["JSON","YAML"],prompt:["TXT","MD"],automation:["JSON","YAML","JS"]}[t]||["All files"]}function xOe({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n,onSelect:i,onEdit:s,className:o}){const[l,c]=O.useState(!1),[u,f]=O.useState(!1),d=t.content,{video_id:p,url:m,platform:x,title:y,description:v,thumbnail:b,duration:w,autoplay:N=!1,controls:j=!0}=d||{},k=T=>{var P,R,L;const M={video_id:T.id,title:T.title,description:T.description,thumbnail:T.thumbnail_url,platform:((P=T.metadata)==null?void 0:P.video_platform)||"internal",url:((R=T.metadata)==null?void 0:R.video_url)||T.file_url,duration:(L=T.metadata)==null?void 0:L.duration_seconds,autoplay:!1,controls:!0};n==null||n(M),c(!1)},_=()=>{n==null||n({})},E=()=>"aspect-video",A=()=>!p&&!m?a.jsx("div",{className:`${E()} bg-gray-100 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300`,children:a.jsxs("div",{className:"text-center",children:[a.jsx(Fw,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Add Video Content"}),a.jsx("p",{className:"text-gray-600 mb-4 max-w-sm",children:"Select a video from your content library to embed in this block."}),e&&a.jsxs(fe,{onClick:()=>c(!0),className:"flex items-center space-x-2",children:[a.jsx(si,{className:"w-4 h-4"}),a.jsx("span",{children:"Select Video"})]})]})}):a.jsxs("div",{className:"space-y-4",children:[y&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:y}),v&&a.jsx("p",{className:"text-gray-600 text-sm",children:v})]}),a.jsxs("div",{className:`${E()} bg-black rounded-lg relative overflow-hidden group`,children:[a.jsx("div",{className:"absolute inset-0",children:b?a.jsx("img",{src:b,alt:y||"Video thumbnail",className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center",children:a.jsx(Fw,{className:"w-16 h-16 text-gray-400"})})}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("button",{onClick:()=>f(!0),className:"w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all duration-200 group-hover:scale-110",children:a.jsx(si,{className:"w-8 h-8 text-gray-800 ml-1",fill:"currentColor"})})}),e&&a.jsxs("div",{className:"absolute top-3 right-3 flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx(fe,{onClick:()=>c(!0),size:"sm",variant:"outline",className:"bg-white/90 hover:bg-white border-gray-300",children:a.jsx(Dn,{className:"w-4 h-4"})}),a.jsx(fe,{onClick:_,size:"sm",variant:"outline",className:"bg-white/90 hover:bg-white border-gray-300 text-red-600 hover:text-red-700",children:"×"})]}),w&&a.jsxs("div",{className:"absolute bottom-3 right-3 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm",children:[Math.floor(w/60),":",(w%60).toString().padStart(2,"0")]})]}),(x||w)&&a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[x&&a.jsxs("span",{className:"capitalize",children:[x," Video"]}),w&&a.jsxs("span",{children:["Duration: ",Math.floor(w/60),":",(w%60).toString().padStart(2,"0")]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>f(!0),className:"p-1 hover:text-gray-700 transition-colors",title:"View fullscreen",children:a.jsx(Jg,{className:"w-4 h-4"})}),m&&a.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"p-1 hover:text-gray-700 transition-colors",title:"Open in new tab",children:a.jsx(Os,{className:"w-4 h-4"})})]})]})]});return a.jsxs("div",{className:ge("relative",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg p-2",o),onClick:i,children:[A(),a.jsx(eW,{isOpen:l,onClose:()=>c(!1),onSelect:k,contentType:"video",title:"Select Video",description:"Choose a video to embed in this block",allowUpload:!0}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"relative w-full max-w-6xl",children:[a.jsx("button",{onClick:()=>f(!1),className:"absolute -top-12 right-0 text-white hover:text-gray-300 text-xl font-bold z-10",children:"×"}),a.jsx("div",{className:"aspect-video bg-black rounded-lg overflow-hidden",children:m?a.jsx("video",{src:m,controls:j,autoPlay:N,className:"w-full h-full",poster:b,children:"Your browser does not support the video tag."}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-white",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Fw,{className:"w-16 h-16 mx-auto mb-4"}),a.jsx("p",{children:"Video not available"})]})})}),y&&a.jsxs("div",{className:"mt-4 text-white text-center",children:[a.jsx("h3",{className:"text-xl font-semibold",children:y}),v&&a.jsx("p",{className:"text-gray-300 mt-2",children:v})]})]})})]})}function bOe({block:t,isSelected:e=!1,isEditing:r=!1,onSelect:n,onEdit:i,className:s}){const o=t.content,{agent_id:l,agent_name:c="AI Assistant",initial_message:u="Hello! How can I help you?",context:f,allowed_interactions:d=["chat"]}=o||{},[p,m]=O.useState([{id:"1",role:"assistant",content:u}]),[x,y]=O.useState(""),[v,b]=O.useState(!1),w=async()=>{if(!x.trim())return;const N={id:Date.now().toString(),role:"user",content:x};m(j=>[...j,N]),y(""),b(!0);try{await new Promise(k=>setTimeout(k,1e3));const j={id:(Date.now()+1).toString(),role:"assistant",content:`Thank you for your message: "${N.content}". I'm a simulated response from ${c}.`};m(k=>[...k,j])}catch(j){console.error("Failed to send message:",j)}finally{b(!1)}};return r&&!l?a.jsxs("div",{className:ge("border-2 border-dashed border-purple-300 rounded-lg p-8 text-center bg-purple-50",s),children:[a.jsx("div",{className:"text-purple-400 mb-4",children:a.jsx(Kr,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-purple-900 mb-2",children:"Select an AI Agent"}),a.jsx("p",{className:"text-purple-600 text-sm mb-4",children:"Choose an AI agent from your repository to embed here."}),a.jsxs(fe,{onClick:i,variant:"outline",size:"sm",className:"border-purple-300 text-purple-600 hover:bg-purple-100",children:[a.jsx(Dn,{className:"w-4 h-4 mr-2"}),"Configure Agent"]})]}):a.jsxs("div",{className:ge("border border-gray-200 rounded-lg bg-white max-w-2xl",e&&"ring-2 ring-blue-500",s),onClick:n,children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-blue-50",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:a.jsx(Kr,{className:"w-4 h-4 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:c}),a.jsx("p",{className:"text-xs text-gray-500",children:"AI Assistant"})]})]}),r&&a.jsx(fe,{onClick:i,variant:"ghost",size:"sm",children:a.jsx(Dn,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"p-4 h-64 overflow-y-auto space-y-3",children:[p.map(N=>a.jsx("div",{className:ge("flex",N.role==="user"?"justify-end":"justify-start"),children:a.jsx("div",{className:ge("max-w-xs lg:max-w-md px-3 py-2 rounded-lg text-sm",N.role==="user"?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"),children:N.content})},N.id)),v&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"bg-gray-100 px-3 py-2 rounded-lg",children:a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})]}),a.jsx("div",{className:"p-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(ct,{value:x,onChange:N=>y(N.target.value),onKeyPress:N=>N.key==="Enter"&&w(),placeholder:"Type your message...",disabled:v||!l,className:"flex-1"}),a.jsx(fe,{onClick:w,disabled:v||!x.trim()||!l,size:"sm",children:a.jsx($B,{className:"w-4 h-4"})})]})})]})}const wOe=Mi(bOe);function jOe({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n,onSelect:i,onEdit:s,className:o}){const[l,c]=O.useState(!1),[u,f]=O.useState(!1),[d,p]=O.useState(1),[m,x]=O.useState(1),[y,v]=O.useState(100),[b,w]=O.useState(0),[N,j]=O.useState(null),k=t.content,{document_id:_,title:E,excerpt:A,display_mode:T="embedded"}=k||{},M=V=>{var U;const D={document_id:V.id,title:V.title,excerpt:V.description||V.excerpt,display_mode:"embedded"};n==null||n(D),c(!1),j(V),(U=V.metadata)!=null&&U.total_pages&&x(V.metadata.total_pages)},P=()=>{d<m&&p(d+1)},R=()=>{d>1&&p(d-1)},L=()=>{y<200&&v(y+25)},$=()=>{y>50&&v(y-25)},F=()=>{w((b+90)%360)},z=()=>!_||!N?a.jsx("div",{className:"aspect-[3/4] bg-gray-100 rounded-lg flex items-center justify-center border border-gray-200",children:a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx(Ot,{className:"w-8 h-8 mx-auto mb-2"}),a.jsx("p",{className:"text-sm",children:"PDF preview unavailable"})]})}):a.jsxs("div",{className:"relative group",children:[a.jsxs("div",{className:"aspect-[3/4] bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-50",children:N.thumbnail_url?a.jsx("img",{src:N.thumbnail_url,alt:`Page ${d} of ${E}`,className:"max-w-full max-h-full object-contain",style:{transform:`rotate(${b}deg) scale(${y/100})`,transition:"transform 0.3s ease"}}):a.jsxs("div",{className:"text-center text-gray-400",children:[a.jsx(Ot,{className:"w-16 h-16 mx-auto mb-4"}),a.jsxs("p",{className:"text-lg font-medium",children:["Page ",d]}),a.jsx("p",{className:"text-sm",children:E})]})}),a.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[d>1&&a.jsx("button",{onClick:R,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-black bg-opacity-75 text-white p-2 rounded-full hover:bg-opacity-90 transition-colors",title:"Previous page",children:a.jsx(r_,{className:"w-4 h-4"})}),d<m&&a.jsx("button",{onClick:P,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-black bg-opacity-75 text-white p-2 rounded-full hover:bg-opacity-90 transition-colors",title:"Next page",children:a.jsx(jh,{className:"w-4 h-4"})}),a.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[a.jsx("button",{onClick:$,className:"bg-black bg-opacity-75 text-white p-1.5 rounded hover:bg-opacity-90 transition-colors",title:"Zoom out",disabled:y<=50,children:a.jsx(NM,{className:"w-3 h-3"})}),a.jsx("button",{onClick:L,className:"bg-black bg-opacity-75 text-white p-1.5 rounded hover:bg-opacity-90 transition-colors",title:"Zoom in",disabled:y>=200,children:a.jsx(SM,{className:"w-3 h-3"})}),a.jsx("button",{onClick:F,className:"bg-black bg-opacity-75 text-white p-1.5 rounded hover:bg-opacity-90 transition-colors",title:"Rotate 90°",children:a.jsx(bM,{className:"w-3 h-3"})})]}),a.jsx("button",{onClick:()=>f(!0),className:"absolute bottom-2 right-2 bg-black bg-opacity-75 text-white p-2 rounded hover:bg-opacity-90 transition-colors",title:"View fullscreen",children:a.jsx(Jg,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-3 px-1",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",d," of ",m]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[y,"% zoom"]})]}),m>1&&m<=10&&a.jsx("div",{className:"flex justify-center mt-2 space-x-1",children:Array.from({length:m},(V,D)=>a.jsx("button",{onClick:()=>p(D+1),className:ge("w-2 h-2 rounded-full transition-colors",d===D+1?"bg-blue-600":"bg-gray-300 hover:bg-gray-400"),title:`Go to page ${D+1}`},D))})]}),W=()=>{n==null||n({document_id:"",title:"",display_mode:"embedded"})},K=V=>{n==null||n({...k,display_mode:V})},q=()=>!_||!E?a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(Ot,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Add Document"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Select a document from your content library to embed in this block."}),e&&a.jsxs(fe,{onClick:()=>c(!0),className:"flex items-center space-x-2",children:[a.jsx(Zn,{className:"w-4 h-4"}),a.jsx("span",{children:"Select Document"})]})]}):a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden group hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ot,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:E}),A&&a.jsx("p",{className:"text-gray-600 text-sm line-clamp-3 mb-3",children:A}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(At,{variant:"outline",className:ge("text-xs",T==="embedded"&&"border-green-300 text-green-700",T==="modal"&&"border-blue-300 text-blue-700",T==="new_tab"&&"border-purple-300 text-purple-700"),children:[T==="embedded"&&"Embedded",T==="modal"&&"Modal View",T==="new_tab"&&"New Tab"]}),a.jsx("span",{className:"text-xs text-gray-500",children:"Document"})]})]})]}),e&&a.jsxs("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsxs(fe,{onClick:()=>c(!0),size:"sm",variant:"outline",className:"flex items-center space-x-1",children:[a.jsx(Dn,{className:"w-4 h-4"}),a.jsx("span",{children:"Change"})]}),a.jsx(fe,{onClick:W,size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 border-red-300",children:"×"})]})]})}),a.jsx("div",{className:"border-t border-gray-100 px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(fe,{onClick:()=>{T==="modal"?f(!0):T==="new_tab"&&window.open(`/content/documents/${_}`,"_blank")},size:"sm",className:"flex items-center space-x-2",children:[T==="embedded"&&a.jsxs(a.Fragment,{children:[a.jsx(ii,{className:"w-4 h-4"}),a.jsx("span",{children:"View Document"})]}),T==="modal"&&a.jsxs(a.Fragment,{children:[a.jsx(Jg,{className:"w-4 h-4"}),a.jsx("span",{children:"Open Modal"})]}),T==="new_tab"&&a.jsxs(a.Fragment,{children:[a.jsx(Os,{className:"w-4 h-4"}),a.jsx("span",{children:"Open in New Tab"})]})]}),a.jsxs(fe,{onClick:()=>{console.log("Download document:",_)},size:"sm",variant:"outline",className:"flex items-center space-x-2",children:[a.jsx(yy,{className:"w-4 h-4"}),a.jsx("span",{children:"Download"})]})]}),e&&a.jsx("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[{mode:"embedded",icon:ii,label:"Embedded"},{mode:"modal",icon:Jg,label:"Modal"},{mode:"new_tab",icon:Os,label:"New Tab"}].map(({mode:V,icon:D,label:U})=>a.jsxs("button",{onClick:()=>K(V),className:ge("px-2 py-1 text-xs rounded-md transition-colors flex items-center space-x-1",T===V?"bg-white shadow-sm text-blue-600":"text-gray-600 hover:text-gray-900"),title:U,children:[a.jsx(D,{className:"w-3 h-3"}),a.jsx("span",{className:"hidden sm:inline",children:U})]},V))})]})}),T==="embedded"&&a.jsx("div",{className:"border-t border-gray-100 p-4",children:z()})]});return a.jsxs("div",{className:ge("relative",r&&e&&"ring-2 ring-blue-500 ring-offset-2 rounded-lg p-2",o),onClick:i,children:[q(),a.jsx(eW,{isOpen:l,onClose:()=>c(!1),onSelect:M,contentType:"document",title:"Select Document",description:"Choose a document to embed in this block",allowUpload:!0}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"relative w-full max-w-6xl max-h-full bg-white rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:E}),A&&a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:A})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{onClick:()=>{console.log("Download document:",_)},size:"sm",variant:"outline",className:"flex items-center space-x-2",children:[a.jsx(yy,{className:"w-4 h-4"}),a.jsx("span",{children:"Download"})]}),a.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600 p-2",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 120px)"},children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[z(),m>1&&a.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-6",children:[a.jsxs(fe,{onClick:R,disabled:d===1,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[a.jsx(r_,{className:"w-4 h-4"}),a.jsx("span",{children:"Previous"})]}),a.jsx("div",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 rounded-lg",children:a.jsxs("span",{className:"text-sm font-medium",children:["Page ",d," of ",m]})}),a.jsxs(fe,{onClick:P,disabled:d===m,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[a.jsx("span",{children:"Next"}),a.jsx(jh,{className:"w-4 h-4"})]})]}),a.jsxs("div",{className:"flex justify-center items-center space-x-3 mt-4",children:[a.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:$,disabled:y<=50,className:"p-2 text-gray-600 hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",title:"Zoom out",children:a.jsx(NM,{className:"w-4 h-4"})}),a.jsxs("span",{className:"px-2 text-sm font-medium",children:[y,"%"]}),a.jsx("button",{onClick:L,disabled:y>=200,className:"p-2 text-gray-600 hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",title:"Zoom in",children:a.jsx(SM,{className:"w-4 h-4"})})]}),a.jsx("button",{onClick:F,className:"p-2 bg-gray-100 text-gray-600 hover:text-gray-800 rounded-lg",title:"Rotate 90°",children:a.jsx(bM,{className:"w-4 h-4"})})]})]})})]})})]})}function SOe({block:t,isSelected:e=!1,isEditing:r=!1,onSelect:n,onEdit:i,onBlockChange:s,className:o}){const l=t.content,{prompt_id:c,title:u="Prompt",preview_text:f,show_copy_button:d=!0,allow_customization:p=!1}=l||{},[m,x]=O.useState(!1),[y,v]=O.useState(!1),[b,w]=O.useState(!1),N=E=>{var T;const A={prompt_id:E.id,title:E.title,preview_text:E.description||((T=E.content)==null?void 0:T.substring(0,200))+"...",show_copy_button:!0,allow_customization:!1};s&&s(t.id,{content:A}),w(!1)},j=()=>{s&&s(t.id,{content:{prompt_id:"",title:"Prompt",show_copy_button:!0}})},k=async()=>{if(f)try{await navigator.clipboard.writeText(f),x(!0),setTimeout(()=>x(!1),2e3)}catch(E){console.error("Failed to copy prompt:",E)}},_=async()=>{if(c){v(!0);try{window.open(`/prompts/${c}`,"_blank")}catch(E){console.error("Failed to view prompt:",E)}finally{v(!1)}}};return r&&!c?a.jsxs("div",{className:ge("border-2 border-dashed border-indigo-300 rounded-lg p-8 text-center bg-indigo-50",o),children:[a.jsx("div",{className:"text-indigo-400 mb-4",children:a.jsx(Gr,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-indigo-900 mb-2",children:"Select a Prompt"}),a.jsx("p",{className:"text-indigo-600 text-sm mb-4",children:"Choose a prompt template from your repository to embed here."}),a.jsxs(fe,{onClick:()=>w(!0),variant:"outline",size:"sm",className:"border-indigo-300 text-indigo-600 hover:bg-indigo-100",children:[a.jsx(Dn,{className:"w-4 h-4 mr-2"}),"Select Prompt"]})]}):a.jsxs("div",{className:ge("border border-gray-200 rounded-lg p-6 bg-white hover:shadow-md transition-shadow",e&&"ring-2 ring-blue-500",o),onClick:n,children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Gr,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:u}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Prompt Template"})]})]}),r&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(fe,{onClick:()=>w(!0),variant:"ghost",size:"sm",className:"flex items-center space-x-1",title:"Change prompt",children:[a.jsx(C0,{className:"w-4 h-4"}),a.jsx("span",{children:"Change"})]}),a.jsx(fe,{onClick:j,variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",title:"Remove prompt",children:"×"})]})]}),f&&a.jsx("div",{className:"mb-4",children:a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border text-sm text-gray-700 max-h-32 overflow-y-auto",children:f})}),c&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{onClick:_,disabled:y,className:"flex items-center space-x-2",children:[y?a.jsx("div",{className:"w-4 h-4 animate-spin border-2 border-white border-t-transparent rounded-full"}):a.jsx(Os,{className:"w-4 h-4"}),a.jsx("span",{children:"View Full Prompt"})]}),d&&f&&a.jsxs(fe,{onClick:k,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[m?a.jsx(ln,{className:"w-3 h-3 text-green-600"}):a.jsx(gy,{className:"w-3 h-3"}),a.jsx("span",{children:m?"Copied!":"Copy"})]})]}),!c&&!r&&a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No prompt selected"}),a.jsx(GC,{isOpen:b,onClose:()=>w(!1),onSelect:N,contentType:"prompt",title:"Select Prompt",description:"Choose a prompt template to embed in this block"})]})}const NOe=Mi(SOe);function kOe({block:t,isSelected:e=!1,isEditing:r=!1,onSelect:n,onEdit:i,onBlockChange:s,userContext:o,className:l}){const c=t.content,{automation_id:u,automation_name:f="Automation",automation_url:d,required_tools:p=[],description:m,display_mode:x="embedded"}=c||{},[y,v]=O.useState(!1),[b,w]=O.useState(!1),N=_=>{var A,T;const E={automation_id:_.id,automation_name:_.title,description:_.description,automation_url:((A=_.metadata)==null?void 0:A.automation_url)||_.file_url,required_tools:((T=_.metadata)==null?void 0:T.required_tools)||[],display_mode:"embedded"};s&&s(t.id,{content:E}),w(!1)},j=()=>{s&&s(t.id,{content:{automation_id:"",automation_name:"Automation",display_mode:"embedded"}})},k=async()=>{if(d){v(!0);try{window.open(d,"_blank")}catch(_){console.error("Failed to run automation:",_)}finally{v(!1)}}};return r&&!u?a.jsxs("div",{className:ge("border-2 border-dashed border-blue-300 rounded-lg p-8 text-center bg-blue-50",l),children:[a.jsx("div",{className:"text-blue-400 mb-4",children:a.jsx(Ei,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Select an Automation"}),a.jsx("p",{className:"text-blue-600 text-sm mb-4",children:"Choose an automation from your repository to embed here."}),a.jsxs(fe,{onClick:()=>w(!0),variant:"outline",size:"sm",className:"border-blue-300 text-blue-600 hover:bg-blue-100",children:[a.jsx(Dn,{className:"w-4 h-4 mr-2"}),"Select Automation"]})]}):a.jsxs("div",{className:ge("border border-gray-200 rounded-lg p-6 bg-white hover:shadow-md transition-shadow",e&&"ring-2 ring-blue-500",l),onClick:n,children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:a.jsx(Ei,{className:"w-5 h-5 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:f}),m&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m})]})]}),r&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(fe,{onClick:()=>w(!0),variant:"ghost",size:"sm",className:"flex items-center space-x-1",title:"Change automation",children:[a.jsx(C0,{className:"w-4 h-4"}),a.jsx("span",{children:"Change"})]}),a.jsx(fe,{onClick:j,variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",title:"Remove automation",children:"×"})]})]}),p&&p.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Required Tools:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:p.map((_,E)=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:_},E))})]}),d&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{onClick:k,disabled:y,className:"flex items-center space-x-2",children:[y?a.jsx("div",{className:"w-4 h-4 animate-spin border-2 border-white border-t-transparent rounded-full"}):a.jsx(si,{className:"w-4 h-4"}),a.jsx("span",{children:"Run Automation"})]}),a.jsxs(fe,{onClick:()=>window.open(d,"_blank"),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[a.jsx(Os,{className:"w-3 h-3"}),a.jsx("span",{children:"Open"})]})]}),!d&&!r&&a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No automation URL configured"}),a.jsx(GC,{isOpen:b,onClose:()=>w(!1),onSelect:N,contentType:"automation",title:"Select Automation",description:"Choose an automation workflow to embed in this block"})]})}const _Oe=Mi(kOe);function OOe({item:t,index:e,isEditing:r,onUpdate:n,onDelete:i}){const[s,o]=O.useState(!1),[l,c]=O.useState(t),[u,f]=O.useState(t.is_open_by_default||!1),{attributes:d,listeners:p,setNodeRef:m,transform:x,transition:y,isDragging:v}=KC({id:t.id}),b={transform:Rs.Transform.toString(x),transition:y},w=()=>{n(t.id,l),o(!1)},N=()=>{c(t),o(!1)};return a.jsx("div",{ref:m,style:b,className:ge("border rounded-lg overflow-hidden transition-colors group",v&&"opacity-50",s?"border-blue-300 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:s?a.jsx("div",{className:"p-4 space-y-4",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[r&&a.jsx("button",{...d,...p,className:"mt-2 p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:"Drag to reorder",children:a.jsx(s_,{className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section Title"}),a.jsx(ct,{value:l.title,onChange:j=>c({...l,title:j.target.value}),placeholder:"Enter section title...",className:"font-medium"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),a.jsx(Ai,{value:l.content,onChange:j=>c({...l,content:j.target.value}),placeholder:"Enter section content...",className:"min-h-[120px] resize-none"})]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:l.is_open_by_default||!1,onChange:j=>c({...l,is_open_by_default:j.target.checked}),className:"form-checkbox text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Open by default"})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200",children:[a.jsxs(fe,{onClick:N,size:"sm",variant:"outline",children:[a.jsx($r,{className:"w-4 h-4 mr-1"}),"Cancel"]}),a.jsxs(fe,{onClick:w,size:"sm",children:[a.jsx(ko,{className:"w-4 h-4 mr-1"}),"Save"]})]})]})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("button",{onClick:()=>f(!u),className:"w-full px-4 py-3 text-left bg-gray-50 hover:bg-gray-100 transition-colors flex items-center justify-between focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset","aria-expanded":u,children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[r&&a.jsx("button",{...d,...p,className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:"Drag to reorder",onClick:j=>j.stopPropagation(),children:a.jsx(s_,{className:"w-4 h-4"})}),a.jsx("span",{className:"font-medium text-gray-900",children:t.title})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[r&&a.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100",onClick:j=>j.stopPropagation(),children:[a.jsx(fe,{onClick:()=>o(!0),size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:a.jsx(yo,{className:"w-3 h-3"})}),a.jsx(fe,{onClick:()=>i(t.id),size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:a.jsx(ns,{className:"w-3 h-3"})})]}),u?a.jsx(CO,{className:"w-5 h-5 text-gray-500"}):a.jsx(mo,{className:"w-5 h-5 text-gray-500"})]})]})}),a.jsx("div",{className:ge("transition-all duration-200 ease-in-out overflow-hidden",u?"max-h-screen":"max-h-0"),children:a.jsxs("div",{className:"p-4 bg-white border-t border-gray-100",children:[t.html?a.jsx("div",{className:"prose prose-gray max-w-none text-sm",dangerouslySetInnerHTML:{__html:t.html}}):a.jsx("p",{className:"text-gray-700 leading-relaxed text-sm whitespace-pre-wrap",children:t.content}),r&&!t.content&&!t.html&&a.jsx("p",{className:"text-gray-400 italic text-sm",children:"No content added yet"})]})})]})})}function EOe({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n}){const i=t.content,{items:s=[],allow_multiple_open:o=!0}=i||{},[l,c]=O.useState(new Set(s.filter(j=>j.is_open_by_default).map(j=>j.id))),[u,f]=O.useState(null),[d,p]=O.useState(!1),m=Fx(Bx(Ad,{activationConstraint:{distance:8}})),x=j=>{n&&n({...i,...j})},y=()=>{const k={id:`accordion_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:"New Section",content:"Enter content for this section...",is_open_by_default:!1};x({items:[...s,k]})},v=(j,k)=>{const _=s.map(E=>E.id===j?{...E,...k}:E);x({items:_})},b=j=>{const k=s.filter(_=>_.id!==j);x({items:k})},w=j=>{const{active:k,over:_}=j;if(_&&k.id!==_.id){const E=s.findIndex(T=>T.id===k.id),A=s.findIndex(T=>T.id===_.id);if(E!==-1&&A!==-1){const T=Td(s,E,A);x({items:T})}}f(null)},N=j=>{c(k=>{const _=new Set(k);return _.has(j)?_.delete(j):(o||_.clear(),_.add(j)),_})};return e&&r?a.jsxs("div",{className:ge("border border-gray-300 rounded-lg overflow-hidden","ring-2 ring-blue-500 ring-offset-2"),children:[a.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Accordion Block"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create collapsible sections with expandable content"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{onClick:()=>p(!d),size:"sm",variant:"outline",className:"flex items-center space-x-2",children:[a.jsx(Dn,{className:"w-4 h-4"}),a.jsx("span",{children:"Settings"})]}),a.jsxs(fe,{onClick:y,size:"sm",className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add Section"})]})]})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[s.length," section",s.length!==1?"s":""]}),d&&a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mt-4",children:a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:j=>x({allow_multiple_open:j.target.checked}),className:"form-checkbox text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Allow multiple sections to be open at once"})]})})]}),a.jsx("div",{className:"p-6",children:s.length===0?a.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(Sh,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Sections Yet"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Add your first accordion section to get started"}),a.jsxs(fe,{onClick:y,className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add First Section"})]})]}):a.jsxs(Ux,{sensors:m,onDragStart:j=>f(j.active.id),onDragEnd:w,children:[a.jsx("div",{className:"space-y-3",children:a.jsx(Wx,{items:s.map(j=>j.id),strategy:Hx,children:s.map((j,k)=>a.jsx(OOe,{item:j,index:k,isEditing:!0,onUpdate:v,onDelete:b},j.id))})}),a.jsx(VC,{children:u?a.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 shadow-lg",children:["Section ",s.findIndex(j=>j.id===u)+1]}):null})]})})]}):s.length===0?a.jsx("div",{className:"text-gray-400 italic py-4 text-center",children:"No accordion items configured"}):a.jsx("div",{className:"space-y-2",children:s.map((j,k)=>{const _=l.has(j.id);return a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsxs("button",{onClick:()=>N(j.id),className:"w-full px-4 py-3 text-left bg-gray-50 hover:bg-gray-100 transition-colors flex items-center justify-between focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset","aria-expanded":_,children:[a.jsx("span",{className:"font-medium text-gray-900",children:j.title}),_?a.jsx(CO,{className:"w-5 h-5 text-gray-500"}):a.jsx(mo,{className:"w-5 h-5 text-gray-500"})]}),a.jsx("div",{className:ge("transition-all duration-200 ease-in-out overflow-hidden",_?"max-h-screen":"max-h-0"),children:a.jsx("div",{className:"p-4 bg-white border-t border-gray-100",children:j.html?a.jsx("div",{className:"prose prose-gray max-w-none",dangerouslySetInnerHTML:{__html:j.html}}):a.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:j.content})})})]},j.id)})})}const COe=Mi(EOe);function AOe({question:t,index:e,isEditing:r,onUpdate:n,onDelete:i}){var k;const[s,o]=O.useState(!1),[l,c]=O.useState(t),{attributes:u,listeners:f,setNodeRef:d,transform:p,transition:m,isDragging:x}=KC({id:t.id}),y={transform:Rs.Transform.toString(p),transition:m},v=()=>{n(t.id,l),o(!1)},b=()=>{c(t),o(!1)},w=()=>{const _=[...l.options||[],"New Option"];c({...l,options:_})},N=(_,E)=>{const A=[...l.options];A[_]=E,c({...l,options:A})},j=_=>{const E=l.options.filter((A,T)=>T!==_);c({...l,options:E})};return a.jsx("div",{ref:d,style:y,className:ge("border rounded-lg p-4 transition-colors group",x&&"opacity-50",s?"border-blue-300 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-start space-x-3",children:[r&&a.jsx("button",{...u,...f,className:"opacity-0 group-hover:opacity-100 mt-1 p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:"Drag to reorder",children:a.jsx(s_,{className:"w-4 h-4"})}),a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 text-sm font-medium rounded-full flex items-center justify-center mt-1",children:e+1}),a.jsx("div",{className:"flex-1",children:s?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question"}),a.jsx(Ai,{value:l.question,onChange:_=>c({...l,question:_.target.value}),placeholder:"Enter your question...",className:"min-h-[80px]"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Type"}),a.jsxs(ec,{value:l.type,onValueChange:_=>c({...l,type:_}),children:[a.jsx(Da,{children:a.jsx(tc,{})}),a.jsxs(La,{children:[a.jsx(kt,{value:"multiple_choice",children:"Multiple Choice"}),a.jsx(kt,{value:"true_false",children:"True/False"}),a.jsx(kt,{value:"short_answer",children:"Short Answer"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points"}),a.jsx(ct,{type:"number",value:l.points,onChange:_=>c({...l,points:parseInt(_.target.value)||1}),min:"1",className:"w-full"})]})]}),l.type==="multiple_choice"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),a.jsxs("div",{className:"space-y-2",children:[(k=l.options)==null?void 0:k.map((_,E)=>a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ct,{value:_,onChange:A=>N(E,A.target.value),placeholder:`Option ${E+1}`,className:"flex-1"}),a.jsx(fe,{onClick:()=>c({...l,correct_answer:_}),size:"sm",variant:l.correct_answer===_?"default":"outline",className:"shrink-0",children:l.correct_answer===_?"Correct":"Set Correct"}),a.jsx(fe,{onClick:()=>j(E),size:"sm",variant:"ghost",className:"shrink-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:a.jsx(ns,{className:"w-4 h-4"})})]},E)),a.jsxs(fe,{onClick:w,size:"sm",variant:"outline",className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add Option"})]})]})]}),l.type!=="multiple_choice"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),l.type==="true_false"?a.jsxs(ec,{value:l.correct_answer,onValueChange:_=>c({...l,correct_answer:_}),children:[a.jsx(Da,{className:"w-32",children:a.jsx(tc,{})}),a.jsxs(La,{children:[a.jsx(kt,{value:"True",children:"True"}),a.jsx(kt,{value:"False",children:"False"})]})]}):a.jsx(ct,{value:l.correct_answer,onChange:_=>c({...l,correct_answer:_.target.value}),placeholder:"Enter the correct answer..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Explanation (Optional)"}),a.jsx(Ai,{value:l.explanation||"",onChange:_=>c({...l,explanation:_.target.value}),placeholder:"Explain why this answer is correct...",className:"min-h-[60px]"})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200",children:[a.jsxs(fe,{onClick:b,size:"sm",variant:"outline",children:[a.jsx($r,{className:"w-4 h-4 mr-1"}),"Cancel"]}),a.jsxs(fe,{onClick:v,size:"sm",children:[a.jsx(ko,{className:"w-4 h-4 mr-1"}),"Save"]})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("p",{className:"font-medium text-gray-900 flex-1",children:[t.question,a.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",t.points," pt",t.points!==1?"s":"",")"]})]}),r&&a.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100",children:[a.jsx(fe,{onClick:()=>o(!0),size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:a.jsx(yo,{className:"w-3 h-3"})}),a.jsx(fe,{onClick:()=>i(t.id),size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:a.jsx(ns,{className:"w-3 h-3"})})]})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("strong",{children:"Type:"})," ",t.type==="multiple_choice"?"Multiple Choice":t.type==="true_false"?"True/False":"Short Answer",t.type==="multiple_choice"&&t.options&&a.jsxs("span",{className:"ml-2",children:["(",t.options.length," options)"]})]}),t.correct_answer&&a.jsxs("div",{className:"text-sm text-green-600",children:[a.jsx("strong",{children:"Answer:"})," ",String(t.correct_answer)]})]})})]})})}function TOe({block:t,isEditing:e=!1,isSelected:r=!1,onContentChange:n,onComplete:i}){const s=t.content,{title:o="Quiz",description:l="",questions:c=[],time_limit:u,passing_score:f=70,allow_retries:d=!0,show_results_immediately:p=!0}=s||{},[m,x]=O.useState({}),[y,v]=O.useState(!1),[b,w]=O.useState(null),[N,j]=O.useState(u?u*60:null),[k,_]=O.useState(!1),[E,A]=O.useState(o),[T,M]=O.useState(l),[P,R]=O.useState(!1),[L,$]=O.useState(null),F=Fx(Bx(Ad,{activationConstraint:{distance:8}})),z=J=>{n&&n({...s,...J})},W=()=>{const ne={id:`q_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,question:"New Question",type:"multiple_choice",options:["Option 1","Option 2"],correct_answer:"Option 1",points:1};z({questions:[...c,ne]})},K=(J,ne)=>{const te=c.map(se=>se.id===J?{...se,...ne}:se);z({questions:te})},q=J=>{const ne=c.filter(te=>te.id!==J);z({questions:ne})},V=J=>{const{active:ne,over:te}=J;if(te&&ne.id!==te.id){const se=c.findIndex(ie=>ie.id===ne.id),ve=c.findIndex(ie=>ie.id===te.id);if(se!==-1&&ve!==-1){const ie=Td(c,se,ve);z({questions:ie})}}$(null)},D=()=>{z({title:E,description:T})},U=(J,ne)=>{x(te=>({...te,[J]:ne}))},G=()=>{let J=0,ne=0;return c.forEach(te=>{J+=te.points;const se=m[te.id];te.type==="multiple_choice"||te.type==="true_false"?se===te.correct_answer&&(ne+=te.points):te.type==="short_answer"&&se&&se.toLowerCase().trim()===String(te.correct_answer).toLowerCase().trim()&&(ne+=te.points)}),J>0?Math.round(ne/J*100):0},ee=()=>{const J=G();w(J),v(!0),p&&_(!0),i==null||i(J,m)},Q=()=>{x({}),v(!1),w(null),_(!1),j(u?u*60:null)},H=J=>m[J]!==void 0&&m[J]!=="",Y=c.every(J=>H(J.id)),re=b!==null&&b>=f;return O.useEffect(()=>{if(N!==null&&N>0&&!y){const J=setTimeout(()=>{j(ne=>ne-1)},1e3);return()=>clearTimeout(J)}else N===0&&!y&&ee()},[N,y]),O.useEffect(()=>{if(e){const J=setTimeout(()=>{(E!==o||T!==l)&&D()},1e3);return()=>clearTimeout(J)}},[E,T,e]),e&&r?a.jsxs("div",{className:ge("border border-gray-300 rounded-lg overflow-hidden","ring-2 ring-blue-500 ring-offset-2"),children:[a.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quiz Title"}),a.jsx(ct,{value:E,onChange:J=>A(J.target.value),placeholder:"Enter quiz title...",className:"font-semibold"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),a.jsx(Ai,{value:T,onChange:J=>M(J.target.value),placeholder:"Enter quiz description...",className:"min-h-[60px] resize-none"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[c.length," question",c.length!==1?"s":""]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{onClick:()=>R(!P),size:"sm",variant:"outline",className:"flex items-center space-x-2",children:[a.jsx(Dn,{className:"w-4 h-4"}),a.jsx("span",{children:"Settings"})]}),a.jsxs(fe,{onClick:W,size:"sm",className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add Question"})]})]})]}),P&&a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Limit (minutes)"}),a.jsx(ct,{type:"number",value:u||"",onChange:J=>z({time_limit:J.target.value?parseInt(J.target.value):void 0}),placeholder:"No limit",min:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Passing Score (%)"}),a.jsx(ct,{type:"number",value:f,onChange:J=>z({passing_score:parseInt(J.target.value)||70}),min:"0",max:"100"})]})]}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:J=>z({allow_retries:J.target.checked}),className:"form-checkbox text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Allow retries"})]}),a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:p,onChange:J=>z({show_results_immediately:J.target.checked}),className:"form-checkbox text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Show results immediately"})]})]})]})]})}),a.jsx("div",{className:"p-6",children:c.length===0?a.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(AO,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Questions Yet"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Add your first question to get started"}),a.jsxs(fe,{onClick:W,className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsx("span",{children:"Add First Question"})]})]}):a.jsxs(Ux,{sensors:F,onDragStart:J=>$(J.active.id),onDragEnd:V,children:[a.jsx("div",{className:"space-y-4",children:a.jsx(Wx,{items:c.map(J=>J.id),strategy:Hx,children:c.map((J,ne)=>a.jsx(AOe,{question:J,index:ne,isEditing:!0,onUpdate:K,onDelete:q},J.id))})}),a.jsx(VC,{children:L?a.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 shadow-lg",children:["Question ",c.findIndex(J=>J.id===L)+1]}):null})]})})]}):c.length===0?a.jsx("div",{className:"text-gray-400 italic py-8 text-center",children:"No quiz questions configured"}):a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"bg-blue-50 px-6 py-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:o}),l&&a.jsx("p",{className:"text-gray-600 mt-1",children:l})]}),N!==null&&!y&&a.jsxs("div",{className:"flex items-center space-x-2 bg-white px-3 py-2 rounded-lg border",children:[a.jsx(go,{className:"w-4 h-4 text-gray-500"}),a.jsxs("span",{className:ge("font-mono text-sm",N<60?"text-red-600 font-bold":"text-gray-700"),children:[Math.floor(N/60),":",String(N%60).padStart(2,"0")]})]})]}),y&&b!==null&&a.jsxs("div",{className:ge("mt-4 p-3 rounded-lg flex items-center space-x-2",re?"bg-green-100 border border-green-200":"bg-red-100 border border-red-200"),children:[re?a.jsx(ko,{className:"w-5 h-5 text-green-600"}):a.jsx($r,{className:"w-5 h-5 text-red-600"}),a.jsxs("span",{className:ge("font-medium",re?"text-green-800":"text-red-800"),children:["Score: ",b,"% ",re?"(Passed)":`(Failed - ${f}% required)`]})]})]}),a.jsx("div",{className:"p-6 space-y-6",children:c.map((J,ne)=>{const te=m[J.id],se=y&&te===J.correct_answer,ve=y&&te!==J.correct_answer;return a.jsx("div",{className:ge("border rounded-lg p-4 transition-colors",y&&se&&"border-green-300 bg-green-50",y&&ve&&"border-red-300 bg-red-50",!y&&"border-gray-200"),children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 text-sm font-medium rounded-full flex items-center justify-center",children:ne+1}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium text-gray-900 mb-3",children:[J.question,a.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",J.points," pt",J.points!==1?"s":"",")"]})]}),J.type==="multiple_choice"&&J.options&&a.jsx("div",{className:"space-y-2",children:J.options.map((ie,ye)=>a.jsxs("label",{className:ge("flex items-center space-x-2 p-2 rounded cursor-pointer transition-colors",!y&&"hover:bg-gray-50",y&&ie===J.correct_answer&&"bg-green-100 border border-green-300",y&&ie===te&&ie!==J.correct_answer&&"bg-red-100 border border-red-300"),children:[a.jsx("input",{type:"radio",name:`question-${J.id}`,value:ie,checked:te===ie,disabled:y,onChange:Te=>U(J.id,Te.target.value),className:"form-radio text-blue-600"}),a.jsx("span",{className:ge("text-gray-700",y&&ie===J.correct_answer&&"font-medium text-green-800",y&&ie===te&&ie!==J.correct_answer&&"text-red-800"),children:ie})]},ye))}),J.type==="true_false"&&a.jsx("div",{className:"space-y-2",children:["True","False"].map(ie=>a.jsxs("label",{className:ge("flex items-center space-x-2 p-2 rounded cursor-pointer transition-colors",!y&&"hover:bg-gray-50",y&&ie===J.correct_answer&&"bg-green-100 border border-green-300",y&&ie===te&&ie!==J.correct_answer&&"bg-red-100 border border-red-300"),children:[a.jsx("input",{type:"radio",name:`question-${J.id}`,value:ie,checked:te===ie,disabled:y,onChange:ye=>U(J.id,ye.target.value),className:"form-radio text-blue-600"}),a.jsx("span",{children:ie})]},ie))}),J.type==="short_answer"&&a.jsx("input",{type:"text",value:te||"",disabled:y,onChange:ie=>U(J.id,ie.target.value),placeholder:"Enter your answer...",className:ge("w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",y&&se&&"border-green-300 bg-green-50",y&&ve&&"border-red-300 bg-red-50")}),y&&k&&J.explanation&&a.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded",children:a.jsxs("p",{className:"text-blue-800 text-sm",children:[a.jsx("strong",{children:"Explanation:"})," ",J.explanation]})})]})]})},J.id)})}),a.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Questions answered: ",Object.keys(m).length," of ",c.length]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[y&&!re&&d&&a.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Retry Quiz"}),!y&&a.jsx("button",{onClick:ee,disabled:!Y,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit Quiz"}),y&&p&&!k&&a.jsx("button",{onClick:()=>_(!0),className:"px-4 py-2 text-sm font-medium text-blue-700 bg-blue-100 border border-blue-300 rounded-md hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Show Answers"})]})]})})]})}const POe=Mi(TOe);function MOe({block:t,isSelected:e=!1,isEditing:r=!1,onSelect:n,onEdit:i,onBlockChange:s,className:o}){const l=t.content,{title:c="Submit Your Work",description:u,submission_type:f="text",instructions:d="Please provide your submission below",max_file_size:p,allowed_file_types:m=[],required_fields:x=[],auto_grade:y=!1}=l||{},[v,b]=O.useState({}),[w,N]=O.useState(null),[j,k]=O.useState(!1),[_,E]=O.useState(!1),[A,T]=O.useState(!1),M=K=>{N(K.target.files)},P=async()=>{k(!0);try{await new Promise(K=>setTimeout(K,2e3)),console.log("Submission:",{blockId:t.id,submissionType:f,submission:v,files:w?Array.from(w):[]}),E(!0)}catch(K){console.error("Failed to submit:",K)}finally{k(!1)}},L=(()=>{switch(f){case"file":return IB;case"url":return E0;case"text":return Ot;default:return Ir}})(),$=K=>{s&&s(t.id,{content:{...l,...K}})},F=()=>{const K={name:`field_${Date.now()}`,label:"New Field",type:"text",required:!0};$({required_fields:[...x||[],K]})},z=(K,q)=>{const V=[...x||[]];V[K]={...V[K],...q},$({required_fields:V})},W=K=>{const q=[...x||[]];q.splice(K,1),$({required_fields:q})};return r?a.jsx("div",{className:ge("border-2 border-dashed border-orange-300 rounded-lg bg-orange-50",o),children:A?a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-medium text-orange-900",children:"Configure User Submission"}),a.jsx(fe,{onClick:()=>T(!1),variant:"ghost",size:"sm",className:"text-orange-600 hover:bg-orange-100",children:a.jsx($r,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),a.jsx(ct,{value:c,onChange:K=>$({title:K.target.value}),placeholder:"Submit Your Work"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Submission Type"}),a.jsxs(ec,{value:f,onValueChange:K=>$({submission_type:K}),children:[a.jsx(Da,{children:a.jsx(tc,{})}),a.jsxs(La,{children:[a.jsx(kt,{value:"text",children:"Text Submission"}),a.jsx(kt,{value:"file",children:"Single File"}),a.jsx(kt,{value:"multiple",children:"Multiple Files"}),a.jsx(kt,{value:"url",children:"URL/Link"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),a.jsx(ct,{value:u||"",onChange:K=>$({description:K.target.value}),placeholder:"Brief description of the submission"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instructions"}),a.jsx(Ai,{value:d,onChange:K=>$({instructions:K.target.value}),placeholder:"Please provide your submission below",rows:3})]}),(f==="file"||f==="multiple")&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[a.jsx("h4",{className:"font-medium text-blue-900",children:"File Upload Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max File Size (MB)"}),a.jsx(ct,{type:"number",value:p?Math.round(p/(1024*1024)):"",onChange:K=>{const q=parseInt(K.target.value)||0;$({max_file_size:q*1024*1024})},placeholder:"10",min:"1",max:"100"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowed File Types (comma separated)"}),a.jsx(ct,{value:(m==null?void 0:m.join(", "))||"",onChange:K=>{const q=K.target.value.split(",").map(V=>V.trim()).filter(Boolean);$({allowed_file_types:q})},placeholder:".pdf, .docx, .txt, image/*"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Additional Fields"}),a.jsxs(fe,{onClick:F,variant:"outline",size:"sm",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[a.jsx(Vt,{className:"w-4 h-4 mr-1"}),"Add Field"]})]}),x&&x.length>0?a.jsx("div",{className:"space-y-3",children:x.map((K,q)=>a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Field ",q+1]}),a.jsx(fe,{onClick:()=>W(q),variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50",children:a.jsx(ns,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Field Name"}),a.jsx(ct,{value:K.name,onChange:V=>z(q,{name:V.target.value}),placeholder:"field_name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Label"}),a.jsx(ct,{value:K.label,onChange:V=>z(q,{label:V.target.value}),placeholder:"Field Label"})]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Type"}),a.jsxs(ec,{value:K.type,onValueChange:V=>z(q,{type:V}),children:[a.jsx(Da,{className:"h-9",children:a.jsx(tc,{})}),a.jsxs(La,{children:[a.jsx(kt,{value:"text",children:"Text"}),a.jsx(kt,{value:"email",children:"Email"}),a.jsx(kt,{value:"number",children:"Number"}),a.jsx(kt,{value:"tel",children:"Phone"}),a.jsx(kt,{value:"date",children:"Date"}),a.jsx(kt,{value:"textarea",children:"Long Text"})]})]})]}),a.jsxs("div",{className:"flex items-center h-9",children:[a.jsx("input",{type:"checkbox",id:`required-${q}`,checked:K.required,onChange:V=>z(q,{required:V.target.checked}),className:"mr-2"}),a.jsx("label",{htmlFor:`required-${q}`,className:"text-xs text-gray-600",children:"Required"})]})]})]})]},q))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:'No additional fields configured. Click "Add Field" to create custom form fields.'})]}),a.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"auto-grade",checked:y||!1,onChange:K=>$({auto_grade:K.target.checked}),className:"mr-3"}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"auto-grade",className:"text-sm font-medium text-green-900",children:"Enable Auto-Grading"}),a.jsx("p",{className:"text-xs text-green-700",children:"Automatically evaluate submissions when possible"})]})]})})]}):a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"text-orange-400 mb-4",children:a.jsx(Ir,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-orange-900 mb-2",children:"User Submission Block"}),a.jsx("p",{className:"text-orange-600 text-sm mb-4",children:"Configure how users can submit their work."}),a.jsxs(fe,{onClick:()=>T(!0),variant:"outline",size:"sm",className:"border-orange-300 text-orange-600 hover:bg-orange-100",children:[a.jsx(Dn,{className:"w-4 h-4 mr-2"}),"Configure Submission"]})]})}):_?a.jsxs("div",{className:ge("border border-green-200 rounded-lg p-6 bg-green-50 text-center",e&&"ring-2 ring-blue-500",o),onClick:n,children:[a.jsx("div",{className:"text-green-500 mb-4",children:a.jsx(ln,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:"Submission Received!"}),a.jsxs("p",{className:"text-green-700 text-sm",children:["Thank you for your submission. ",y?"Your work is being evaluated automatically.":"Your work will be reviewed soon."]})]}):a.jsxs("div",{className:ge("border border-gray-200 rounded-lg p-6 bg-white",e&&"ring-2 ring-blue-500",o),onClick:n,children:[a.jsx("div",{className:"flex items-start justify-between mb-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:a.jsx(L,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:c}),u&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u})]})]})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Instructions:"})," ",d]})}),a.jsxs("div",{className:"space-y-4",children:[x.map((K,q)=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[K.label," ",K.required&&a.jsx("span",{className:"text-red-500",children:"*"})]}),K.type==="textarea"?a.jsx("textarea",{value:v[K.name]||"",onChange:V=>b(D=>({...D,[K.name]:V.target.value})),placeholder:`Enter ${K.label.toLowerCase()}`,required:K.required,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx(ct,{type:K.type||"text",value:v[K.name]||"",onChange:V=>b(D=>({...D,[K.name]:V.target.value})),placeholder:`Enter ${K.label.toLowerCase()}`,required:K.required})]},q)),f==="text"&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Your Submission ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:v.content||"",onChange:K=>b(q=>({...q,content:K.target.value})),placeholder:"Enter your submission here...",rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(f==="file"||f==="multiple")&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Upload File(s) ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"file",onChange:M,multiple:f==="multiple",accept:m.join(","),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),p&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Maximum file size: ",Math.round(p/(1024*1024)),"MB"]})]}),f==="url"&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["URL ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(ct,{type:"url",value:v.url||"",onChange:K=>b(q=>({...q,url:K.target.value})),placeholder:"https://example.com",required:!0})]}),a.jsxs(fe,{onClick:P,disabled:j,className:"w-full flex items-center justify-center space-x-2",children:[j?a.jsx("div",{className:"w-4 h-4 animate-spin border-2 border-white border-t-transparent rounded-full"}):a.jsx($B,{className:"w-4 h-4"}),a.jsx("span",{children:j?"Submitting...":"Submit"})]})]})]})}const ROe=Mi(MOe);function tW({block:t,isSelected:e=!1,isEditing:r=!1,onSelect:n,onEdit:i,onProgress:s,onContentChange:o,userContext:l,className:c}){const u={block:t,isSelected:e,isEditing:r,onSelect:n,onEdit:i,className:c},f=d=>{o==null||o(t.id,d)};switch(t.block_type){case"section_header":return a.jsx(v_e,{...u,onContentChange:f});case"rich_text":return a.jsx(b_e,{...u,onContentChange:f});case"image":return a.jsx(j_e,{...u,onContentChange:f});case"list":return a.jsx(uOe,{...u,onContentChange:f});case"quote":return a.jsx(fOe,{...u,onContentChange:f});case"divider":return a.jsx(pOe,{...u});case"video":return a.jsx(xOe,{...u,onContentChange:f});case"agent":return a.jsx(wOe,{...u});case"document":return a.jsx(jOe,{...u,onContentChange:f});case"prompt":return a.jsx(NOe,{...u});case"automation":return a.jsx(_Oe,{...u,userContext:l});case"quiz":return a.jsx(POe,{...u,onComplete:(d,p)=>{console.log("Quiz completed:",{blockId:t.id,score:d,answers:p})}});case"user_submission":return a.jsx(ROe,{...u});case"accordion":return a.jsx(COe,{...u});default:return a.jsxs("div",{className:"border-2 border-dashed border-red-300 rounded-lg p-8 text-center bg-red-50",children:[a.jsx("div",{className:"text-red-400 mb-2",children:a.jsx("svg",{className:"w-8 h-8 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),a.jsxs("p",{className:"text-red-600 text-sm font-medium",children:["Unknown Block Type: ",t.block_type]}),a.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This block type is not supported"})]})}}var IOe="Separator",Z6="horizontal",DOe=["horizontal","vertical"],rW=O.forwardRef((t,e)=>{const{decorative:r,orientation:n=Z6,...i}=t,s=LOe(n)?n:Z6,l=r?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return a.jsx($t.div,{"data-orientation":s,...l,...i,ref:e})});rW.displayName=IOe;function LOe(t){return DOe.includes(t)}var nW=rW;const Pd=O.forwardRef(({className:t,orientation:e="horizontal",decorative:r=!0,...n},i)=>a.jsx(nW,{ref:i,decorative:r,orientation:e,className:ge("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Pd.displayName=nW.displayName;var YC="Switch",[$Oe,CEe]=Yp(YC),[BOe,FOe]=$Oe(YC),iW=O.forwardRef((t,e)=>{const{__scopeSwitch:r,name:n,checked:i,defaultChecked:s,required:o,disabled:l,value:c="on",onCheckedChange:u,form:f,...d}=t,[p,m]=O.useState(null),x=yr(e,N=>m(N)),y=O.useRef(!1),v=p?f||!!p.closest("form"):!0,[b=!1,w]=v0({prop:i,defaultProp:s,onChange:u});return a.jsxs(BOe,{scope:r,checked:b,disabled:l,children:[a.jsx($t.button,{type:"button",role:"switch","aria-checked":b,"aria-required":o,"data-state":aW(b),"data-disabled":l?"":void 0,disabled:l,value:c,...d,ref:x,onClick:Jt(t.onClick,N=>{w(j=>!j),v&&(y.current=N.isPropagationStopped(),y.current||N.stopPropagation())})}),v&&a.jsx(qOe,{control:p,bubbles:!y.current,name:n,value:c,checked:b,required:o,disabled:l,form:f,style:{transform:"translateX(-100%)"}})]})});iW.displayName=YC;var sW="SwitchThumb",oW=O.forwardRef((t,e)=>{const{__scopeSwitch:r,...n}=t,i=FOe(sW,r);return a.jsx($t.span,{"data-state":aW(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:e})});oW.displayName=sW;var qOe=t=>{const{control:e,checked:r,bubbles:n=!0,...i}=t,s=O.useRef(null),o=$C(r),l=IC(e);return O.useEffect(()=>{const c=s.current,u=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==r&&d){const p=new Event("click",{bubbles:n});d.call(c,r),c.dispatchEvent(p)}},[o,r,n]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:s,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function aW(t){return t?"checked":"unchecked"}var lW=iW,zOe=oW;const kp=O.forwardRef(({className:t,...e},r)=>a.jsx(lW,{className:ge("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:r,children:a.jsx(zOe,{className:ge("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));kp.displayName=lW.displayName;var UOe="Label",cW=O.forwardRef((t,e)=>a.jsx($t.label,{...t,ref:e,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));cW.displayName=UOe;var uW=cW;const HOe=it,WOe=(t,e)=>r=>HOe(t,r==null?void 0:r.class,r==null?void 0:r.className),VOe=WOe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),_t=O.forwardRef(({className:t,...e},r)=>a.jsx(uW,{ref:r,className:ge(VOe(),t),...e}));_t.displayName=uW.displayName;const If={ai_agent:"AI Agents",video:"Videos",document:"Documents",prompt:"Prompts",automation:"Automations",image:"Images",pdf:"PDFs"},Gg={ai_agent:"🤖",video:"📹",document:"📄",prompt:"💬",automation:"⚡",image:"🖼️",pdf:"📑"};function KOe({contentType:t,selectedItemId:e,onSelect:r,onCancel:n,className:i}){const{user:s}=Ln(),[o,l]=O.useState([]),[c,u]=O.useState(!0),[f,d]=O.useState(""),[p,m]=O.useState("grid"),[x,y]=O.useState("updated_at"),[v,b]=O.useState("desc"),[w,N]=O.useState("published"),[j,k]=O.useState(null);O.useEffect(()=>{_()},[t,x,v,w]);const _=async()=>{try{u(!0),k(null);let R=pe.from("content_items").select("*");if(t==="image"){const{data:z,error:W}=await pe.from("content_images").select("*").eq("status",w==="all"?void 0:w).order(x,{ascending:v==="asc"});if(W)throw W;l(z||[]);return}if(t==="pdf"){const{data:z,error:W}=await pe.from("content_pdfs").select("*").eq("status",w==="all"?void 0:w).order(x,{ascending:v==="asc"});if(W)throw W;l(z||[]);return}R=R.eq("content_type",t),w!=="all"&&(R=R.eq("status",w)),R=R.order(x,{ascending:v==="asc"});const{data:L,error:$}=await R;if($)throw $;const F=await Promise.all((L||[]).map(async z=>{try{switch(z.content_type){case"ai_agent":{const{data:W}=await pe.from("ai_agents").select("agent_name").eq("content_item_id",z.id).maybeSingle();return{...z,agent_name:W==null?void 0:W.agent_name}}case"video":{const{data:W}=await pe.from("videos").select("video_url").eq("content_item_id",z.id).maybeSingle();return{...z,video_url:W==null?void 0:W.video_url}}case"document":{const{data:W}=await pe.from("documents").select("content_html").eq("content_item_id",z.id).maybeSingle();return{...z,content_html:W==null?void 0:W.content_html}}case"prompt":{const{data:W}=await pe.from("prompts").select("prompt_text").eq("content_item_id",z.id).maybeSingle();return{...z,prompt_text:W==null?void 0:W.prompt_text}}case"automation":{const{data:W}=await pe.from("automations").select("automation_url").eq("content_item_id",z.id).maybeSingle();return{...z,automation_url:W==null?void 0:W.automation_url}}default:return z}}catch(W){return console.error(`Error loading details for ${z.content_type}:`,W),z}}));l(F)}catch(R){console.error("Error loading content:",R),k(R instanceof Error?R.message:"Failed to load content")}finally{u(!1)}},E=O.useMemo(()=>o.filter(R=>{var $,F,z,W;const L=f.toLowerCase();return(($=R.title)==null?void 0:$.toLowerCase().includes(L))||((F=R.description)==null?void 0:F.toLowerCase().includes(L))||((z=R.agent_name)==null?void 0:z.toLowerCase().includes(L))||((W=R.prompt_text)==null?void 0:W.toLowerCase().includes(L))}),[o,f]),A=R=>{x===R?b(v==="asc"?"desc":"asc"):(y(R),b("desc"))},T=R=>{switch(R){case"published":return a.jsxs(At,{className:"bg-green-100 text-green-800 border-green-200",children:[a.jsx(ln,{className:"w-3 h-3 mr-1"}),"Published"]});case"draft":return a.jsxs(At,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[a.jsx(go,{className:"w-3 h-3 mr-1"}),"Draft"]});case"archived":return a.jsxs(At,{className:"bg-gray-100 text-gray-800 border-gray-200",children:[a.jsx(t_,{className:"w-3 h-3 mr-1"}),"Archived"]});default:return a.jsx(At,{variant:"outline",children:R})}},M=R=>new Date(R).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),P=R=>{switch(R.content_type||t){case"ai_agent":return R.agent_name||"AI Agent";case"video":return"Video Content";case"document":return R.content_html?`${R.content_html.length} characters`:"Document";case"prompt":return R.prompt_text?R.prompt_text.substring(0,100)+"...":"Prompt";case"automation":return R.automation_url||"Automation";case"image":return"Image File";case"pdf":return"PDF Document";default:return R.description||"Content Item"}};return c?a.jsx("div",{className:ge("bg-white rounded-lg border border-gray-200 p-6 max-w-4xl mx-auto",i),children:a.jsxs("div",{className:"flex items-center justify-center h-64",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsxs("span",{className:"ml-3 text-gray-600",children:["Loading ",If[t],"..."]})]})}):a.jsxs("div",{className:ge("bg-white rounded-lg border border-gray-200 max-w-4xl mx-auto",i),children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:"text-2xl",children:Gg[t]}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold",children:["Select ",If[t]]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Choose content from your repository"})]})]}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:n,children:a.jsx($r,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(ct,{placeholder:`Search ${If[t].toLowerCase()}...`,value:f,onChange:R=>d(R.target.value),className:"pl-10"})]}),a.jsxs("div",{className:"flex border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx(fe,{variant:p==="grid"?"default":"ghost",size:"sm",onClick:()=>m("grid"),className:"rounded-none border-0",children:a.jsx(dd,{className:"h-4 w-4"})}),a.jsx(fe,{variant:p==="list"?"default":"ghost",size:"sm",onClick:()=>m("list"),className:"rounded-none border-0 border-l border-gray-200",children:a.jsx(rs,{className:"h-4 w-4"})})]}),a.jsxs("select",{value:w,onChange:R=>N(R.target.value),className:"border border-gray-200 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"published",children:"Published Only"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"archived",children:"Archived"})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>A("name"),className:ge("flex items-center space-x-1",x==="name"&&"bg-blue-50 border-blue-200"),children:[a.jsx("span",{children:"Name"}),x==="name"&&(v==="asc"?a.jsx(yM,{className:"h-3 w-3"}):a.jsx(gM,{className:"h-3 w-3"}))]}),a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>A("updated_at"),className:ge("flex items-center space-x-1",x==="updated_at"&&"bg-blue-50 border-blue-200"),children:[a.jsx("span",{children:"Modified"}),x==="updated_at"&&(v==="asc"?a.jsx(yM,{className:"h-3 w-3"}):a.jsx(gM,{className:"h-3 w-3"}))]})]})]})]}),a.jsxs("div",{className:"p-6",children:[j&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-red-800",children:j}),a.jsx(fe,{variant:"outline",size:"sm",onClick:_,className:"mt-2",children:"Try Again"})]}),E.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("span",{className:"text-6xl mb-4 block",children:Gg[t]}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",If[t]," Found"]}),a.jsx("p",{className:"text-gray-600 mb-4",children:f?"Try adjusting your search terms.":`No ${If[t].toLowerCase()} available yet.`}),f&&a.jsx(fe,{variant:"outline",onClick:()=>d(""),children:"Clear Search"})]}):a.jsx("div",{className:ge(p==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3"),children:E.map(R=>a.jsx("div",{onClick:()=>r(R),className:ge("border border-gray-200 rounded-lg p-4 cursor-pointer transition-all hover:border-blue-300 hover:shadow-md",e===R.id&&"border-blue-500 bg-blue-50",p==="list"&&"flex items-center space-x-4"),children:p==="grid"?a.jsxs("div",{children:[a.jsx("div",{className:"w-full h-32 bg-gray-100 rounded-lg flex items-center justify-center mb-3",children:a.jsx("span",{className:"text-3xl",children:Gg[t]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:R.title}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:P(R)}),a.jsxs("div",{className:"flex items-center justify-between",children:[T(R.status),a.jsx("span",{className:"text-xs text-gray-500",children:M(R.updated_at)})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-xl",children:Gg[t]})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-sm truncate",children:R.title}),a.jsx("p",{className:"text-xs text-gray-600 truncate",children:P(R)})]}),a.jsxs("div",{className:"flex items-center space-x-3 flex-shrink-0",children:[T(R.status),a.jsx("span",{className:"text-xs text-gray-500",children:M(R.updated_at)})]})]})},R.id))})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:[E.length," ",E.length===1?"item":"items",f&&` matching "${f}"`]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx(fe,{variant:"outline",onClick:n,children:"Cancel"}),a.jsx(fe,{disabled:!e,onClick:()=>{const R=E.find(L=>L.id===e);R&&r(R)},children:"Select Content"})]})]})]})}const GOe={section_header:{icon:DO,label:"Section Header",description:"Create section headings with formatting"},rich_text:{icon:Ot,label:"Rich Text",description:"WYSIWYG text editor with formatting"},list:{icon:rs,label:"List",description:"Bullets, numbers, checkboxes with interactions"},quote:{icon:xy,label:"Quote",description:"Blockquotes with optional author attribution"},divider:{icon:RO,label:"Division",description:"Horizontal rule with spacing controls"},quiz:{icon:AO,label:"Quiz",description:"Interactive quizzes with multiple question types"},accordion:{icon:mo,label:"Accordion",description:"Expandable content sections"},user_submission:{icon:Ir,label:"User Submission",description:"Forms for text and file submissions"}},YOe={video:{icon:UB,label:"Video",description:"Video content from repository"},agent:{icon:Kr,label:"AI Agent",description:"Interactive AI agent conversations"},document:{icon:IB,label:"Document",description:"Rich documents from repository"},prompt:{icon:Gr,label:"Prompts",description:"Interactive prompt execution"},automation:{icon:Ei,label:"Automation",description:"Process automation workflows"},image:{icon:Eu,label:"Image",description:"Images with upload or repository selection"},pdf:{icon:RX,label:"PDF",description:"PDF documents with carousel view"}};function XOe({onBlockAdd:t,onPageCreate:e,onPageSelect:r,pages:n,currentPageId:i,structure:s,onSave:o,onPreview:l,isPreviewMode:c=!1,onStructureUpdate:u,className:f}){const[d,p]=O.useState(null),[m,x]=O.useState(""),[y,v]=O.useState((s==null?void 0:s.title)||""),[b,w]=O.useState((s==null?void 0:s.description)||""),[N,j]=O.useState((s==null?void 0:s.status)==="published"),[k,_]=O.useState(!1),[E,A]=O.useState(!1),[T,M]=O.useState(!1),[P,R]=O.useState(null);O.useEffect(()=>{s&&(v(s.title||""),w(s.description||""),j(s.status==="published"),_(!1))},[s]),O.useEffect(()=>{if(s){const U=y!==(s.title||"")||b!==(s.description||"")||N!==(s.status==="published");_(U)}},[s,y,b,N]);const L=async()=>{if(!(!u||!s||!k)){A(!0);try{await u({title:y,description:b,status:N?"published":"draft"}),_(!1),console.log("Settings saved successfully")}catch(U){console.error("Failed to save settings:",U)}finally{A(!1)}}},$=async U=>{if(!P)return;const ee={video:"video",ai_agent:"agent",document:"document",prompt:"prompt",automation:"automation",image:"image",pdf:"pdf"}[P];ee&&await t(ee),M(!1),R(null),p(null)},F=()=>{M(!1),R(null)},z=U=>{p(d===U?null:U)},W=()=>{p(null)},K=Object.entries(GOe).filter(([U,G])=>m===""||G.label.toLowerCase().includes(m.toLowerCase())),q=Object.entries(YOe).filter(([U,G])=>m===""||G.label.toLowerCase().includes(m.toLowerCase())),V=K.length>0,D=q.length>0;return a.jsxs("div",{className:ge("flex",f),children:[a.jsxs("div",{className:"w-16 bg-gray-900 border-r border-gray-800 flex flex-col items-center py-4 space-y-2 fixed left-0 top-0 bottom-0 z-40",children:[a.jsx(fe,{variant:d==="setup"?"secondary":"ghost",size:"sm",onClick:()=>z("setup"),className:"w-12 h-12 p-0 text-gray-300 hover:text-white hover:bg-gray-700 data-[state=open]:bg-gray-700",title:"Setup",children:a.jsx(Dn,{className:"h-5 w-5"})}),a.jsx(fe,{variant:d==="elements"?"secondary":"ghost",size:"sm",onClick:()=>z("elements"),className:"w-12 h-12 p-0 text-gray-300 hover:text-white hover:bg-gray-700 data-[state=open]:bg-gray-700",title:"Elements",children:a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-6 h-6 border-2 border-current rounded-full flex items-center justify-center",children:a.jsx(Vt,{className:"h-3 w-3"})})})}),a.jsx(fe,{variant:d==="content"?"secondary":"ghost",size:"sm",onClick:()=>z("content"),className:"w-12 h-12 p-0 text-gray-300 hover:text-white hover:bg-gray-700 data-[state=open]:bg-gray-700",title:"Content",children:a.jsx(Ot,{className:"h-5 w-5"})}),a.jsx(fe,{variant:d==="pages"?"secondary":"ghost",size:"sm",onClick:()=>z("pages"),className:"w-12 h-12 p-0 text-gray-300 hover:text-white hover:bg-gray-700 data-[state=open]:bg-gray-700",title:"Pages",children:a.jsx(Sh,{className:"h-5 w-5"})}),a.jsx("div",{className:"flex-1"}),o&&a.jsx(fe,{variant:"ghost",size:"sm",onClick:o,className:"w-12 h-12 p-0 text-gray-300 hover:text-white hover:bg-gray-700",title:"Save",children:a.jsx(Cp,{className:"h-5 w-5"})}),l&&a.jsx(fe,{variant:"ghost",size:"sm",onClick:l,className:"w-12 h-12 p-0 text-gray-300 hover:text-white hover:bg-gray-700",title:c?"Exit Preview":"Preview",children:a.jsx(ii,{className:"h-5 w-5"})})]}),d&&a.jsx("div",{className:"fixed inset-0 z-30",onClick:W}),d&&a.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col fixed left-16 top-0 bottom-0 z-40 shadow-lg",children:[d==="setup"&&a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"font-semibold text-lg",children:"WOD Setup"}),E?a.jsxs("div",{className:"flex items-center text-blue-600 text-sm",children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-600 mr-2"}),"Saving..."]}):k?a.jsxs("div",{className:"flex items-center text-orange-600 text-sm",children:[a.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mr-2"}),"Unsaved"]}):a.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[a.jsx(ln,{className:"h-3 w-3 mr-1"}),"Saved"]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Configure your Workout of the Day"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"wod-title",className:"text-sm font-medium",children:"WOD Title"}),a.jsx(ct,{id:"wod-title",value:y,onChange:U=>v(U.target.value),placeholder:"Enter WOD title...",className:"mt-1"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"wod-description",className:"text-sm font-medium",children:"Description"}),a.jsx(Ai,{id:"wod-description",value:b,onChange:U=>w(U.target.value),placeholder:"Describe this WOD...",rows:3,className:"mt-1"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"publication-status",className:"text-sm font-medium",children:"Publication Status"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:N?"Published - visible to users":"Draft - only visible to admins"})]}),a.jsx(kp,{id:"publication-status",checked:N,onCheckedChange:j})]}),k&&a.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Unsaved Changes"}),a.jsx("p",{className:"text-xs text-orange-700 mt-1",children:"Click save to update WOD settings"})]}),a.jsx(fe,{onClick:L,disabled:E,size:"sm",className:"bg-orange-600 hover:bg-orange-700",children:E?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-white mr-2"}),"Saving..."]}):"Save Settings"})]})}),a.jsx(Pd,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"WOD Categories & Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{className:"text-sm font-medium",children:"Category"}),a.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 mt-1",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"strength",children:"Strength Training"}),a.jsx("option",{value:"cardio",children:"Cardiovascular"}),a.jsx("option",{value:"hiit",children:"HIIT"}),a.jsx("option",{value:"flexibility",children:"Flexibility & Mobility"}),a.jsx("option",{value:"functional",children:"Functional Fitness"}),a.jsx("option",{value:"olympic",children:"Olympic Lifting"}),a.jsx("option",{value:"bodyweight",children:"Bodyweight"}),a.jsx("option",{value:"crossfit",children:"CrossFit Style"})]})]}),a.jsxs("div",{children:[a.jsx(_t,{className:"text-sm font-medium",children:"Workout Type"}),a.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 mt-1",children:[a.jsx("option",{value:"",children:"Select Type"}),a.jsx("option",{value:"strength",children:"Strength"}),a.jsx("option",{value:"cardio",children:"Cardio"}),a.jsx("option",{value:"hiit",children:"HIIT"}),a.jsx("option",{value:"endurance",children:"Endurance"}),a.jsx("option",{value:"power",children:"Power"}),a.jsx("option",{value:"flexibility",children:"Flexibility"}),a.jsx("option",{value:"recovery",children:"Recovery"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(_t,{className:"text-sm font-medium",children:"Difficulty Level"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Set the difficulty level"})]}),a.jsxs("select",{className:"text-sm border rounded px-2 py-1",children:[a.jsx("option",{children:"Beginner"}),a.jsx("option",{children:"Intermediate"}),a.jsx("option",{children:"Advanced"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(_t,{className:"text-sm font-medium",children:"Progress Tracking"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Track user progress (ready for future functionality)"})]}),a.jsx(kp,{defaultChecked:!0,disabled:!0,className:"opacity-50"})]})]})]})]})]}),d==="elements"&&a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsx("h2",{className:"font-semibold text-lg mb-3",children:"Elements"}),a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(ct,{placeholder:"Search elements...",value:m,onChange:U=>x(U.target.value),className:"w-full pl-10"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"space-y-6",children:[V&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Basic Elements"}),a.jsx("div",{className:"space-y-3",children:K.map(([U,G])=>{const ee=G.icon;return a.jsxs(fe,{variant:"outline",onClick:()=>{t(U),p(null)},className:"w-full h-auto p-4 flex items-start space-x-3 hover:bg-gray-50 transition-colors text-left",children:[a.jsx(ee,{className:"h-5 w-5 text-gray-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-sm",children:G.label}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:G.description})]})]},U)})})]}),D&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Content Elements"}),a.jsx("div",{className:"space-y-3",children:q.map(([U,G])=>{const ee=G.icon;return a.jsxs(fe,{variant:"outline",onClick:()=>{t(U),p(null)},className:"w-full h-auto p-4 flex items-start space-x-3 hover:bg-gray-50 transition-colors text-left",children:[a.jsx(ee,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-sm",children:G.label}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:G.description})]}),a.jsx(At,{variant:"secondary",className:"text-xs ml-2",children:"Repository"})]},U)})})]}),!V&&!D&&m&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(dd,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No elements found"}),a.jsx("p",{className:"text-xs",children:"Try adjusting your search"})]})]})})]}),d==="content"&&a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsx("h2",{className:"font-semibold text-lg mb-3",children:"Content"}),a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(ct,{placeholder:"Search content blocks...",value:m,onChange:U=>x(U.target.value),className:"w-full pl-10"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsx("div",{className:"space-y-3",children:q.map(([U,G])=>{const ee=G.icon;return a.jsxs(fe,{variant:"outline",onClick:()=>{const Q={video:"video",agent:"ai_agent",document:"document",prompt:"prompt",automation:"automation",image:"image",pdf:"pdf"};U in Q?(R(Q[U]),M(!0)):(t(U),p(null))},className:"w-full h-auto p-4 flex items-start space-x-3 hover:bg-gray-50 transition-colors text-left",children:[a.jsx(ee,{className:"h-5 w-5 text-gray-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-sm",children:G.label}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Select from ",G.label.toLowerCase()," repository"]})]})]},U)})})})]}),d==="pages"&&a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"font-semibold text-lg",children:"Pages"}),a.jsxs(fe,{size:"sm",onClick:e,children:[a.jsx(Vt,{className:"h-4 w-4 mr-1"}),"New"]})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Manage WOD pages"})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"space-y-2",children:[n.map((U,G)=>a.jsx("div",{onClick:()=>{r(U.id),p(null)},className:ge("p-3 rounded-lg border cursor-pointer transition-colors",i===U.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:G+1}),a.jsx("span",{className:"font-medium text-sm",children:U.title})]}),a.jsxs(At,{variant:"outline",className:"text-xs",children:[U.blocks," blocks"]})]})},U.id)),n.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Sh,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No pages yet"}),a.jsx("p",{className:"text-xs",children:"Create your first page to get started"})]})]})})]})]}),T&&P&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx(KOe,{contentType:P,onSelect:$,onCancel:F,className:"max-w-4xl w-full mx-4"})})]})}function JOe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const i=t.content||{},s=i.title||"",o=i.subtitle||"",l=i.level||1,c=d=>{e({...i,title:d})},u=d=>{e({...i,subtitle:d})},f=d=>{e({...i,level:parseInt(d)})};if(n){const d=`h${l}`;return a.jsxs("div",{className:"p-4",children:[a.jsx(d,{className:`font-bold mb-2 ${l===1?"text-3xl":l===2?"text-2xl":l===3?"text-xl":l===4?"text-lg":l===5?"text-base":"text-sm"}`,children:s||"Untitled Section"}),o&&a.jsx("p",{className:"text-gray-600 text-sm",children:o})]})}return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"title",children:"Section Title"}),a.jsx(ct,{id:"title",value:s,onChange:d=>c(d.target.value),placeholder:"Enter section title...",className:"mt-1"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"subtitle",children:"Subtitle (optional)"}),a.jsx(ct,{id:"subtitle",value:o,onChange:d=>u(d.target.value),placeholder:"Enter subtitle...",className:"mt-1"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"level",children:"Heading Level"}),a.jsxs(ec,{value:l.toString(),onValueChange:f,children:[a.jsx(Da,{className:"mt-1",children:a.jsx(tc,{placeholder:"Select heading level"})}),a.jsxs(La,{children:[a.jsx(kt,{value:"1",children:"H1 - Main Title"}),a.jsx(kt,{value:"2",children:"H2 - Section Title"}),a.jsx(kt,{value:"3",children:"H3 - Subsection"}),a.jsx(kt,{value:"4",children:"H4 - Small Heading"}),a.jsx(kt,{value:"5",children:"H5 - Tiny Heading"})]})]})]})]})}function QOe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const i=t.content||{},s=i.html||"<p>Enter your text here...</p>";i.text;const o=Rv({extensions:[d0.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),xp,bp,CH.configure({types:["heading","paragraph"]}),NC.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 hover:text-blue-800 underline"}}),f0,u0.configure({placeholder:"Start typing your content here..."})],content:s,editable:!n,onUpdate:({editor:y})=>{const v=y.getHTML(),b=y.getText();e({html:v,text:b})}});if(O.useEffect(()=>{o&&o.getHTML()!==s&&o.commands.setContent(s)},[o,s]),!o)return a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"animate-pulse space-y-4",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})});const l=()=>o.chain().focus().toggleBold().run(),c=()=>o.chain().focus().toggleItalic().run(),u=()=>o.chain().focus().toggleUnderline().run(),f=()=>o.chain().focus().toggleStrike().run(),d=y=>o.chain().focus().setTextAlign(y).run(),p=()=>o.chain().focus().toggleBulletList().run(),m=()=>o.chain().focus().toggleOrderedList().run(),x=()=>{const y=o.getAttributes("link").href,v=window.prompt("URL",y);if(v!==null){if(v===""){o.chain().focus().extendMarkRange("link").unsetLink().run();return}o.chain().focus().extendMarkRange("link").setLink({href:v}).run()}};return n?a.jsx("div",{className:"p-4",children:a.jsx("div",{dangerouslySetInnerHTML:{__html:s},className:"prose prose-sm max-w-none"})}):a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{className:"text-base font-semibold mb-4 block",children:"Content Editor"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Use the toolbar below to format your text. Changes will be reflected on the canvas in real-time."})]}),a.jsx(Pd,{}),a.jsx("div",{className:"border border-gray-200 rounded-lg bg-gray-50 p-2",children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.jsx(fe,{variant:"ghost",size:"sm",onClick:l,className:ge("h-8 w-8 p-0",o.isActive("bold")&&"bg-gray-200"),children:a.jsx(my,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:c,className:ge("h-8 w-8 p-0",o.isActive("italic")&&"bg-gray-200"),children:a.jsx(vy,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:u,className:ge("h-8 w-8 p-0",o.isActive("underline")&&"bg-gray-200"),children:a.jsx(qB,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:f,className:ge("h-8 w-8 p-0",o.isActive("strike")&&"bg-gray-200"),children:a.jsx(BB,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1 self-center"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>d("left"),className:ge("h-8 w-8 p-0",o.isActive({textAlign:"left"})&&"bg-gray-200"),children:a.jsx(PB,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>d("center"),className:ge("h-8 w-8 p-0",o.isActive({textAlign:"center"})&&"bg-gray-200"),children:a.jsx(TB,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>d("right"),className:ge("h-8 w-8 p-0",o.isActive({textAlign:"right"})&&"bg-gray-200"),children:a.jsx(MB,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1 self-center"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:p,className:ge("h-8 w-8 p-0",o.isActive("bulletList")&&"bg-gray-200"),children:a.jsx(rs,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:m,className:ge("h-8 w-8 p-0",o.isActive("orderedList")&&"bg-gray-200"),children:a.jsx(MO,{className:"w-4 h-4"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:x,className:ge("h-8 w-8 p-0",o.isActive("link")&&"bg-gray-200"),children:a.jsx(E0,{className:"w-4 h-4"})})]})}),a.jsx("div",{className:"border border-gray-200 rounded-lg p-4 min-h-[300px] bg-white",children:a.jsx(Mv,{editor:o,className:"prose prose-gray max-w-none focus:outline-none min-h-[250px]"})}),a.jsxs("div",{className:"text-xs text-gray-500",children:[a.jsx("strong",{children:"Tip:"})," Select text and use the toolbar buttons to format it. Your changes will appear on the canvas immediately."]})]})}function ZOe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const{user:i}=Ln(),s=O.useRef(null),[o,l]=O.useState([]),[c,u]=O.useState(""),[f,d]=O.useState(!1),[p,m]=O.useState(!1),[x,y]=O.useState(!1),v=t.content||{},b=v.src||"",w=v.alt||"",N=v.caption||"",j=v.width,k=v.height;Z.useEffect(()=>{x&&_()},[x]);const _=async()=>{if(i)try{d(!0);const{data:$,error:F}=await pe.from("uploaded_files").select("*").like("mime_type","image/%").order("created_at",{ascending:!1});if(F)throw F;l($||[])}catch($){console.error("Error loading images:",$)}finally{d(!1)}},E=async $=>{var z;const F=(z=$.target.files)==null?void 0:z[0];if(F){if(!F.type.startsWith("image/")){alert("Please select a valid image file");return}if(F.size>5*1024*1024){alert("File size must be less than 5MB");return}try{m(!0);const W=await new Promise((D,U)=>{const G=new FileReader;G.onloadend=()=>D(G.result),G.onerror=U,G.readAsDataURL(F)}),{data:K,error:q}=await pe.functions.invoke("enhanced-file-upload",{body:{fileData:W,fileName:F.name,fileType:F.type,folder:"page-builder"}});if(q)throw q;const V=K.data;e({...v,src:V.publicUrl,alt:w||F.name,width:void 0,height:void 0}),_()}catch(W){console.error("Error uploading file:",W),alert("Failed to upload image. Please try again.")}finally{m(!1),s.current&&(s.current.value="")}}},A=$=>{e({...v,src:$.file_url,alt:w||$.filename,width:void 0,height:void 0}),y(!1)},T=$=>{e({...v,alt:$})},M=$=>{e({...v,caption:$})},P=($,F)=>{const z=F?parseInt(F,10):void 0;e({...v,[$]:z})},R=()=>{e({...v,src:"",alt:"",caption:"",width:void 0,height:void 0})},L=o.filter($=>c===""||$.filename.toLowerCase().includes(c.toLowerCase()));return n?b?a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:b,alt:w,style:{width:j?`${j}px`:"auto",height:k?`${k}px`:"auto",maxWidth:"100%"},className:"rounded-lg shadow-sm mx-auto"}),N&&a.jsx("p",{className:"text-sm text-gray-600 mt-2 italic",children:N})]})}):a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Eu,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No image selected"})]}):a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{children:"Current Image"}),b?a.jsxs("div",{className:"mt-2 relative",children:[a.jsx("img",{src:b,alt:w,className:"w-full max-w-xs rounded-lg border border-gray-200"}),a.jsx(fe,{variant:"destructive",size:"sm",onClick:R,className:"absolute top-2 right-2 h-6 w-6 p-0",children:a.jsx($r,{className:"h-3 w-3"})})]}):a.jsxs("div",{className:"mt-2 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center text-gray-500",children:[a.jsx(Eu,{className:"h-12 w-12 mx-auto mb-2"}),a.jsx("p",{children:"No image selected"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(fe,{onClick:()=>{var $;return($=s.current)==null?void 0:$.click()},disabled:p,size:"sm",children:[a.jsx(Ir,{className:"h-4 w-4 mr-1"}),p?"Uploading...":"Upload New"]}),a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>y(!x),children:x?"Hide Repository":"Browse Repository"})]}),a.jsx("input",{type:"file",ref:s,onChange:E,accept:"image/*",className:"hidden"}),x&&a.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[a.jsx("div",{className:"p-3 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(In,{className:"h-4 w-4 text-gray-400"}),a.jsx(ct,{placeholder:"Search images...",value:c,onChange:$=>u($.target.value),className:"flex-1"})]})}),a.jsx("div",{className:"max-h-64 overflow-y-auto",children:f?a.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading images..."}):L.length>0?a.jsx("div",{className:"grid grid-cols-3 gap-2 p-3",children:L.map($=>a.jsx("button",{onClick:()=>A($),className:"aspect-square bg-gray-100 rounded border hover:border-blue-500 transition-colors overflow-hidden",children:a.jsx("img",{src:$.file_url,alt:$.filename,className:"w-full h-full object-cover"})},$.id))}):a.jsx("div",{className:"p-4 text-center text-gray-500",children:a.jsx("p",{children:"No images found"})})})]}),b&&a.jsxs(a.Fragment,{children:[a.jsx(Pd,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"alt-text",children:"Alt Text"}),a.jsx(ct,{id:"alt-text",value:w,onChange:$=>T($.target.value),placeholder:"Describe this image for accessibility...",className:"mt-1"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alt text is important for screen readers and SEO"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"caption",children:"Caption (optional)"}),a.jsx(Ai,{id:"caption",value:N,onChange:$=>M($.target.value),placeholder:"Add a caption that will appear below the image...",className:"mt-1 min-h-[60px]"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"width",children:"Width (px)"}),a.jsx(ct,{id:"width",type:"number",value:j||"",onChange:$=>P("width",$.target.value),placeholder:"Auto",className:"mt-1"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"height",children:"Height (px)"}),a.jsx(ct,{id:"height",type:"number",value:k||"",onChange:$=>P("height",$.target.value),placeholder:"Auto",className:"mt-1"})]})]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Leave dimensions empty for automatic sizing"})]})]})]})}const dW=({fileTypes:t=[],onSelect:e,onCancel:r,allowUpload:n=!0,multiSelect:i=!1,title:s="Content Repository",subtitle:o="Select content from your repository"})=>{const[l,c]=O.useState([]),[u,f]=O.useState([]),[d,p]=O.useState(!0),[m,x]=O.useState(null),[y,v]=O.useState(""),[b,w]=O.useState("grid"),[N,j]=O.useState("created_at"),[k,_]=O.useState("desc"),[E,A]=O.useState(!0),[T,M]=O.useState([]),[P,R]=O.useState(null),[L,$]=O.useState(0),[F,z]=O.useState(!1);O.useEffect(()=>{W()},[]),O.useEffect(()=>{K()},[l,y,N,k,E,t]);const W=async()=>{try{p(!0),x(null);let Q=pe.from("uploaded_files").select("*");if(t.length>0){const re=t.map(J=>J.endsWith("/*")?`file_type.like.${J.replace("/*","/%")}`:`file_type.eq.${J}`);Q=Q.or(re.join(","))}const{data:H,error:Y}=await Q;if(Y)throw Y;c(H||[])}catch(Q){console.error("Error fetching files:",Q),x(Q.message||"Failed to load files")}finally{p(!1)}},K=()=>{let Q=[...l];y.trim()&&(Q=Q.filter(H=>H.file_name.toLowerCase().includes(y.toLowerCase()))),E&&(Q=Q.filter(H=>H.is_published)),Q.sort((H,Y)=>{let re,J;switch(N){case"name":re=H.file_name.toLowerCase(),J=Y.file_name.toLowerCase();break;case"created_at":re=new Date(H.created_at).getTime(),J=new Date(Y.created_at).getTime();break;case"file_size":re=H.file_size,J=Y.file_size;break;default:return 0}return re<J?k==="asc"?-1:1:re>J?k==="asc"?1:-1:0}),f(Q)},q=async Q=>{const H=Q.target.files;if(!H||H.length===0)return;const Y=H[0];try{z(!0),$(0),x(null);const ne=`uploads/${`${Date.now()}-${Y.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`}`,{data:te,error:se}=await pe.storage.from("missions").upload(ne,Y,{cacheControl:"3600",upsert:!1});if(se)throw se;const{data:{user:ve}}=await pe.auth.getUser();if(!ve)throw new Error("User not authenticated");const{data:ie}=await pe.from("users").select("organization_id").eq("id",ve.id).single();if(!(ie!=null&&ie.organization_id))throw new Error("User organization not found");const{data:ye,error:Te}=await pe.from("uploaded_files").insert({file_name:Y.name,file_type:Y.type,file_size:Y.size,storage_path:ne,organization_id:ie.organization_id,uploader_id:ve.id,is_published:!0}).select().single();if(Te)throw Te;await W(),e(ye)}catch(re){console.error("Error uploading file:",re),x(re.message||"Failed to upload file")}finally{z(!1),$(0)}},V=Q=>{if(Q===0)return"0 Bytes";const H=1024,Y=["Bytes","KB","MB","GB"],re=Math.floor(Math.log(Q)/Math.log(H));return parseFloat((Q/Math.pow(H,re)).toFixed(2))+" "+Y[re]},D=Q=>Q.startsWith("image/")?"🖼️":Q==="application/pdf"?"📄":Q.startsWith("video/")?"🎥":"📎",U=Q=>{if(i){const H=T.includes(Q.id)?T.filter(Y=>Y!==Q.id):[...T,Q.id];M(H)}else R(Q)},G=()=>{P&&e(P)},ee=()=>{const Q=u.filter(H=>T.includes(H.id));Q.length>0&&e(Q[0])};return d?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg p-8 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:a.jsxs("div",{className:"flex items-center justify-center h-64",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),a.jsx("span",{className:"ml-3 text-lg",children:"Loading files..."})]})})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:s}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"×"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",placeholder:t.some(Q=>Q.startsWith("video"))?"Search videos...":"Search files...",value:y,onChange:Q=>v(Q.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs("div",{className:"flex border border-gray-300 rounded-md",children:[a.jsx("button",{onClick:()=>w("grid"),className:`p-2 ${b==="grid"?"bg-blue-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(dd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>w("list"),className:`p-2 ${b==="list"?"bg-blue-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:a.jsx(rs,{className:"h-4 w-4"})})]}),a.jsxs("select",{value:`${N}-${k}`,onChange:Q=>{const[H,Y]=Q.target.value.split("-");j(H),_(Y)},className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"created_at-desc",children:"Newest First"}),a.jsx("option",{value:"created_at-asc",children:"Oldest First"}),a.jsx("option",{value:"name-asc",children:"Name A-Z"}),a.jsx("option",{value:"name-desc",children:"Name Z-A"}),a.jsx("option",{value:"file_size-desc",children:"Largest First"}),a.jsx("option",{value:"file_size-asc",children:"Smallest First"})]}),a.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx("input",{type:"checkbox",checked:E,onChange:Q=>A(Q.target.checked),className:"rounded border-gray-300 focus:ring-2 focus:ring-blue-500"}),"Published Only"]})]})]})]}),n&&a.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md cursor-pointer transition-colors",children:[a.jsx(Ir,{className:"h-4 w-4"}),F?"Uploading...":"Upload New File",a.jsx("input",{type:"file",onChange:q,className:"hidden",accept:t.join(","),disabled:F})]}),F&&a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${L}%`}})})})]})}),m&&a.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:a.jsx("p",{className:"text-red-600",children:m})}),a.jsx("div",{className:"flex-1 overflow-auto p-6",children:u.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"📁"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No files found"}),a.jsx("p",{className:"text-gray-600",children:y?"Try adjusting your search terms":"Upload some files to get started"})]}):b==="grid"?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:u.map(Q=>a.jsx("div",{onClick:()=>U(Q),className:`border-2 rounded-lg p-4 cursor-pointer transition-all duration-200 hover:shadow-lg ${i&&T.includes(Q.id)||!i&&(P==null?void 0:P.id)===Q.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-4xl mb-2",children:D(Q.file_type)}),a.jsx("h4",{className:"font-medium text-sm text-gray-900 mb-1 truncate",title:Q.file_name,children:Q.file_name}),a.jsx("p",{className:"text-xs text-gray-500",children:V(Q.file_size)}),a.jsx("p",{className:"text-xs text-gray-400",children:new Date(Q.created_at).toLocaleDateString()})]})},Q.id))}):a.jsx("div",{className:"space-y-2",children:u.map(Q=>a.jsxs("div",{onClick:()=>U(Q),className:`flex items-center gap-4 p-4 rounded-lg cursor-pointer transition-all duration-200 hover:bg-gray-50 ${i&&T.includes(Q.id)||!i&&(P==null?void 0:P.id)===Q.id?"bg-blue-50 border border-blue-200":"border border-gray-200"}`,children:[a.jsx("div",{className:"text-2xl",children:D(Q.file_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:Q.file_name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[V(Q.file_size)," • ",new Date(Q.created_at).toLocaleDateString()]})]}),!Q.is_published&&a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:"Draft"})]},Q.id))})}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between items-center",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:[u.length," file",u.length!==1?"s":""," found",i&&T.length>0&&` • ${T.length} selected`,!i&&P&&` • ${P.file_name} selected`]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),i&&T.length>0&&a.jsxs("button",{onClick:ee,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors",children:["Select ",T.length," File",T.length!==1?"s":""]}),!i&&P&&a.jsx("button",{onClick:G,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors",children:"Select Content"})]})]})]})})};function eEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const{user:i}=Ln(),[s,o]=O.useState([]),[l,c]=O.useState(!1),[u,f]=O.useState(!1),d=t.content||{},p=d.video_id,m=s.find(k=>k.id===p),x=d.autoplay||!1,y=d.controls!==!1;O.useEffect(()=>{v()},[]);const v=async()=>{if(i)try{c(!0);const{data:k,error:_}=await pe.from("videos").select("*").eq("status","published").order("created_at",{ascending:!1});if(_)throw _;o(k||[])}catch(k){console.error("Error loading videos:",k)}finally{c(!1)}},b=k=>{e({...d,video_id:k.id,title:k.file_name,description:"",thumbnail:"",url:k.storage_path,platform:"direct",video_id_external:"",duration:0}),f(!1)},w=k=>{e({...d,autoplay:k})},N=k=>{e({...d,controls:k})},j=k=>k.video_url?k.video_url:k.platform==="youtube"&&k.video_id_external?`https://www.youtube.com/embed/${k.video_id_external}?autoplay=${x?1:0}&controls=${y?1:0}`:k.platform==="vimeo"&&k.video_id_external?`https://player.vimeo.com/video/${k.video_id_external}?autoplay=${x?1:0}&controls=${y?1:0}`:null;if(n){if(!m)return a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(si,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No video selected"})]});const k=j(m);return k?a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"aspect-video bg-black rounded-lg overflow-hidden",children:m.platform&&m.platform!=="direct"?a.jsx("iframe",{src:k,title:m.title,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):a.jsx("video",{src:k,controls:y,autoPlay:x,className:"w-full h-full",poster:m.thumbnail_url,children:"Your browser does not support the video tag."})}),a.jsxs("div",{className:"mt-3",children:[a.jsx("h3",{className:"font-medium",children:m.title}),m.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.description}),m.duration&&a.jsxs(At,{variant:"secondary",className:"mt-2 text-xs",children:[Math.floor(m.duration/60),":",(m.duration%60).toString().padStart(2,"0")]})]})]}):a.jsx("div",{className:"p-4 text-center text-red-500",children:a.jsx("p",{children:"Invalid video configuration"})})}return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx(_t,{children:"Selected Video"}),a.jsx(fe,{size:"sm",onClick:()=>{console.log("Browse Repository button clicked"),f(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white",children:"Browse Repository"})]}),m?a.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:m.title}),m.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.description}),a.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[a.jsx(At,{variant:"outline",className:"text-xs",children:m.platform||"Direct"}),m.duration&&a.jsxs(At,{variant:"secondary",className:"text-xs",children:[Math.floor(m.duration/60),":",(m.duration%60).toString().padStart(2,"0")]})]})]}),m.thumbnail_url&&a.jsx("img",{src:m.thumbnail_url,alt:m.title,className:"w-16 h-12 object-cover rounded"})]})}):a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center text-gray-500",children:[a.jsx(si,{className:"h-12 w-12 mx-auto mb-2"}),a.jsx("p",{children:"No video selected"}),a.jsx("p",{className:"text-sm",children:"Browse the repository to select a video"})]})]}),u&&a.jsx(dW,{title:"Select Videos",subtitle:"Choose a video from your content repository",fileTypes:["video/*"],onSelect:b,onCancel:()=>f(!1),allowUpload:!0}),m&&a.jsxs(a.Fragment,{children:[a.jsx(Pd,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(_t,{className:"font-medium",children:"Autoplay"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Start playing automatically when visible"})]}),a.jsx(kp,{checked:x,onCheckedChange:w})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(_t,{className:"font-medium",children:"Show Controls"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Display video player controls"})]}),a.jsx(kp,{checked:y,onCheckedChange:N})]})]})]})]})}function tEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const{user:i}=Ln(),[s,o]=O.useState([]),[l,c]=O.useState(!1),[u,f]=O.useState(!1),d=t.content||{},p=d.agent_id,m=s.find(j=>j.id===p),x=d.initial_message||"",y=d.context||"";O.useEffect(()=>{v()},[]);const v=async()=>{if(i)try{c(!0);const{data:j,error:k}=await pe.from("ai_agents").select("*").eq("status","published").order("created_at",{ascending:!1});if(k)throw k;o(j||[])}catch(j){console.error("Error loading AI agents:",j)}finally{c(!1)}},b=j=>{e({...d,agent_id:j.id,agent_name:j.file_name,agent_description:"AI Agent from file repository",model:"default",avatar_url:""}),f(!1)},w=j=>{e({...d,initial_message:j})},N=j=>{e({...d,context:j})};return n?m?a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:m.avatar_url?a.jsx("img",{src:m.avatar_url,alt:m.name,className:"w-full h-full rounded-full object-cover"}):a.jsx(Kr,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-blue-900",children:m.name}),m.description&&a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:m.description}),x&&a.jsx("div",{className:"mt-3 bg-white border border-blue-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(Gr,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-gray-700",children:x})]})}),a.jsx(fe,{size:"sm",className:"mt-3 bg-blue-600 hover:bg-blue-700",disabled:!0,children:"Start Conversation"})]})]})})}):a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx(Kr,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No AI agent selected"})]}):a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx(_t,{children:"Selected AI Agent"}),a.jsx(fe,{size:"sm",onClick:()=>{console.log("Browse Repository button clicked"),f(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white",children:"Browse Repository"})]}),m?a.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0",children:m.avatar_url?a.jsx("img",{src:m.avatar_url,alt:m.name,className:"w-full h-full rounded-full object-cover"}):a.jsx(Kr,{className:"h-5 w-5 text-gray-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:m.name}),m.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.description}),a.jsx("div",{className:"flex items-center space-x-2 mt-2",children:a.jsx(At,{variant:"outline",className:"text-xs",children:m.model||"Default Model"})})]})]})}):a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center text-gray-500",children:[a.jsx(Kr,{className:"h-12 w-12 mx-auto mb-2"}),a.jsx("p",{children:"No AI agent selected"}),a.jsx("p",{className:"text-sm",children:"Browse the repository to select an agent"})]})]}),u&&a.jsx(dW,{title:"Select AI Agent",subtitle:"Choose an AI agent from your content repository",fileTypes:["application/json"],onSelect:b,onCancel:()=>f(!1),allowUpload:!0}),m&&a.jsxs(a.Fragment,{children:[a.jsx(Pd,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"initial-message",children:"Initial Message (optional)"}),a.jsx(Ai,{id:"initial-message",value:x,onChange:j=>w(j.target.value),placeholder:"Enter the agent's greeting message...",className:"mt-1 min-h-[80px]"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This message will be displayed when the agent first loads"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"custom-context",children:"Additional Context (optional)"}),a.jsx(Ai,{id:"custom-context",value:y,onChange:j=>N(j.target.value),placeholder:"Provide additional context specific to this interaction...",className:"mt-1 min-h-[80px]"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Additional context that will be provided to the agent for this specific interaction"})]})]})]})]})}function rEe(t,e){return O.useReducer((r,n)=>e[r][n]??r,t)}var fW=t=>{const{present:e,children:r}=t,n=nEe(e),i=typeof r=="function"?r({present:n.isPresent}):O.Children.only(r),s=yr(n.ref,iEe(i));return typeof r=="function"||n.isPresent?O.cloneElement(i,{ref:s}):null};fW.displayName="Presence";function nEe(t){const[e,r]=O.useState(),n=O.useRef({}),i=O.useRef(t),s=O.useRef("none"),o=t?"mounted":"unmounted",[l,c]=rEe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return O.useEffect(()=>{const u=Yg(n.current);s.current=l==="mounted"?u:"none"},[l]),Sn(()=>{const u=n.current,f=i.current;if(f!==t){const p=s.current,m=Yg(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&p!==m?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,c]),Sn(()=>{if(e){let u;const f=e.ownerDocument.defaultView??window,d=m=>{const y=Yg(n.current).includes(m.animationName);if(m.target===e&&y&&(c("ANIMATION_END"),!i.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",u=f.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},p=m=>{m.target===e&&(s.current=Yg(n.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{f.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:O.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function Yg(t){return(t==null?void 0:t.animationName)||"none"}function iEe(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var XC="Checkbox",[sEe,AEe]=Yp(XC),[oEe,aEe]=sEe(XC),hW=O.forwardRef((t,e)=>{const{__scopeCheckbox:r,name:n,checked:i,defaultChecked:s,required:o,disabled:l,value:c="on",onCheckedChange:u,form:f,...d}=t,[p,m]=O.useState(null),x=yr(e,j=>m(j)),y=O.useRef(!1),v=p?f||!!p.closest("form"):!0,[b=!1,w]=v0({prop:i,defaultProp:s,onChange:u}),N=O.useRef(b);return O.useEffect(()=>{const j=p==null?void 0:p.form;if(j){const k=()=>w(N.current);return j.addEventListener("reset",k),()=>j.removeEventListener("reset",k)}},[p,w]),a.jsxs(oEe,{scope:r,state:b,disabled:l,children:[a.jsx($t.button,{type:"button",role:"checkbox","aria-checked":Ca(b)?"mixed":b,"aria-required":o,"data-state":gW(b),"data-disabled":l?"":void 0,disabled:l,value:c,...d,ref:x,onKeyDown:Jt(t.onKeyDown,j=>{j.key==="Enter"&&j.preventDefault()}),onClick:Jt(t.onClick,j=>{w(k=>Ca(k)?!0:!k),v&&(y.current=j.isPropagationStopped(),y.current||j.stopPropagation())})}),v&&a.jsx(lEe,{control:p,bubbles:!y.current,name:n,value:c,checked:b,required:o,disabled:l,form:f,style:{transform:"translateX(-100%)"},defaultChecked:Ca(s)?!1:s})]})});hW.displayName=XC;var pW="CheckboxIndicator",mW=O.forwardRef((t,e)=>{const{__scopeCheckbox:r,forceMount:n,...i}=t,s=aEe(pW,r);return a.jsx(fW,{present:n||Ca(s.state)||s.state===!0,children:a.jsx($t.span,{"data-state":gW(s.state),"data-disabled":s.disabled?"":void 0,...i,ref:e,style:{pointerEvents:"none",...t.style}})})});mW.displayName=pW;var lEe=t=>{const{control:e,checked:r,bubbles:n=!0,defaultChecked:i,...s}=t,o=O.useRef(null),l=$C(r),c=IC(e);O.useEffect(()=>{const f=o.current,d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&m){const x=new Event("click",{bubbles:n});f.indeterminate=Ca(r),m.call(f,Ca(r)?!1:r),f.dispatchEvent(x)}},[l,r,n]);const u=O.useRef(Ca(r)?!1:r);return a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??u.current,...s,tabIndex:-1,ref:o,style:{...t.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ca(t){return t==="indeterminate"}function gW(t){return Ca(t)?"indeterminate":t?"checked":"unchecked"}var yW=hW,cEe=mW;const Yf=O.forwardRef(({className:t,...e},r)=>a.jsx(yW,{ref:r,className:ge("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(cEe,{className:ge("flex items-center justify-center text-current"),children:a.jsx(ko,{className:"h-4 w-4"})})}));Yf.displayName=yW.displayName;function uEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const i=t.content||{},s=i.type||"unordered",o=i.items||[{id:"1",text:""}],l=i.checklistStyle||!1,c=y=>{e({...i,type:y})},u=y=>{e({...i,checklistStyle:y,items:o.map(v=>({...v,checked:y?!1:void 0}))})},f=(y,v)=>{const b=o.map(w=>w.id===y?{...w,text:v}:w);e({...i,items:b})},d=(y,v)=>{const b=o.map(w=>w.id===y?{...w,checked:v}:w);e({...i,items:b})},p=()=>{const y=(Math.max(...o.map(b=>parseInt(b.id)||0))+1).toString(),v=[...o,{id:y,text:"",...l&&{checked:!1}}];e({...i,items:v})},m=y=>{if(o.length<=1)return;const v=o.filter(b=>b.id!==y);e({...i,items:v})},x=(y,v)=>{const b=[...o],w=y-1;w<0||w>=b.length||([b[y],b[w]]=[b[w],b[y]],e({...i,items:b}))};return n?a.jsx("div",{className:"p-4",children:s==="ordered"?a.jsx("ol",{className:"list-decimal list-inside space-y-2",children:o.map((y,v)=>a.jsx("li",{className:"flex items-start",children:l?a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Yf,{checked:y.checked||!1,disabled:!0,className:"mt-0.5"}),a.jsx("span",{className:y.checked?"line-through text-gray-500":"",children:y.text||`Item ${v+1}`})]}):a.jsx("span",{children:y.text||`Item ${v+1}`})},y.id))}):a.jsx("ul",{className:"list-disc list-inside space-y-2",children:o.map((y,v)=>a.jsx("li",{className:"flex items-start",children:l?a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsx(Yf,{checked:y.checked||!1,disabled:!0,className:"mt-0.5"}),a.jsx("span",{className:y.checked?"line-through text-gray-500":"",children:y.text||`Item ${v+1}`})]}):a.jsx("span",{className:"ml-4",children:y.text||`Item ${v+1}`})},y.id))})}):a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"list-type",children:"List Type"}),a.jsxs(ec,{value:s,onValueChange:c,children:[a.jsx(Da,{className:"mt-1",children:a.jsx(tc,{placeholder:"Select list type"})}),a.jsxs(La,{children:[a.jsx(kt,{value:"unordered",children:"Bulleted List"}),a.jsx(kt,{value:"ordered",children:"Numbered List"})]})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Yf,{id:"checklist-style",checked:l,onCheckedChange:u}),a.jsx(_t,{htmlFor:"checklist-style",className:"text-sm",children:"Interactive Checklist"})]})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(_t,{children:"List Items"}),a.jsxs(fe,{size:"sm",onClick:p,children:[a.jsx(Vt,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),o.map((y,v)=>a.jsxs("div",{className:"flex items-center space-x-2 group",children:[a.jsx("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>x(v),disabled:v===0,className:"h-8 w-8 p-0",children:a.jsx(DB,{className:"h-4 w-4"})})}),l&&a.jsx(Yf,{checked:y.checked||!1,onCheckedChange:b=>d(y.id,b)}),a.jsx(ct,{value:y.text,onChange:b=>f(y.id,b.target.value),placeholder:`Item ${v+1}...`,className:"flex-1"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>m(y.id),disabled:o.length<=1,className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(RO,{className:"h-4 w-4"})})]},y.id))]})]})}function dEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){const i=t.content||{},s=i.text||"",o=i.author||"",l=i.source||"",c=d=>{e({...i,text:d})},u=d=>{e({...i,author:d})},f=d=>{e({...i,source:d})};return n?a.jsx("div",{className:"p-4",children:a.jsxs("blockquote",{className:"border-l-4 border-blue-500 bg-blue-50 p-4 italic",children:[a.jsxs("p",{className:"text-gray-800 text-lg mb-2",children:['"',s||"Enter your quote text...",'"']}),(o||l)&&a.jsxs("footer",{className:"text-gray-600 text-sm",children:[o&&a.jsx("span",{className:"font-medium",children:o}),o&&l&&a.jsx("span",{children:", "}),l&&a.jsx("cite",{className:"not-italic",children:l})]})]})}):a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"quote-text",children:"Quote Text"}),a.jsx(Ai,{id:"quote-text",value:s,onChange:d=>c(d.target.value),placeholder:"Enter the quote text...",className:"mt-1 min-h-[100px]"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"quote-author",children:"Author (optional)"}),a.jsx(ct,{id:"quote-author",value:o,onChange:d=>u(d.target.value),placeholder:"Quote author...",className:"mt-1"})]}),a.jsxs("div",{children:[a.jsx(_t,{htmlFor:"quote-source",children:"Source (optional)"}),a.jsx(ct,{id:"quote-source",value:l,onChange:d=>f(d.target.value),placeholder:"Source or publication...",className:"mt-1"})]})]})}function fEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){return Z.createElement("div",{className:"p-4 text-center text-gray-500"},Z.createElement("p",null,"Document editor coming soon"),Z.createElement("p",{className:"text-sm"},"This will integrate with the document repository"))}function hEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){return Z.createElement("div",{className:"p-4 text-center text-gray-500"},Z.createElement("p",null,"Prompt editor coming soon"),Z.createElement("p",{className:"text-sm"},"This will integrate with the prompts repository"))}function pEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){return Z.createElement("div",{className:"p-4 text-center text-gray-500"},Z.createElement("p",null,"Automation editor coming soon"),Z.createElement("p",{className:"text-sm"},"This will integrate with the automations repository"))}function mEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){return Z.createElement("div",{className:"p-4 text-center text-gray-500"},Z.createElement("p",null,"Quiz editor coming soon"),Z.createElement("p",{className:"text-sm"},"This will include question creation and scoring"))}function gEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){return Z.createElement("div",{className:"p-4 text-center text-gray-500"},Z.createElement("p",null,"Accordion editor coming soon"),Z.createElement("p",{className:"text-sm"},"This will create expandable sections"))}function yEe({block:t,onContentChange:e,onConfigChange:r,isPreview:n}){return Z.createElement("div",{className:"p-4 text-center text-gray-500"},Z.createElement("p",null,"User submission editor coming soon"),Z.createElement("p",{className:"text-sm"},"This will create forms for user data collection"))}function Fk(){const{type:t,id:e}=us(),r=Ti(),{user:n}=Ln(),{structure:i,currentPage:s,selectedBlock:o,isEditing:l,previewMode:c,loading:u,error:f,loadStructure:d,createPage:p,updatePage:m,navigateToPage:x,createBlock:y,updateBlock:v,deleteBlock:b,reorderBlocks:w,setSelectedBlock:N,setIsEditing:j,setPreviewMode:k}=C8(t==="wods"?"mission":"course",e||""),_=O.useCallback(async Ae=>{var ut,wt;if(!i)return;const Me=t==="wods",Re=Me?qf:zf,sr=Me?(ut=i.mission)==null?void 0:ut.id:(wt=i.course)==null?void 0:wt.id;if(!sr)throw new Error("Parent ID not found");try{await Re.update(sr,Ae),await d()}catch(ci){throw console.error("Failed to update structure:",ci),ci}},[i,t,d]),{trackProgress:E}=A8(t==="wods"?"mission":"course",e||""),[A,T]=O.useState("desktop"),[M,P]=O.useState(!1),[R,L]=O.useState({isOpen:!1}),[$,F]=O.useState(!1),[z,W]=O.useState("idle"),[K,q]=O.useState(null),[V,D]=O.useState(null),[U,G]=O.useState(null),ee=Fx(Bx(Ad,{activationConstraint:{distance:8}})),Q=O.useRef(!0),H=O.useRef(null),Y=O.useMemo(()=>s?{id:s.id,title:s.title,description:s.description,status:s.status,is_locked:s.is_locked,unlock_conditions:s.unlock_conditions,page_config:s.page_config,order_index:s.order_index}:null,[s==null?void 0:s.id,s==null?void 0:s.title,s==null?void 0:s.description,s==null?void 0:s.status]);O.useEffect(()=>{e&&Q.current&&d(!0)},[e,d]),O.useEffect(()=>()=>{Q.current=!1,H.current&&H.current.abort()},[]);const re=O.useCallback(async Ae=>{if(!s||!Q.current){console.warn("Cannot add block - no current page or component unmounted");return}try{const Me=Xye[Ae];if(!Me)throw new Error(`Unknown block type: ${Ae}`);console.log("Creating block of type:",Ae);const Re=await y(Ae,Me.defaultContent||{});Re&&Q.current&&(N(Re),P(!0),j(!0),E({progressType:"block_interacted",pageId:s.id,progressData:{action:"block_created",blockType:Ae}}))}catch(Me){console.error("Failed to add block:",Me),q(Me instanceof Error?Me.message:"Failed to add block"),W("error")}},[s,y,E,N,j]),J=O.useCallback(async(Ae,Me)=>{new AbortController;try{await v(Ae,{content:Me}),Q.current&&j(!0)}catch(Re){Re.name!=="AbortError"&&(console.error("Failed to update block content:",Re),q(Re instanceof Error?Re.message:"Failed to update block"),W("error"))}},[v,j]),ne=O.useCallback(Ae=>{Q.current&&(N(Ae),P(!0),j(!1))},[N,j]),te=O.useCallback(Ae=>{Q.current&&(N(Ae),P(!0),j(!0))},[N,j]),se=O.useCallback(async(Ae,Me)=>{new AbortController;try{await v(Ae,Me),Q.current&&j(!0)}catch(Re){Re.name!=="AbortError"&&(console.error("Failed to update block:",Re),q(Re instanceof Error?Re.message:"Failed to update block"),W("error"))}},[v,j]),ve=O.useCallback(Ae=>{L({isOpen:!0,blockId:Ae})},[]),ie=O.useCallback(async()=>{if(!R.blockId||!Q.current)return;const Ae=new AbortController,Me=setTimeout(()=>{Ae.abort(),q("Delete operation timed out - please try again"),W("error")},1e4);try{await b(R.blockId),clearTimeout(Me),L({isOpen:!1}),(o==null?void 0:o.id)===R.blockId&&(N(null),P(!1))}catch(Re){clearTimeout(Me),Re.name!=="AbortError"&&(console.error("Failed to delete block:",Re),q(Re instanceof Error?Re.message:"Failed to delete block"),W("error"))}},[R.blockId,b,o,N]),ye=O.useCallback(async Ae=>{new AbortController;try{await w(Ae),Q.current&&j(!0)}catch(Me){Me.name!=="AbortError"&&(console.error("Failed to reorder blocks:",Me),q(Me instanceof Error?Me.message:"Failed to reorder blocks"),W("error"))}},[w,j]),Te=O.useCallback(async()=>{if(!Y||!Q.current){console.warn("Save attempted without valid page data");return}if(H.current){console.log("Save operation already in progress");return}W("saving"),F(!0),q(null);const Ae=new AbortController;H.current=Ae;try{console.log("Saving WOD page data:",Y.title),await m(Y),Q.current&&(W("saved"),j(!1),H.current=null,console.log("WOD saved successfully - staying on current page"),setTimeout(()=>{Q.current&&z!=="saving"&&W("idle")},3e3))}catch(Me){if(Me.name!=="AbortError"&&Q.current){console.error("Save failed:",Me);const Re=Me instanceof Error?Me.message:"Failed to save";q(Re),W("error"),H.current=null,setTimeout(()=>{Q.current&&(q(null),W("idle"))},1e4)}}finally{Q.current&&F(!1)}},[Y,m,j,z]),Le=O.useCallback(()=>{Q.current&&(k(!c),c||P(!1))},[c,k]),ue=O.useCallback(async()=>{if(!i||!Q.current)return;const Ae=new AbortController,Me=setTimeout(()=>{Ae.abort(),q("Page creation timed out - please try again"),W("error")},15e3);try{const Re=i.pages.length+1,sr=await p({title:`Page ${Re}`,description:"",is_locked:!1,status:"draft"});clearTimeout(Me),sr&&Q.current&&x(sr)}catch(Re){clearTimeout(Me),Re.name!=="AbortError"&&(console.error("Failed to create page:",Re),q(Re instanceof Error?Re.message:"Failed to create page"),W("error"))}},[i,p,x]),he=O.useCallback(Ae=>{const Me=i==null?void 0:i.pages.find(Re=>Re.id===Ae);Me&&Q.current&&(x(Me),P(!1),N(null))},[i==null?void 0:i.pages,x,N]),we=O.useCallback(Ae=>{const{active:Me}=Ae;if(D(Me.id),s!=null&&s.blocks){const Re=s.blocks.find(sr=>sr.id===Me.id);G(Re||null)}},[s==null?void 0:s.blocks]),Oe=O.useCallback(Ae=>{var sr;const{active:Me,over:Re}=Ae;if(D(null),G(null),!!Re){if(((sr=Me.data.current)==null?void 0:sr.type)==="block-type"){const ut=Me.data.current.blockType;re(ut);return}if(Me.id!==Re.id&&(s!=null&&s.blocks)){const ut=s.blocks.findIndex(ci=>ci.id===Me.id),wt=s.blocks.findIndex(ci=>ci.id===Re.id);if(ut!==-1&&wt!==-1){const dc=Td(s.blocks,ut,wt).map(fc=>fc.id);ye(dc)}}}},[s==null?void 0:s.blocks,re,ye]),be=O.useCallback(()=>{if(!o)return null;const Ae={block:o,onContentChange:Me=>{J(o.id,Me)},onConfigChange:Me=>{se(o.id,{config:Me})},isPreview:!1};switch(o.block_type){case"rich_text":return a.jsx(QOe,{...Ae});case"section_header":return a.jsx(JOe,{...Ae});case"image":return a.jsx(ZOe,{...Ae});case"video":return a.jsx(eEe,{...Ae});case"agent":return a.jsx(tEe,{...Ae});case"list":return a.jsx(uEe,{...Ae});case"quote":return a.jsx(dEe,{...Ae});case"document":return a.jsx(fEe,{...Ae});case"prompt":return a.jsx(hEe,{...Ae});case"automation":return a.jsx(pEe,{...Ae});case"quiz":return a.jsx(mEe,{...Ae});case"accordion":return a.jsx(gEe,{...Ae});case"user_submission":return a.jsx(yEe,{...Ae});default:return a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsxs("p",{children:["Editor not available for ",o.block_type]}),a.jsx("p",{className:"text-sm",children:"Using fallback to generic editor"})]})}},[o,J,se]),We=()=>{switch(A){case"mobile":return"max-w-sm mx-auto";case"tablet":return"max-w-2xl mx-auto";case"desktop":default:return"max-w-full"}},Je=Ae=>{switch(Ae){case"mobile":return UX;case"tablet":return HX;case"desktop":return $X}};if(u)return a.jsx("div",{className:"h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading WOD builder..."})]})});if(f||!i)return a.jsx("div",{className:"h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-8 max-w-md",children:[a.jsx(ql,{className:"h-8 w-8 text-red-600 mx-auto mb-4"}),a.jsxs("p",{className:"text-red-800 text-center mb-4",children:["Error: ",f||"Failed to load content"]}),a.jsxs(fe,{onClick:()=>r("/training-zone"),variant:"outline",className:"w-full",children:[a.jsx(lo,{className:"h-4 w-4 mr-2"}),"Back to Training Zone"]})]})});const Ye=t==="wods"?i.mission:i.course;return Ye?a.jsxs("div",{className:"h-screen bg-gray-50 flex overflow-hidden",children:[!c&&a.jsx(XOe,{onBlockAdd:re,onPageCreate:ue,onPageSelect:he,pages:i.pages.map(Ae=>{var Me;return{id:Ae.id,title:Ae.title,blocks:((Me=Ae.blocks)==null?void 0:Me.length)||0}}),currentPageId:s==null?void 0:s.id,structure:Ye,onSave:Te,onPreview:Le,isPreviewMode:c,onStructureUpdate:_}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{marginLeft:c?"0":"64px"},children:[a.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs(fe,{variant:"ghost",size:"sm",onClick:()=>r("/training-zone"),className:"text-gray-600 hover:text-gray-900",children:[a.jsx(lo,{className:"h-4 w-4 mr-2"}),"Back to Training Zone"]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:Ye.title}),a.jsxs("p",{className:"text-sm text-gray-600",children:[Ye.status," • ",i.pages.length," pages",s&&` • Page: ${s.title}`]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[!c&&a.jsx("div",{className:"flex items-center border border-gray-200 rounded-lg",children:["desktop","tablet","mobile"].map(Ae=>{const Me=Je(Ae);return a.jsx(fe,{variant:A===Ae?"default":"ghost",size:"sm",onClick:()=>T(Ae),className:"rounded-none first:rounded-l-lg last:rounded-r-lg",children:a.jsx(Me,{className:"h-4 w-4"})},Ae)})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[z==="saving"&&a.jsxs("div",{className:"flex items-center text-blue-600 text-sm",children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-600 mr-2"}),"Saving..."]}),z==="saved"&&a.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[a.jsx(ln,{className:"h-3 w-3 mr-1"}),"Saved"]}),z==="error"&&K&&a.jsxs("div",{className:"flex items-center text-red-600 text-sm",children:[a.jsx(ql,{className:"h-3 w-3 mr-1"}),K]}),l&&z==="idle"&&a.jsx(At,{variant:"outline",className:"text-orange-600",children:"Unsaved Changes"})]}),a.jsx(fe,{variant:c?"default":"outline",size:"sm",onClick:Le,className:"min-w-[100px]",children:c?a.jsxs(a.Fragment,{children:[a.jsx(TO,{className:"h-4 w-4 mr-2"}),"Exit Preview"]}):a.jsxs(a.Fragment,{children:[a.jsx(ii,{className:"h-4 w-4 mr-2"}),"Preview"]})}),a.jsxs(fe,{onClick:Te,disabled:$||!l,size:"sm",className:"min-w-[80px]",children:[$?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b border-white mr-2"}):a.jsx(Cp,{className:"h-4 w-4 mr-2"}),"Save"]})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsx("div",{className:ge("flex-1 overflow-auto",c&&"bg-white",!c&&M&&"mr-96"),children:a.jsx("div",{className:ge("min-h-full",We()),children:a.jsx(Ux,{sensors:ee,onDragStart:we,onDragEnd:Oe,children:a.jsx("div",{className:ge("min-h-full",c?"bg-white":"bg-gray-50 p-8"),children:s?a.jsx("div",{className:ge("bg-white rounded-lg shadow-sm",c?"min-h-screen":"min-h-[600px] p-6"),children:s.blocks&&s.blocks.length>0?a.jsx(Wx,{items:s.blocks.map(Ae=>Ae.id),strategy:Hx,children:a.jsx("div",{className:"space-y-4",children:s.blocks.map(Ae=>a.jsxs("div",{className:ge("group relative",!c&&"border border-transparent hover:border-gray-300 rounded-lg transition-colors",(o==null?void 0:o.id)===Ae.id&&!c&&"border-blue-500 bg-blue-50/50"),onClick:()=>!c&&ne(Ae),children:[!c&&a.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:a.jsxs("div",{className:"flex items-center space-x-1 bg-white border border-gray-200 rounded-lg shadow-sm p-1",children:[a.jsx(fe,{variant:"ghost",size:"sm",onClick:Me=>{Me.stopPropagation(),te(Ae)},className:"h-6 w-6 p-0",children:a.jsx(FX,{className:"h-3 w-3"})}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:Me=>{Me.stopPropagation(),ve(Ae.id)},className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",children:a.jsx(ns,{className:"h-3 w-3"})})]})}),a.jsx(tW,{block:Ae,isEditing:!c&&(o==null?void 0:o.id)===Ae.id,isSelected:(o==null?void 0:o.id)===Ae.id,onContentChange:(Me,Re)=>J(Me,Re)})]},Ae.id))})}):a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Sh,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Start building your ",t==="wods"?"WOD":"block"]}),a.jsx("p",{className:"text-gray-500 mb-6",children:"Add blocks from the left panel to create engaging content"}),a.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Use the left sidebar to add blocks and manage content"})]})})}):a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ot,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No page selected"}),a.jsx("p",{className:"text-gray-500",children:"Select a page from the pages panel to start editing"})]})})})})})}),!c&&M&&o&&a.jsxs("div",{className:"w-96 bg-white border-l border-gray-200 flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[(()=>{const Ae=(()=>{switch(o.block_type){case"section_header":return IX;case"rich_text":return DO;case"list":return rs;case"quote":return xy;case"image":return Eu;case"video":return si;case"agent":return Kr;case"document":return Ot;case"prompt":return Gr;case"automation":return Ei;case"quiz":return AO;case"user_submission":return Ir;default:return Dn}})();return a.jsx(Ae,{className:"h-5 w-5 text-gray-600"})})(),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:(()=>{switch(o.block_type){case"section_header":return"Section Header";case"rich_text":return"Rich Text";case"list":return"List";case"quote":return"Quote";case"image":return"Image";case"video":return"Video";case"agent":return"AI Agent";case"document":return"Document";case"prompt":return"Prompts";case"automation":return"Automation";case"quiz":return"Quiz";case"user_submission":return"User Form";default:return"Block"}})()}),a.jsx("p",{className:"text-sm text-gray-500",children:"Configure block content and settings"})]})]}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>P(!1),className:"h-8 w-8 p-0",children:a.jsx($r,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"flex-1 overflow-auto",children:be()})]})]})]}),a.jsx(T8,{isOpen:R.isOpen,onClose:()=>L({isOpen:!1}),onConfirm:ie,title:"Delete Block",message:"Are you sure you want to delete this block? This action cannot be undone.",confirmText:"Delete",variant:"destructive"})]}):a.jsx("div",{className:"h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-8 max-w-md",children:[a.jsx("p",{className:"text-red-800 text-center mb-4",children:"Content not found"}),a.jsxs(fe,{onClick:()=>r("/training-zone"),variant:"outline",className:"w-full",children:[a.jsx(lo,{className:"h-4 w-4 mr-2"}),"Back to Training Zone"]})]})})}function vEe({value:t=0,max:e=100,className:r,...n}){const i=Math.min(Math.max(t/e*100,0),100);return a.jsx("div",{className:ge("relative h-2 w-full overflow-hidden rounded-full bg-gray-200",r),...n,children:a.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300 ease-in-out",style:{width:`${i}%`}})})}function xEe(){const{type:t,id:e}=us(),r=Ti(),{user:n}=Ln(),{structure:i,currentPage:s,loading:o,error:l,loadStructure:c,navigateToPageIndex:u}=C8(t==="missions"?"mission":"course",e||""),{progressMetrics:f,trackProgress:d}=A8(t==="missions"?"mission":"course",e||""),[p,m]=O.useState(!1),[x,y]=O.useState(0),[v,b]=O.useState(null);O.useEffect(()=>{e&&n&&(c(!0),b(new Date))},[e,n,c]),O.useEffect(()=>{s&&n&&d({progressType:"page_started",pageId:s.id,progressData:{timestamp:new Date().toISOString(),pageIndex:x}})},[s,n,d,x]),O.useEffect(()=>()=>{if(v&&s&&n){const T=Math.floor((new Date().getTime()-v.getTime())/1e3);T>10&&d({progressType:"page_completed",pageId:s.id,completionPercentage:100,timeSpent:T,progressData:{completed:!0,endTime:new Date().toISOString()}})}},[v,s,n,d]);const w=()=>{if(x>0){const T=x-1;y(T),u(T),b(new Date)}},N=()=>{if(i&&x<i.pages.length-1){const T=x+1;y(T),u(T),b(new Date)}},j=T=>{y(T),u(T),m(!1),b(new Date)},k=(T,M)=>{n&&s&&d({progressType:"block_interacted",pageId:s.id,blockId:T,progressData:{interactionProgress:M,timestamp:new Date().toISOString()}})},_=T=>f.lastActivity?f.lastActivity.page_id===T.id&&f.lastActivity.progress_type==="page_completed":!1,E=()=>i!=null&&i.pages.length?f.completedPages/i.pages.length*100:0;if(o)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading your learning experience..."})]})});if(l||!i)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-red-500 mb-4",children:a.jsx(Zn,{className:"w-12 h-12 mx-auto"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Content not available"}),a.jsx("p",{className:"text-gray-600 mb-6",children:l||"The requested content could not be found."}),a.jsx(fe,{onClick:()=>r("/dashboard"),variant:"outline",children:"Return to Dashboard"})]})});const A=t==="missions"?i.mission:i.course;return A?a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsxs("div",{className:"sticky top-0 z-40 bg-white border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>m(!0),className:"md:hidden",children:a.jsx(LX,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Zn,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"font-semibold text-gray-900 text-sm md:text-base truncate max-w-48",children:A.title}),a.jsxs("p",{className:"text-xs text-gray-500",children:[x+1," of ",i.pages.length]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("div",{className:"text-right hidden sm:block",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[Math.round(E()),"% Complete"]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[f.completedPages," of ",i.pages.length," pages"]})]}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>r("/dashboard"),children:"Exit"})]})]}),a.jsx("div",{className:"px-4 pb-3",children:a.jsx(vEe,{value:E(),className:"h-2"})})]}),a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"hidden md:block w-80 bg-gray-50 border-r border-gray-200 h-screen sticky top-16 overflow-y-auto",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(At,{variant:A.status==="published"?"default":"secondary",children:A.status}),A.difficulty_level&&a.jsx(At,{variant:"outline",children:A.difficulty_level})]}),A.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:A.description}),a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[A.estimated_duration_minutes&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(go,{className:"w-3 h-3"}),a.jsxs("span",{children:[A.estimated_duration_minutes,"min"]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(TX,{className:"w-3 h-3"}),a.jsxs("span",{children:[f.completedPages," completed"]})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Pages"}),a.jsx("nav",{className:"space-y-1",children:i.pages.map((T,M)=>{const P=_(T),R=M===x;return a.jsxs("button",{onClick:()=>j(M),className:ge("w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center space-x-2",R?"bg-blue-100 text-blue-900 font-medium":"text-gray-700 hover:bg-gray-200"),disabled:T.is_locked,children:[a.jsx("div",{className:"flex-shrink-0",children:P?a.jsx(ln,{className:"w-4 h-4 text-green-500"}):a.jsx(vM,{className:ge("w-4 h-4",R?"text-blue-600":"text-gray-400")})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:ge("truncate",T.is_locked?"text-gray-400":""),children:T.title}),T.description&&a.jsx("div",{className:"text-xs text-gray-500 truncate",children:T.description})]}),a.jsx("div",{className:"text-xs text-gray-400",children:M+1})]},T.id)})})]})]})}),p&&a.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>m(!1)}),a.jsxs("div",{className:"fixed left-0 top-0 bottom-0 w-80 bg-white",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"font-semibold text-gray-900",children:"Navigation"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>m(!1),children:a.jsx($r,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-4 overflow-y-auto h-full",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(At,{variant:A.status==="published"?"default":"secondary",children:A.status}),A.difficulty_level&&a.jsx(At,{variant:"outline",children:A.difficulty_level})]}),A.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:A.description})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Pages"}),a.jsx("nav",{className:"space-y-1",children:i.pages.map((T,M)=>{const P=_(T),R=M===x;return a.jsxs("button",{onClick:()=>j(M),className:ge("w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center space-x-2",R?"bg-blue-100 text-blue-900 font-medium":"text-gray-700 hover:bg-gray-200"),disabled:T.is_locked,children:[a.jsx("div",{className:"flex-shrink-0",children:P?a.jsx(ln,{className:"w-4 h-4 text-green-500"}):a.jsx(vM,{className:ge("w-4 h-4",R?"text-blue-600":"text-gray-400")})}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("div",{className:ge("truncate",T.is_locked?"text-gray-400":""),children:T.title})}),a.jsx("div",{className:"text-xs text-gray-400",children:M+1})]},T.id)})})]})]})]})]}),a.jsx("div",{className:"flex-1 min-h-screen",children:s?a.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:s.title}),s.description&&a.jsx("p",{className:"text-lg text-gray-600 leading-relaxed",children:s.description})]}),a.jsx("div",{className:"space-y-8 mb-12",children:s.blocks&&s.blocks.length>0?s.blocks.filter(T=>T.is_visible).map(T=>a.jsx(tW,{block:T,onProgress:k,userContext:{userId:n==null?void 0:n.id,progress:f,learningMode:!0}},T.id)):a.jsxs("div",{className:"text-center py-16",children:[a.jsx(Zn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"This page doesn't have any content yet."})]})}),a.jsx("div",{className:"border-t border-gray-200 pt-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(fe,{variant:"outline",onClick:w,disabled:x===0,className:"flex items-center space-x-2",children:[a.jsx(r_,{className:"w-4 h-4"}),a.jsx("span",{children:"Previous"})]}),a.jsx("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:a.jsxs("span",{children:["Page ",x+1," of ",i.pages.length]})}),a.jsxs(fe,{onClick:N,disabled:x===i.pages.length-1,className:"flex items-center space-x-2",children:[a.jsx("span",{children:"Next"}),a.jsx(jh,{className:"w-4 h-4"})]})]})})]}):a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})})]})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-red-600",children:"Content not found"})})})}function bEe(){const[t,e]=O.useState(!1),[r,n]=O.useState("video"),[i,s]=O.useState([]),o=[{type:"video",label:"Videos",icon:si,color:"#EF4444",description:"Educational videos with transcriptions"},{type:"ai_agent",label:"AI Agents",icon:Kr,color:"#3B82F6",description:"Intelligent AI agents with custom prompts"},{type:"document",label:"Documents",icon:Ot,color:"#10B981",description:"Rich text documents and guides"},{type:"prompt",label:"Prompts",icon:Gr,color:"#8B5CF6",description:"Reusable prompt templates"},{type:"automation",label:"Automations",icon:Ei,color:"#F59E0B",description:"Process automations and workflows"}],l=p=>{n(p),e(!0)},c=p=>{const m={type:r,item:p};s(x=>[...x.filter(v=>!(v.type===r&&v.item.id===p.id)),m]),e(!1)},u=(p,m)=>{s(x=>x.filter(y=>!(y.type===p&&y.item.id===m)))},f=p=>o.find(m=>m.type===p),d=p=>{const m=f(p.type),{item:x}=p,y=uy.generatePreviewText(x);return a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:m.color+"15"},children:a.jsx(m.icon,{className:"w-5 h-5",style:{color:m.color}})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:x.title}),a.jsx("button",{onClick:()=>u(p.type,x.id),className:"text-red-500 hover:text-red-700 text-sm ml-2",children:"Remove"})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:y}),a.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:m.color+"10",color:m.color},children:m.label.slice(0,-1)}),a.jsxs("span",{children:["Updated ",new Date(x.updated_at).toLocaleDateString()]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${x.status==="published"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:x.status})]})]})]})},`${p.type}-${x.id}`)};return a.jsx(pr,{children:a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:a.jsx(wM,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Content Selector System Demo"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Demonstrating the reusable Content Selector Modal for all content types"})]})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Select Content Type"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:o.map(p=>{const m=p.icon;return a.jsx("button",{onClick:()=>l(p.type),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all text-left group",children:a.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform",style:{backgroundColor:p.color+"15"},children:a.jsx(m,{className:"w-6 h-6",style:{color:p.color}})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:p.label}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:p.description})]})]})},p.type)})})]}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Selected Content"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[i.length," ",i.length===1?"item":"items"," selected"]})]}),i.length===0?a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center",children:[a.jsx(wM,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Content Selected"}),a.jsx("p",{className:"text-gray-600",children:"Click on any content type above to open the Content Selector Modal and choose items from your repositories."})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(d)})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Demo Features"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Content Selector Modal"}),a.jsxs("ul",{className:"text-blue-700 space-y-1",children:[a.jsx("li",{children:"• Unified interface for all content types"}),a.jsx("li",{children:"• Search and filter capabilities"}),a.jsx("li",{children:"• Card and list view modes"}),a.jsx("li",{children:"• Pagination for large datasets"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Content Integration"}),a.jsxs("ul",{className:"text-blue-700 space-y-1",children:[a.jsx("li",{children:"• Type-specific metadata display"}),a.jsx("li",{children:"• Status and update information"}),a.jsx("li",{children:"• Reusable across all block types"}),a.jsx("li",{children:"• Error handling and loading states"})]})]})]})]}),a.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"How It Works"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-sm text-gray-700",children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx("span",{className:"text-blue-600 font-semibold",children:"1"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Select Content Type"}),a.jsx("p",{children:"Click any content type button to open the selector modal for that specific repository."})]})]}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx("span",{className:"text-blue-600 font-semibold",children:"2"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Browse & Search"}),a.jsx("p",{children:"Use the search, filters, and view modes to find the content you need from the repository."})]})]}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx("span",{className:"text-blue-600 font-semibold",children:"3"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Select & Use"}),a.jsx("p",{children:'Click on any item to select it. The selected content will appear in the "Selected Content" section below.'})]})]})]})]})]}),a.jsx(GC,{isOpen:t,onClose:()=>e(!1),onSelect:c,contentType:r})]})})}function wEe(){return a.jsx(Nh,{onError:(t,e)=>{console.group("🚨 Application Error"),console.error("App-level error:",t),console.error("Error info:",e),console.groupEnd(),console.warn("Production error reporting not configured")},children:a.jsx(EX,{children:a.jsx(bG,{children:a.jsx("div",{className:"App",children:a.jsx(Nh,{children:a.jsxs(hG,{children:[a.jsx(rt,{path:"/login",element:a.jsx(_J,{})}),a.jsx(rt,{path:"/",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(da,{to:"/dashboard",replace:!0})})}),a.jsx(rt,{path:"/dashboard",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(mge,{})})}),a.jsx(rt,{path:"/clients",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(yge,{})})}),a.jsx(rt,{path:"/clients/:clientId",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Sge,{})})}),a.jsx(rt,{path:"/users/:userId",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Nge,{})})}),a.jsx(rt,{path:"/users",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(vge,{})})}),a.jsx(rt,{path:"/tags",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(wge,{})})}),a.jsx(rt,{path:"/content",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(_ge,{})})}),a.jsx(rt,{path:"/content/articles",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Oge,{})})}),a.jsx(rt,{path:"/content/ai-agents",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Ege,{})})}),a.jsx(rt,{path:"/content/videos",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Cge,{})})}),a.jsx(rt,{path:"/content/documents",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Age,{})})}),a.jsx(rt,{path:"/content/prompts",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Tge,{})})}),a.jsx(rt,{path:"/content/automations",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Pge,{})})}),a.jsx(rt,{path:"/content/articles/create",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(A5,{})})}),a.jsx(rt,{path:"/content/articles/:id/edit",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(A5,{})})}),a.jsx(rt,{path:"/content/ai-agents/create",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(L5,{})})}),a.jsx(rt,{path:"/content/ai-agents/:id/edit",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(L5,{})})}),a.jsx(rt,{path:"/content/videos/create",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx($5,{})})}),a.jsx(rt,{path:"/content/videos/:id/edit",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx($5,{})})}),a.jsx(rt,{path:"/content/documents/create",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(q5,{})})}),a.jsx(rt,{path:"/content/documents/:id/edit",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(q5,{})})}),a.jsx(rt,{path:"/content/prompts/create",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(z5,{})})}),a.jsx(rt,{path:"/content/prompts/:id/edit",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(z5,{})})}),a.jsx(rt,{path:"/content/automations/create",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(U5,{})})}),a.jsx(rt,{path:"/content/automations/:id/edit",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(U5,{})})}),a.jsx(rt,{path:"/training-zone",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Yye,{})})}),a.jsx(rt,{path:"/wod-builder",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Fk,{})})}),a.jsx(rt,{path:"/training-zone/:type/:id",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Fk,{})})}),a.jsx(rt,{path:"/training-zone/legacy/:type/:id",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(Fk,{})})}),a.jsx(rt,{path:"/page-builder",element:a.jsx(da,{to:"/training-zone",replace:!0})}),a.jsx(rt,{path:"/page-builder/*",element:a.jsx(da,{to:"/training-zone",replace:!0})}),a.jsx(rt,{path:"/mission-builder-v4",element:a.jsx(da,{to:"/wod-builder",replace:!0})}),a.jsx(rt,{path:"/demo/content-selector",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(bEe,{})})}),a.jsx(rt,{path:"/learn/:type/:id",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(xEe,{})})}),a.jsx(rt,{path:"/sandbox",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"AI Sandbox"}),a.jsx("p",{className:"text-gray-600",children:"Interactive learning environment coming soon..."})]})})})}),a.jsx(rt,{path:"/admin",element:a.jsx(da,{to:"/dashboard",replace:!0})}),a.jsx(rt,{path:"/settings",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Settings"}),a.jsx("p",{className:"text-gray-600",children:"Settings page coming soon..."})]})})})}),a.jsx(rt,{path:"/logout",element:a.jsx(ft,{requireAdmin:!0,children:a.jsx(kge,{})})}),a.jsx(rt,{path:"*",element:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Page Not Found"}),a.jsx("p",{className:"text-gray-600",children:"The page you're looking for doesn't exist."})]})})})]})})})})})})}jK.createRoot(document.getElementById("root")).render(a.jsx(Z.StrictMode,{children:a.jsx(wEe,{})}));
