`);const k=await w.signMessage(new TextEncoder().encode(x),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=k}}try{const{data:y,error:j}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:RD(b)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:zn});if(j)throw j;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new lf}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:j})}catch(y){if(He(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const r=await ua(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:a,error:o}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:zn});if(await ki(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new lf}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(He(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:a,nonce:o}=e,l=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:zn}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new lf}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,p=null;this.flowType==="pkce"&&([d,p]=await vo(this.storage,this.storageKey));const{error:h}=await Ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:p},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:p}=await Ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:p}}throw new uf("You must provide either an email or phone number.")}catch(l){if(He(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,n;try{let i,a;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await Ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:zn});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(He(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await vo(this.storage,this.storageKey)),await Ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:tL})}catch(a){if(He(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Ti;const{error:i}=await Ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:a}=e,{error:o}=await Ye(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:a}=e,{data:o,error:l}=await Ye(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new uf("You must provide either an email or phone number and a type")}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ua(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<jm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await ua(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Nm()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,p)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,p))})}return{data:{session:e},error:null}}const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Mi}):await this._useSession(async r=>{var n,i,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ti}:await Ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Mi})})}catch(r){if(He(r))return kD(r)&&(await this._removeSession(),await ki(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new Ti;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await vo(this.storage,this.storageKey));const{data:d,error:p}=await Ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Mi});if(p)throw p;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(He(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ti;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:o}=Om(e.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(He(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ti;const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(He(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!fn())throw new cf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new cf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new oS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new cf("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new oS("No code detected.");const{data:_,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new cf("No session defined in URL");const p=Math.round(Date.now()/1e3),h=parseInt(l);let m=p+h;c&&(m=parseInt(c));const v=m-p;v*1e3<=Oo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${h}s`);const x=m-h;p-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,m,p):p-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,m,p);const{data:b,error:y}=await this._getUser(a);if(y)throw y;const j={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:e.type},error:null}}catch(n){if(He(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ua(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return{error:a};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(ND(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await ki(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=LD(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await vo(this.storage,this.storageKey,!0));try{return await Ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(He(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(He(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var o,l,c,d,p;const{data:h,error:m}=a;if(m)throw m;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ye(this.fetch,"GET",v,{headers:this.headers,jwt:(p=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return fn()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(He(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:a,error:o}=r;if(o)throw o;return await Ye(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await FD(async i=>(i>0&&await BD(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:zn})),(i,a)=>{const o=200*Math.pow(2,i);return a&&Sm(a)&&Date.now()+o-n<Oo})}catch(n){if(this._debug(r,"error",n),He(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),fn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ua(this.storage,this.storageKey);if(i&&this.userStorage){let o=await ua(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await No(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Nm()}else if(i&&!i.user&&!i.user){const o=await ua(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await ki(this.storage,this.storageKey+"-user"),await No(this.storage,this.storageKey,i)):i.user=Nm()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<jm;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${jm}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Sm(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Ti;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new qd;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new Ti;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),He(a)){const o={session:null,error:a};return Sm(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await No(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const a=fS(i);await No(this.storage,this.storageKey,a)}else{const i=fS(r);await No(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await ki(this.storage,this.storageKey),await ki(this.storage,this.storageKey+"-code-verifier"),await ki(this.storage,this.storageKey+"-user"),this.userStorage&&await ki(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Oo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/Oo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Oo}ms, refresh threshold is ${V0} ticks`),i<=V0&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof hT)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await vo(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?{data:null,error:a}:await Ye(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:a,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await Ye(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(He(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:l}=await Ye(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(He(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?{data:null,error:a}:await Ye(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(He(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:a}=e;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Om(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const p=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+SD>i)return n;const{data:a,error:o}=await Ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:v,error:x}=await this.getSession();if(x||!v.session)return{data:null,error:x};n=v.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=Om(n);r!=null&&r.allowExpired||GD(a.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:a,header:i,signature:o},error:null}}const p=YD(i.alg),h=await crypto.subtle.importKey("jwk",d,p,!0,["verify"]);if(!await crypto.subtle.verify(p,h,o,ID(`${l}.${c}`)))throw new Y0("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(n){if(He(n))return{data:null,error:n};throw n}}}Wl.nextInstanceID=0;const fL=Wl;class dL extends fL{constructor(e){super(e)}}var hL=function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(p){try{d(n.next(p))}catch(h){o(h)}}function c(p){try{d(n.throw(p))}catch(h){o(h)}}function d(p){p.done?a(p.value):i(p.value).then(l,c)}d((n=n.apply(t,e||[])).next())})};class pL{constructor(e,r,n){var i,a,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=yD(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,p={db:cD,realtime:dD,auth:Object.assign(Object.assign({},fD),{storageKey:d}),global:uD},h=bD(n??{},p);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=vD(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new P5(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new oD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new x5(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return hL(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:a,flowType:o,lock:l,debug:c},d,p){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dL({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:a,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,flowType:o,lock:l,debug:c,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new K5(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mL=(t,e,r)=>new pL(t,e,r);function vL(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}vL()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const gL="https://givgsxytkbsdrlmoxzkp.supabase.co",yL="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA",we=mL(gL,yL),dr={ai_agent:{label:"AI Agents",color:"#3B82F6",description:"Intelligent AI agents with custom prompts"},video:{label:"Videos",color:"#EF4444",description:"Educational videos with transcriptions"},document:{label:"Documents",color:"#10B981",description:"Rich text documents and guides"},prompt:{label:"Prompts",color:"#8B5CF6",description:"Reusable prompt templates"},automation:{label:"Automations",color:"#F59E0B",description:"Process automations and workflows"}},pT=z.createContext(void 0);function Bd(){const t=z.useContext(pT);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function bL({children:t}){const[e,r]=z.useState(null),[n,i]=z.useState(null),[a,o]=z.useState(!0);z.useEffect(()=>{let p=!0;async function h(){var v;try{o(!0);const x=setTimeout(()=>{p&&(console.warn("Auth initialization timeout"),o(!1))},1e4),{data:{user:b},error:y}=await we.auth.getUser();if(!p)return;if(clearTimeout(x),y){(v=y.message)!=null&&v.includes("Auth session missing")||y.name==="AuthSessionMissingError"?console.log("Auth session not yet available, waiting for auth state change..."):console.error("Auth error:",y),o(!1);return}if(r(b),b)try{const{data:j,error:_}=await we.from("admins").select("*").eq("id",b.id).maybeSingle();_?console.error("Admin lookup error:",_):i(j)}catch(j){console.error("Admin query failed:",j)}o(!1)}catch(x){p&&(console.error("Error getting initial session:",x),o(!1))}}h();const{data:{subscription:m}}=we.auth.onAuthStateChange(async(v,x)=>{if(!p)return;console.log("Auth state changed:",v);const b=(x==null?void 0:x.user)||null;if(JSON.stringify(e)!==JSON.stringify(b)){if(r(b),x!=null&&x.user)try{const{data:y,error:j}=await we.from("admins").select("*").eq("id",x.user.id).maybeSingle();j?console.error("Admin lookup in auth change failed:",j):p&&i(y)}catch(y){console.error("Admin lookup in auth change failed:",y)}else i(null);p&&o(!1)}});return()=>{p=!1,m.unsubscribe()}},[]);const d={user:e,admin:n,loading:a,signIn:async(p,h)=>{try{const{error:m}=await we.auth.signInWithPassword({email:p,password:h});return m?{error:m.message}:{}}catch{return{error:"An unexpected error occurred"}}},signOut:async()=>{await we.auth.signOut()}};return f.jsx(pT.Provider,{value:d,children:t})}function mT(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=mT(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Ke(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=mT(t))&&(n&&(n+=" "),n+=e);return n}const Ix="-",xL=t=>{const e=_L(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const l=o.split(Ix);return l[0]===""&&l.length!==1&&l.shift(),vT(l,e)||wL(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},vT=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?vT(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(Ix);return(o=e.validators.find(({validator:l})=>l(a)))==null?void 0:o.classGroupId},vS=/^\[(.+)\]$/,wL=t=>{if(vS.test(t)){const e=vS.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},_L=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return SL(Object.entries(t.classGroups),r).forEach(([a,o])=>{X0(o,n,a,e)}),n},X0=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:gS(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(jL(i)){X0(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,o])=>{X0(o,gS(e,a),r,n)})})},gS=(t,e)=>{let r=t;return e.split(Ix).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},jL=t=>t.isThemeGetter,SL=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,l])=>[e+o,l])):a);return[r,i]}):t,OL=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,o)=>{r.set(a,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set(a,o){r.has(a)?r.set(a,o):i(a,o)}}},gT="!",NL=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,o=l=>{const c=[];let d=0,p=0,h;for(let y=0;y<l.length;y++){let j=l[y];if(d===0){if(j===i&&(n||l.slice(y,y+a)===e)){c.push(l.slice(p,y)),p=y+a;continue}if(j==="/"){h=y;continue}}j==="["?d++:j==="]"&&d--}const m=c.length===0?l:l.substring(p),v=m.startsWith(gT),x=v?m.substring(1):m,b=h&&h>p?h-p:void 0;return{modifiers:c,hasImportantModifier:v,baseClassName:x,maybePostfixModifierPosition:b}};return r?l=>r({className:l,parseClassName:o}):o},kL=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},EL=t=>({cache:OL(t.cacheSize),parseClassName:NL(t),...xL(t)}),AL=/\s+/,PL=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],o=t.trim().split(AL);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:p,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:v}=r(d);let x=!!v,b=n(x?m.substring(0,v):m);if(!b){if(!x){l=d+(l.length>0?" "+l:l);continue}if(b=n(m),!b){l=d+(l.length>0?" "+l:l);continue}x=!1}const y=kL(p).join(":"),j=h?y+gT:y,_=j+b;if(a.includes(_))continue;a.push(_);const S=i(b,x);for(let w=0;w<S.length;++w){const O=S[w];a.push(j+O)}l=d+(l.length>0?" "+l:l)}return l};function TL(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=yT(e))&&(n&&(n+=" "),n+=r);return n}const yT=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=yT(t[n]))&&(r&&(r+=" "),r+=e);return r};function CL(t,...e){let r,n,i,a=o;function o(c){const d=e.reduce((p,h)=>h(p),t());return r=EL(d),n=r.cache.get,i=r.cache.set,a=l,l(c)}function l(c){const d=n(c);if(d)return d;const p=PL(c,r);return i(c,p),p}return function(){return a(TL.apply(null,arguments))}}const yt=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},bT=/^\[(?:([a-z-]+):)?(.+)\]$/i,ML=/^\d+\/\d+$/,IL=new Set(["px","full","screen"]),RL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,DL=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,LL=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,$L=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qL=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Fn=t=>Io(t)||IL.has(t)||ML.test(t),Ei=t=>vs(t,"length",KL),Io=t=>!!t&&!Number.isNaN(Number(t)),Em=t=>vs(t,"number",Io),dl=t=>!!t&&Number.isInteger(Number(t)),BL=t=>t.endsWith("%")&&Io(t.slice(0,-1)),Ve=t=>bT.test(t),Ai=t=>RL.test(t),FL=new Set(["length","size","percentage"]),UL=t=>vs(t,FL,xT),zL=t=>vs(t,"position",xT),WL=new Set(["image","url"]),HL=t=>vs(t,WL,YL),VL=t=>vs(t,"",GL),hl=()=>!0,vs=(t,e,r)=>{const n=bT.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},KL=t=>DL.test(t)&&!LL.test(t),xT=()=>!1,GL=t=>$L.test(t),YL=t=>qL.test(t),XL=()=>{const t=yt("colors"),e=yt("spacing"),r=yt("blur"),n=yt("brightness"),i=yt("borderColor"),a=yt("borderRadius"),o=yt("borderSpacing"),l=yt("borderWidth"),c=yt("contrast"),d=yt("grayscale"),p=yt("hueRotate"),h=yt("invert"),m=yt("gap"),v=yt("gradientColorStops"),x=yt("gradientColorStopPositions"),b=yt("inset"),y=yt("margin"),j=yt("opacity"),_=yt("padding"),S=yt("saturate"),w=yt("scale"),O=yt("sepia"),k=yt("skew"),E=yt("space"),C=yt("translate"),I=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto",Ve,e],T=()=>[Ve,e],L=()=>["",Fn,Ei],$=()=>["auto",Io,Ve],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],V=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",Ve],F=()=>["auto","avoid","all","avoid-page","page","left","right","column"],R=()=>[Io,Ve];return{cacheSize:500,separator:":",theme:{colors:[hl],spacing:[Fn,Ei],blur:["none","",Ai,Ve],brightness:R(),borderColor:[t],borderRadius:["none","","full",Ai,Ve],borderSpacing:T(),borderWidth:L(),contrast:R(),grayscale:G(),hueRotate:R(),invert:G(),gap:T(),gradientColorStops:[t],gradientColorStopPositions:[BL,Ei],inset:A(),margin:A(),opacity:R(),padding:T(),saturate:R(),scale:R(),sepia:G(),skew:R(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",Ve]}],container:["container"],columns:[{columns:[Ai]}],"break-after":[{"break-after":F()}],"break-before":[{"break-before":F()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),Ve]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",dl,Ve]}],basis:[{basis:A()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ve]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",dl,Ve]}],"grid-cols":[{"grid-cols":[hl]}],"col-start-end":[{col:["auto",{span:["full",dl,Ve]},Ve]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[hl]}],"row-start-end":[{row:["auto",{span:[dl,Ve]},Ve]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...X()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...X(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...X(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ve,e]}],"min-w":[{"min-w":[Ve,e,"min","max","fit"]}],"max-w":[{"max-w":[Ve,e,"none","full","min","max","fit","prose",{screen:[Ai]},Ai]}],h:[{h:[Ve,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ve,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ve,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ve,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ai,Ei]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Em]}],"font-family":[{font:[hl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ve]}],"line-clamp":[{"line-clamp":["none",Io,Em]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Fn,Ve]}],"list-image":[{"list-image":["none",Ve]}],"list-style-type":[{list:["none","disc","decimal",Ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[j]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[j]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Fn,Ei]}],"underline-offset":[{"underline-offset":["auto",Fn,Ve]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[j]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),zL]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",UL]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},HL]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[j]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[j]}],"divide-style":[{divide:U()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[Fn,Ve]}],"outline-w":[{outline:[Fn,Ei]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[j]}],"ring-offset-w":[{"ring-offset":[Fn,Ei]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ai,VL]}],"shadow-color":[{shadow:[hl]}],opacity:[{opacity:[j]}],"mix-blend":[{"mix-blend":[...V(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":V()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ai,Ve]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[j]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ve]}],duration:[{duration:R()}],ease:[{ease:["linear","in","out","in-out",Ve]}],delay:[{delay:R()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[dl,Ve]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ve]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ve]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ve]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Fn,Ei,Em]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},QL=CL(XL);function JL(...t){return QL(Ke(t))}function Nt({size:t="md",className:e}){const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return f.jsx("div",{className:JL("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",r[t],e)})}function lt({children:t,requireAdmin:e=!1}){const{user:r,admin:n,loading:i}=Bd();if(i)return f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsx(Nt,{size:"lg"})});if(!r)return f.jsx(Ex,{to:"/login",replace:!0});if(e){if(r&&n===null)return f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsx(Nt,{size:"lg"})});if(!n)return f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),f.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})})}return f.jsx(f.Fragment,{children:t})}/**
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WI(t,e){if(t){if(typeof t=="string")return xx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xx(t,e)}}function DQ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LQ(t){if(Array.isArray(t))return xx(t)}function xx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vP(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function he(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vP(Object(r),!0).forEach(function(n){$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vP(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $e(t,e,r){return e=HI(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HI(t){var e=$Q(t,"string");return fs(e)=="symbol"?e:e+""}function $Q(t,e){if(fs(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(fs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qQ={xAxis:["bottom","top"],yAxis:["left","right"]},BQ={width:"100%",height:"100%"},VI={x:0,y:0};function jf(t){return t}var FQ=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},UQ=function(e,r,n,i){var a=r.find(function(p){return p&&p.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,l=i.radius;return he(he(he({},i),mt(i.cx,i.cy,l,o)),{},{angle:o,radius:l})}var c=a.coordinate,d=i.angle;return he(he(he({},i),mt(i.cx,i.cy,c,d)),{},{angle:d,radius:c})}return VI},Sh=function(e,r){var n=r.graphicalItems,i=r.dataStartIndex,a=r.dataEndIndex,o=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(ds(l),ds(d)):l},[]);return o.length>0?o:e&&e.length&&Se(i)&&Se(a)?e.slice(i,a+1):[]};function KI(t){return t==="number"?[0,"auto"]:void 0}var wx=function(e,r,n,i){var a=e.graphicalItems,o=e.tooltipAxis,l=Sh(r,e);return n<0||!a||!a.length||n>=l.length?null:a.reduce(function(c,d){var p,h=(p=d.props.data)!==null&&p!==void 0?p:r;h&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(h=h.slice(e.dataStartIndex,e.dataEndIndex+1));var m;if(o.dataKey&&!o.allowDuplicatedCategory){var v=h===void 0?l:h;m=Lf(v,o.dataKey,i)}else m=h&&h[n]||l[n];return m?[].concat(ds(c),[LM(d,m)]):c},[])},gP=function(e,r,n,i){var a=i||{x:e.chartX,y:e.chartY},o=FQ(a,n),l=e.orderedTooltipTicks,c=e.tooltipAxis,d=e.tooltipTicks,p=hz(o,l,d,c);if(p>=0&&d){var h=d[p]&&d[p].value,m=wx(e,r,p,h),v=UQ(n,l,p,a);return{activeTooltipIndex:p,activeLabel:h,activePayload:m,activeCoordinate:v}}return null},zQ=function(e,r){var n=r.axes,i=r.graphicalItems,a=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,p=e.layout,h=e.children,m=e.stackOffset,v=TM(p,a);return n.reduce(function(x,b){var y,j=b.type.defaultProps!==void 0?he(he({},b.type.defaultProps),b.props):b.props,_=j.type,S=j.dataKey,w=j.allowDataOverflow,O=j.allowDuplicatedCategory,k=j.scale,E=j.ticks,C=j.includeHidden,I=j[o];if(x[I])return x;var P=Sh(e.data,{graphicalItems:i.filter(function(q){var H,ee=o in q.props?q.props[o]:(H=q.type.defaultProps)===null||H===void 0?void 0:H[o];return ee===I}),dataStartIndex:c,dataEndIndex:d}),A=P.length,T,L,$;mQ(j.domain,w,_)&&(T=Rb(j.domain,null,w),v&&(_==="number"||k!=="auto")&&($=Dl(P,S,"category")));var B=KI(_);if(!T||T.length===0){var U,V=(U=j.domain)!==null&&U!==void 0?U:B;if(S){if(T=Dl(P,S,_),_==="category"&&v){var X=l6(T);O&&X?(L=T,T=wd(0,A)):O||(T=gE(V,T,b).reduce(function(q,H){return q.indexOf(H)>=0?q:[].concat(ds(q),[H])},[]))}else if(_==="category")O?T=T.filter(function(q){return q!==""&&!We(q)}):T=gE(V,T,b).reduce(function(q,H){return q.indexOf(H)>=0||H===""||We(H)?q:[].concat(ds(q),[H])},[]);else if(_==="number"){var G=yz(P,i.filter(function(q){var H,ee,J=o in q.props?q.props[o]:(H=q.type.defaultProps)===null||H===void 0?void 0:H[o],K="hide"in q.props?q.props.hide:(ee=q.type.defaultProps)===null||ee===void 0?void 0:ee.hide;return J===I&&(C||!K)}),S,a,p);G&&(T=G)}v&&(_==="number"||k!=="auto")&&($=Dl(P,S,"category"))}else v?T=wd(0,A):l&&l[I]&&l[I].hasStack&&_==="number"?T=m==="expand"?[0,1]:DM(l[I].stackGroups,c,d):T=PM(P,i.filter(function(q){var H=o in q.props?q.props[o]:q.type.defaultProps[o],ee="hide"in q.props?q.props.hide:q.type.defaultProps.hide;return H===I&&(C||!ee)}),_,p,!0);if(_==="number")T=yx(h,T,I,a,E),V&&(T=Rb(V,T,w));else if(_==="category"&&V){var F=V,R=T.every(function(q){return F.indexOf(q)>=0});R&&(T=F)}}return he(he({},x),{},$e({},I,he(he({},j),{},{axisType:a,domain:T,categoricalDomain:$,duplicateDomain:L,originalDomain:(y=j.domain)!==null&&y!==void 0?y:B,isCategorical:v,layout:p})))},{})},WQ=function(e,r){var n=r.graphicalItems,i=r.Axis,a=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,p=e.layout,h=e.children,m=Sh(e.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),v=m.length,x=TM(p,a),b=-1;return n.reduce(function(y,j){var _=j.type.defaultProps!==void 0?he(he({},j.type.defaultProps),j.props):j.props,S=_[o],w=KI("number");if(!y[S]){b++;var O;return x?O=wd(0,v):l&&l[S]&&l[S].hasStack?(O=DM(l[S].stackGroups,c,d),O=yx(h,O,S,a)):(O=Rb(w,PM(m,n.filter(function(k){var E,C,I=o in k.props?k.props[o]:(E=k.type.defaultProps)===null||E===void 0?void 0:E[o],P="hide"in k.props?k.props.hide:(C=k.type.defaultProps)===null||C===void 0?void 0:C.hide;return I===S&&!P}),"number",p),i.defaultProps.allowDataOverflow),O=yx(h,O,S,a)),he(he({},y),{},$e({},S,he(he({axisType:a},i.defaultProps),{},{hide:!0,orientation:Rr(qQ,"".concat(a,".").concat(b%2),null),domain:O,originalDomain:w,isCategorical:x,layout:p})))}return y},{})},HQ=function(e,r){var n=r.axisType,i=n===void 0?"xAxis":n,a=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,p=e.children,h="".concat(i,"Id"),m=Dr(p,a),v={};return m&&m.length?v=zQ(e,{axes:m,graphicalItems:o,axisType:i,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(v=WQ(e,{Axis:a,graphicalItems:o,axisType:i,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),v},VQ=function(e){var r=Ii(e),n=Gn(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:iw(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:ld(r,n)}},yP=function(e){var r=e.children,n=e.defaultShowTooltip,i=Tr(r,rs),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(a=i.props.startIndex),i.props.endIndex>=0&&(o=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},KQ=function(e){return!e||!e.length?!1:e.some(function(r){var n=Xn(r&&r.type);return n&&n.indexOf("Bar")>=0})},bP=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},GQ=function(e,r){var n=e.props,i=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,l=e.yAxisMap,c=l===void 0?{}:l,d=n.width,p=n.height,h=n.children,m=n.margin||{},v=Tr(h,rs),x=Tr(h,Do),b=Object.keys(c).reduce(function(O,k){var E=c[k],C=E.orientation;return!E.mirror&&!E.hide?he(he({},O),{},$e({},C,O[C]+E.width)):O},{left:m.left||0,right:m.right||0}),y=Object.keys(o).reduce(function(O,k){var E=o[k],C=E.orientation;return!E.mirror&&!E.hide?he(he({},O),{},$e({},C,Rr(O,"".concat(C))+E.height)):O},{top:m.top||0,bottom:m.bottom||0}),j=he(he({},y),b),_=j.bottom;v&&(j.bottom+=v.props.height||rs.defaultProps.height),x&&r&&(j=vz(j,i,n,r));var S=d-j.left-j.right,w=p-j.top-j.bottom;return he(he({brushBottom:_},j),{},{width:Math.max(S,0),height:Math.max(w,0)})},YQ=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},Uw=function(e){var r=e.chartName,n=e.GraphicalChild,i=e.defaultTooltipEventType,a=i===void 0?"axis":i,o=e.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=e.axisComponents,d=e.legendContent,p=e.formatAxisMap,h=e.defaultProps,m=function(j,_){var S=_.graphicalItems,w=_.stackGroups,O=_.offset,k=_.updateId,E=_.dataStartIndex,C=_.dataEndIndex,I=j.barSize,P=j.layout,A=j.barGap,T=j.barCategoryGap,L=j.maxBarSize,$=bP(P),B=$.numericAxisName,U=$.cateAxisName,V=KQ(S),X=[];return S.forEach(function(G,F){var R=Sh(j.data,{graphicalItems:[G],dataStartIndex:E,dataEndIndex:C}),q=G.type.defaultProps!==void 0?he(he({},G.type.defaultProps),G.props):G.props,H=q.dataKey,ee=q.maxBarSize,J=q["".concat(B,"Id")],K=q["".concat(U,"Id")],Y={},re=c.reduce(function(je,me){var qe=_["".concat(me.axisType,"Map")],Ue=q["".concat(me.axisType,"Id")];qe&&qe[Ue]||me.axisType==="zAxis"||Aa();var ze=qe[Ue];return he(he({},je),{},$e($e({},me.axisType,ze),"".concat(me.axisType,"Ticks"),Gn(ze)))},Y),Q=re[U],oe=re["".concat(U,"Ticks")],pe=w&&w[J]&&w[J].hasStack&&kz(G,w[J].stackGroups),ce=Xn(G.type).indexOf("Bar")>=0,Oe=ld(Q,oe),ae=[],ye=V&&pz({barSize:I,stackGroups:w,totalSize:YQ(re,U)});if(ce){var Te,Ie,ue=We(ee)?L:ee,de=(Te=(Ie=ld(Q,oe,!0))!==null&&Ie!==void 0?Ie:ue)!==null&&Te!==void 0?Te:0;ae=mz({barGap:A,barCategoryGap:T,bandSize:de!==Oe?de:Oe,sizeList:ye[K],maxBarSize:ue}),de!==Oe&&(ae=ae.map(function(je){return he(he({},je),{},{position:he(he({},je.position),{},{offset:je.position.offset-de/2})})}))}var xe=G&&G.type&&G.type.getComposedData;xe&&X.push({props:he(he({},xe(he(he({},re),{},{displayedData:R,props:j,dataKey:H,item:G,bandSize:Oe,barPosition:ae,offset:O,stackedData:pe,layout:P,dataStartIndex:E,dataEndIndex:C}))),{},$e($e($e({key:G.key||"item-".concat(F)},B,re[B]),U,re[U]),"animationId",k)),childIndex:x6(G,j.children),item:G})}),X},v=function(j,_){var S=j.props,w=j.dataStartIndex,O=j.dataEndIndex,k=j.updateId;if(!TO({props:S}))return null;var E=S.children,C=S.layout,I=S.stackOffset,P=S.data,A=S.reverseStackOrder,T=bP(C),L=T.numericAxisName,$=T.cateAxisName,B=Dr(E,n),U=Oz(P,B,"".concat(L,"Id"),"".concat($,"Id"),I,A),V=c.reduce(function(q,H){var ee="".concat(H.axisType,"Map");return he(he({},q),{},$e({},ee,HQ(S,he(he({},H),{},{graphicalItems:B,stackGroups:H.axisType===L&&U,dataStartIndex:w,dataEndIndex:O}))))},{}),X=GQ(he(he({},V),{},{props:S,graphicalItems:B}),_==null?void 0:_.legendBBox);Object.keys(V).forEach(function(q){V[q]=p(S,V[q],X,q.replace("Map",""),r)});var G=V["".concat($,"Map")],F=VQ(G),R=m(S,he(he({},V),{},{dataStartIndex:w,dataEndIndex:O,updateId:k,graphicalItems:B,stackGroups:U,offset:X}));return he(he({formattedGraphicalItems:R,graphicalItems:B,offset:X,stackGroups:U},F),V)},x=function(y){function j(_){var S,w,O;return EQ(this,j),O=TQ(this,j,[_]),$e(O,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),$e(O,"accessibilityManager",new pQ),$e(O,"handleLegendBBoxUpdate",function(k){if(k){var E=O.state,C=E.dataStartIndex,I=E.dataEndIndex,P=E.updateId;O.setState(he({legendBBox:k},v({props:O.props,dataStartIndex:C,dataEndIndex:I,updateId:P},he(he({},O.state),{},{legendBBox:k}))))}}),$e(O,"handleReceiveSyncEvent",function(k,E,C){if(O.props.syncId===k){if(C===O.eventEmitterSymbol&&typeof O.props.syncMethod!="function")return;O.applySyncEvent(E)}}),$e(O,"handleBrushChange",function(k){var E=k.startIndex,C=k.endIndex;if(E!==O.state.dataStartIndex||C!==O.state.dataEndIndex){var I=O.state.updateId;O.setState(function(){return he({dataStartIndex:E,dataEndIndex:C},v({props:O.props,dataStartIndex:E,dataEndIndex:C,updateId:I},O.state))}),O.triggerSyncEvent({dataStartIndex:E,dataEndIndex:C})}}),$e(O,"handleMouseEnter",function(k){var E=O.getMouseInfo(k);if(E){var C=he(he({},E),{},{isTooltipActive:!0});O.setState(C),O.triggerSyncEvent(C);var I=O.props.onMouseEnter;Fe(I)&&I(C,k)}}),$e(O,"triggeredAfterMouseMove",function(k){var E=O.getMouseInfo(k),C=E?he(he({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};O.setState(C),O.triggerSyncEvent(C);var I=O.props.onMouseMove;Fe(I)&&I(C,k)}),$e(O,"handleItemMouseEnter",function(k){O.setState(function(){return{isTooltipActive:!0,activeItem:k,activePayload:k.tooltipPayload,activeCoordinate:k.tooltipPosition||{x:k.cx,y:k.cy}}})}),$e(O,"handleItemMouseLeave",function(){O.setState(function(){return{isTooltipActive:!1}})}),$e(O,"handleMouseMove",function(k){k.persist(),O.throttleTriggeredAfterMouseMove(k)}),$e(O,"handleMouseLeave",function(k){O.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};O.setState(E),O.triggerSyncEvent(E);var C=O.props.onMouseLeave;Fe(C)&&C(E,k)}),$e(O,"handleOuterEvent",function(k){var E=b6(k),C=Rr(O.props,"".concat(E));if(E&&Fe(C)){var I,P;/.*touch.*/i.test(E)?P=O.getMouseInfo(k.changedTouches[0]):P=O.getMouseInfo(k),C((I=P)!==null&&I!==void 0?I:{},k)}}),$e(O,"handleClick",function(k){var E=O.getMouseInfo(k);if(E){var C=he(he({},E),{},{isTooltipActive:!0});O.setState(C),O.triggerSyncEvent(C);var I=O.props.onClick;Fe(I)&&I(C,k)}}),$e(O,"handleMouseDown",function(k){var E=O.props.onMouseDown;if(Fe(E)){var C=O.getMouseInfo(k);E(C,k)}}),$e(O,"handleMouseUp",function(k){var E=O.props.onMouseUp;if(Fe(E)){var C=O.getMouseInfo(k);E(C,k)}}),$e(O,"handleTouchMove",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&O.throttleTriggeredAfterMouseMove(k.changedTouches[0])}),$e(O,"handleTouchStart",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&O.handleMouseDown(k.changedTouches[0])}),$e(O,"handleTouchEnd",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&O.handleMouseUp(k.changedTouches[0])}),$e(O,"handleDoubleClick",function(k){var E=O.props.onDoubleClick;if(Fe(E)){var C=O.getMouseInfo(k);E(C,k)}}),$e(O,"handleContextMenu",function(k){var E=O.props.onContextMenu;if(Fe(E)){var C=O.getMouseInfo(k);E(C,k)}}),$e(O,"triggerSyncEvent",function(k){O.props.syncId!==void 0&&k0.emit(E0,O.props.syncId,k,O.eventEmitterSymbol)}),$e(O,"applySyncEvent",function(k){var E=O.props,C=E.layout,I=E.syncMethod,P=O.state.updateId,A=k.dataStartIndex,T=k.dataEndIndex;if(k.dataStartIndex!==void 0||k.dataEndIndex!==void 0)O.setState(he({dataStartIndex:A,dataEndIndex:T},v({props:O.props,dataStartIndex:A,dataEndIndex:T,updateId:P},O.state)));else if(k.activeTooltipIndex!==void 0){var L=k.chartX,$=k.chartY,B=k.activeTooltipIndex,U=O.state,V=U.offset,X=U.tooltipTicks;if(!V)return;if(typeof I=="function")B=I(X,k);else if(I==="value"){B=-1;for(var G=0;G<X.length;G++)if(X[G].value===k.activeLabel){B=G;break}}var F=he(he({},V),{},{x:V.left,y:V.top}),R=Math.min(L,F.x+F.width),q=Math.min($,F.y+F.height),H=X[B]&&X[B].value,ee=wx(O.state,O.props.data,B),J=X[B]?{x:C==="horizontal"?X[B].coordinate:R,y:C==="horizontal"?q:X[B].coordinate}:VI;O.setState(he(he({},k),{},{activeLabel:H,activeCoordinate:J,activePayload:ee,activeTooltipIndex:B}))}else O.setState(k)}),$e(O,"renderCursor",function(k){var E,C=O.state,I=C.isTooltipActive,P=C.activeCoordinate,A=C.activePayload,T=C.offset,L=C.activeTooltipIndex,$=C.tooltipAxisBandSize,B=O.getTooltipEventType(),U=(E=k.props.active)!==null&&E!==void 0?E:I,V=O.props.layout,X=k.key||"_recharts-cursor";return te.createElement(wQ,{key:X,activeCoordinate:P,activePayload:A,activeTooltipIndex:L,chartName:r,element:k,isActive:U,layout:V,offset:T,tooltipAxisBandSize:$,tooltipEventType:B})}),$e(O,"renderPolarAxis",function(k,E,C){var I=Rr(k,"type.axisType"),P=Rr(O.state,"".concat(I,"Map")),A=k.type.defaultProps,T=A!==void 0?he(he({},A),k.props):k.props,L=P&&P[T["".concat(I,"Id")]];return z.cloneElement(k,he(he({},L),{},{className:Ke(I,L.className),key:k.key||"".concat(E,"-").concat(C),ticks:Gn(L,!0)}))}),$e(O,"renderPolarGrid",function(k){var E=k.props,C=E.radialLines,I=E.polarAngles,P=E.polarRadius,A=O.state,T=A.radiusAxisMap,L=A.angleAxisMap,$=Ii(T),B=Ii(L),U=B.cx,V=B.cy,X=B.innerRadius,G=B.outerRadius;return z.cloneElement(k,{polarAngles:Array.isArray(I)?I:Gn(B,!0).map(function(F){return F.coordinate}),polarRadius:Array.isArray(P)?P:Gn($,!0).map(function(F){return F.coordinate}),cx:U,cy:V,innerRadius:X,outerRadius:G,key:k.key||"polar-grid",radialLines:C})}),$e(O,"renderLegend",function(){var k=O.state.formattedGraphicalItems,E=O.props,C=E.children,I=E.width,P=E.height,A=O.props.margin||{},T=I-(A.left||0)-(A.right||0),L=EM({children:C,formattedGraphicalItems:k,legendWidth:T,legendContent:d});if(!L)return null;var $=L.item,B=mP(L,_Q);return z.cloneElement($,he(he({},B),{},{chartWidth:I,chartHeight:P,margin:A,onBBoxUpdate:O.handleLegendBBoxUpdate}))}),$e(O,"renderTooltip",function(){var k,E=O.props,C=E.children,I=E.accessibilityLayer,P=Tr(C,Kr);if(!P)return null;var A=O.state,T=A.isTooltipActive,L=A.activeCoordinate,$=A.activePayload,B=A.activeLabel,U=A.offset,V=(k=P.props.active)!==null&&k!==void 0?k:T;return z.cloneElement(P,{viewBox:he(he({},U),{},{x:U.left,y:U.top}),active:V,label:B,payload:V?$:[],coordinate:L,accessibilityLayer:I})}),$e(O,"renderBrush",function(k){var E=O.props,C=E.margin,I=E.data,P=O.state,A=P.offset,T=P.dataStartIndex,L=P.dataEndIndex,$=P.updateId;return z.cloneElement(k,{key:k.key||"_recharts-brush",onChange:yf(O.handleBrushChange,k.props.onChange),data:I,x:Se(k.props.x)?k.props.x:A.left,y:Se(k.props.y)?k.props.y:A.top+A.height+A.brushBottom-(C.bottom||0),width:Se(k.props.width)?k.props.width:A.width,startIndex:T,endIndex:L,updateId:"brush-".concat($)})}),$e(O,"renderReferenceElement",function(k,E,C){if(!k)return null;var I=O,P=I.clipPathId,A=O.state,T=A.xAxisMap,L=A.yAxisMap,$=A.offset,B=k.type.defaultProps||{},U=k.props,V=U.xAxisId,X=V===void 0?B.xAxisId:V,G=U.yAxisId,F=G===void 0?B.yAxisId:G;return z.cloneElement(k,{key:k.key||"".concat(E,"-").concat(C),xAxis:T[X],yAxis:L[F],viewBox:{x:$.left,y:$.top,width:$.width,height:$.height},clipPathId:P})}),$e(O,"renderActivePoints",function(k){var E=k.item,C=k.activePoint,I=k.basePoint,P=k.childIndex,A=k.isRange,T=[],L=E.props.key,$=E.item.type.defaultProps!==void 0?he(he({},E.item.type.defaultProps),E.item.props):E.item.props,B=$.activeDot,U=$.dataKey,V=he(he({index:P,dataKey:U,cx:C.x,cy:C.y,r:4,fill:Pw(E.item),strokeWidth:2,stroke:"#fff",payload:C.payload,value:C.value},Le(B,!1)),$f(B));return T.push(j.renderActiveDot(B,V,"".concat(L,"-activePoint-").concat(P))),I?T.push(j.renderActiveDot(B,he(he({},V),{},{cx:I.x,cy:I.y}),"".concat(L,"-basePoint-").concat(P))):A&&T.push(null),T}),$e(O,"renderGraphicChild",function(k,E,C){var I=O.filterFormatItem(k,E,C);if(!I)return null;var P=O.getTooltipEventType(),A=O.state,T=A.isTooltipActive,L=A.tooltipAxis,$=A.activeTooltipIndex,B=A.activeLabel,U=O.props.children,V=Tr(U,Kr),X=I.props,G=X.points,F=X.isRange,R=X.baseLine,q=I.item.type.defaultProps!==void 0?he(he({},I.item.type.defaultProps),I.item.props):I.item.props,H=q.activeDot,ee=q.hide,J=q.activeBar,K=q.activeShape,Y=!!(!ee&&T&&V&&(H||J||K)),re={};P!=="axis"&&V&&V.props.trigger==="click"?re={onClick:yf(O.handleItemMouseEnter,k.props.onClick)}:P!=="axis"&&(re={onMouseLeave:yf(O.handleItemMouseLeave,k.props.onMouseLeave),onMouseEnter:yf(O.handleItemMouseEnter,k.props.onMouseEnter)});var Q=z.cloneElement(k,he(he({},I.props),re));function oe(me){return typeof L.dataKey=="function"?L.dataKey(me.payload):null}if(Y)if($>=0){var pe,ce;if(L.dataKey&&!L.allowDuplicatedCategory){var Oe=typeof L.dataKey=="function"?oe:"payload.".concat(L.dataKey.toString());pe=Lf(G,Oe,B),ce=F&&R&&Lf(R,Oe,B)}else pe=G==null?void 0:G[$],ce=F&&R&&R[$];if(K||J){var ae=k.props.activeIndex!==void 0?k.props.activeIndex:$;return[z.cloneElement(k,he(he(he({},I.props),re),{},{activeIndex:ae})),null,null]}if(!We(pe))return[Q].concat(ds(O.renderActivePoints({item:I,activePoint:pe,basePoint:ce,childIndex:$,isRange:F})))}else{var ye,Te=(ye=O.getItemByXY(O.state.activeCoordinate))!==null&&ye!==void 0?ye:{graphicalItem:Q},Ie=Te.graphicalItem,ue=Ie.item,de=ue===void 0?k:ue,xe=Ie.childIndex,je=he(he(he({},I.props),re),{},{activeIndex:xe});return[z.cloneElement(de,je),null,null]}return F?[Q,null,null]:[Q,null]}),$e(O,"renderCustomized",function(k,E,C){return z.cloneElement(k,he(he({key:"recharts-customized-".concat(C)},O.props),O.state))}),$e(O,"renderMap",{CartesianGrid:{handler:jf,once:!0},ReferenceArea:{handler:O.renderReferenceElement},ReferenceLine:{handler:jf},ReferenceDot:{handler:O.renderReferenceElement},XAxis:{handler:jf},YAxis:{handler:jf},Brush:{handler:O.renderBrush,once:!0},Bar:{handler:O.renderGraphicChild},Line:{handler:O.renderGraphicChild},Area:{handler:O.renderGraphicChild},Radar:{handler:O.renderGraphicChild},RadialBar:{handler:O.renderGraphicChild},Scatter:{handler:O.renderGraphicChild},Pie:{handler:O.renderGraphicChild},Funnel:{handler:O.renderGraphicChild},Tooltip:{handler:O.renderCursor,once:!0},PolarGrid:{handler:O.renderPolarGrid,once:!0},PolarAngleAxis:{handler:O.renderPolarAxis},PolarRadiusAxis:{handler:O.renderPolarAxis},Customized:{handler:O.renderCustomized}}),O.clipPathId="".concat((S=_.id)!==null&&S!==void 0?S:ws("recharts"),"-clip"),O.throttleTriggeredAfterMouseMove=NC(O.triggeredAfterMouseMove,(w=_.throttleDelay)!==null&&w!==void 0?w:1e3/60),O.state={},O}return IQ(j,y),PQ(j,[{key:"componentDidMount",value:function(){var S,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var S=this.props,w=S.children,O=S.data,k=S.height,E=S.layout,C=Tr(w,Kr);if(C){var I=C.props.defaultIndex;if(!(typeof I!="number"||I<0||I>this.state.tooltipTicks.length-1)){var P=this.state.tooltipTicks[I]&&this.state.tooltipTicks[I].value,A=wx(this.state,O,I,P),T=this.state.tooltipTicks[I].coordinate,L=(this.state.offset.top+k)/2,$=E==="horizontal",B=$?{x:T,y:L}:{y:T,x:L},U=this.state.formattedGraphicalItems.find(function(X){var G=X.item;return G.type.name==="Scatter"});U&&(B=he(he({},B),U.props.points[I].tooltipPosition),A=U.props.points[I].tooltipPayload);var V={activeTooltipIndex:I,isTooltipActive:!0,activeLabel:P,activePayload:A,activeCoordinate:B};this.setState(V),this.renderCursor(C),this.accessibilityManager.setIndex(I)}}}},{key:"getSnapshotBeforeUpdate",value:function(S,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==S.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==S.margin){var O,k;this.accessibilityManager.setDetails({offset:{left:(O=this.props.margin.left)!==null&&O!==void 0?O:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0}})}return null}},{key:"componentDidUpdate",value:function(S){rb([Tr(S.children,Kr)],[Tr(this.props.children,Kr)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var S=Tr(this.props.children,Kr);if(S&&typeof S.props.shared=="boolean"){var w=S.props.shared?"axis":"item";return l.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(S){if(!this.container)return null;var w=this.container,O=w.getBoundingClientRect(),k=oF(O),E={chartX:Math.round(S.pageX-k.left),chartY:Math.round(S.pageY-k.top)},C=O.width/w.offsetWidth||1,I=this.inRange(E.chartX,E.chartY,C);if(!I)return null;var P=this.state,A=P.xAxisMap,T=P.yAxisMap,L=this.getTooltipEventType(),$=gP(this.state,this.props.data,this.props.layout,I);if(L!=="axis"&&A&&T){var B=Ii(A).scale,U=Ii(T).scale,V=B&&B.invert?B.invert(E.chartX):null,X=U&&U.invert?U.invert(E.chartY):null;return he(he({},E),{},{xValue:V,yValue:X},$)}return $?he(he({},E),$):null}},{key:"inRange",value:function(S,w){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=this.props.layout,E=S/O,C=w/O;if(k==="horizontal"||k==="vertical"){var I=this.state.offset,P=E>=I.left&&E<=I.left+I.width&&C>=I.top&&C<=I.top+I.height;return P?{x:E,y:C}:null}var A=this.state,T=A.angleAxisMap,L=A.radiusAxisMap;if(T&&L){var $=Ii(T);return xE({x:E,y:C},$)}return null}},{key:"parseEventsOfWrapper",value:function(){var S=this.props.children,w=this.getTooltipEventType(),O=Tr(S,Kr),k={};O&&w==="axis"&&(O.props.trigger==="click"?k={onClick:this.handleClick}:k={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var E=$f(this.props,this.handleOuterEvent);return he(he({},E),k)}},{key:"addListener",value:function(){k0.on(E0,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){k0.removeListener(E0,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(S,w,O){for(var k=this.state.formattedGraphicalItems,E=0,C=k.length;E<C;E++){var I=k[E];if(I.item===S||I.props.key===S.key||w===Xn(I.item.type)&&O===I.childIndex)return I}return null}},{key:"renderClipPath",value:function(){var S=this.clipPathId,w=this.state.offset,O=w.left,k=w.top,E=w.height,C=w.width;return te.createElement("defs",null,te.createElement("clipPath",{id:S},te.createElement("rect",{x:O,y:k,height:E,width:C})))}},{key:"getXScales",value:function(){var S=this.state.xAxisMap;return S?Object.entries(S).reduce(function(w,O){var k=pP(O,2),E=k[0],C=k[1];return he(he({},w),{},$e({},E,C.scale))},{}):null}},{key:"getYScales",value:function(){var S=this.state.yAxisMap;return S?Object.entries(S).reduce(function(w,O){var k=pP(O,2),E=k[0],C=k[1];return he(he({},w),{},$e({},E,C.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(S){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[S])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(S){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[S])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(S){var w=this.state,O=w.formattedGraphicalItems,k=w.activeItem;if(O&&O.length)for(var E=0,C=O.length;E<C;E++){var I=O[E],P=I.props,A=I.item,T=A.type.defaultProps!==void 0?he(he({},A.type.defaultProps),A.props):A.props,L=Xn(A.type);if(L==="Bar"){var $=(P.data||[]).find(function(X){return _V(S,X)});if($)return{graphicalItem:I,payload:$}}else if(L==="RadialBar"){var B=(P.data||[]).find(function(X){return xE(S,X)});if(B)return{graphicalItem:I,payload:B}}else if(gh(I,k)||yh(I,k)||ju(I,k)){var U=VK({graphicalItem:I,activeTooltipItem:k,itemData:T.data}),V=T.activeIndex===void 0?U:T.activeIndex;return{graphicalItem:he(he({},I),{},{childIndex:V}),payload:ju(I,k)?T.data[U]:I.props.data[U]}}}return null}},{key:"render",value:function(){var S=this;if(!TO(this))return null;var w=this.props,O=w.children,k=w.className,E=w.width,C=w.height,I=w.style,P=w.compact,A=w.title,T=w.desc,L=mP(w,jQ),$=Le(L,!1);if(P)return te.createElement(YA,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},te.createElement(ib,Co({},$,{width:E,height:C,title:A,desc:T}),this.renderClipPath(),MO(O,this.renderMap)));if(this.props.accessibilityLayer){var B,U;$.tabIndex=(B=this.props.tabIndex)!==null&&B!==void 0?B:0,$.role=(U=this.props.role)!==null&&U!==void 0?U:"application",$.onKeyDown=function(X){S.accessibilityManager.keyboardEvent(X)},$.onFocus=function(){S.accessibilityManager.focus()}}var V=this.parseEventsOfWrapper();return te.createElement(YA,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},te.createElement("div",Co({className:Ke("recharts-wrapper",k),style:he({position:"relative",cursor:"default",width:E,height:C},I)},V,{ref:function(G){S.container=G}}),te.createElement(ib,Co({},$,{width:E,height:C,title:A,desc:T,style:BQ}),this.renderClipPath(),MO(O,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(z.Component);$e(x,"displayName",r),$e(x,"defaultProps",he({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),$e(x,"getDerivedStateFromProps",function(y,j){var _=y.dataKey,S=y.data,w=y.children,O=y.width,k=y.height,E=y.layout,C=y.stackOffset,I=y.margin,P=j.dataStartIndex,A=j.dataEndIndex;if(j.updateId===void 0){var T=yP(y);return he(he(he({},T),{},{updateId:0},v(he(he({props:y},T),{},{updateId:0}),j)),{},{prevDataKey:_,prevData:S,prevWidth:O,prevHeight:k,prevLayout:E,prevStackOffset:C,prevMargin:I,prevChildren:w})}if(_!==j.prevDataKey||S!==j.prevData||O!==j.prevWidth||k!==j.prevHeight||E!==j.prevLayout||C!==j.prevStackOffset||!Ro(I,j.prevMargin)){var L=yP(y),$={chartX:j.chartX,chartY:j.chartY,isTooltipActive:j.isTooltipActive},B=he(he({},gP(j,S,E)),{},{updateId:j.updateId+1}),U=he(he(he({},L),$),B);return he(he(he({},U),v(he({props:y},U),j)),{},{prevDataKey:_,prevData:S,prevWidth:O,prevHeight:k,prevLayout:E,prevStackOffset:C,prevMargin:I,prevChildren:w})}if(!rb(w,j.prevChildren)){var V,X,G,F,R=Tr(w,rs),q=R&&(V=(X=R.props)===null||X===void 0?void 0:X.startIndex)!==null&&V!==void 0?V:P,H=R&&(G=(F=R.props)===null||F===void 0?void 0:F.endIndex)!==null&&G!==void 0?G:A,ee=q!==P||H!==A,J=!We(S),K=J&&!ee?j.updateId:j.updateId+1;return he(he({updateId:K},v(he(he({props:y},j),{},{updateId:K,dataStartIndex:q,dataEndIndex:H}),j)),{},{prevChildren:w,dataStartIndex:q,dataEndIndex:H})}return null}),$e(x,"renderActiveDot",function(y,j,_){var S;return z.isValidElement(y)?S=z.cloneElement(y,j):Fe(y)?S=y(j):S=te.createElement(dh,j),te.createElement(Je,{className:"recharts-active-dot",key:_},S)});var b=z.forwardRef(function(j,_){return te.createElement(x,Co({},j,{ref:_}))});return b.displayName=x.displayName,b},XQ=Uw({chartName:"LineChart",GraphicalChild:Hu,axisComponents:[{axisType:"xAxis",AxisComp:ks},{axisType:"yAxis",AxisComp:Es}],formatAxisMap:hI}),QQ=Uw({chartName:"BarChart",GraphicalChild:$a,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ks},{axisType:"yAxis",AxisComp:Es}],formatAxisMap:hI}),JQ=Uw({chartName:"PieChart",GraphicalChild:si,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:vh},{axisType:"radiusAxis",AxisComp:ph}],formatAxisMap:Lz,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function $r(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Fi(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function ZQ(t,e){const r=$r(t);return isNaN(e)?Fi(t,NaN):(r.setDate(r.getDate()+e),r)}const GI=6048e5,eJ=864e5;let tJ={};function Oh(){return tJ}function Pu(t,e){var l,c,d,p;const r=Oh(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((p=(d=r.locale)==null?void 0:d.options)==null?void 0:p.weekStartsOn)??0,i=$r(t),a=i.getDay(),o=(a<n?7:0)+a-n;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function Rd(t){return Pu(t,{weekStartsOn:1})}function YI(t){const e=$r(t),r=e.getFullYear(),n=Fi(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=Rd(n),a=Fi(t,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Rd(a);return e.getTime()>=i.getTime()?r+1:e.getTime()>=o.getTime()?r:r-1}function _x(t){const e=$r(t);return e.setHours(0,0,0,0),e}function xP(t){const e=$r(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function rJ(t,e){const r=_x(t),n=_x(e),i=+r-xP(r),a=+n-xP(n);return Math.round((i-a)/eJ)}function nJ(t){const e=YI(t),r=Fi(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),Rd(r)}function iJ(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function aJ(t){if(!iJ(t)&&typeof t!="number")return!1;const e=$r(t);return!isNaN(Number(e))}function oJ(t){const e=$r(t);return e.setHours(23,59,59,999),e}function sJ(t){const e=$r(t),r=Fi(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}const lJ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},uJ=(t,e,r)=>{let n;const i=lJ[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function P0(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const cJ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fJ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dJ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hJ={date:P0({formats:cJ,defaultWidth:"full"}),time:P0({formats:fJ,defaultWidth:"full"}),dateTime:P0({formats:dJ,defaultWidth:"full"})},pJ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},mJ=(t,e,r,n)=>pJ[t];function jl(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;i=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return i[a]}}const vJ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},gJ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},yJ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},bJ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xJ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wJ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_J=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},jJ={ordinalNumber:_J,era:jl({values:vJ,defaultWidth:"wide"}),quarter:jl({values:gJ,defaultWidth:"wide",argumentCallback:t=>t-1}),month:jl({values:yJ,defaultWidth:"wide"}),day:jl({values:bJ,defaultWidth:"wide"}),dayPeriod:jl({values:xJ,defaultWidth:"wide",formattingValues:wJ,defaultFormattingWidth:"wide"})};function Sl(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?OJ(l,h=>h.test(o)):SJ(l,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const p=e.slice(o.length);return{value:d,rest:p}}}function SJ(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function OJ(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function NJ(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(i.length);return{value:o,rest:l}}}const kJ=/^(\d+)(th|st|nd|rd)?/i,EJ=/\d+/i,AJ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PJ={any:[/^b/i,/^(a|c)/i]},TJ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},CJ={any:[/1/i,/2/i,/3/i,/4/i]},MJ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},IJ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},RJ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},DJ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},LJ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$J={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},qJ={ordinalNumber:NJ({matchPattern:kJ,parsePattern:EJ,valueCallback:t=>parseInt(t,10)}),era:Sl({matchPatterns:AJ,defaultMatchWidth:"wide",parsePatterns:PJ,defaultParseWidth:"any"}),quarter:Sl({matchPatterns:TJ,defaultMatchWidth:"wide",parsePatterns:CJ,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Sl({matchPatterns:MJ,defaultMatchWidth:"wide",parsePatterns:IJ,defaultParseWidth:"any"}),day:Sl({matchPatterns:RJ,defaultMatchWidth:"wide",parsePatterns:DJ,defaultParseWidth:"any"}),dayPeriod:Sl({matchPatterns:LJ,defaultMatchWidth:"any",parsePatterns:$J,defaultParseWidth:"any"})},BJ={code:"en-US",formatDistance:uJ,formatLong:hJ,formatRelative:mJ,localize:jJ,match:qJ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function FJ(t){const e=$r(t);return rJ(e,sJ(e))+1}function UJ(t){const e=$r(t),r=+Rd(e)-+nJ(e);return Math.round(r/GI)+1}function XI(t,e){var p,h,m,v;const r=$r(t),n=r.getFullYear(),i=Oh(),a=(e==null?void 0:e.firstWeekContainsDate)??((h=(p=e==null?void 0:e.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??i.firstWeekContainsDate??((v=(m=i.locale)==null?void 0:m.options)==null?void 0:v.firstWeekContainsDate)??1,o=Fi(t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Pu(o,e),c=Fi(t,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const d=Pu(c,e);return r.getTime()>=l.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function zJ(t,e){var l,c,d,p;const r=Oh(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(d=r.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,i=XI(t,e),a=Fi(t,0);return a.setFullYear(i,0,n),a.setHours(0,0,0,0),Pu(a,e)}function WJ(t,e){const r=$r(t),n=+Pu(r,e)-+zJ(r,e);return Math.round(n/GI)+1}function at(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const Pi={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return at(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):at(r+1,2)},d(t,e){return at(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return at(t.getHours()%12||12,e.length)},H(t,e){return at(t.getHours(),e.length)},m(t,e){return at(t.getMinutes(),e.length)},s(t,e){return at(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return at(i,e.length)}},So={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wP={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Pi.y(t,e)},Y:function(t,e,r,n){const i=XI(t,n),a=i>0?i:1-i;if(e==="YY"){const o=a%100;return at(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):at(a,e.length)},R:function(t,e){const r=YI(t);return at(r,e.length)},u:function(t,e){const r=t.getFullYear();return at(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return at(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return at(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return Pi.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return at(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const i=WJ(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):at(i,e.length)},I:function(t,e,r){const n=UJ(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):at(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Pi.d(t,e)},D:function(t,e,r){const n=FJ(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):at(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return at(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const i=t.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return at(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return at(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let i;switch(n===12?i=So.noon:n===0?i=So.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let i;switch(n>=17?i=So.evening:n>=12?i=So.afternoon:n>=4?i=So.morning:i=So.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Pi.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Pi.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):at(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):at(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Pi.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Pi.s(t,e)},S:function(t,e){return Pi.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return jP(n);case"XXXX":case"XX":return ga(n);case"XXXXX":case"XXX":default:return ga(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return jP(n);case"xxxx":case"xx":return ga(n);case"xxxxx":case"xxx":default:return ga(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+_P(n,":");case"OOOO":default:return"GMT"+ga(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+_P(n,":");case"zzzz":default:return"GMT"+ga(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return at(n,e.length)},T:function(t,e,r){const n=t.getTime();return at(n,e.length)}};function _P(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),a=n%60;return a===0?r+String(i):r+String(i)+e+at(a,2)}function jP(t,e){return t%60===0?(t>0?"-":"+")+at(Math.abs(t)/60,2):ga(t,e)}function ga(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=at(Math.trunc(n/60),2),a=at(n%60,2);return r+i+e+a}const SP=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},QI=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},HJ=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return SP(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",SP(n,e)).replace("{{time}}",QI(i,e))},VJ={p:QI,P:HJ},KJ=/^D+$/,GJ=/^Y+$/,YJ=["D","DD","YY","YYYY"];function XJ(t){return KJ.test(t)}function QJ(t){return GJ.test(t)}function JJ(t,e,r){const n=ZJ(t,e,r);if(console.warn(n),YJ.includes(t))throw new RangeError(n)}function ZJ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const eZ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rZ=/^'([^]*?)'?$/,nZ=/''/g,iZ=/[a-zA-Z]/;function ha(t,e,r){var p,h,m,v;const n=Oh(),i=n.locale??BJ,a=n.firstWeekContainsDate??((h=(p=n.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,o=n.weekStartsOn??((v=(m=n.locale)==null?void 0:m.options)==null?void 0:v.weekStartsOn)??0,l=$r(t);if(!aJ(l))throw new RangeError("Invalid time value");let c=e.match(tZ).map(x=>{const b=x[0];if(b==="p"||b==="P"){const y=VJ[b];return y(x,i.formatLong)}return x}).join("").match(eZ).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const b=x[0];if(b==="'")return{isToken:!1,value:aZ(x)};if(wP[b])return{isToken:!0,value:x};if(b.match(iZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:x}});i.localize.preprocessor&&(c=i.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:i};return c.map(x=>{if(!x.isToken)return x.value;const b=x.value;(QJ(b)||XJ(b))&&JJ(b,e,String(t));const y=wP[b[0]];return y(l,b,i.localize,d)}).join("")}function aZ(t){const e=t.match(rZ);return e?e[1].replace(nZ,"'"):t}function oZ(t,e){return ZQ(t,-30)}const OP=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"],sZ=()=>f.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 animate-pulse",children:f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),f.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"})]})]})}),Sf=({height:t="h-80"})=>f.jsxs("div",{className:`bg-white rounded-xl border border-gray-200 ${t} animate-pulse`,children:[f.jsx("div",{className:"p-6 border-b border-gray-200",children:f.jsx("div",{className:"h-6 bg-gray-200 rounded w-32"})}),f.jsx("div",{className:"p-6 space-y-4",children:[...Array(5)].map((e,r)=>f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-8 h-4 bg-gray-200 rounded"}),f.jsx("div",{className:"flex-1 h-4 bg-gray-200 rounded"}),f.jsx("div",{className:"w-12 h-4 bg-gray-200 rounded"})]},r))})]}),Of=({title:t,description:e,icon:r})=>f.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[f.jsx(r,{className:"w-12 h-12 text-gray-300 mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),f.jsx("p",{className:"text-gray-500 max-w-md",children:e})]});function lZ(){var k,E,C,I,P,A,T,L,$,B;const[t,e]=z.useState({}),[r,n]=z.useState([]),[i,a]=z.useState("all"),[o,l]=z.useState({start:ha(oZ(new Date),"yyyy-MM-dd"),end:ha(new Date,"yyyy-MM-dd")}),[c,d]=z.useState(!0),[p,h]=z.useState(null),[m,v]=z.useState(!1),x=z.useCallback(async()=>{try{const{data:U,error:V}=await we.from("clients").select("id, name, brand_color").order("name");if(V)throw V;n(U||[])}catch(U){console.error("Error fetching clients:",U)}},[]),b=z.useCallback(async(U=!1)=>{try{U?v(!0):d(!0),h(null);const{data:V,error:X}=await we.functions.invoke("analytics-dashboard",{body:{clientId:i,dateRange:{start:ha(_x(new Date(o.start)),"yyyy-MM-dd'T'HH:mm:ss.SSSxxx"),end:ha(oJ(new Date(o.end)),"yyyy-MM-dd'T'HH:mm:ss.SSSxxx")},metrics:["user_activity","recent_activity","content_engagement","agent_usage","summary_stats"]}});if(X)throw new Error(X.message||"Failed to fetch analytics data");e(V||{})}catch(V){h(V instanceof Error?V.message:"Failed to load analytics data"),console.error("Analytics fetch error:",V)}finally{d(!1),v(!1)}},[i,o.start,o.end]);z.useEffect(()=>{x()},[]),z.useEffect(()=>{let U=!0;return(async()=>{U&&await b()})(),()=>{U=!1}},[i,o.start,o.end]);const y=()=>{b(!0)},j=U=>{a(U)},_=(U,V)=>{l(X=>({...X,[U]:V}))},S=[{title:"Total Users",value:((k=t.summaryStats)==null?void 0:k.totalUsers)||0,icon:Lr,color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-600"},{title:"Content Items",value:((E=t.summaryStats)==null?void 0:E.totalContent)||0,icon:ko,color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-600"},{title:"Recent Activities",value:((C=t.summaryStats)==null?void 0:C.recentActivities)||0,icon:Ef,color:"bg-purple-500",bgColor:"bg-purple-50",textColor:"text-purple-600"},{title:"Active Sessions",value:((I=t.agentUsage)==null?void 0:I.reduce((U,V)=>U+V.conversation_count,0))||0,icon:wr,color:"bg-orange-500",bgColor:"bg-orange-50",textColor:"text-orange-600"}],w=((P=t.contentEngagement)==null?void 0:P.slice(0,8).map(U=>({name:U.content_items.title.substring(0,20)+"...",engagements:U.engagement_count,type:U.content_items.content_type})))||[],O=((A=t.agentUsage)==null?void 0:A.slice(0,6).map((U,V)=>({name:U.content_items.title.substring(0,15)+"...",conversations:U.conversation_count,messages:U.total_messages,fill:OP[V%OP.length]})))||[];return c&&!m?f.jsx(hr,{children:f.jsxs("div",{className:"space-y-8",children:[f.jsx("div",{className:"flex items-center justify-between",children:f.jsxs("div",{children:[f.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2 animate-pulse"}),f.jsx("div",{className:"h-5 bg-gray-200 rounded w-80 animate-pulse"})]})}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((U,V)=>f.jsx(sZ,{},V))}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[f.jsx(Sf,{}),f.jsx(Sf,{}),f.jsx(Sf,{}),f.jsx(Sf,{})]})]})}):f.jsx(hr,{children:f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Analytics Dashboard"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Track platform performance and user engagement"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[f.jsxs("div",{className:"relative",children:[f.jsxs("select",{value:i,onChange:U=>j(U.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"all",children:"All Clients"}),r.map(U=>f.jsx("option",{value:U.id,children:U.name},U.id))]}),f.jsx(Rf,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"date",value:o.start,onChange:U=>_("start",U.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("span",{className:"text-gray-500",children:"to"}),f.jsx("input",{type:"date",value:o.end,onChange:U=>_("end",U.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("button",{onClick:y,disabled:m,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[f.jsx(d$,{className:`w-4 h-4 mr-2 ${m?"animate-spin":""}`}),"Refresh"]})]})]}),p&&f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3",children:[f.jsx(Rx,{className:"w-5 h-5 text-red-500"}),f.jsx("span",{className:"text-red-700",children:p}),f.jsx("button",{onClick:y,className:"ml-auto text-red-600 hover:text-red-700 font-medium",children:"Try Again"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map(U=>{const V=U.icon;return f.jsx("div",{className:`${U.bgColor} rounded-xl p-6 border border-gray-200`,children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:`${U.color} rounded-lg p-3 mr-4`,children:f.jsx(V,{className:"h-6 w-6 text-white"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:U.title}),f.jsx("p",{className:`text-3xl font-bold ${U.textColor}`,children:U.value.toLocaleString()})]})]})},U.title)})}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[f.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(v$,{className:"w-5 h-5 text-yellow-500"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Top Active Users"})]}),f.jsx("span",{className:"text-sm text-gray-500",children:"Last 30 days"})]}),f.jsx("div",{className:"p-6",children:t.userActivity&&t.userActivity.length>0?f.jsx("div",{className:"space-y-4",children:t.userActivity.slice(0,10).map((U,V)=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${V<3?"bg-yellow-100 text-yellow-800":"bg-gray-200 text-gray-600"}`,children:V+1}),f.jsxs("div",{children:[f.jsxs("p",{className:"font-medium text-gray-900",children:[U.first_name," ",U.last_name]}),f.jsx("p",{className:"text-sm text-gray-500",children:U.email})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"font-semibold text-gray-900",children:U.activity_count}),f.jsx("p",{className:"text-xs text-gray-500",children:"activities"})]})]},U.user_id))}):f.jsx(Of,{title:"No user activity data",description:"User activity will appear here once users start engaging with the platform",icon:Lr})})]}),f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[f.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(Kl,{className:"w-5 h-5 text-blue-500"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Activity"})]}),f.jsx("span",{className:"text-sm text-gray-500",children:"Live feed"})]}),f.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:t.recentActivity&&t.recentActivity.length>0?f.jsx("div",{className:"space-y-4",children:t.recentActivity.slice(0,20).map(U=>f.jsxs("div",{className:"flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[f.jsx(Ef,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("p",{className:"text-sm text-gray-900",children:[f.jsxs("span",{className:"font-medium",children:[U.users.first_name," ",U.users.last_name]})," ",U.activity_type.replace("_"," "),U.content_items&&f.jsxs("span",{className:"text-gray-600",children:[" ",'"',f.jsx("span",{className:"font-medium",children:U.content_items.title}),'"']})]}),f.jsx("p",{className:"text-xs text-gray-500",children:ha(new Date(U.created_at),"MMM d, h:mm a")})]})]},U.id))}):f.jsx(Of,{title:"No recent activity",description:"User activities will appear here as they happen on your platform",icon:Ef})})]}),f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[f.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(If,{className:"w-5 h-5 text-purple-500"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Content Engagement"})]})}),f.jsx("div",{className:"p-6",children:w.length>0?f.jsx(yb,{width:"100%",height:300,children:f.jsxs(QQ,{data:w,layout:"horizontal",children:[f.jsx(Fw,{strokeDasharray:"3 3"}),f.jsx(ks,{type:"number"}),f.jsx(Es,{dataKey:"name",type:"category",width:120}),f.jsx(Kr,{}),f.jsx($a,{dataKey:"engagements",fill:"#8B5CF6",radius:[0,4,4,0]})]})}):f.jsx(Of,{title:"No engagement data",description:"Content engagement metrics will appear here once users start interacting with your content",icon:If})})]}),f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[f.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(f$,{className:"w-5 h-5 text-green-500"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Agent Usage"})]})}),f.jsx("div",{className:"p-6",children:O.length>0?f.jsxs("div",{className:"flex items-center space-x-8",children:[f.jsx(yb,{width:"70%",height:300,children:f.jsxs(JQ,{children:[f.jsx(si,{data:O,cx:"50%",cy:"50%",outerRadius:100,dataKey:"conversations",children:O.map((U,V)=>f.jsx(eh,{fill:U.fill},`cell-${V}`))}),f.jsx(Kr,{})]})}),f.jsx("div",{className:"space-y-2",children:O.map((U,V)=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:U.fill}}),f.jsx("span",{className:"text-sm text-gray-700",children:U.name})]},V))})]}):f.jsx(Of,{title:"No agent usage data",description:"Agent conversation statistics will appear here once users start chatting with AI agents",icon:wr})})]})]}),f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[f.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(OT,{className:"w-5 h-5 text-blue-500"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Platform Overview"})]}),f.jsxs("span",{className:"text-sm text-gray-500",children:[ha(new Date(o.start),"MMM d")," - ",ha(new Date(o.end),"MMM d, yyyy")]})]})}),f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"text-center",children:[f.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[((((T=t.summaryStats)==null?void 0:T.recentActivities)||0)/Math.max(((L=t.summaryStats)==null?void 0:L.totalUsers)||1,1)*100).toFixed(1),"%"]}),f.jsx("p",{className:"text-gray-600",children:"User Engagement Rate"}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Activities per user in selected period"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:(($=t.contentEngagement)==null?void 0:$.length)||0}),f.jsx("p",{className:"text-gray-600",children:"Active Content Items"}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Content with user interactions"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:((B=t.agentUsage)==null?void 0:B.reduce((U,V)=>U+V.total_messages,0))||0}),f.jsx("p",{className:"text-gray-600",children:"Total Messages"}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Messages exchanged with AI agents"})]})]})})]})]})})}const uZ=({isOpen:t,onClose:e,onClientCreated:r,editingClient:n})=>{const i=z.useRef(null),[a,o]=z.useState(!1),[l,c]=z.useState([]),[d,p]=z.useState([]),[h,m]=z.useState({}),[v,x]=z.useState({clientName:(n==null?void 0:n.name)||"",projectName:(n==null?void 0:n.project_name)||"",logoFile:null,logoPreview:(n==null?void 0:n.logo_url)||"",brandColor:(n==null?void 0:n.brand_color)||"#3B82F6",apiKeyId:(n==null?void 0:n.api_key_id)||"",forumEnabled:(n==null?void 0:n.forum_enabled)??!0,startFromTemplate:!1,templateId:"",includeContent:!1});te.useEffect(()=>{t&&!n&&b()},[t]);const b=async()=>{try{const{data:C}=await we.from("api_keys").select("id, name, key_type").eq("status","active").order("name");C&&c(C);const{data:I}=await we.from("clients").select("id, name, project_name").eq("is_template",!0).eq("status","active").order("name");I&&p(I)}catch(C){console.error("Error loading options:",C)}},y=()=>{const C={};return v.clientName.trim()?v.clientName.length<2&&(C.clientName="Client name must be at least 2 characters"):C.clientName="Client name is required",/^#[0-9A-F]{6}$/i.test(v.brandColor)||(C.brandColor="Please enter a valid HEX color code"),!v.apiKeyId&&!v.startFromTemplate&&(C.apiKeyId="Please select an API key"),m(C),Object.keys(C).length===0},j=z.useCallback(C=>{if(C&&C.type.startsWith("image/")){const I=new FileReader;I.onload=P=>{x(A=>{var T;return{...A,logoFile:C,logoPreview:(T=P.target)==null?void 0:T.result}})},I.readAsDataURL(C)}},[]),_=z.useCallback(C=>{C.preventDefault();const I=Array.from(C.dataTransfer.files);I.length>0&&j(I[0])},[j]),S=z.useCallback(C=>{const I=C.target.files;I&&I.length>0&&j(I[0])},[j]),w=async()=>{if(!v.logoFile)return null;try{const C=v.logoFile.name.split(".").pop(),P=`client-logos/${`${Date.now()}-${Math.random().toString(36).substring(2)}.${C}`}`,{error:A}=await we.storage.from("assets").upload(P,v.logoFile);if(A)throw A;const{data:T}=we.storage.from("assets").getPublicUrl(P);return T.publicUrl}catch(C){return console.error("Error uploading logo:",C),null}},O=async C=>{if(C.preventDefault(),!!y()){o(!0);try{let I=v.logoPreview;if(v.logoFile){const T=await w();T&&(I=T)}const P={name:v.clientName.trim(),project_name:v.projectName.trim()||null,logo_url:I,brand_color:v.brandColor,api_key_id:v.apiKeyId||null,forum_enabled:v.forumEnabled,status:"active",is_template:!1};let A;if(n){const{data:T,error:L}=await we.from("clients").update(P).eq("id",n.id).select().single();A={data:T,error:L}}else if(v.startFromTemplate&&v.templateId){const{data:T,error:L}=await we.functions.invoke("clone-client-template",{body:{template_id:v.templateId,client_data:P,include_content:v.includeContent}});A={data:T,error:L}}else{const{data:T,error:L}=await we.from("clients").insert([P]).select().single();A={data:T,error:L}}if(A.error){if(A.error.code==="23505"){m({clientName:"A client with this name already exists"});return}throw A.error}k(),r(),e()}catch(I){console.error("Error saving client:",I)}finally{o(!1)}}},k=()=>{x({clientName:"",projectName:"",logoFile:null,logoPreview:"",brandColor:"#3B82F6",apiKeyId:"",forumEnabled:!0,startFromTemplate:!1,templateId:"",includeContent:!1}),m({})},E=()=>{a||(k(),e())};return t?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Client":"Create New Client"}),f.jsx("button",{onClick:E,disabled:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:f.jsx(Iu,{size:24})})]}),f.jsxs("form",{onSubmit:O,className:"p-6 space-y-6",children:[!n&&f.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[f.jsxs("label",{className:"flex items-center space-x-3",children:[f.jsx("input",{type:"checkbox",checked:v.startFromTemplate,onChange:C=>x(I=>({...I,startFromTemplate:C.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Start from Template"})]}),v.startFromTemplate&&f.jsxs("div",{className:"mt-4 space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Template"}),f.jsxs("select",{value:v.templateId,onChange:C=>x(I=>({...I,templateId:C.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:v.startFromTemplate,children:[f.jsx("option",{value:"",children:"Select a template..."}),d.map(C=>f.jsxs("option",{value:C.id,children:[C.name," ",C.project_name&&`(${C.project_name})`]},C.id))]})]}),f.jsxs("label",{className:"flex items-center space-x-3",children:[f.jsx("input",{type:"checkbox",checked:v.includeContent,onChange:C=>x(I=>({...I,includeContent:C.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-gray-600",children:"Include all content (agents, documents, etc.)"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),f.jsx("input",{type:"text",value:v.clientName,onChange:C=>x(I=>({...I,clientName:C.target.value})),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${h.clientName?"border-red-500":"border-gray-300"}`,placeholder:"Enter client name",required:!0}),h.clientName&&f.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[f.jsx(Ml,{size:16,className:"mr-1"}),h.clientName]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name"}),f.jsx("input",{type:"text",value:v.projectName,onChange:C=>x(I=>({...I,projectName:C.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional project name"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Logo"}),f.jsxs("div",{className:"flex items-center space-x-6",children:[f.jsx("div",{className:"flex-shrink-0",children:v.logoPreview?f.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-2 border-gray-200",children:f.jsx("img",{src:v.logoPreview,alt:"Logo preview",className:"w-full h-full object-cover"})}):f.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 border-2 border-gray-200 flex items-center justify-center",children:f.jsx(Df,{size:24,className:"text-gray-400"})})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{onDrop:_,onDragOver:C=>C.preventDefault(),onClick:()=>{var C;return(C=i.current)==null?void 0:C.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-blue-400 transition-colors",children:[f.jsx(Df,{size:24,className:"mx-auto mb-2 text-gray-400"}),f.jsxs("p",{className:"text-sm text-gray-600",children:["Drag and drop an image, or ",f.jsx("span",{className:"text-blue-600",children:"click to browse"})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: Square image, at least 200x200px"})]}),f.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:S,className:"hidden"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand Color *"}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-md border border-gray-300 cursor-pointer",style:{backgroundColor:v.brandColor},onClick:()=>{const C=document.createElement("input");C.type="color",C.value=v.brandColor,C.onchange=I=>{x(P=>({...P,brandColor:I.target.value}))},C.click()},children:f.jsx(c$,{size:16,className:"text-white m-2"})}),f.jsx("input",{type:"text",value:v.brandColor,onChange:C=>x(I=>({...I,brandColor:C.target.value})),className:`flex-1 border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono ${h.brandColor?"border-red-500":"border-gray-300"}`,placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}),h.brandColor&&f.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[f.jsx(Ml,{size:16,className:"mr-1"}),h.brandColor]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["API Key ",!v.startFromTemplate&&"*"]}),f.jsxs("select",{value:v.apiKeyId,onChange:C=>x(I=>({...I,apiKeyId:C.target.value})),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${h.apiKeyId?"border-red-500":"border-gray-300"}`,required:!v.startFromTemplate,children:[f.jsx("option",{value:"",children:"Select an API key..."}),l.map(C=>f.jsxs("option",{value:C.id,children:[C.name," (",C.key_type,")"]},C.id))]}),h.apiKeyId&&f.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[f.jsx(Ml,{size:16,className:"mr-1"}),h.apiKeyId]})]})]}),f.jsx("div",{children:f.jsxs("label",{className:"flex items-center space-x-3",children:[f.jsx("input",{type:"checkbox",checked:v.forumEnabled,onChange:C=>x(I=>({...I,forumEnabled:C.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Forum"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Allow users to participate in community discussions"})]})]})}),f.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:E,disabled:a,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),f.jsxs("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 flex items-center space-x-2",children:[a&&f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),f.jsx("span",{children:n?"Update Client":"Create Client"}),!a&&f.jsx(t$,{size:16})]})]})]})]})}):null},cZ=()=>{const t=zi(),[e,r]=z.useState([]),[n,i]=z.useState(!0),[a,o]=z.useState(""),[l,c]=z.useState("all"),[d,p]=z.useState(!1),[h,m]=z.useState(!1),[v,x]=z.useState(null),[b,y]=z.useState(null);z.useEffect(()=>{j()},[l,d]);const j=async()=>{i(!0);try{let A=we.from("clients").select("*").order("created_at",{ascending:!1});l!=="all"&&(A=A.eq("status",l)),d||(A=A.neq("status","archived"));const{data:T,error:L}=await A;if(L)throw L;r(T||[])}catch(A){console.error("Error loading clients:",A)}finally{i(!1)}},_=()=>{x(null),m(!0)},S=A=>{x(A),m(!0)},w=A=>{t(`/clients/${A}`)},O=async A=>{const T=A.status==="archived"?"active":"archived";try{const{error:L}=await we.from("clients").update({status:T}).eq("id",A.id);if(L)throw L;j()}catch(L){console.error("Error updating client status:",L)}},k=async A=>{if(confirm(`Are you sure you want to permanently delete "${A.name}"? This action cannot be undone.`))try{const{error:T}=await we.from("clients").delete().eq("id",A.id);if(T)throw T;j()}catch(T){console.error("Error deleting client:",T)}},E=A=>{window.open(`/client-preview/${A.id}`,"_blank")},C=e.filter(A=>A.name.toLowerCase().includes(a.toLowerCase())||A.project_name&&A.project_name.toLowerCase().includes(a.toLowerCase())),I=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),P=A=>{const T={active:{bg:"bg-green-100",text:"text-green-800",icon:Yn},archived:{bg:"bg-gray-100",text:"text-gray-800",icon:yS},inactive:{bg:"bg-yellow-100",text:"text-yellow-800",icon:null}},L=T[A]||T.active,$=L.icon;return f.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L.bg} ${L.text}`,children:[$&&f.jsx($,{size:12,className:"mr-1"}),A.charAt(0).toUpperCase()+A.slice(1)]})};return f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Client Management"}),f.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your clients and their platform configurations"})]}),f.jsxs("button",{onClick:_,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 transition-colors",children:[f.jsx(Qr,{size:20}),f.jsx("span",{children:"Create New Client"})]})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4",children:[f.jsxs("div",{className:"relative flex-1 max-w-md",children:[f.jsx(gs,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),f.jsx("input",{type:"text",value:a,onChange:A=>o(A.target.value),placeholder:"Search clients or projects...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),f.jsxs("div",{className:"flex items-center space-x-6",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Fd,{size:16,className:"text-gray-400"}),f.jsxs("select",{value:l,onChange:A=>c(A.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[f.jsx("option",{value:"all",children:"All Status"}),f.jsx("option",{value:"active",children:"Active"}),f.jsx("option",{value:"inactive",children:"Inactive"}),f.jsx("option",{value:"archived",children:"Archived"})]})]}),f.jsxs("label",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"checkbox",checked:d,onChange:A=>p(A.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-gray-700",children:"Show Archived"})]})]})]}),f.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.filter(A=>A.status==="active").length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Active Clients"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-gray-600",children:e.length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Total Clients"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(A=>A.forum_enabled).length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Forum Enabled"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.filter(A=>A.is_template).length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Templates"})]})]})})]}),f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:n?f.jsxs("div",{className:"p-8 text-center",children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Loading clients..."})]}):C.length===0?f.jsxs("div",{className:"p-8 text-center",children:[f.jsx(Lr,{size:48,className:"mx-auto text-gray-300 mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No clients found"}),f.jsx("p",{className:"text-gray-600 mb-4",children:a?"Try adjusting your search criteria.":"Get started by creating your first client."}),!a&&f.jsx("button",{onClick:_,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create First Client"})]}):f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Active Users"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),f.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(A=>f.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[A.logo_url?f.jsx("img",{src:A.logo_url,alt:`${A.name} logo`,className:"w-10 h-10 rounded-full object-cover border border-gray-200"}):f.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold shadow-sm",style:{backgroundColor:A.brand_color||"#3B82F6"},children:A.name.charAt(0).toUpperCase()}),f.jsxs("div",{className:"ml-4",children:[f.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),A.is_template&&f.jsx("span",{className:"inline-block px-2 py-0.5 text-xs bg-purple-100 text-purple-800 rounded-full mt-1",children:"Template"})]})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("div",{className:"text-sm text-gray-900",children:A.project_name||f.jsx("span",{className:"text-gray-400",children:"-"})})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Lr,{size:16,className:"text-gray-400 mr-1"}),f.jsx("span",{className:"text-sm text-gray-900",children:"-"})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Vl,{size:16,className:"text-gray-400 mr-1"}),f.jsx("span",{className:"text-sm text-gray-900",children:I(A.created_at)})]})}),f.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[P(A.status),A.forum_enabled&&f.jsx("span",{className:"ml-2 inline-block w-2 h-2 bg-green-400 rounded-full",title:"Forum Enabled"})]}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:f.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[f.jsx("button",{onClick:()=>w(A.id),className:"bg-blue-600 text-white px-3 py-1.5 rounded text-sm hover:bg-blue-700 transition-colors",children:"Manage"}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>y(b===A.id?null:A.id),className:"text-gray-400 hover:text-gray-600 p-1 rounded transition-colors",children:f.jsx(wT,{size:16})}),b===A.id&&f.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:f.jsxs("div",{className:"py-1",children:[f.jsxs("button",{onClick:()=>{E(A),y(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[f.jsx(Bi,{size:16,className:"mr-2"}),"Preview"]}),f.jsxs("button",{onClick:()=>{S(A),y(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[f.jsx(Z0,{size:16,className:"mr-2"}),"Edit"]}),f.jsxs("button",{onClick:()=>{O(A),y(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[f.jsx(yS,{size:16,className:"mr-2"}),A.status==="archived"?"Restore":"Archive"]}),A.status==="archived"&&f.jsxs("button",{onClick:()=>{k(A),y(null)},className:"flex items-center w-full px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:[f.jsx(ys,{size:16,className:"mr-2"}),"Delete Permanently"]})]})})]})]})})]},A.id))})]})})}),f.jsx(uZ,{isOpen:h,onClose:()=>m(!1),onClientCreated:j,editingClient:v})]})};function fZ(){const[t,e]=z.useState([]),[r,n]=z.useState([]),[i,a]=z.useState([]),[o,l]=z.useState(!0),[c,d]=z.useState(""),[p,h]=z.useState("");z.useEffect(()=>{m()},[]);const m=async()=>{try{l(!0);const[y,j,_]=await Promise.all([we.from("users").select("*").order("created_at",{ascending:!1}),we.from("clients").select("*").order("name"),we.from("user_tags").select("*").order("name")]);y.data&&e(y.data),j.data&&n(j.data),_.data&&a(_.data)}catch(y){console.error("Error fetching data:",y)}finally{l(!1)}},v=t.filter(y=>{var S,w;const j=y.email.toLowerCase().includes(c.toLowerCase())||((S=y.first_name)==null?void 0:S.toLowerCase().includes(c.toLowerCase()))||((w=y.last_name)==null?void 0:w.toLowerCase().includes(c.toLowerCase())),_=p===""||y.client_id===p;return j&&_}),x=y=>r.find(j=>j.id===y),b=y=>y.first_name&&y.last_name?`${y.first_name} ${y.last_name}`:y.first_name||y.last_name||"Unnamed User";return o?f.jsx(hr,{children:f.jsx("div",{className:"flex justify-center items-center py-12",children:f.jsx(Nt,{size:"lg"})})}):f.jsx(hr,{children:f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Users"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Manage users across all client organizations"})]}),f.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[f.jsx(Qr,{className:"-ml-1 mr-2 h-4 w-4"}),"Add User"]})]}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx(gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),f.jsx("input",{type:"text",placeholder:"Search users by name or email...",value:c,onChange:y=>d(y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("select",{value:p,onChange:y=>h(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"All Clients"}),r.map(y=>f.jsx("option",{value:y.id,children:y.name},y.id))]})]})}),f.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 overflow-hidden",children:[f.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"All Users"}),f.jsxs("span",{className:"text-sm text-gray-500",children:[v.length," users"]})]})}),f.jsx("div",{className:"divide-y divide-gray-200",children:v.map(y=>{const j=x(y.client_id);return f.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-white text-sm font-medium",children:b(y).charAt(0).toUpperCase()})}),f.jsxs("div",{children:[f.jsx("div",{className:"flex items-center space-x-2",children:f.jsx("h3",{className:"text-base font-medium text-gray-900",children:b(y)})}),f.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[f.jsx("p",{className:"text-sm text-gray-600",children:y.email}),j&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Bo,{className:"h-3 w-3",style:{color:j.brand_color}}),f.jsx("span",{className:"text-xs text-gray-500",children:j.name})]})]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("div",{className:"text-right text-sm",children:[f.jsx("p",{className:"text-gray-900",children:"Created"}),f.jsx("p",{className:"text-gray-500",children:new Date(y.created_at).toLocaleDateString()})]}),y.last_active&&f.jsxs("div",{className:"text-right text-sm",children:[f.jsx("p",{className:"text-gray-900",children:"Last Active"}),f.jsx("p",{className:"text-gray-500",children:new Date(y.last_active).toLocaleDateString()})]}),f.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:f.jsx(wT,{className:"h-4 w-4"})})]})]})},y.id)})}),v.length===0&&f.jsxs("div",{className:"px-6 py-8 text-center",children:[f.jsx(Lr,{className:"mx-auto h-12 w-12 text-gray-300"}),f.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:c||p?"No users found":"No users yet"}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:c||p?"Try adjusting your search or filter criteria.":"Users will appear here once they are created for clients."})]})]})]})})}const dZ=["#EF4444","#F97316","#F59E0B","#84CC16","#10B981","#14B8A6","#06B6D4","#3B82F6","#6366F1","#8B5CF6","#A855F7","#EC4899","#F43F5E","#6B7280"];function hZ({isOpen:t,onClose:e,onSuccess:r,tag:n,clients:i}){const[a,o]=z.useState({name:"",color:"#6B7280",client_id:""}),[l,c]=z.useState(!1),[d,p]=z.useState("");z.useEffect(()=>{o(n?{name:n.name,color:n.color,client_id:n.client_id}:{name:"",color:"#6B7280",client_id:i.length>0?i[0].id:""}),p("")},[n,i,t]);const h=async x=>{if(x.preventDefault(),p(""),c(!0),!a.client_id){p("Please select a client"),c(!1);return}try{const b={name:a.name.trim(),color:a.color,client_id:a.client_id};if(n){const{error:y}=await we.from("user_tags").update(b).eq("id",n.id);if(y)throw y}else{const{error:y}=await we.from("user_tags").insert([b]);if(y)throw y}r()}catch(b){console.error("Error saving tag:",b),p(b.message||"An error occurred while saving the tag")}finally{c(!1)}},m=x=>{const{name:b,value:y}=x.target;o(j=>({...j,[b]:y}))},v=i.find(x=>x.id===a.client_id);return t?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center",style:{backgroundColor:a.color},children:f.jsx(En,{className:"h-5 w-5 text-white"})}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Tag":"Create Tag"})]}),f.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:l,children:f.jsx(Iu,{className:"h-6 w-6"})})]}),f.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[d&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:f.jsx("p",{className:"text-sm text-red-800",children:d})}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Organization"}),f.jsxs("select",{id:"client_id",name:"client_id",required:!0,value:a.client_id,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:l||!!n,children:[f.jsx("option",{value:"",children:"Select a client..."}),i.map(x=>f.jsx("option",{value:x.id,children:x.name},x.id))]}),v&&f.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-sm text-gray-600",children:[f.jsx(Bo,{className:"h-4 w-4",style:{color:v.brand_color}}),f.jsx("span",{children:v.project_name})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tag Name"}),f.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:a.name,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Beginner, Advanced, VIP",disabled:l})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tag Color"}),f.jsx("div",{className:"grid grid-cols-7 gap-3",children:dZ.map(x=>f.jsx("button",{type:"button",onClick:()=>o(b=>({...b,color:x})),className:`h-10 w-10 rounded-lg border-2 transition-all ${a.color===x?"border-gray-400 scale-110 shadow-md":"border-gray-200 hover:border-gray-300"}`,style:{backgroundColor:x},disabled:l},x))}),f.jsx("div",{className:"mt-3",children:f.jsx("input",{type:"text",value:a.color,onChange:x=>o(b=>({...b,color:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"#6B7280",pattern:"^#[0-9A-Fa-f]{6}$",disabled:l})})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[f.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",disabled:l,children:"Cancel"}),f.jsx("button",{type:"submit",disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?f.jsxs(f.Fragment,{children:[f.jsx(Nt,{size:"sm",className:"mr-2"}),n?"Updating...":"Creating..."]}):n?"Update Tag":"Create Tag"})]})]})]})}):null}function pZ(){const[t,e]=z.useState([]),[r,n]=z.useState([]),[i,a]=z.useState(!0),[o,l]=z.useState(!1),[c,d]=z.useState(null),[p,h]=z.useState("");z.useEffect(()=>{m()},[]);const m=async()=>{try{a(!0);const[w,O]=await Promise.all([we.from("user_tags").select("*").order("created_at",{ascending:!1}),we.from("clients").select("*").order("name")]);w.data&&e(w.data),O.data&&n(O.data)}catch(w){console.error("Error fetching data:",w)}finally{a(!1)}},v=()=>{d(null),l(!0)},x=w=>{d(w),l(!0)},b=async w=>{if(confirm(`Are you sure you want to delete the tag "${w.name}"? This action cannot be undone.`))try{const{error:O}=await we.from("user_tags").delete().eq("id",w.id);if(O)throw O;e(t.filter(k=>k.id!==w.id))}catch(O){console.error("Error deleting tag:",O),alert("Failed to delete tag. Please try again.")}},y=()=>{l(!1),m()},j=p?t.filter(w=>w.client_id===p):t,_=w=>{var O;return((O=r.find(k=>k.id===w))==null?void 0:O.name)||"Unknown Client"},S=j.reduce((w,O)=>{const k=_(O.client_id);return w[k]||(w[k]=[]),w[k].push(O),w},{});return i?f.jsx(hr,{children:f.jsx("div",{className:"flex justify-center items-center py-12",children:f.jsx(Nt,{size:"lg"})})}):f.jsxs(hr,{children:[f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Tags"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Manage user categorization tags for each client"})]}),f.jsxs("button",{onClick:v,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[f.jsx(Qr,{className:"-ml-1 mr-2 h-4 w-4"}),"Create Tag"]})]}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("label",{htmlFor:"client-filter",className:"text-sm font-medium text-gray-700",children:"Filter by Client:"}),f.jsxs("select",{id:"client-filter",value:p,onChange:w=>h(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"All Clients"}),r.map(w=>f.jsx("option",{value:w.id,children:w.name},w.id))]})]})}),Object.keys(S).length>0?f.jsx("div",{className:"space-y-8",children:Object.entries(S).map(([w,O])=>{const k=r.find(E=>E.name===w);return f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[f.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[k&&f.jsx("div",{className:"h-6 w-6 rounded flex items-center justify-center",style:{backgroundColor:k.brand_color+"20"},children:f.jsx(Bo,{className:"h-4 w-4",style:{color:k.brand_color}})}),f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:w}),f.jsxs("span",{className:"text-sm text-gray-500",children:["(",O.length," tags)"]})]})}),f.jsx("div",{className:"p-6",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O.map(E=>f.jsx("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors group",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"h-8 w-8 rounded-full flex items-center justify-center",style:{backgroundColor:E.color},children:f.jsx(En,{className:"h-4 w-4 text-white"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-gray-900",children:E.name}),f.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",new Date(E.created_at).toLocaleDateString()]})]})]}),f.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:()=>x(E),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:f.jsx(ST,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>b(E),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:f.jsx(ys,{className:"h-4 w-4"})})]})]})},E.id))})})]},w)})}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(En,{className:"mx-auto h-12 w-12 text-gray-300"}),f.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:p?"No tags found for this client":"No tags yet"}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:p?"This client has no user tags created yet.":"Get started by creating your first user tag."}),f.jsx("div",{className:"mt-6",children:f.jsxs("button",{onClick:v,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[f.jsx(Qr,{className:"-ml-1 mr-2 h-5 w-5"}),"Create Tag"]})})]})]}),f.jsx(hZ,{isOpen:o,onClose:()=>l(!1),onSuccess:y,tag:c,clients:r})]})}const mZ=({isOpen:t,onClose:e,clientId:r,onUploadComplete:n})=>{var k;const i=z.useRef(null),[a,o]=z.useState(!1),[l,c]=z.useState(null),[d,p]=z.useState(!1),[h,m]=z.useState(null),[v,x]=z.useState([]),b=z.useCallback(()=>{const E=`firstName,lastName,email,tags
`),C=new Blob([E],{type:"text/csv"}),I=window.URL.createObjectURL(C),P=document.createElement("a");P.href=I,P.download="created_users_with_passwords.csv",document.body.appendChild(P),P.click(),document.body.removeChild(P),window.URL.revokeObjectURL(I)},[l]),O=()=>{m(null),x([]),c(null),e()};return t?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Bulk User Upload"}),f.jsx("button",{onClick:O,disabled:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:f.jsx(Iu,{size:24})})]}),f.jsx("div",{className:"p-6",children:l?f.jsxs("div",{children:[f.jsxs("div",{className:"mb-6",children:[f.jsx("div",{className:"flex items-center space-x-4 mb-4",children:l.failed_rows===0?f.jsxs("div",{className:"flex items-center text-green-600",children:[f.jsx(Yn,{size:24,className:"mr-2"}),f.jsx("span",{className:"text-lg font-semibold",children:"Upload Completed Successfully!"})]}):f.jsxs("div",{className:"flex items-center text-amber-600",children:[f.jsx(Ml,{size:24,className:"mr-2"}),f.jsx("span",{className:"text-lg font-semibold",children:"Upload Completed with Some Errors"})]})}),f.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.total_rows}),f.jsx("div",{className:"text-sm text-blue-800",children:"Total Rows"})]}),f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.successful_rows}),f.jsx("div",{className:"text-sm text-green-800",children:"Successful"})]}),f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-red-600",children:l.failed_rows}),f.jsx("div",{className:"text-sm text-red-800",children:"Failed"})]})]})]}),l.successful_rows>0&&f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Created Users"}),f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[f.jsxs("p",{className:"text-green-800 mb-3",children:["Successfully created ",l.successful_rows," users with temporary passwords."]}),f.jsxs("button",{onClick:w,className:"inline-flex items-center px-3 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700",children:[f.jsx(bS,{size:16,className:"mr-2"}),"Download User Credentials"]})]})]}),l.errors&&l.errors.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:["Errors (",l.errors.length,")"]}),f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 max-h-64 overflow-y-auto",children:l.errors.map((E,C)=>f.jsxs("div",{className:"mb-2 text-sm",children:[f.jsxs("span",{className:"font-medium text-red-800",children:["Row ",E.row,":"]}),f.jsxs("span",{className:"text-red-700 ml-1",children:[E.email," - ",E.error]})]},C))})]}),f.jsx("div",{className:"flex justify-end pt-4 border-t",children:f.jsx("button",{onClick:O,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Close"})})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[f.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"CSV Format Requirements:"}),f.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[f.jsxs("li",{children:["• Required headers: ",f.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"firstName"}),", ",f.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"lastName"}),", ",f.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"email"})]}),f.jsxs("li",{children:["• Optional header: ",f.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"tags"})," (separate multiple tags with semicolons)"]}),f.jsx("li",{children:"• Maximum 1000 users per upload"}),f.jsx("li",{children:"• Secure passwords will be auto-generated for each user"})]}),f.jsxs("button",{onClick:b,className:"mt-3 inline-flex items-center text-sm text-blue-600 hover:text-blue-800",children:[f.jsx(bS,{size:16,className:"mr-1"}),"Download Template CSV"]})]}),f.jsxs("div",{onDrop:j,onDragOver:E=>{E.preventDefault(),p(!0)},onDragLeave:()=>p(!1),onClick:()=>{var E;return(E=i.current)==null?void 0:E.click()},className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${d?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-blue-400"}`,children:[f.jsx(Df,{size:48,className:"mx-auto mb-4 text-gray-400"}),f.jsx("p",{className:"text-lg text-gray-600 mb-2",children:h?h.name:"Drop your CSV file here, or click to browse"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Supports .csv files up to 10MB"}),f.jsx("input",{ref:i,type:"file",accept:".csv,text/csv",onChange:_,className:"hidden"})]}),v.length>0&&f.jsxs("div",{className:"mt-6",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"File Preview (first 5 rows):"}),f.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsx("tr",{children:(k=v[0])==null?void 0:k.map((E,C)=>f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:E},C))})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.slice(1).map((E,C)=>f.jsx("tr",{children:E.map((I,P)=>f.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:I},P))},C))})]})})})]}),f.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6 pt-6 border-t",children:[f.jsx("button",{onClick:O,disabled:a,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),f.jsxs("button",{onClick:S,disabled:!h||a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[a&&f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),f.jsx("span",{children:a?"Processing...":"Upload Users"})]})]})]})})]})}):null},T0=[{key:"agents_marketplace",label:"AI Agents Marketplace",description:"Access to AI agents and custom prompts"},{key:"courses",label:"Courses",description:"Structured learning courses and programs"},{key:"missions",label:"Missions",description:"Gamified learning missions and challenges"},{key:"forums",label:"Forums",description:"Community discussion forums"},{key:"documents",label:"Documents",description:"Rich text documents and guides"},{key:"prompts",label:"Prompts",description:"Reusable prompt templates"},{key:"automations",label:"Automations",description:"Process automations and workflows"}],vZ=()=>{const{clientId:t}=ni(),e=zi(),[r,n]=z.useState(null),[i,a]=z.useState(!0),[o,l]=z.useState("settings"),[c,d]=z.useState(!1),[p,h]=z.useState({name:"",project_name:"",brand_color:"",forum_enabled:!0}),[m,v]=z.useState(!1),[x,b]=z.useState([]),[y,j]=z.useState([]),[_,S]=z.useState(""),[w,O]=z.useState("#3B82F6"),[k,E]=z.useState(null),[C,I]=z.useState(null),[P,A]=z.useState(""),[T,L]=z.useState([]),[$,B]=z.useState(""),[U,V]=z.useState("all"),[X,G]=z.useState(!1),[F,R]=z.useState(!1),q=z.useCallback(async()=>{if(t)try{const{data:ae,error:ye}=await we.from("clients").select("*").eq("id",t).single();if(ye)throw ye;if(!ae)throw new Error("Client not found");n(ae),h({name:ae.name,project_name:ae.project_name||"",brand_color:ae.brand_color||"#3B82F6",forum_enabled:ae.forum_enabled}),await H(ae.id)}catch(ae){console.error("Error loading client:",ae),e("/clients")}finally{a(!1)}},[t,e]),H=async ae=>{try{const{data:ye}=await we.from("client_features").select("*").eq("client_id",ae),Te=new Map((ye==null?void 0:ye.map(ue=>[ue.feature_name,ue]))||[]),Ie=T0.map(ue=>{var de,xe;return{id:((de=Te.get(ue.key))==null?void 0:de.id)||"",feature_name:ue.key,enabled:((xe=Te.get(ue.key))==null?void 0:xe.enabled)??!0}});b(Ie)}catch(ye){console.error("Error initializing features:",ye)}},ee=z.useCallback(async()=>{if(t)try{const{data:ae,error:ye}=await we.functions.invoke("manage-user-tags",{body:{client_id:t,action:"list"}});if(ye)throw ye;j(ae||[])}catch(ae){console.error("Error loading tags:",ae)}},[t]),J=z.useCallback(async()=>{if(t)try{const{data:ae,error:ye}=await we.from("users").select(`
        `).eq("client_id",t).order("created_at",{ascending:!1});if(ye)throw ye;const Te=(ae==null?void 0:ae.map(Ie=>{var ue;return{...Ie,tags:((ue=Ie.user_tag_assignments)==null?void 0:ue.map(de=>de.user_tags))||[]}}))||[];L(Te)}catch(ae){console.error("Error loading users:",ae)}},[t]);z.useEffect(()=>{q()},[q]),z.useEffect(()=>{o==="tags"?ee():o==="users"&&J()},[o,ee,J]);const K=(ae,ye)=>{h(Te=>({...Te,[ae]:ye})),v(!0)},Y=async()=>{if(r){d(!0);try{const{error:ae}=await we.from("clients").update({name:p.name,project_name:p.project_name||null,brand_color:p.brand_color,forum_enabled:p.forum_enabled}).eq("id",r.id);if(ae)throw ae;n(ye=>ye?{...ye,...p}:null),v(!1),alert("Settings saved successfully!")}catch(ae){console.error("Error saving settings:",ae),alert("Error saving settings")}finally{d(!1)}}},re=async ae=>{var Ie;const ye=x[ae],Te=!ye.enabled;try{if(ye.id){const{error:de}=await we.from("client_features").update({enabled:Te}).eq("id",ye.id);if(de)throw de}else{const{data:de,error:xe}=await we.from("client_features").insert({client_id:t,feature_name:ye.feature_name,enabled:Te}).select().single();if(xe)throw xe;b(je=>je.map((me,qe)=>qe===ae?{...me,id:de.id,enabled:Te}:me));return}b(de=>de.map((xe,je)=>je===ae?{...xe,enabled:Te}:xe));const ue=((Ie=T0.find(de=>de.key===ye.feature_name))==null?void 0:Ie.label)||ye.feature_name;alert(`${ue} ${Te?"enabled":"disabled"}`)}catch(ue){console.error("Error toggling feature:",ue),alert("Error updating feature")}},Q=async()=>{if(!(!_.trim()||!t))try{const{data:ae,error:ye}=await we.functions.invoke("manage-user-tags",{body:{client_id:t,action:"create",tag_data:{name:_.trim(),color:w}}});if(ye)throw ye;j(Te=>[...Te,{...ae,user_count:0}]),S(""),O("#3B82F6")}catch(ae){console.error("Error creating tag:",ae),alert("Error creating tag")}},oe=async()=>{if(!(!C||P!==C.name))try{const{error:ae}=await we.functions.invoke("manage-user-tags",{body:{client_id:t,action:"delete",tag_data:{id:C.id}}});if(ae)throw ae;j(ye=>ye.filter(Te=>Te.id!==C.id)),I(null),A(""),J()}catch(ae){console.error("Error deleting tag:",ae),alert("Error deleting tag")}},pe=T.filter(ae=>{var Ie,ue;const ye=((Ie=ae.first_name)==null?void 0:Ie.toLowerCase().includes($.toLowerCase()))||((ue=ae.last_name)==null?void 0:ue.toLowerCase().includes($.toLowerCase()))||ae.email.toLowerCase().includes($.toLowerCase()),Te=U==="all"||ae.tags.some(de=>de.id===U);return ye&&Te}),ce=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Oe=()=>{switch(o){case"settings":return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),f.jsx("input",{type:"text",value:p.name,onChange:ae=>K("name",ae.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter client name"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name"}),f.jsx("input",{type:"text",value:p.project_name,onChange:ae=>K("project_name",ae.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional project name"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand Color"}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-md border border-gray-300 cursor-pointer",style:{backgroundColor:p.brand_color},onClick:()=>{const ae=document.createElement("input");ae.type="color",ae.value=p.brand_color,ae.onchange=ye=>{K("brand_color",ye.target.value)},ae.click()}}),f.jsx("input",{type:"text",value:p.brand_color,onChange:ae=>K("brand_color",ae.target.value),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono",placeholder:"#3B82F6"})]})]}),f.jsx("div",{children:f.jsxs("label",{className:"flex items-center space-x-3",children:[f.jsx("input",{type:"checkbox",checked:p.forum_enabled,onChange:ae=>K("forum_enabled",ae.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Forum"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Allow users to participate in community discussions"})]})]})}),f.jsx("div",{className:"flex justify-end pt-4 border-t",children:f.jsxs("button",{onClick:Y,disabled:!m||c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[c&&f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),f.jsx(Dx,{size:16}),f.jsx("span",{children:"Save Changes"})]})})]});case"features":return f.jsxs("div",{className:"space-y-4",children:[f.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"Control which platform features are available to this client's users."}),T0.map((ae,ye)=>{const Te=x.find(ue=>ue.feature_name===ae.key),Ie=(Te==null?void 0:Te.enabled)??!0;return f.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-900",children:ae.label}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ae.description})]}),f.jsxs("button",{onClick:()=>re(ye),className:`flex items-center space-x-2 px-3 py-2 rounded-md transition-colors ${Ie?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[Ie?f.jsx(m$,{size:20}):f.jsx(_S,{size:20}),f.jsx("span",{className:"text-sm font-medium",children:Ie?"Enabled":"Disabled"})]})]},ae.key)})]});case"tags":return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Create New Tag"}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("input",{type:"text",value:_,onChange:ae=>S(ae.target.value),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tag name"}),f.jsx("div",{className:"w-10 h-10 rounded-md border border-gray-300 cursor-pointer",style:{backgroundColor:w},onClick:()=>{const ae=document.createElement("input");ae.type="color",ae.value=w,ae.onchange=ye=>{O(ye.target.value)},ae.click()}}),f.jsxs("button",{onClick:Q,disabled:!_.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[f.jsx(Qr,{size:16}),f.jsx("span",{children:"Create Tag"})]})]})]}),f.jsx("div",{className:"space-y-3",children:y.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(En,{size:48,className:"mx-auto mb-4 text-gray-300"}),f.jsx("p",{children:"No tags created yet"}),f.jsx("p",{className:"text-sm",children:"Create your first tag above"})]}):y.map(ae=>f.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-white text-sm font-medium",style:{backgroundColor:ae.color},children:ae.name}),f.jsxs("span",{className:"text-sm text-gray-500",children:["(",ae.user_count," users)"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>E(ae),className:"text-gray-400 hover:text-blue-600 transition-colors",children:f.jsx(ST,{size:16})}),f.jsx("button",{onClick:()=>I(ae),className:"text-gray-400 hover:text-red-600 transition-colors",children:f.jsx(ys,{size:16})})]})]},ae.id))}),C&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx(Ml,{className:"text-red-500 mr-3",size:24}),f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Tag"})]}),f.jsxs("p",{className:"text-gray-600 mb-4",children:['This will permanently delete the tag "',C.name,'" and remove it from all ',C.user_count," assigned users."]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type the tag name to confirm:"}),f.jsx("input",{type:"text",value:P,onChange:ae=>A(ae.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:C.name})]}),f.jsxs("div",{className:"flex justify-end space-x-3",children:[f.jsx("button",{onClick:()=>{I(null),A("")},className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),f.jsx("button",{onClick:oe,disabled:P!==C.name,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete Tag"})]})]})})]});case"users":return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx(gs,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),f.jsx("input",{type:"text",value:$,onChange:ae=>B(ae.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search users..."})]}),f.jsxs("select",{value:U,onChange:ae=>V(ae.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"all",children:"All Tags"}),y.map(ae=>f.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]}),f.jsxs("button",{onClick:()=>G(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[f.jsx(Df,{size:20}),f.jsx("span",{children:"Upload CSV"})]})]}),f.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:pe.length===0?f.jsxs("div",{className:"text-center py-12",children:[f.jsx(Lr,{size:48,className:"mx-auto mb-4 text-gray-300"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),f.jsx("p",{className:"text-gray-600 mb-4",children:$||U!=="all"?"Try adjusting your search criteria.":"Start by uploading users via CSV or create them manually."}),!$&&U==="all"&&f.jsx("button",{onClick:()=>G(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Upload First Users"})]}):f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),f.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:pe.map(ae=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{children:[f.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[ae.first_name," ",ae.last_name]}),f.jsx("div",{className:"text-sm text-gray-500",children:ae.email})]})}),f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[ae.tags.map(ye=>f.jsx("span",{className:"inline-block px-2 py-1 text-xs text-white rounded-full",style:{backgroundColor:ye.color},children:ye.name},ye.id)),ae.tags.length===0&&f.jsx("span",{className:"text-sm text-gray-400",children:"No tags"})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae.last_active?ce(ae.last_active):"Never"}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ce(ae.created_at)}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:f.jsx("button",{onClick:()=>e(`/users/${ae.id}`),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"View Details",children:f.jsx(Bi,{size:16})})})]},ae.id))})]})})})]});default:return null}};return i?f.jsx("div",{className:"flex justify-center items-center min-h-screen",children:f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r?f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("div",{className:"bg-white border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsx("div",{className:"flex items-center justify-between py-6",children:f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("button",{onClick:()=>e("/clients"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:f.jsx(Hl,{size:24})}),f.jsxs("div",{className:"flex items-center space-x-4",children:[r.logo_url?f.jsx("img",{src:r.logo_url,alt:r.name,className:"w-12 h-12 rounded-full object-cover border border-gray-200"}):f.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold",style:{backgroundColor:r.brand_color},children:r.name.charAt(0).toUpperCase()}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.name}),r.project_name&&f.jsx("p",{className:"text-gray-600",children:r.project_name})]})]})]})})})}),f.jsx("div",{className:"bg-white border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsx("nav",{className:"flex space-x-8",children:[{id:"settings",label:"Settings",icon:Lx},{id:"features",label:"Enabled Features",icon:_S},{id:"tags",label:"Tag Management",icon:En},{id:"users",label:"User Management",icon:Lr}].map(ae=>{const ye=ae.icon;return f.jsxs("button",{onClick:()=>l(ae.id),className:`flex items-center space-x-2 px-1 py-4 border-b-2 font-medium text-sm transition-colors ${o===ae.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[f.jsx(ye,{size:18}),f.jsx("span",{children:ae.label})]},ae.id)})})})}),f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:Oe()})}),f.jsx(mZ,{isOpen:X,onClose:()=>G(!1),clientId:t,onUploadComplete:()=>{J(),ee()}})]}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Client not found"}),f.jsx("button",{onClick:()=>e("/clients"),className:"mt-4 text-blue-600 hover:text-blue-800",children:"Back to Clients"})]})},gZ=()=>{const{userId:t}=ni(),e=zi(),[r,n]=z.useState(null),[i,a]=z.useState(!0),[o,l]=z.useState("overview"),[c,d]=z.useState([]),[p,h]=z.useState([]),[m,v]=z.useState([]),[x,b]=z.useState([]),[y,j]=z.useState({totalActivities:0,contentCompleted:0,avgScore:0,streakDays:0,totalTimeSpent:0}),_=z.useCallback(async()=>{var T;if(t)try{const{data:L,error:$}=await we.from("users").select(`
        `).eq("id",t).single();if($)throw $;if(!L)throw new Error("User not found");const B={...L,client:L.clients,tags:((T=L.user_tag_assignments)==null?void 0:T.map(U=>U.user_tags))||[]};n(B),await S(t,B.client.id)}catch(L){console.error("Error loading user:",L),e("/clients")}finally{a(!1)}},[t,e]),S=async(T,L)=>{try{const $=new Date;$.setDate($.getDate()-30);const{data:B}=await we.from("user_activity_log").select("*").eq("user_id",T).gte("created_at",$.toISOString()).order("created_at",{ascending:!0}),U=new Map;B==null||B.forEach(F=>{var H;const R=new Date(F.created_at).toISOString().split("T")[0],q=U.get(R)||{score:0,activities:0};U.set(R,{score:q.score+(((H=F.activity_data)==null?void 0:H.score)||1),activities:q.activities+1})});const V=Array.from(U.entries()).map(([F,R])=>({date:F,score:R.score,activities:R.activities}));d(V);const X=(B==null?void 0:B.length)||0,G=V.length>0?V.reduce((F,R)=>F+R.score,0)/V.length:0;j({totalActivities:X,contentCompleted:Math.floor(X*.7),avgScore:Math.round(G*10)/10,streakDays:E(V),totalTimeSpent:Math.floor(X*15)})}catch($){console.error("Error loading overview data:",$)}},w=async()=>{if(t)try{const{data:T}=await we.from("user_activity_log").select(`
        `).eq("user_id",t).eq("activity_type","content_completed").order("created_at",{ascending:!1}).limit(50),L=(T==null?void 0:T.map($=>{var B;return{id:$.id,content_item:$.content_items||{title:"Content Item",content_type:"document",thumbnail_url:null},practiced_at:$.created_at,completion_score:((B=$.activity_data)==null?void 0:B.score)||Math.floor(Math.random()*40)+60}}))||[];h(L)}catch(T){console.error("Error loading content mastery:",T)}},O=async()=>{if(t)try{const T=[{id:"1",course_title:"AI Fundamentals",progress_percentage:75,lessons_completed:6,total_lessons:8,last_accessed:new Date(Date.now()-1728e5).toISOString()},{id:"2",course_title:"Advanced Prompt Engineering",progress_percentage:45,lessons_completed:9,total_lessons:20,last_accessed:new Date(Date.now()-432e6).toISOString()},{id:"3",course_title:"Machine Learning Basics",progress_percentage:100,lessons_completed:12,total_lessons:12,last_accessed:new Date(Date.now()-864e5).toISOString()}];v(T)}catch(T){console.error("Error loading course progress:",T)}},k=async()=>{if(t)try{const{data:T}=await we.from("agent_conversations").select(`
        `).eq("user_id",t).order("started_at",{ascending:!1}).limit(20),L=(T==null?void 0:T.map($=>{var B,U;return{id:$.id,agent_name:((B=$.content_items)==null?void 0:B.title)||"AI Assistant",message_count:$.message_count||0,started_at:$.started_at,last_message_at:$.last_message_at||$.started_at,summary:"Conversation about "+(((U=$.content_items)==null?void 0:U.title)||"various topics")}}))||[];b(L)}catch(T){console.error("Error loading conversations:",T)}},E=T=>{if(T.length===0)return 0;let L=0;const $=[...T].sort((B,U)=>new Date(U.date).getTime()-new Date(B.date).getTime());for(const B of $)if(B.activities>0)L++;else break;return L};z.useEffect(()=>{_()},[_]),z.useEffect(()=>{o==="content"?w():o==="courses"?O():o==="conversations"&&k()},[o,t]);const C=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),I=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=T=>{switch(T){case"ai_agent":return f.jsx(wr,{size:16,className:"text-blue-500"});case"video":return f.jsx(n$,{size:16,className:"text-red-500"});case"document":return f.jsx(nr,{size:16,className:"text-green-500"});default:return f.jsx(ko,{size:16,className:"text-gray-500"})}},A=()=>{switch(o){case"overview":return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y.totalActivities}),f.jsx("div",{className:"text-sm text-blue-800",children:"Total Activities"})]}),f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.contentCompleted}),f.jsx("div",{className:"text-sm text-green-800",children:"Content Completed"})]}),f.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-purple-600",children:y.avgScore}),f.jsx("div",{className:"text-sm text-purple-800",children:"Avg Score"})]}),f.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-orange-600",children:y.streakDays}),f.jsx("div",{className:"text-sm text-orange-800",children:"Day Streak"})]}),f.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[f.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[y.totalTimeSpent,"m"]}),f.jsx("div",{className:"text-sm text-gray-800",children:"Time Spent"})]})]}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Score (Last 30 Days)"}),f.jsx("div",{className:"h-64",children:f.jsx(yb,{width:"100%",height:"100%",children:f.jsxs(XQ,{data:c,children:[f.jsx(Fw,{strokeDasharray:"3 3"}),f.jsx(ks,{dataKey:"date",tick:{fontSize:12},tickFormatter:T=>new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),f.jsx(Es,{tick:{fontSize:12}}),f.jsx(Kr,{labelFormatter:T=>C(T),formatter:(T,L)=>[T,L==="score"?"Activity Score":"Activities Count"]}),f.jsx(Hu,{type:"monotone",dataKey:"score",stroke:"#3B82F6",strokeWidth:2,dot:{fill:"#3B82F6",strokeWidth:2,r:4}})]})})})]}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),p.slice(0,5).length>0?f.jsx("div",{className:"space-y-3",children:p.slice(0,5).map(T=>f.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg",children:[P(T.content_item.content_type),f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.content_item.title}),f.jsxs("div",{className:"text-xs text-gray-500",children:["Completed ",I(T.practiced_at)]})]}),f.jsxs("div",{className:"text-sm font-semibold text-green-600",children:[T.completion_score,"%"]})]},T.id))}):f.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent activity"})]})]});case"content":return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Content Mastery Log"}),f.jsxs("div",{className:"text-sm text-gray-500",children:[p.length," items practiced"]})]}),p.length>0?f.jsx("div",{className:"space-y-3",children:p.map(T=>f.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[P(T.content_item.content_type),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium text-gray-900",children:T.content_item.title}),f.jsxs("div",{className:"text-sm text-gray-500",children:["Practiced on ",I(T.practiced_at)]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("div",{className:"text-right",children:[f.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[T.completion_score,"%"]}),f.jsx("div",{className:"text-xs text-gray-500",children:"Completion"})]}),T.completion_score>=90&&f.jsx(Yn,{size:20,className:"text-green-500"})]})]},T.id))}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(ko,{size:48,className:"mx-auto mb-4 text-gray-300"}),f.jsx("p",{className:"text-gray-500",children:"No content practiced yet"})]})]});case"courses":return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Progress"}),f.jsxs("div",{className:"text-sm text-gray-500",children:[m.length," courses enrolled"]})]}),m.length>0?f.jsx("div",{className:"space-y-4",children:m.map(T=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h4",{className:"text-lg font-medium text-gray-900",children:T.course_title}),f.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${T.progress_percentage===100?"bg-green-100 text-green-800":T.progress_percentage>=50?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:[T.progress_percentage,"% Complete"]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[f.jsxs("span",{children:[T.lessons_completed," of ",T.total_lessons," lessons"]}),f.jsxs("span",{children:["Last accessed ",C(T.last_accessed)]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${T.progress_percentage}%`}})})]}),T.progress_percentage===100&&f.jsxs("div",{className:"flex items-center text-green-600",children:[f.jsx(Yn,{size:16,className:"mr-2"}),f.jsx("span",{className:"text-sm font-medium",children:"Course Completed!"})]})]},T.id))}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(ko,{size:48,className:"mx-auto mb-4 text-gray-300"}),f.jsx("p",{className:"text-gray-500",children:"No courses enrolled yet"})]})]});case"conversations":return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Conversation History"}),f.jsxs("div",{className:"text-sm text-gray-500",children:[x.length," conversations"]})]}),x.length>0?f.jsx("div",{className:"space-y-3",children:x.map(T=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(wr,{size:20,className:"text-blue-500"}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium text-gray-900",children:T.agent_name}),f.jsxs("div",{className:"text-sm text-gray-500",children:[T.message_count," messages"]})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-sm text-gray-900",children:I(T.started_at)}),f.jsxs("div",{className:"text-xs text-gray-500",children:["Last: ",I(T.last_message_at)]})]})]}),f.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md",children:T.summary})]},T.id))}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(wr,{size:48,className:"mx-auto mb-4 text-gray-300"}),f.jsx("p",{className:"text-gray-500",children:"No conversations yet"})]})]});default:return null}};return i?f.jsx("div",{className:"flex justify-center items-center min-h-screen",children:f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r?f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("div",{className:"bg-white border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsx("div",{className:"flex items-center justify-between py-6",children:f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("button",{onClick:()=>e(-1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:f.jsx(Hl,{size:24})}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white text-xl font-semibold",style:{backgroundColor:r.client.brand_color},children:[r.first_name.charAt(0).toUpperCase(),r.last_name.charAt(0).toUpperCase()]}),f.jsxs("div",{children:[f.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r.first_name," ",r.last_name]}),f.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(u$,{size:16}),f.jsx("span",{children:r.email})]}),f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Vl,{size:16}),f.jsxs("span",{children:["Joined ",C(r.created_at)]})]}),r.last_active&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Ef,{size:16}),f.jsxs("span",{children:["Active ",C(r.last_active)]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[r.client.logo_url?f.jsx("img",{src:r.client.logo_url,alt:r.client.name,className:"w-6 h-6 rounded-full"}):f.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:r.client.brand_color}}),f.jsx("span",{className:"text-sm text-gray-700",children:r.client.name})]}),r.tags.length>0&&f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(En,{size:16,className:"text-gray-400"}),f.jsx("div",{className:"flex flex-wrap gap-1",children:r.tags.map(T=>f.jsx("span",{className:"inline-block px-2 py-1 text-xs text-white rounded-full",style:{backgroundColor:T.color},children:T.name},T.id))})]})]})]})]})]})})})}),f.jsx("div",{className:"bg-white border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",label:"Overview",icon:OT},{id:"content",label:"Content Mastery",icon:ko},{id:"courses",label:"Course Progress",icon:Yn},{id:"conversations",label:"Conversation History",icon:wr}].map(T=>{const L=T.icon;return f.jsxs("button",{onClick:()=>l(T.id),className:`flex items-center space-x-2 px-1 py-4 border-b-2 font-medium text-sm transition-colors ${o===T.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[f.jsx(L,{size:18}),f.jsx("span",{children:T.label})]},T.id)})})})}),f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:A()})})]}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User not found"}),f.jsx("button",{onClick:()=>e("/clients"),className:"mt-4 text-blue-600 hover:text-blue-800",children:"Back to Clients"})]})},C0=[{type:"articles",label:"Articles",icon:nr,color:"#10B981",description:"Blog posts, tutorials, and written content",count:0},{type:"ai-agents",label:"AI Agents",icon:Sn,color:"#3B82F6",description:"Intelligent AI agents with custom prompts",count:0},{type:"videos",label:"Videos",icon:Gl,color:"#EF4444",description:"Educational videos with transcriptions",count:0},{type:"documents",label:"Documents",icon:nr,color:"#10B981",description:"Rich text documents and guides",count:0},{type:"prompts",label:"Prompts",icon:wr,color:"#8B5CF6",description:"Reusable prompt templates",count:0},{type:"automations",label:"Automations",icon:Fo,color:"#F59E0B",description:"Process automations and workflows",count:0}];function yZ(){const[t,e]=z.useState(C0),[r,n]=z.useState(!0);z.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0);const{count:a}=await we.from("content_articles").select("*",{count:"exact",head:!0}),o=C0.map(l=>{switch(l.type){case"articles":return{...l,count:a||0};default:return l}});e(o)}catch(a){console.error("Error fetching content counts:",a),e(C0)}finally{n(!1)}};return r?f.jsx(hr,{children:f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):f.jsx(hr,{children:f.jsxs("div",{className:"space-y-8",children:[f.jsx("div",{className:"flex justify-between items-center",children:f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Content Management"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Create and manage content for your AI platform"})]})}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(a=>{const o=a.icon;return f.jsxs(Yr,{to:`/content/${a.type}`,className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow group",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",style:{backgroundColor:a.color+"20"},children:f.jsx(o,{className:"h-6 w-6",style:{color:a.color}})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:a.label}),f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]})]}),f.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[f.jsxs("span",{className:"text-sm text-gray-500",children:[a.count," items"]}),f.jsx("div",{className:"flex items-center space-x-2",children:f.jsxs(Yr,{to:`/content/${a.type}/create`,className:"inline-flex items-center px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:l=>l.stopPropagation(),children:[f.jsx(Qr,{className:"h-4 w-4 mr-1"}),"Create"]})})]})]},a.type)})}),f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("button",{className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(gs,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"Search Content"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Find existing content"})]})]}),f.jsxs("button",{className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(Fd,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"Filter by Tags"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Organize content"})]})]}),f.jsxs(Yr,{to:"/content/ai-agents/create",className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(Sn,{className:"h-5 w-5 text-blue-500"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"Quick Agent"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Create new AI agent"})]})]}),f.jsxs(Yr,{to:"/content/articles/create",className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(nr,{className:"h-5 w-5 text-green-500"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"New Article"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Write blog posts and tutorials"})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Recent Activity"}),f.jsxs("div",{className:"text-center py-8",children:[f.jsx(nr,{className:"mx-auto h-12 w-12 text-gray-300"}),f.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No recent activity"}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Content creation and editing activity will appear here"})]})]})]})})}function bZ(){const[t,e]=z.useState([]),[r,n]=z.useState([]),[i,a]=z.useState(!0),[o,l]=z.useState(""),[c,d]=z.useState("all"),[p,h]=z.useState("all"),[m,v]=z.useState(!1);z.useEffect(()=>{x(),b()},[]);const x=async()=>{try{a(!0);const{data:w,error:O}=await we.from("content_articles").select(`
        `).order("created_at",{ascending:!1});if(O)throw O;e(w||[])}catch(w){console.error("Error fetching articles:",w)}finally{a(!1)}},b=async()=>{try{const{data:w,error:O}=await we.from("content_categories").select("*").order("name");if(O)throw O;n(w||[])}catch(w){console.error("Error fetching categories:",w)}},y=async w=>{if(confirm("Are you sure you want to delete this article?"))try{const{error:O}=await we.from("content_articles").delete().eq("id",w);if(O)throw O;await x()}catch(O){console.error("Error deleting article:",O)}},j=t.filter(w=>{var C;const O=w.title.toLowerCase().includes(o.toLowerCase())||w.author.toLowerCase().includes(o.toLowerCase()),k=c==="all"||((C=w.category_id)==null?void 0:C.toString())===c,E=p==="all"||w.status===p;return O&&k&&E}),_=w=>{const k={draft:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Draft"},published:{bg:"bg-green-100",text:"text-green-800",label:"Published"},archived:{bg:"bg-gray-100",text:"text-gray-800",label:"Archived"}}[w];return f.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${k.bg} ${k.text}`,children:k.label})},S=w=>w?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(w)):"-";return i?f.jsx(hr,{children:f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):f.jsx(hr,{children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Articles Management"}),f.jsx("p",{className:"text-gray-600",children:"Create and manage your content articles"})]}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsxs("button",{onClick:()=>v(!m),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[f.jsx(Fd,{className:"h-4 w-4 mr-2"}),"Filters"]}),f.jsxs(Yr,{to:"/content/articles/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[f.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Add New Article"]})]})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 space-y-4",children:[f.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:f.jsx("div",{className:"flex-1",children:f.jsxs("div",{className:"relative",children:[f.jsx(gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search articles by title or author...",value:o,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})})}),m&&f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),f.jsxs("select",{value:c,onChange:w=>d(w.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"all",children:"All Categories"}),r.map(w=>f.jsx("option",{value:w.id.toString(),children:w.name},w.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),f.jsxs("select",{value:p,onChange:w=>h(w.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"all",children:"All Statuses"}),f.jsx("option",{value:"draft",children:"Draft"}),f.jsx("option",{value:"published",children:"Published"}),f.jsx("option",{value:"archived",children:"Archived"})]})]})]})]}),f.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),f.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.length===0?f.jsx("tr",{children:f.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center",children:[f.jsx(nr,{className:"mx-auto h-12 w-12 text-gray-300"}),f.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No articles found"}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o||c!=="all"||p!=="all"?"Try adjusting your search or filters.":"Get started by creating your first article."})]})}):j.map(w=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("div",{className:"text-sm font-medium text-gray-900 mb-1",children:w.title}),w.excerpt&&f.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:w.excerpt})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:w.content_categories?f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:w.content_categories.color}}),f.jsx("span",{className:"text-sm text-gray-900",children:w.content_categories.name})]}):f.jsx("span",{className:"text-sm text-gray-500",children:"Uncategorized"})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(NT,{className:"h-4 w-4 text-gray-400 mr-2"}),f.jsx("span",{className:"text-sm text-gray-900",children:w.author})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_(w.status)}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Vl,{className:"h-4 w-4 text-gray-400 mr-2"}),f.jsx("span",{className:"text-sm text-gray-900",children:S(w.created_at)})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:f.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[f.jsx(Yr,{to:`/content/articles/${w.id}/edit`,className:"text-blue-600 hover:text-blue-900 p-1",children:f.jsx(Bi,{className:"h-4 w-4"})}),f.jsx(Yr,{to:`/content/articles/${w.id}/edit`,className:"text-indigo-600 hover:text-indigo-900 p-1",children:f.jsx(Z0,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>y(w.id),className:"text-red-600 hover:text-red-900 p-1",children:f.jsx(ys,{className:"h-4 w-4"})})]})})]},w.id))})]})})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(nr,{className:"h-8 w-8 text-blue-500"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Articles"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.length})]})]})}),f.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Bi,{className:"h-8 w-8 text-green-500"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Published"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(w=>w.status==="published").length})]})]})}),f.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Z0,{className:"h-8 w-8 text-yellow-500"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Drafts"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(w=>w.status==="draft").length})]})]})}),f.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(En,{className:"h-8 w-8 text-purple-500"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Categories"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.length})]})]})})]})]})})}function NP(){const{id:t}=ni(),e=zi(),r=!!t,[n,i]=z.useState({title:"",content:"",excerpt:"",author:"Admin User",category_id:null,status:"draft",tags:[],featured_image_url:"",slug:"",seo_title:"",seo_description:""}),[a,o]=z.useState([]),[l,c]=z.useState(!1),[d,p]=z.useState(!1),[h,m]=z.useState(""),[v,x]=z.useState("content"),[b,y]=z.useState(null);z.useEffect(()=>{j(),r&&_()},[t]);const j=async()=>{try{const{data:I,error:P}=await we.from("content_categories").select("*").order("name");if(P)throw P;o(I||[])}catch(I){console.error("Error fetching categories:",I)}},_=async()=>{if(t)try{c(!0);const{data:I,error:P}=await we.from("content_articles").select("*").eq("id",parseInt(t)).single();if(P)throw P;I&&i({...I,tags:I.tags||[]})}catch(I){console.error("Error fetching article:",I)}finally{c(!1)}},S=I=>I.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),w=I=>{i(P=>({...P,title:I,slug:P.slug||S(I),seo_title:P.seo_title||I}))},O=()=>{h.trim()&&!n.tags.includes(h.trim())&&(i(I=>({...I,tags:[...I.tags,h.trim()]})),m(""))},k=I=>{i(P=>({...P,tags:P.tags.filter(A=>A!==I)}))},E=(I,P)=>{y({message:I,type:P}),setTimeout(()=>{y(null)},3e3)},C=async(I=!1)=>{try{p(!0);const P={...n,status:I?"published":n.status,published_at:I?new Date().toISOString():null,updated_at:new Date().toISOString()};if(r){const{error:A}=await we.from("content_articles").update(P).eq("id",parseInt(t));if(A)throw A;E(I?"Article published successfully!":"Article saved successfully!","success"),setTimeout(()=>{e("/content/articles")},1500)}else{const{data:A,error:T}=await we.from("content_articles").insert([P]).select().single();if(T)throw T;E(I?"Article published successfully!":"Article created successfully!","success"),setTimeout(()=>{A?e(`/content/articles/${A.id}/edit`,{replace:!0}):e("/content/articles")},1500)}}catch(P){console.error("Error saving article:",P),E("Failed to save article. Please try again.","error")}finally{p(!1)}};return l?f.jsx(hr,{children:f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):f.jsxs(hr,{children:[b&&f.jsx("div",{className:"fixed top-4 right-4 z-50 transition-all duration-500 ease-in-out transform translate-x-0 opacity-100",children:f.jsx("div",{className:`max-w-sm w-full ${b.type==="success"?"bg-green-500":"bg-red-500"} shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5`,children:f.jsx("div",{className:"flex-1 w-0 p-4",children:f.jsxs("div",{className:"flex items-start",children:[f.jsx("div",{className:"ml-3 flex-1",children:f.jsx("p",{className:"text-sm font-medium text-white",children:b.message})}),f.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:f.jsxs("button",{className:"bg-transparent rounded-md inline-flex text-white hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-white",onClick:()=>y(null),children:[f.jsx("span",{className:"sr-only",children:"Close"}),f.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})})}),f.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("button",{onClick:()=>e("/content/articles"),className:"p-2 hover:bg-gray-100 rounded-md",children:f.jsx(Hl,{className:"h-5 w-5"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Article":"Create New Article"}),f.jsx("p",{className:"text-gray-600",children:"Write and publish your content"})]})]}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsxs("button",{onClick:()=>C(!1),disabled:d,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[f.jsx(Dx,{className:"h-4 w-4 mr-2"}),"Save Draft"]}),f.jsxs("button",{onClick:()=>C(!0),disabled:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[f.jsx(Bi,{className:"h-4 w-4 mr-2"}),"Publish"]})]})]}),f.jsx("div",{className:"border-b border-gray-200",children:f.jsxs("nav",{className:"-mb-px flex space-x-8",children:[f.jsx("button",{onClick:()=>x("content"),className:`py-2 px-1 border-b-2 font-medium text-sm ${v==="content"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Content"}),f.jsx("button",{onClick:()=>x("settings"),className:`py-2 px-1 border-b-2 font-medium text-sm ${v==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Settings"}),f.jsx("button",{onClick:()=>x("seo"),className:`py-2 px-1 border-b-2 font-medium text-sm ${v==="seo"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"SEO"})]})}),v==="content"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),f.jsx("input",{type:"text",value:n.title,onChange:I=>w(I.target.value),placeholder:"Enter article title...",className:"w-full text-2xl font-bold border-0 border-b border-gray-200 focus:border-blue-500 focus:ring-0 px-0 py-2",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excerpt"}),f.jsx("textarea",{value:n.excerpt,onChange:I=>i(P=>({...P,excerpt:I.target.value})),placeholder:"Brief description of the article...",rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content *"}),f.jsx("textarea",{value:n.content,onChange:I=>i(P=>({...P,content:I.target.value})),placeholder:"Write your article content here...",rows:20,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",required:!0}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You can use HTML tags for formatting."})]})]}),v==="settings"&&f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),f.jsxs("select",{value:n.category_id||"",onChange:I=>i(P=>({...P,category_id:I.target.value?parseInt(I.target.value):null})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"No Category"}),a.map(I=>f.jsx("option",{value:I.id,children:I.name},I.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Author"}),f.jsx("input",{type:"text",value:n.author,onChange:I=>i(P=>({...P,author:I.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),f.jsxs("select",{value:n.status,onChange:I=>i(P=>({...P,status:I.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"draft",children:"Draft"}),f.jsx("option",{value:"published",children:"Published"}),f.jsx("option",{value:"archived",children:"Archived"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Slug"}),f.jsx("input",{type:"text",value:n.slug,onChange:I=>i(P=>({...P,slug:I.target.value})),placeholder:"article-url-slug",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Featured Image URL"}),f.jsx("input",{type:"url",value:n.featured_image_url,onChange:I=>i(P=>({...P,featured_image_url:I.target.value})),placeholder:"https://example.com/image.jpg",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),f.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:n.tags.map((I,P)=>f.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[I,f.jsx("button",{type:"button",onClick:()=>k(I),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full hover:bg-blue-200",children:"×"})]},P))}),f.jsxs("div",{className:"flex",children:[f.jsx("input",{type:"text",value:h,onChange:I=>m(I.target.value),onKeyPress:I=>I.key==="Enter"&&O(),placeholder:"Add a tag...",className:"flex-1 border border-gray-300 rounded-l-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 border border-l-0 border-gray-300 bg-gray-50 rounded-r-md hover:bg-gray-100",children:"Add"})]})]})]}),v==="seo"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SEO Title"}),f.jsx("input",{type:"text",value:n.seo_title,onChange:I=>i(P=>({...P,seo_title:I.target.value})),placeholder:"SEO optimized title...",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Recommended: 50-60 characters"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SEO Description"}),f.jsx("textarea",{value:n.seo_description,onChange:I=>i(P=>({...P,seo_description:I.target.value})),placeholder:"Meta description for search engines...",rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Recommended: 150-160 characters"})]})]})]})]})}function Vu({contentType:t,title:e,description:r,icon:n,color:i}){const a=zi(),[o,l]=z.useState([]),[c,d]=z.useState([]),[p,h]=z.useState(!0),[m,v]=z.useState({search:"",clients:[],status:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:"cards"}),[x,b]=z.useState(!1),[y,j]=z.useState({});z.useEffect(()=>{_()},[t]),z.useEffect(()=>{p||_()},[m]);const _=async()=>{try{h(!0);let P=we.from("content_items").select("*").eq("content_type",t);m.search.trim()&&(P=P.or(`title.ilike.%${m.search}%,description.ilike.%${m.search}%`)),m.status!=="all"&&(P=P.eq("status",m.status)),P=P.order(m.sortBy,{ascending:m.sortOrder==="asc"});const{data:A,error:T}=await P;if(T){console.error("Error fetching content items:",T),l([]);return}let L=A||[];if(m.clients.length>0){const{data:$,error:B}=await we.from("content_client_assignments").select("content_item_id").in("client_id",m.clients);if(B)console.error("Error fetching assignments:",B);else if($){const U=$.map(V=>V.content_item_id);L=L.filter(V=>U.includes(V.id))}}if(l(L),c.length===0){const{data:$,error:B}=await we.from("clients").select("*").eq("status","active").order("name");B?console.error("Error fetching clients:",B):$&&d($)}if(L.length>0){const $=L.map(X=>X.id),[B,U]=await Promise.all([we.from("content_client_assignments").select("content_item_id").in("content_item_id",$),we.from("content_user_assignments").select("content_item_id").in("content_item_id",$)]),V={};$.forEach(X=>{var R,q;const G=((R=B.data)==null?void 0:R.filter(H=>H.content_item_id===X).length)||0,F=((q=U.data)==null?void 0:q.filter(H=>H.content_item_id===X).length)||0;V[X]=G+F}),j(V)}}catch(P){console.error("Error in fetchData:",P),l([])}finally{h(!1)}},S=()=>({ai_agent:"ai-agents",video:"videos",document:"documents",prompt:"prompts",automation:"automations"})[t]||t,w=()=>{const P=S();a(`/content/${P}/create`)},O=P=>{const A=S();a(`/content/${A}/${P}/edit`)},k=(P,A)=>{v(T=>({...T,[P]:A}))},E=()=>{v({search:"",clients:[],status:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:m.viewMode})},C=P=>f.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${P==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:P==="published"?f.jsxs(f.Fragment,{children:[f.jsx(Bi,{className:"h-3 w-3 mr-1"})," Published"]}):f.jsxs(f.Fragment,{children:[f.jsx(jT,{className:"h-3 w-3 mr-1"})," Draft"]})}),I=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return f.jsx(hr,{children:f.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[f.jsxs("div",{className:`transition-all duration-300 ${x?"w-80":"w-12"} bg-white border-r border-gray-200 flex flex-col shadow-sm`,children:[f.jsx("div",{className:"p-4 border-b border-gray-200",children:f.jsxs("button",{onClick:()=>b(!x),className:"flex items-center justify-center w-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[f.jsx(Fd,{className:"h-5 w-5"}),x&&f.jsx("span",{className:"ml-2 text-sm font-medium",children:"Filters"})]})}),x&&f.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Content"}),f.jsxs("div",{className:"relative",children:[f.jsx(gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),f.jsx("input",{type:"text",placeholder:"Search by title or description...",value:m.search,onChange:P=>k("search",P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),f.jsxs("select",{value:m.status,onChange:P=>k("status",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[f.jsx("option",{value:"all",children:"All Status"}),f.jsx("option",{value:"published",children:"Published Only"}),f.jsx("option",{value:"draft",children:"Drafts Only"})]})]}),c.length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Clients"}),f.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:c.map(P=>f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:m.clients.includes(P.id),onChange:A=>{A.target.checked?k("clients",[...m.clients,P.id]):k("clients",m.clients.filter(T=>T!==P.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:P.brand_color}}),f.jsx("span",{className:"text-sm text-gray-900",children:P.name})]})]},P.id))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Content"}),f.jsxs("select",{value:`${m.sortBy}_${m.sortOrder}`,onChange:P=>{const[A,T]=P.target.value.split("_");k("sortBy",A),k("sortOrder",T)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[f.jsx("option",{value:"updated_at_desc",children:"Last Updated (Newest)"}),f.jsx("option",{value:"updated_at_asc",children:"Last Updated (Oldest)"}),f.jsx("option",{value:"created_at_desc",children:"Date Created (Newest)"}),f.jsx("option",{value:"created_at_asc",children:"Date Created (Oldest)"}),f.jsx("option",{value:"title_asc",children:"Title (A-Z)"}),f.jsx("option",{value:"title_desc",children:"Title (Z-A)"})]})]}),f.jsx("div",{className:"pt-4 border-t border-gray-200",children:f.jsx("button",{onClick:E,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Clear All Filters"})})]})]}),f.jsxs("div",{className:"flex-1 flex flex-col",children:[f.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center shadow-sm",style:{backgroundColor:i+"15"},children:f.jsx(n,{className:"h-6 w-6",style:{color:i}})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e}),f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r}),f.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[f.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," ",o.length===1?"item":"items"]}),m.status!=="all"&&f.jsxs("span",{className:"text-xs text-gray-500",children:["• Filtered by ",m.status]}),m.clients.length>0&&f.jsxs("span",{className:"text-xs text-gray-500",children:["• ",m.clients.length," client(s)"]})]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[f.jsx("button",{onClick:()=>k("viewMode","cards"),className:`p-2 rounded-md transition-colors ${m.viewMode==="cards"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Card View",children:f.jsx(a$,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>k("viewMode","list"),className:`p-2 rounded-md transition-colors ${m.viewMode==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:f.jsx(s$,{className:"h-4 w-4"})})]}),f.jsxs("button",{onClick:w,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all",style:{backgroundColor:i,boxShadow:`0 4px 12px ${i}40`},children:[f.jsx(Qr,{className:"-ml-1 mr-2 h-4 w-4"}),"Create New"]})]})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:p?f.jsx("div",{className:"flex justify-center items-center py-20",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsxs("p",{className:"text-sm text-gray-500 mt-3",children:["Loading ",e.toLowerCase(),"..."]})]})}):f.jsx(f.Fragment,{children:o.length===0?f.jsxs("div",{className:"text-center py-20",children:[f.jsx("div",{className:"mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",style:{backgroundColor:i+"10"},children:f.jsx(n,{className:"h-12 w-12",style:{color:i}})}),f.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["No ",e.toLowerCase()," yet"]}),f.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:m.search||m.status!=="all"||m.clients.length>0?`No ${e.toLowerCase()} match your current filters. Try adjusting your search criteria.`:`Get started by creating your first ${t.replace("_"," ")}.`}),f.jsx("div",{className:"mt-8",children:m.search||m.status!=="all"||m.clients.length>0?f.jsx("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear Filters"}):f.jsxs("button",{onClick:w,className:"inline-flex items-center px-6 py-3 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2",style:{backgroundColor:i},children:[f.jsx(Qr,{className:"-ml-1 mr-2 h-5 w-5"}),"Create ",t.replace("_"," ")]})})]}):f.jsx("div",{className:m.viewMode==="cards"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-3",children:o.map(P=>f.jsx("div",{onClick:()=>O(P.id),className:`${m.viewMode==="cards"?"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md cursor-pointer transition-all hover:scale-105":"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md cursor-pointer transition-all"}`,children:m.viewMode==="cards"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"h-32 bg-gradient-to-br from-opacity-10 to-opacity-20 flex items-center justify-center relative",style:{backgroundColor:i+"08",backgroundImage:`linear-gradient(135deg, ${i}15, ${i}05)`},children:[f.jsx(n,{className:"h-8 w-8",style:{color:i}}),P.thumbnail_url&&f.jsx("img",{src:P.thumbnail_url,alt:P.title,className:"absolute inset-0 w-full h-full object-cover"})]}),f.jsxs("div",{className:"p-4",children:[f.jsxs("div",{className:"flex items-start justify-between mb-2",children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 leading-5",children:P.title}),C(P.status)]}),P.description&&f.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-3 leading-4",children:P.description}),f.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Vl,{className:"h-3 w-3"}),f.jsx("span",{children:I(P.updated_at)})]}),y[P.id]>0&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Lr,{className:"h-3 w-3"}),f.jsx("span",{children:y[P.id]})]})]})]})]}):f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"h-12 w-12 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:i+"15"},children:f.jsx(n,{className:"h-6 w-6",style:{color:i}})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:P.title}),C(P.status)]}),P.description&&f.jsx("p",{className:"text-xs text-gray-600 truncate mt-1",children:P.description}),f.jsx("div",{className:"flex items-center justify-between mt-2",children:f.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Vl,{className:"h-3 w-3"}),f.jsxs("span",{children:["Updated ",I(P.updated_at)]})]}),y[P.id]>0&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Lr,{className:"h-3 w-3"}),f.jsxs("span",{children:[y[P.id]," assignment",y[P.id]!==1?"s":""]})]})]})})]})]})},P.id))})})})]})]})})}function xZ(){return f.jsx(Vu,{contentType:"ai_agent",title:dr.ai_agent.label,description:dr.ai_agent.description,icon:Sn,color:dr.ai_agent.color})}function wZ(){return f.jsx(Vu,{contentType:"video",title:dr.video.label,description:dr.video.description,icon:Gl,color:dr.video.color})}function _Z(){return f.jsx(Vu,{contentType:"document",title:dr.document.label,description:dr.document.description,icon:nr,color:dr.document.color})}function jZ(){return f.jsx(Vu,{contentType:"prompt",title:dr.prompt.label,description:dr.prompt.description,icon:wr,color:dr.prompt.color})}function SZ(){return f.jsx(Vu,{contentType:"automation",title:dr.automation.label,description:dr.automation.description,icon:Fo,color:dr.automation.color})}function OZ({isOpen:t,onClose:e,client:r,contentItemId:n,onSave:i}){const[a,o]=z.useState([]),[l,c]=z.useState([]),[d,p]=z.useState([]),[h,m]=z.useState([]),[v,x]=z.useState(!1),[b,y]=z.useState(!1);z.useEffect(()=>{t&&j()},[t,r.id]);const j=async()=>{try{x(!0);const{data:S,error:w}=await we.from("user_tags").select("*").eq("client_id",r.id).order("name");w?console.error("Error fetching tags:",w):S&&p(S);const{data:O,error:k}=await we.from("users").select("*").eq("client_id",r.id).order("first_name");k?console.error("Error fetching users:",k):O&&m(O);const[E,C]=await Promise.all([we.from("content_tag_assignments").select("tag_id").eq("content_item_id",n),we.from("content_user_assignments").select("user_id").eq("content_item_id",n)]);E.data&&o(E.data.map(I=>I.tag_id)),C.data&&c(C.data.map(I=>I.user_id))}catch(S){console.error("Error fetching assignment data:",S)}finally{x(!1)}},_=async()=>{try{y(!0);const{data:{user:S}}=await we.auth.getUser();if(!S)return;const w=[];d.length>0&&w.push(we.from("content_tag_assignments").delete().eq("content_item_id",n).in("tag_id",d.map(k=>k.id))),h.length>0&&w.push(we.from("content_user_assignments").delete().eq("content_item_id",n).in("user_id",h.map(k=>k.id))),await Promise.all(w);const O=[];if(a.length>0){const k=a.map(E=>({content_item_id:n,tag_id:E,assigned_by:S.id}));O.push(we.from("content_tag_assignments").insert(k))}if(l.length>0){const k=l.map(E=>({content_item_id:n,user_id:E,assigned_by:S.id}));O.push(we.from("content_user_assignments").insert(k))}await Promise.all(O),i(),e()}catch(S){console.error("Error saving assignments:",S)}finally{y(!1)}};return t?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"h-8 w-8 rounded-lg flex items-center justify-center",style:{backgroundColor:r.brand_color+"20"},children:f.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:r.brand_color}})}),f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Assign to ",r.name]}),f.jsx("p",{className:"text-sm text-gray-500",children:"Configure content visibility and access"})]})]}),f.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded-lg transition-colors",children:f.jsx(Iu,{className:"h-5 w-5"})})]}),v?f.jsxs("div",{className:"p-8 text-center",children:[f.jsx(Nt,{size:"md"}),f.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading assignment options..."})]}):f.jsxs("div",{className:"p-6 space-y-6",children:[d.length>0&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[f.jsx(En,{className:"h-4 w-4 inline mr-2"}),"Assign to User Tags (",a.length," selected)"]}),f.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:d.map(S=>f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-50 rounded-md",children:[f.jsx("input",{type:"checkbox",checked:a.includes(S.id),onChange:w=>{w.target.checked?o([...a,S.id]):o(a.filter(O=>O!==S.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:S.color}}),f.jsx("span",{className:"text-sm text-gray-900",children:S.name})]})]},S.id))}),f.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Content will be visible to all users with the selected tags"})]}),h.length>0&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[f.jsx(Lr,{className:"h-4 w-4 inline mr-2"}),"Assign to Specific Users (",l.length," selected)"]}),f.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3",children:h.map(S=>f.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-50 rounded-md",children:[f.jsx("input",{type:"checkbox",checked:l.includes(S.id),onChange:w=>{w.target.checked?c([...l,S.id]):c(l.filter(O=>O!==S.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[S.first_name," ",S.last_name]}),f.jsx("div",{className:"text-xs text-gray-500",children:S.email})]})]},S.id))}),f.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Content will be visible to the specifically selected users"})]}),d.length===0&&h.length===0&&f.jsxs("div",{className:"text-center py-8",children:[f.jsx(Lr,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),f.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"No assignment options"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This client has no users or tags configured. Set up users and tags first."})]})]}),f.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[f.jsx("button",{onClick:e,disabled:b,className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),f.jsxs("button",{onClick:_,disabled:b||d.length===0&&h.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[b?f.jsx(Nt,{size:"sm",className:"mr-2"}):null,"Save Assignments"]})]})]})}):null}function Ku({contentType:t,isEdit:e=!1,children:r,onSaveContent:n,title:i,description:a,color:o,icon:l}){const{id:c}=ni(),d=zi(),{admin:p}=Bd(),[h,m]=z.useState(null),[v,x]=z.useState([]),[b,y]=z.useState([]),[j,_]=z.useState(e),[S,w]=z.useState(!1),[O,k]=z.useState(!1),[E,C]=z.useState(null),[I,P]=z.useState(!1),[A,T]=z.useState(""),[L,$]=z.useState(""),[B,U]=z.useState("draft"),[V,X]=z.useState("");z.useEffect(()=>{e&&c&&G(),F()},[e,c]),z.useEffect(()=>{k(!0)},[A,L,B,V]);const G=async()=>{if(c)try{const{data:Y,error:re}=await we.from("content_items").select("*").eq("id",c).maybeSingle();if(re)throw re;if(!Y){d("/content");return}m(Y),T(Y.title),$(Y.description||""),U(Y.status),X(Y.thumbnail_url||"");const{data:Q}=await we.from("content_client_assignments").select("client_id").eq("content_item_id",Y.id);Q&&y(Q.map(oe=>oe.client_id))}catch(Y){console.error("Error fetching content item:",Y),d("/content")}finally{_(!1)}},F=async()=>{try{const{data:Y,error:re}=await we.from("clients").select("*").eq("status","active").order("name");if(re)throw re;Y&&x(Y)}catch(Y){console.error("Error fetching clients:",Y)}},R=async()=>{if(p)try{w(!0);let Y=c;const re={title:A.trim(),description:L.trim()||null,content_type:t,status:B,thumbnail_url:V.trim()||null,created_by:p.id,updated_at:new Date().toISOString()};if(e&&Y){const{error:Q}=await we.from("content_items").update(re).eq("id",Y);if(Q)throw Q}else{const{data:Q,error:oe}=await we.from("content_items").insert([{...re,created_at:new Date().toISOString()}]).select().single();if(oe)throw oe;Q&&(Y=Q.id,m(Q))}if(n&&Y&&await n(Y),await H(Y),k(!1),!e&&Y){const Q=J();d(`/content/${Q}/${Y}/edit`,{replace:!0})}}catch(Y){console.error("Error saving content:",Y),alert("Error saving content. Please try again.")}finally{w(!1)}},q=async()=>{if(p)try{w(!0);let Y=c;const re={title:A.trim(),description:L.trim()||null,content_type:t,status:B,thumbnail_url:V.trim()||null,created_by:p.id,updated_at:new Date().toISOString()};if(e&&Y){const{error:oe}=await we.from("content_items").update(re).eq("id",Y);if(oe)throw oe}else{const{data:oe,error:pe}=await we.from("content_items").insert([{...re,created_at:new Date().toISOString()}]).select().single();if(pe)throw pe;oe&&(Y=oe.id,m(oe))}n&&Y&&await n(Y),await H(Y),k(!1);const Q=J();d(`/content/${Q}`,{replace:!0})}catch(Y){console.error("Error saving content:",Y),alert("Error saving content. Please try again.")}finally{w(!1)}},H=async Y=>{if(p&&(await we.from("content_client_assignments").delete().eq("content_item_id",Y),b.length>0)){const re=b.map(Q=>({content_item_id:Y,client_id:Q,assigned_by:p.id}));await we.from("content_client_assignments").insert(re)}},ee=async()=>{if(!(!h||!p)&&confirm("Are you sure you want to delete this content? This action cannot be undone."))try{w(!0);const{error:Y}=await we.from("content_items").delete().eq("id",h.id);if(Y)throw Y;d("/content")}catch(Y){console.error("Error deleting content:",Y),alert("Error deleting content. Please try again.")}finally{w(!1)}},J=()=>({ai_agent:"ai-agents",video:"videos",document:"documents",prompt:"prompts",automation:"automations"})[t]||t,K=Y=>{y(re=>re.includes(Y)?re.filter(Q=>Q!==Y):[...re,Y]),k(!0)};return j?f.jsx(hr,{children:f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading content..."})]})})}):f.jsx(hr,{children:f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex items-center justify-between py-4",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx(Yr,{to:`/content/${J()}`,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:f.jsx(Hl,{className:"h-5 w-5"})}),f.jsx("div",{className:"h-8 w-8 rounded-lg flex items-center justify-center",style:{backgroundColor:o+"20"},children:f.jsx(l,{className:"h-5 w-5",style:{color:o}})}),f.jsxs("div",{children:[f.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:[e?"Edit":"Create"," ",i.slice(0,-1)]}),f.jsx("p",{className:"text-sm text-gray-500",children:a})]})]}),f.jsxs("div",{className:"flex items-center space-x-3",children:[e&&f.jsxs("button",{onClick:ee,disabled:S,className:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:[f.jsx(ys,{className:"h-4 w-4 mr-1"}),"Delete"]}),!e&&f.jsxs("button",{onClick:q,disabled:S||!A.trim(),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[S?f.jsx(Nt,{size:"sm",className:"mr-2"}):f.jsx(Hl,{className:"h-4 w-4 mr-2"}),S?"Saving...":"Save & Return to List"]}),f.jsxs("button",{onClick:R,disabled:S||!A.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50",style:{backgroundColor:o},children:[S?f.jsx(Nt,{size:"sm",className:"mr-2"}):f.jsx(Dx,{className:"h-4 w-4 mr-2"}),S?"Saving...":e?"Update":"Save & Continue Editing"]})]})]})})}),f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),f.jsx("input",{type:"text",id:"title",value:A,onChange:Y=>T(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter ${i.slice(0,-1).toLowerCase()} title...`,required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),f.jsx("textarea",{id:"description",rows:3,value:L,onChange:Y=>$(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Brief description of this ${i.slice(0,-1).toLowerCase()}...`})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Thumbnail URL"}),f.jsx("input",{type:"url",id:"thumbnail",value:V,onChange:Y=>X(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/image.jpg"})]})]})]}),r]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status & Visibility"}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),f.jsxs("select",{value:B,onChange:Y=>U(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"draft",children:"📝 Draft"}),f.jsx("option",{value:"published",children:"👁️ Published"})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:B==="draft"?"Only visible to admin users":"Visible to assigned clients and users"})]})})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Client Assignment"}),f.jsxs("span",{className:"text-sm text-gray-500",children:[b.length," of ",v.length]})]}),v.length>0?f.jsx("div",{className:"space-y-3",children:v.map(Y=>{const re=b.includes(Y.id);return f.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("input",{type:"checkbox",checked:re,onChange:()=>K(Y.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:Y.brand_color}}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y.name})]})]}),re&&f.jsx("button",{onClick:()=>C(Y.id),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Configure"})]},Y.id)})}):f.jsxs("div",{className:"text-center py-4",children:[f.jsx(Lr,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),f.jsx("p",{className:"text-sm text-gray-500",children:"No clients available"})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[f.jsxs("button",{onClick:()=>P(!I),className:"w-full flex items-center justify-between p-6 text-left",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Lx,{className:"h-5 w-5 text-gray-600"}),f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Advanced Settings"})]}),I?f.jsx(Rf,{className:"h-5 w-5 text-gray-600"}):f.jsx(r$,{className:"h-5 w-5 text-gray-600"})]}),I&&f.jsx("div",{className:"px-6 pb-6 border-t border-gray-200",children:f.jsx("div",{className:"pt-4 space-y-4",children:f.jsxs("div",{className:"text-sm text-gray-600",children:[f.jsxs("p",{children:["Content ID: ",f.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:(h==null?void 0:h.id)||"Not created yet"})]}),f.jsxs("p",{children:["Content Type: ",f.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:t})]}),h&&f.jsxs(f.Fragment,{children:[f.jsxs("p",{children:["Created: ",new Date(h.created_at).toLocaleString()]}),f.jsxs("p",{children:["Updated: ",new Date(h.updated_at).toLocaleString()]})]})]})})})]})]})]})}),E&&f.jsx(OZ,{isOpen:!0,onClose:()=>C(null),client:v.find(Y=>Y.id===E),contentItemId:(h==null?void 0:h.id)||c,onSave:()=>{}})]})})}function NZ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kP(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function EP(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kP(Object(r),!0).forEach(function(n){NZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kP(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kZ(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function EZ(t,e){if(t==null)return{};var r=kZ(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function AZ(t,e){return PZ(t)||TZ(t,e)||CZ(t,e)||MZ()}function PZ(t){if(Array.isArray(t))return t}function TZ(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,a=void 0;try{for(var o=t[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(e&&r.length===e));n=!0);}catch(c){i=!0,a=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}}function CZ(t,e){if(t){if(typeof t=="string")return AP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AP(t,e)}}function AP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function MZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
  `},CP=XZ(eee)(JI),tee={config:JZ},ree=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(a,o){return o(a)},i)}};function ZI(t,e){return Object.keys(e).forEach(function(r){e[r]instanceof Object&&t[r]&&Object.assign(e[r],ZI(t[r],e[r]))}),EP(EP({},t),e)}var nee={type:"cancelation",msg:"operation is manually canceled"};function M0(t){var e=!1,r=new Promise(function(n,i){t.then(function(a){return e?i(nee):n(a)}),t.catch(i)});return r.cancel=function(){return e=!0},r}var iee=GZ.create({config:YZ,isInitialized:!1,resolve:null,reject:null,monaco:null}),eR=AZ(iee,2),Gu=eR[0],Nh=eR[1];function aee(t){var e=tee.config(t),r=e.monaco,n=EZ(e,["monaco"]);Nh(function(i){return{config:ZI(i.config,n),monaco:r}})}function oee(){var t=Gu(function(e){var r=e.monaco,n=e.isInitialized,i=e.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!t.isInitialized){if(Nh({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),M0(I0);if(window.monaco&&window.monaco.editor)return tR(window.monaco),t.resolve(window.monaco),M0(I0);ree(see,uee)(cee)}return M0(I0)}function see(t){return document.body.appendChild(t)}function lee(t){var e=document.createElement("script");return t&&(e.src=t),e}function uee(t){var e=Gu(function(n){var i=n.config,a=n.reject;return{config:i,reject:a}}),r=lee("".concat(e.config.paths.vs,"/loader.js"));return r.onload=function(){return t()},r.onerror=e.reject,r}function cee(){var t=Gu(function(r){var n=r.config,i=r.resolve,a=r.reject;return{config:n,resolve:i,reject:a}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(r){tR(r),t.resolve(r)},function(r){t.reject(r)})}function tR(t){Gu().monaco||Nh({monaco:t})}function fee(){return Gu(function(t){var e=t.monaco;return e})}var I0=new Promise(function(t,e){return Nh({resolve:t,reject:e})}),rR={config:aee,init:oee,__getMonacoInstance:fee},dee={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},R0=dee,hee={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},pee=hee;function mee({children:t}){return te.createElement("div",{style:pee.container},t)}var vee=mee,gee=vee;function yee({width:t,height:e,isEditorReady:r,loading:n,_ref:i,className:a,wrapperProps:o}){return te.createElement("section",{style:{...R0.wrapper,width:t,height:e},...o},!r&&te.createElement(gee,null,n),te.createElement("div",{ref:i,style:{...R0.fullWidth,...!r&&R0.hide},className:a}))}var bee=yee,nR=z.memo(bee);function xee(t){z.useEffect(t,[])}var iR=xee;function wee(t,e,r=!0){let n=z.useRef(!0);z.useEffect(n.current||!r?()=>{n.current=!1}:t,e)}var Cr=wee;function Fl(){}function Mo(t,e,r,n){return _ee(t,n)||jee(t,e,r,n)}function _ee(t,e){return t.editor.getModel(aR(t,e))}function jee(t,e,r,n){return t.editor.createModel(e,r,n?aR(t,n):void 0)}function aR(t,e){return t.Uri.parse(e)}function See({original:t,modified:e,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:a,modifiedModelPath:o,keepCurrentOriginalModel:l=!1,keepCurrentModifiedModel:c=!1,theme:d="light",loading:p="Loading...",options:h={},height:m="100%",width:v="100%",className:x,wrapperProps:b={},beforeMount:y=Fl,onMount:j=Fl}){let[_,S]=z.useState(!1),[w,O]=z.useState(!0),k=z.useRef(null),E=z.useRef(null),C=z.useRef(null),I=z.useRef(j),P=z.useRef(y),A=z.useRef(!1);iR(()=>{let B=rR.init();return B.then(U=>(E.current=U)&&O(!1)).catch(U=>(U==null?void 0:U.type)!=="cancelation"&&console.error("Monaco initialization: error:",U)),()=>k.current?$():B.cancel()}),Cr(()=>{if(k.current&&E.current){let B=k.current.getOriginalEditor(),U=Mo(E.current,t||"",n||r||"text",a||"");U!==B.getModel()&&B.setModel(U)}},[a],_),Cr(()=>{if(k.current&&E.current){let B=k.current.getModifiedEditor(),U=Mo(E.current,e||"",i||r||"text",o||"");U!==B.getModel()&&B.setModel(U)}},[o],_),Cr(()=>{let B=k.current.getModifiedEditor();B.getOption(E.current.editor.EditorOption.readOnly)?B.setValue(e||""):e!==B.getValue()&&(B.executeEdits("",[{range:B.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),B.pushUndoStop())},[e],_),Cr(()=>{var B,U;(U=(B=k.current)==null?void 0:B.getModel())==null||U.original.setValue(t||"")},[t],_),Cr(()=>{let{original:B,modified:U}=k.current.getModel();E.current.editor.setModelLanguage(B,n||r||"text"),E.current.editor.setModelLanguage(U,i||r||"text")},[r,n,i],_),Cr(()=>{var B;(B=E.current)==null||B.editor.setTheme(d)},[d],_),Cr(()=>{var B;(B=k.current)==null||B.updateOptions(h)},[h],_);let T=z.useCallback(()=>{var V;if(!E.current)return;P.current(E.current);let B=Mo(E.current,t||"",n||r||"text",a||""),U=Mo(E.current,e||"",i||r||"text",o||"");(V=k.current)==null||V.setModel({original:B,modified:U})},[r,e,i,t,n,a,o]),L=z.useCallback(()=>{var B;!A.current&&C.current&&(k.current=E.current.editor.createDiffEditor(C.current,{automaticLayout:!0,...h}),T(),(B=E.current)==null||B.editor.setTheme(d),S(!0),A.current=!0)},[h,d,T]);z.useEffect(()=>{_&&I.current(k.current,E.current)},[_]),z.useEffect(()=>{!w&&!_&&L()},[w,_,L]);function $(){var U,V,X,G;let B=(U=k.current)==null?void 0:U.getModel();l||((V=B==null?void 0:B.original)==null||V.dispose()),c||((X=B==null?void 0:B.modified)==null||X.dispose()),(G=k.current)==null||G.dispose()}return te.createElement(nR,{width:v,height:m,isEditorReady:_,loading:p,_ref:C,className:x,wrapperProps:b})}var Oee=See;z.memo(Oee);function Nee(t){let e=z.useRef();return z.useEffect(()=>{e.current=t},[t]),e.current}var kee=Nee,kf=new Map;function Eee({defaultValue:t,defaultLanguage:e,defaultPath:r,value:n,language:i,path:a,theme:o="light",line:l,loading:c="Loading...",options:d={},overrideServices:p={},saveViewState:h=!0,keepCurrentModel:m=!1,width:v="100%",height:x="100%",className:b,wrapperProps:y={},beforeMount:j=Fl,onMount:_=Fl,onChange:S,onValidate:w=Fl}){let[O,k]=z.useState(!1),[E,C]=z.useState(!0),I=z.useRef(null),P=z.useRef(null),A=z.useRef(null),T=z.useRef(_),L=z.useRef(j),$=z.useRef(),B=z.useRef(n),U=kee(a),V=z.useRef(!1),X=z.useRef(!1);iR(()=>{let R=rR.init();return R.then(q=>(I.current=q)&&C(!1)).catch(q=>(q==null?void 0:q.type)!=="cancelation"&&console.error("Monaco initialization: error:",q)),()=>P.current?F():R.cancel()}),Cr(()=>{var q,H,ee,J;let R=Mo(I.current,t||n||"",e||i||"",a||r||"");R!==((q=P.current)==null?void 0:q.getModel())&&(h&&kf.set(U,(H=P.current)==null?void 0:H.saveViewState()),(ee=P.current)==null||ee.setModel(R),h&&((J=P.current)==null||J.restoreViewState(kf.get(a))))},[a],O),Cr(()=>{var R;(R=P.current)==null||R.updateOptions(d)},[d],O),Cr(()=>{!P.current||n===void 0||(P.current.getOption(I.current.editor.EditorOption.readOnly)?P.current.setValue(n):n!==P.current.getValue()&&(X.current=!0,P.current.executeEdits("",[{range:P.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),P.current.pushUndoStop(),X.current=!1))},[n],O),Cr(()=>{var q,H;let R=(q=P.current)==null?void 0:q.getModel();R&&i&&((H=I.current)==null||H.editor.setModelLanguage(R,i))},[i],O),Cr(()=>{var R;l!==void 0&&((R=P.current)==null||R.revealLine(l))},[l],O),Cr(()=>{var R;(R=I.current)==null||R.editor.setTheme(o)},[o],O);let G=z.useCallback(()=>{var R;if(!(!A.current||!I.current)&&!V.current){L.current(I.current);let q=a||r,H=Mo(I.current,n||t||"",e||i||"",q||"");P.current=(R=I.current)==null?void 0:R.editor.create(A.current,{model:H,automaticLayout:!0,...d},p),h&&P.current.restoreViewState(kf.get(q)),I.current.editor.setTheme(o),l!==void 0&&P.current.revealLine(l),k(!0),V.current=!0}},[t,e,r,n,i,a,d,p,h,o,l]);z.useEffect(()=>{O&&T.current(P.current,I.current)},[O]),z.useEffect(()=>{!E&&!O&&G()},[E,O,G]),B.current=n,z.useEffect(()=>{var R,q;O&&S&&((R=$.current)==null||R.dispose(),$.current=(q=P.current)==null?void 0:q.onDidChangeModelContent(H=>{X.current||S(P.current.getValue(),H)}))},[O,S]),z.useEffect(()=>{if(O){let R=I.current.editor.onDidChangeMarkers(q=>{var ee;let H=(ee=P.current.getModel())==null?void 0:ee.uri;if(H&&q.find(J=>J.path===H.path)){let J=I.current.editor.getModelMarkers({resource:H});w==null||w(J)}});return()=>{R==null||R.dispose()}}return()=>{}},[O,w]);function F(){var R,q;(R=$.current)==null||R.dispose(),m?h&&kf.set(a,P.current.saveViewState()):(q=P.current.getModel())==null||q.dispose(),P.current.dispose()}return te.createElement(nR,{width:v,height:x,isEditorReady:O,loading:c,_ref:A,className:b,wrapperProps:y})}var Aee=Eee,Pee=z.memo(Aee),Tee=Pee;function MP(){const{id:t}=ni(),e=!!t,[r,n]=z.useState(null),[i,a]=z.useState(""),[o,l]=z.useState(""),[c,d]=z.useState(""),[p,h]=z.useState([]),[m,v]=z.useState(e),[x,b]=z.useState(""),[y,j]=z.useState(null),[_,S]=z.useState(!1),[w,O]=z.useState(null),k=z.useRef(null),[E,C]=z.useState([]),[I,P]=z.useState(!1);z.useEffect(()=>{let F=!0;return e&&t?A():e||F&&v(!1),()=>{F=!1}},[e,t]),z.useEffect(()=>{let F=!0;if(r&&r.id){const q=setTimeout(async()=>{F&&await T()},100);return()=>{clearTimeout(q),F=!1}}},[r==null?void 0:r.id]),z.useEffect(()=>{k.current&&k.current.scrollIntoView({behavior:"smooth"})},[y==null?void 0:y.messages]);const A=async()=>{if(!t){v(!1);return}try{const{data:F,error:R}=await we.from("ai_agents").select("*").eq("content_item_id",t).maybeSingle();if(R){console.error("Error fetching AI agent:",R),v(!1);return}F?(n(F),a(F.system_prompt||""),l(F.agent_name||""),d(F.short_description||""),h(F.test_conversations||[])):(n(null),a(""),l(""),d(""),h([]))}catch(F){console.error("Error fetching AI agent:",F)}finally{v(!1)}},T=async()=>{if(!(!r||!r.id||I)){P(!0);try{const{data:{user:F}}=await we.auth.getUser();if(!F)return;const{data:R,error:q}=await we.functions.invoke("conversation-history",{body:{agentId:r.id,userId:F.id,limit:10}});if(q){console.error("Error fetching conversation history:",q);return}C((R==null?void 0:R.conversations)||[])}catch(F){console.error("Error loading conversation history:",F)}finally{P(!1)}}},L=()=>{const F={id:`conv_${Date.now()}`,messages:[],created_at:new Date().toISOString()};j(F),h([F,...p]),O(null)},$=F=>{j(F),O(null)},B=F=>{const R=p.filter(q=>q.id!==F);h(R),(y==null?void 0:y.id)===F&&j(R[0]||null)},U=async()=>{var q,H,ee;if(!x.trim()||!y||!i.trim())return;S(!0),O(null);const F={role:"user",content:x.trim(),timestamp:new Date().toISOString()},R={...y,messages:[...y.messages,F]};j(R),b("");try{const{data:J,error:K}=await we.functions.invoke("ai-chat",{body:{messages:R.messages,systemPrompt:i,agentId:(r==null?void 0:r.id)||t,conversationId:y.id.startsWith("conv_")?void 0:y.id,userId:(ee=(H=(q=await we.auth.getUser())==null?void 0:q.data)==null?void 0:H.user)==null?void 0:ee.id}});if(K)throw new Error(K.message||"Failed to connect to AI service");if(J!=null&&J.error)throw new Error(J.error.message||"AI service error");const Y={role:"assistant",content:(J==null?void 0:J.message)||"Sorry, I could not generate a response.",timestamp:new Date().toISOString()},re={...R,messages:[...R.messages,Y]};J!=null&&J.conversationId&&y.id.startsWith("conv_")&&(re.id=J.conversationId),j(re),h(Q=>Q.map(oe=>oe.id===y.id||oe.id===re.id?re:oe))}catch(J){console.error("Error testing agent:",J),O(J.message||"Failed to get AI response")}finally{S(!1)}},V=async()=>{try{await navigator.clipboard.writeText(i)}catch(F){console.error("Failed to copy prompt:",F)}},X=async F=>{try{const R={content_item_id:F,system_prompt:i,agent_name:o,short_description:c||null,test_conversations:p};if(r){const{error:q}=await we.from("ai_agents").update({...R,updated_at:new Date().toISOString()}).eq("id",r.id);if(q)throw q}else{const{error:q}=await we.from("ai_agents").insert([R]);if(q)throw q}}catch(R){throw console.error("Error saving agent data:",R),R}},G=F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),U())};return m?f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading AI agent..."})]})}):f.jsx(Ku,{contentType:"ai_agent",isEdit:e,onSaveContent:X,title:"AI Agents",description:"Intelligent AI agents with custom prompts",color:"#3B82F6",icon:Sn,children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(Sn,{className:"h-5 w-5 mr-2 text-blue-500"}),"Agent Configuration"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"agentName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Agent Name *"}),f.jsx("input",{type:"text",id:"agentName",value:o,onChange:F=>l(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Customer Support Assistant",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"shortDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Short Description"}),f.jsx("input",{type:"text",id:"shortDescription",value:c,onChange:F=>d(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of agent capabilities"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[f.jsx(wr,{className:"h-5 w-5 mr-2 text-purple-500"}),"System Prompt"]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:V,className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[f.jsx(Q0,{className:"h-3 w-3 mr-1"}),"Copy"]}),f.jsxs("span",{className:"text-xs text-gray-500",children:[i.length," characters"]})]})]}),f.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:f.jsx(Tee,{height:"400px",defaultLanguage:"markdown",value:i,onChange:F=>a(F||""),theme:"vs-light",options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,lineNumbers:"on",wordWrap:"on",automaticLayout:!0,padding:{top:16,bottom:16}}})})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[f.jsx("div",{className:"border-b border-gray-200 p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[f.jsx(Fo,{className:"h-5 w-5 mr-2 text-green-500"}),"AI Test Sandbox with History"]}),f.jsx("div",{className:"flex items-center space-x-2",children:f.jsxs("button",{onClick:L,disabled:!i.trim(),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[f.jsx(wr,{className:"h-3 w-3 mr-1"}),"New Chat"]})})]})}),f.jsxs("div",{className:"flex h-96",children:[f.jsxs("div",{className:"w-80 border-r border-gray-200 bg-gray-50 flex flex-col",children:[f.jsxs("div",{className:"p-4",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Active Conversations"}),f.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:p.filter(F=>F.id.startsWith("conv_")).map((F,R)=>f.jsxs("div",{onClick:()=>$(F),className:`p-2 rounded-lg cursor-pointer transition-colors border ${(y==null?void 0:y.id)===F.id?"bg-blue-100 border-blue-200":"bg-white border-gray-200 hover:bg-gray-100"}`,children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["New Chat ",R+1]}),f.jsx("button",{onClick:q=>{q.stopPropagation(),B(F.id)},className:"text-red-500 hover:text-red-700",children:f.jsx(ys,{className:"h-3 w-3"})})]}),f.jsxs("p",{className:"text-xs text-gray-500",children:[F.messages.length," messages"]})]},F.id))})]}),f.jsxs("div",{className:"flex-1 border-t border-gray-200 p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsxs("h4",{className:"text-sm font-medium text-gray-700 flex items-center",children:[f.jsx(wS,{className:"h-4 w-4 mr-2"}),"Saved History"]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[I&&f.jsx(Nt,{size:"sm"}),f.jsx("button",{onClick:T,disabled:I||!r,className:"text-xs text-blue-600 hover:text-blue-700 disabled:opacity-50",title:"Refresh conversation history",children:f.jsx(h$,{className:"h-3 w-3"})})]})]}),f.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[E.map(F=>f.jsxs("div",{className:"p-2 rounded-lg border bg-white hover:bg-gray-50 cursor-pointer",children:[f.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[F.title.substring(0,40),"..."]}),f.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[f.jsx(Kl,{className:"h-3 w-3 mr-1"}),new Date(F.updated_at).toLocaleDateString()]})]},F.id)),E.length===0&&!I&&f.jsxs("div",{className:"text-center py-4",children:[f.jsx(wS,{className:"h-6 w-6 mx-auto text-gray-300 mb-2"}),f.jsx("p",{className:"text-xs text-gray-500",children:"No saved conversations"})]})]})]})]}),f.jsx("div",{className:"flex-1 flex flex-col",children:y?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[y.messages.length===0?f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(Sn,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),f.jsx("p",{className:"text-sm",children:"Start testing your AI agent"})]}):y.messages.map((F,R)=>f.jsxs("div",{className:`flex items-start space-x-3 ${F.role==="user"?"flex-row-reverse space-x-reverse":""}`,children:[f.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center ${F.role==="user"?"bg-blue-500 text-white":"bg-gray-600 text-white"}`,children:F.role==="user"?f.jsx(NT,{className:"h-4 w-4"}):f.jsx(Sn,{className:"h-4 w-4"})}),f.jsxs("div",{className:`flex-1 ${F.role==="user"?"text-right":"text-left"}`,children:[f.jsx("div",{className:`inline-block max-w-3xl p-3 rounded-lg text-sm ${F.role==="user"?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"}`,children:f.jsx("div",{className:"whitespace-pre-wrap",children:F.content})}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(F.timestamp||F.created_at||new Date).toLocaleTimeString()})]})]},`${y.id}-${R}`)),_&&f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-600 flex items-center justify-center",children:f.jsx(Sn,{className:"h-4 w-4 text-white"})}),f.jsx("div",{className:"flex-1",children:f.jsxs("div",{className:"inline-block bg-gray-100 p-3 rounded-lg",children:[f.jsx(Nt,{size:"sm"}),f.jsx("span",{className:"text-sm text-gray-600 ml-2",children:"Thinking..."})]})})]}),f.jsx("div",{ref:k})]}),f.jsxs("div",{className:"border-t border-gray-200 p-4",children:[f.jsxs("div",{className:"flex items-end space-x-3",children:[f.jsx("div",{className:"flex-1",children:f.jsx("textarea",{value:x,onChange:F=>b(F.target.value),onKeyPress:G,placeholder:"Type your message...",disabled:!i.trim()||_,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none disabled:opacity-50",rows:2})}),f.jsx("button",{onClick:U,disabled:!x.trim()||!i.trim()||_,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 transition-colors",children:_?f.jsx(Nt,{size:"sm"}):f.jsx(p$,{className:"h-4 w-4"})})]}),w&&f.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg",children:f.jsx("p",{className:"text-sm text-red-600",children:w})})]})]}):f.jsx("div",{className:"flex-1 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Sn,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Conversation Selected"}),f.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Create a new conversation to start testing"}),f.jsxs("button",{onClick:L,disabled:!i.trim(),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:[f.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Start New Conversation"]})]})})})]})]})]})})}function IP(){const{id:t}=ni(),e=!!t,[r,n]=z.useState(null),[i,a]=z.useState(""),[o,l]=z.useState(""),[c,d]=z.useState(""),[p,h]=z.useState(""),[m,v]=z.useState(e),[x,b]=z.useState(!1),[y,j]=z.useState(null),[_,S]=z.useState(null);z.useEffect(()=>{e&&t&&w()},[e,t]),z.useEffect(()=>{i.trim()&&O(i.trim())},[i]);const w=async()=>{if(t)try{const{data:P,error:A}=await we.from("videos").select("*").eq("content_item_id",t).maybeSingle();if(A)throw A;P&&(n(P),a(P.video_url),l(P.transcription||""),d(P.auto_title||""),h(P.auto_description||""),P.video_platform&&P.video_id&&S({platform:P.video_platform,videoId:P.video_id,duration:P.duration_seconds||void 0}))}catch(P){console.error("Error fetching video:",P)}finally{v(!1)}},O=async P=>{b(!0),j(null);try{const A=k(P);S(A),A.title&&d(A.title),A.description&&h(A.description)}catch(A){j(A.message||"Failed to process video URL"),S(null)}finally{b(!1)}},k=P=>{var L;const A=[/(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]+)/,/youtube\.com\/embed\/([\w-]+)/,/youtube\.com\/v\/([\w-]+)/],T=[/vimeo\.com\/(\d+)/,/player\.vimeo\.com\/video\/(\d+)/];for(const $ of A){const B=P.match($);if(B)return{platform:"youtube",videoId:B[1],title:`YouTube Video ${B[1]}`,description:"Video imported from YouTube"}}for(const $ of T){const B=P.match($);if(B)return{platform:"vimeo",videoId:B[1],title:`Vimeo Video ${B[1]}`,description:"Video imported from Vimeo"}}if(P.match(/\.(mp4|webm|ogg|mov|avi|mkv)$/i))return{platform:"other",title:((L=P.split("/").pop())==null?void 0:L.split(".")[0])||"Video File",description:"Direct video file"};throw new Error("Unsupported video URL format. Please use YouTube, Vimeo, or direct video file URLs.")},E=P=>P.platform==="youtube"&&P.videoId?`https://www.youtube.com/embed/${P.videoId}?rel=0&modestbranding=1`:P.platform==="vimeo"&&P.videoId?`https://player.vimeo.com/video/${P.videoId}?title=0&byline=0&portrait=0`:i,C=P=>{const A=P.trim().split(/\s+/).length;return Math.ceil(A/200)},I=async P=>{try{const A={content_item_id:P,video_url:i.trim(),video_platform:(_==null?void 0:_.platform)||null,video_id:(_==null?void 0:_.videoId)||null,duration_seconds:(_==null?void 0:_.duration)||null,transcription:o.trim()||null,auto_title:c.trim()||null,auto_description:p.trim()||null};if(r){const{error:T}=await we.from("videos").update({...A,updated_at:new Date().toISOString()}).eq("id",r.id);if(T)throw T}else{const{error:T}=await we.from("videos").insert([A]);if(T)throw T}}catch(A){throw console.error("Error saving video data:",A),A}};return m?f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading video..."})]})}):f.jsx(Ku,{contentType:"video",isEdit:e,onSaveContent:I,title:"Videos",description:"Educational videos with transcriptions",color:"#EF4444",icon:Gl,children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(J0,{className:"h-5 w-5 mr-2 text-red-500"}),"Video Source"]}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx("label",{htmlFor:"videoUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"Video URL *"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"url",id:"videoUrl",value:i,onChange:P=>a(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"https://www.youtube.com/watch?v=... or https://vimeo.com/...",required:!0}),x&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx(Nt,{size:"sm"})})]}),y&&f.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Rx,{className:"h-4 w-4 text-red-600"}),f.jsx("p",{className:"text-sm text-red-700",children:y})]})}),_&&!y&&f.jsxs("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[f.jsx(Yn,{className:"h-4 w-4 text-green-600"}),f.jsxs("p",{className:"text-sm text-green-700 font-medium",children:[_.platform.charAt(0).toUpperCase()+_.platform.slice(1)," video detected"]})]}),f.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[f.jsxs("p",{children:["Platform: ",f.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:_.platform})]}),_.videoId&&f.jsxs("p",{children:["Video ID: ",f.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:_.videoId})]}),_.duration&&f.jsxs("p",{children:["Duration: ",f.jsxs("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:[Math.floor(_.duration/60),":",(_.duration%60).toString().padStart(2,"0")]})]})]})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported: YouTube, Vimeo, and direct video file URLs (.mp4, .webm, .ogg, etc.)"})]})})]}),_&&i&&!y&&f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(Gl,{className:"h-5 w-5 mr-2 text-red-500"}),"Video Preview"]}),f.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden",children:_.platform==="youtube"||_.platform==="vimeo"?f.jsx("iframe",{src:E(_),title:"Video Preview",className:"w-full h-full",frameBorder:"0",allowFullScreen:!0}):f.jsx("video",{src:i,controls:!0,className:"w-full h-full object-cover",preload:"metadata"})}),f.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-600",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[_.platform&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(J0,{className:"h-4 w-4"}),f.jsx("span",{className:"capitalize",children:_.platform})]}),_.duration&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Kl,{className:"h-4 w-4"}),f.jsxs("span",{children:[Math.floor(_.duration/60),":",(_.duration%60).toString().padStart(2,"0")]})]})]}),f.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-red-600 hover:text-red-800",children:[f.jsx(_T,{className:"h-4 w-4"}),f.jsx("span",{children:"Open Original"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(nr,{className:"h-5 w-5 mr-2 text-blue-500"}),"Video Metadata"]}),f.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"autoTitle",className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto-detected Title"}),f.jsx("input",{type:"text",id:"autoTitle",value:c,onChange:P=>d(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Title will be auto-detected from video platform"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This can be used as a fallback title if main title is empty"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"autoDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto-detected Description"}),f.jsx("textarea",{id:"autoDescription",rows:3,value:p,onChange:P=>h(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Description will be auto-detected from video platform"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-populated from the video platform's metadata"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[f.jsx(nr,{className:"h-5 w-5 mr-2 text-purple-500"}),"Video Transcription"]}),f.jsx("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:o.trim()&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(nr,{className:"h-4 w-4"}),f.jsxs("span",{children:[o.trim().split(/\s+/).length," words"]})]}),f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Kl,{className:"h-4 w-4"}),f.jsxs("span",{children:[C(o)," min read"]})]})]})})]}),f.jsxs("div",{children:[f.jsx("textarea",{value:o,onChange:P=>l(P.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter the video transcription here...\\n\\nThis text will be searchable and can be used for generating subtitles or providing accessible content for users."}),f.jsx("div",{className:"mt-3 p-3 bg-purple-50 rounded-lg",children:f.jsxs("p",{className:"text-xs text-purple-700",children:[f.jsx("strong",{children:"Accessibility Tip:"})," Adding transcriptions makes your video content accessible to hearing-impaired users and improves SEO by making video content searchable."]})})]})]}),_&&f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Technical Information"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Platform"}),f.jsx("p",{className:"text-gray-900 capitalize",children:_.platform})]}),_.videoId&&f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Video ID"}),f.jsx("p",{className:"text-gray-900 font-mono text-xs",children:_.videoId})]}),_.duration&&f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Duration"}),f.jsxs("p",{className:"text-gray-900",children:[Math.floor(_.duration/3600),"h ",Math.floor(_.duration%3600/60),"m ",_.duration%60,"s"]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"URL"}),f.jsx("p",{className:"text-gray-900 truncate",title:i,children:i})]})]})]})]})})}var Pf={exports:{}};/*!
`)}return de}function Te(ue,de){var xe={},je=ue.style||{};return je.fontStyle&&ee(ue).fontStyle==="italic"&&(xe.italic=!0),je.fontWeight&&(ee(ue).fontWeight.startsWith("bold")||parseInt(ee(ue).fontWeight)>=700)&&(xe.bold=!0),Object.keys(xe).length>0&&(de=H(de,xe)),parseFloat(je.textIndent||0)>0&&(de=new h.default().insert("	").concat(de)),de}function Ie(ue,de){var xe=ue.data;if(ue.parentNode.tagName==="O:P")return de.insert(xe.trim());if(xe.trim().length===0&&ue.parentNode.classList.contains("ql-clipboard"))return de;if(!ee(ue.parentNode).whiteSpace.startsWith("pre")){var je=function(qe,Ue){return Ue=Ue.replace(/[^\u00a0]/g,""),Ue.length<1&&qe?" ":Ue};xe=xe.replace(/\r\n/g," ").replace(/\n/g," "),xe=xe.replace(/\s\s+/g,je.bind(je,!0)),(ue.previousSibling==null&&K(ue.parentNode)||ue.previousSibling!=null&&K(ue.previousSibling))&&(xe=xe.replace(/^\s+/,je.bind(je,!1))),(ue.nextSibling==null&&K(ue.parentNode)||ue.nextSibling!=null&&K(ue.nextSibling))&&(xe=xe.replace(/\s+$/,je.bind(je,!1)))}return de.insert(xe)}n.default=q,n.matchAttributor=Q,n.matchBlot=oe,n.matchNewline=ae,n.matchSpacing=ye,n.matchText=Ie},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(b,y){for(var j=0;j<y.length;j++){var _=y[j];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(b,_.key,_)}}return function(b,y,j){return y&&x(b.prototype,y),j&&x(b,j),b}}(),o=function x(b,y,j){b===null&&(b=Function.prototype);var _=Object.getOwnPropertyDescriptor(b,y);if(_===void 0){var S=Object.getPrototypeOf(b);return S===null?void 0:x(S,y,j)}else{if("value"in _)return _.value;var w=_.get;return w===void 0?void 0:w.call(j)}},l=i(6),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function p(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function h(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function m(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=function(x){m(b,x);function b(){return p(this,b),h(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return a(b,[{key:"optimize",value:function(j){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,j),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),b}(c.default);v.blotName="bold",v.tagName=["STRONG","B"],n.default=v},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var a=function(){function A(T,L){var $=[],B=!0,U=!1,V=void 0;try{for(var X=T[Symbol.iterator](),G;!(B=(G=X.next()).done)&&($.push(G.value),!(L&&$.length===L));B=!0);}catch(F){U=!0,V=F}finally{try{!B&&X.return&&X.return()}finally{if(U)throw V}}return $}return function(T,L){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return A(T,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function A(T,L){for(var $=0;$<L.length;$++){var B=L[$];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(T,B.key,B)}}return function(T,L,$){return L&&A(T.prototype,L),$&&A(T,$),T}}(),l=i(2),c=j(l),d=i(0),p=j(d),h=i(5),m=j(h),v=i(10),x=j(v),b=i(9),y=j(b);function j(A){return A&&A.__esModule?A:{default:A}}function _(A,T,L){return T in A?Object.defineProperty(A,T,{value:L,enumerable:!0,configurable:!0,writable:!0}):A[T]=L,A}function S(A,T){if(!(A instanceof T))throw new TypeError("Cannot call a class as a function")}function w(A,T){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:A}function O(A,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);A.prototype=Object.create(T&&T.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(A,T):A.__proto__=T)}var k=(0,x.default)("quill:toolbar"),E=function(A){O(T,A);function T(L,$){S(this,T);var B=w(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,L,$));if(Array.isArray(B.options.container)){var U=document.createElement("div");I(U,B.options.container),L.container.parentNode.insertBefore(U,L.container),B.container=U}else typeof B.options.container=="string"?B.container=document.querySelector(B.options.container):B.container=B.options.container;if(!(B.container instanceof HTMLElement)){var V;return V=k.error("Container required for toolbar",B.options),w(B,V)}return B.container.classList.add("ql-toolbar"),B.controls=[],B.handlers={},Object.keys(B.options.handlers).forEach(function(X){B.addHandler(X,B.options.handlers[X])}),[].forEach.call(B.container.querySelectorAll("button, select"),function(X){B.attach(X)}),B.quill.on(m.default.events.EDITOR_CHANGE,function(X,G){X===m.default.events.SELECTION_CHANGE&&B.update(G)}),B.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){var X=B.quill.selection.getRange(),G=a(X,1),F=G[0];B.update(F)}),B}return o(T,[{key:"addHandler",value:function($,B){this.handlers[$]=B}},{key:"attach",value:function($){var B=this,U=[].find.call($.classList,function(X){return X.indexOf("ql-")===0});if(U){if(U=U.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[U]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[U]==null){k.warn("ignoring attaching to disabled format",U,$);return}if(p.default.query(U)==null){k.warn("ignoring attaching to nonexistent format",U,$);return}}var V=$.tagName==="SELECT"?"change":"click";$.addEventListener(V,function(X){var G=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var F=$.options[$.selectedIndex];F.hasAttribute("selected")?G=!1:G=F.value||!1}else $.classList.contains("ql-active")?G=!1:G=$.value||!$.hasAttribute("value"),X.preventDefault();B.quill.focus();var R=B.quill.selection.getRange(),q=a(R,1),H=q[0];if(B.handlers[U]!=null)B.handlers[U].call(B,G);else if(p.default.query(U).prototype instanceof p.default.Embed){if(G=prompt("Enter "+U),!G)return;B.quill.updateContents(new c.default().retain(H.index).delete(H.length).insert(_({},U,G)),m.default.sources.USER)}else B.quill.format(U,G,m.default.sources.USER);B.update(H)}),this.controls.push([U,$])}}},{key:"update",value:function($){var B=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(U){var V=a(U,2),X=V[0],G=V[1];if(G.tagName==="SELECT"){var F=void 0;if($==null)F=null;else if(B[X]==null)F=G.querySelector("option[selected]");else if(!Array.isArray(B[X])){var R=B[X];typeof R=="string"&&(R=R.replace(/\"/g,'\\"')),F=G.querySelector('option[value="'+R+'"]')}F==null?(G.value="",G.selectedIndex=-1):F.selected=!0}else if($==null)G.classList.remove("ql-active");else if(G.hasAttribute("value")){var q=B[X]===G.getAttribute("value")||B[X]!=null&&B[X].toString()===G.getAttribute("value")||B[X]==null&&!G.getAttribute("value");G.classList.toggle("ql-active",q)}else G.classList.toggle("ql-active",B[X]!=null)})}}]),T}(y.default);E.DEFAULTS={};function C(A,T,L){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+T),L!=null&&($.value=L),A.appendChild($)}function I(A,T){Array.isArray(T[0])||(T=[T]),T.forEach(function(L){var $=document.createElement("span");$.classList.add("ql-formats"),L.forEach(function(B){if(typeof B=="string")C($,B);else{var U=Object.keys(B)[0],V=B[U];Array.isArray(V)?P($,U,V):C($,U,V)}}),A.appendChild($)})}function P(A,T,L){var $=document.createElement("select");$.classList.add("ql-"+T),L.forEach(function(B){var U=document.createElement("option");B!==!1?U.setAttribute("value",B):U.setAttribute("selected","selected"),$.appendChild(U)}),A.appendChild($)}E.DEFAULTS={container:null,handlers:{clean:function(){var T=this,L=this.quill.getSelection();if(L!=null)if(L.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(B){p.default.query(B,p.default.Scope.INLINE)!=null&&T.quill.format(B,!1)})}else this.quill.removeFormat(L,m.default.sources.USER)},direction:function(T){var L=this.quill.getFormat().align;T==="rtl"&&L==null?this.quill.format("align","right",m.default.sources.USER):!T&&L==="right"&&this.quill.format("align",!1,m.default.sources.USER),this.quill.format("direction",T,m.default.sources.USER)},indent:function(T){var L=this.quill.getSelection(),$=this.quill.getFormat(L),B=parseInt($.indent||0);if(T==="+1"||T==="-1"){var U=T==="+1"?1:-1;$.direction==="rtl"&&(U*=-1),this.quill.format("indent",B+U,m.default.sources.USER)}},link:function(T){T===!0&&(T=prompt("Enter link URL:")),this.quill.format("link",T,m.default.sources.USER)},list:function(T){var L=this.quill.getSelection(),$=this.quill.getFormat(L);T==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,m.default.sources.USER):this.quill.format("list","unchecked",m.default.sources.USER):this.quill.format("list",T,m.default.sources.USER)}}},n.default=E,n.addControls=I},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(b,y){for(var j=0;j<y.length;j++){var _=y[j];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(b,_.key,_)}}return function(b,y,j){return y&&x(b.prototype,y),j&&x(b,j),b}}(),o=function x(b,y,j){b===null&&(b=Function.prototype);var _=Object.getOwnPropertyDescriptor(b,y);if(_===void 0){var S=Object.getPrototypeOf(b);return S===null?void 0:x(S,y,j)}else{if("value"in _)return _.value;var w=_.get;return w===void 0?void 0:w.call(j)}},l=i(28),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function p(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function h(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function m(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=function(x){m(b,x);function b(y,j){p(this,b);var _=h(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,y));return _.label.innerHTML=j,_.container.classList.add("ql-color-picker"),[].slice.call(_.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(S){S.classList.add("ql-primary")}),_}return a(b,[{key:"buildItem",value:function(j){var _=o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"buildItem",this).call(this,j);return _.style.backgroundColor=j.getAttribute("value")||"",_}},{key:"selectItem",value:function(j,_){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"selectItem",this).call(this,j,_);var S=this.label.querySelector(".ql-color-label"),w=j&&j.getAttribute("data-value")||"";S&&(S.tagName==="line"?S.style.stroke=w:S.style.fill=w)}}]),b}(c.default);n.default=v},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(b,y){for(var j=0;j<y.length;j++){var _=y[j];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(b,_.key,_)}}return function(b,y,j){return y&&x(b.prototype,y),j&&x(b,j),b}}(),o=function x(b,y,j){b===null&&(b=Function.prototype);var _=Object.getOwnPropertyDescriptor(b,y);if(_===void 0){var S=Object.getPrototypeOf(b);return S===null?void 0:x(S,y,j)}else{if("value"in _)return _.value;var w=_.get;return w===void 0?void 0:w.call(j)}},l=i(28),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function p(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function h(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function m(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=function(x){m(b,x);function b(y,j){p(this,b);var _=h(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,y));return _.container.classList.add("ql-icon-picker"),[].forEach.call(_.container.querySelectorAll(".ql-picker-item"),function(S){S.innerHTML=j[S.getAttribute("data-value")||""]}),_.defaultItem=_.container.querySelector(".ql-selected"),_.selectItem(_.defaultItem),_}return a(b,[{key:"selectItem",value:function(j,_){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"selectItem",this).call(this,j,_),j=j||this.defaultItem,this.label.innerHTML=j.innerHTML}}]),b}(c.default);n.default=v},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function c(d,p){for(var h=0;h<p.length;h++){var m=p[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(d,m.key,m)}}return function(d,p,h){return p&&c(d.prototype,p),h&&c(d,h),d}}();function o(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(d,p){var h=this;o(this,c),this.quill=d,this.boundsContainer=p||document.body,this.root=d.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){h.root.style.marginTop=-1*h.quill.root.scrollTop+"px"}),this.hide()}return a(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(p){var h=p.left+p.width/2-this.root.offsetWidth/2,m=p.bottom+this.quill.root.scrollTop;this.root.style.left=h+"px",this.root.style.top=m+"px",this.root.classList.remove("ql-flip");var v=this.boundsContainer.getBoundingClientRect(),x=this.root.getBoundingClientRect(),b=0;if(x.right>v.right&&(b=v.right-x.right,this.root.style.left=h+b+"px"),x.left<v.left&&(b=v.left-x.left,this.root.style.left=h+b+"px"),x.bottom>v.bottom){var y=x.bottom-x.top,j=p.bottom-p.top+y;this.root.style.top=m-j+"px",this.root.classList.add("ql-flip")}return b}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c}();n.default=l},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function P(A,T){var L=[],$=!0,B=!1,U=void 0;try{for(var V=A[Symbol.iterator](),X;!($=(X=V.next()).done)&&(L.push(X.value),!(T&&L.length===T));$=!0);}catch(G){B=!0,U=G}finally{try{!$&&V.return&&V.return()}finally{if(B)throw U}}return L}return function(A,T){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return P(A,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function P(A,T,L){A===null&&(A=Function.prototype);var $=Object.getOwnPropertyDescriptor(A,T);if($===void 0){var B=Object.getPrototypeOf(A);return B===null?void 0:P(B,T,L)}else{if("value"in $)return $.value;var U=$.get;return U===void 0?void 0:U.call(L)}},l=function(){function P(A,T){for(var L=0;L<T.length;L++){var $=T[L];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(A,$.key,$)}}return function(A,T,L){return T&&P(A.prototype,T),L&&P(A,L),A}}(),c=i(3),d=S(c),p=i(8),h=S(p),m=i(43),v=S(m),x=i(27),b=S(x),y=i(15),j=i(41),_=S(j);function S(P){return P&&P.__esModule?P:{default:P}}function w(P,A){if(!(P instanceof A))throw new TypeError("Cannot call a class as a function")}function O(P,A){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:P}function k(P,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);P.prototype=Object.create(A&&A.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(P,A):P.__proto__=A)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],C=function(P){k(A,P);function A(T,L){w(this,A),L.modules.toolbar!=null&&L.modules.toolbar.container==null&&(L.modules.toolbar.container=E);var $=O(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,L));return $.quill.container.classList.add("ql-snow"),$}return l(A,[{key:"extendToolbar",value:function(L){L.container.classList.add("ql-snow"),this.buildButtons([].slice.call(L.container.querySelectorAll("button")),_.default),this.buildPickers([].slice.call(L.container.querySelectorAll("select")),_.default),this.tooltip=new I(this.quill,this.options.bounds),L.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,B){L.handlers.link.call(L,!B.format.link)})}}]),A}(v.default);C.DEFAULTS=(0,d.default)(!0,{},v.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(A){if(A){var T=this.quill.getSelection();if(T==null||T.length==0)return;var L=this.quill.getText(T);/^\S+@\S+\.\S+$/.test(L)&&L.indexOf("mailto:")!==0&&(L="mailto:"+L);var $=this.quill.theme.tooltip;$.edit("link",L)}else this.quill.format("link",!1)}}}}});var I=function(P){k(A,P);function A(T,L){w(this,A);var $=O(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,L));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(A,[{key:"listen",value:function(){var L=this;o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){L.root.classList.contains("ql-editing")?L.save():L.edit("link",L.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(L.linkRange!=null){var B=L.linkRange;L.restoreFocus(),L.quill.formatText(B,"link",!1,h.default.sources.USER),delete L.linkRange}$.preventDefault(),L.hide()}),this.quill.on(h.default.events.SELECTION_CHANGE,function($,B,U){if($!=null){if($.length===0&&U===h.default.sources.USER){var V=L.quill.scroll.descendant(b.default,$.index),X=a(V,2),G=X[0],F=X[1];if(G!=null){L.linkRange=new y.Range($.index-F,G.length());var R=b.default.formats(G.domNode);L.preview.textContent=R,L.preview.setAttribute("href",R),L.show(),L.position(L.quill.getBounds(L.linkRange));return}}else delete L.linkRange;L.hide()}})}},{key:"show",value:function(){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),A}(m.BaseTooltip);I.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=C},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(29),o=me(a),l=i(36),c=i(38),d=i(64),p=i(65),h=me(p),m=i(66),v=me(m),x=i(67),b=me(x),y=i(37),j=i(26),_=i(39),S=i(40),w=i(56),O=me(w),k=i(68),E=me(k),C=i(27),I=me(C),P=i(69),A=me(P),T=i(70),L=me(T),$=i(71),B=me($),U=i(72),V=me(U),X=i(73),G=me(X),F=i(13),R=me(F),q=i(74),H=me(q),ee=i(75),J=me(ee),K=i(57),Y=me(K),re=i(41),Q=me(re),oe=i(28),pe=me(oe),ce=i(59),Oe=me(ce),ae=i(60),ye=me(ae),Te=i(61),Ie=me(Te),ue=i(108),de=me(ue),xe=i(62),je=me(xe);function me(qe){return qe&&qe.__esModule?qe:{default:qe}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":y.BackgroundClass,"attributors/class/color":j.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":_.FontClass,"attributors/class/size":S.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":y.BackgroundStyle,"attributors/style/color":j.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":_.FontStyle,"attributors/style/size":S.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":d.IndentClass,"formats/background":y.BackgroundStyle,"formats/color":j.ColorStyle,"formats/font":_.FontClass,"formats/size":S.SizeClass,"formats/blockquote":h.default,"formats/code-block":R.default,"formats/header":v.default,"formats/list":b.default,"formats/bold":O.default,"formats/code":F.Code,"formats/italic":E.default,"formats/link":I.default,"formats/script":A.default,"formats/strike":L.default,"formats/underline":B.default,"formats/image":V.default,"formats/video":G.default,"formats/list/item":x.ListItem,"modules/formula":H.default,"modules/syntax":J.default,"modules/toolbar":Y.default,"themes/bubble":de.default,"themes/snow":je.default,"ui/icons":Q.default,"ui/picker":pe.default,"ui/icon-picker":ye.default,"ui/color-picker":Oe.default,"ui/tooltip":Ie.default},!0),n.default=o.default},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var a=function(){function b(y,j){for(var _=0;_<j.length;_++){var S=j[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(y,S.key,S)}}return function(y,j,_){return j&&b(y.prototype,j),_&&b(y,_),y}}(),o=function b(y,j,_){y===null&&(y=Function.prototype);var S=Object.getOwnPropertyDescriptor(y,j);if(S===void 0){var w=Object.getPrototypeOf(y);return w===null?void 0:b(w,j,_)}else{if("value"in S)return S.value;var O=S.get;return O===void 0?void 0:O.call(_)}},l=i(0),c=d(l);function d(b){return b&&b.__esModule?b:{default:b}}function p(b,y){if(!(b instanceof y))throw new TypeError("Cannot call a class as a function")}function h(b,y){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:b}function m(b,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);b.prototype=Object.create(y&&y.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(b,y):b.__proto__=y)}var v=function(b){m(y,b);function y(){return p(this,y),h(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return a(y,[{key:"add",value:function(_,S){if(S==="+1"||S==="-1"){var w=this.value(_)||0;S=S==="+1"?w+1:w-1}return S===0?(this.remove(_),!0):o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"add",this).call(this,_,S)}},{key:"canAdd",value:function(_,S){return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,_,S)||o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,_,parseInt(S))}},{key:"value",value:function(_){return parseInt(o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"value",this).call(this,_))||void 0}}]),y}(c.default.Attributor.Class),x=new v("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=x},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(4),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function c(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function d(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:m}function p(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}var h=function(m){p(v,m);function v(){return c(this,v),d(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);h.blotName="blockquote",h.tagName="blockquote",n.default=h},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function v(x,b){for(var y=0;y<b.length;y++){var j=b[y];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(x,j.key,j)}}return function(x,b,y){return b&&v(x.prototype,b),y&&v(x,y),x}}(),o=i(4),l=c(o);function c(v){return v&&v.__esModule?v:{default:v}}function d(v,x){if(!(v instanceof x))throw new TypeError("Cannot call a class as a function")}function p(v,x){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:v}function h(v,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);v.prototype=Object.create(x&&x.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(v,x):v.__proto__=x)}var m=function(v){h(x,v);function x(){return d(this,x),p(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return a(x,null,[{key:"formats",value:function(y){return this.tagName.indexOf(y.tagName)+1}}]),x}(l.default);m.blotName="header",m.tagName=["H1","H2","H3","H4","H5","H6"],n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var a=function(){function w(O,k){for(var E=0;E<k.length;E++){var C=k[E];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(O,C.key,C)}}return function(O,k,E){return k&&w(O.prototype,k),E&&w(O,E),O}}(),o=function w(O,k,E){O===null&&(O=Function.prototype);var C=Object.getOwnPropertyDescriptor(O,k);if(C===void 0){var I=Object.getPrototypeOf(O);return I===null?void 0:w(I,k,E)}else{if("value"in C)return C.value;var P=C.get;return P===void 0?void 0:P.call(E)}},l=i(0),c=v(l),d=i(4),p=v(d),h=i(25),m=v(h);function v(w){return w&&w.__esModule?w:{default:w}}function x(w,O,k){return O in w?Object.defineProperty(w,O,{value:k,enumerable:!0,configurable:!0,writable:!0}):w[O]=k,w}function b(w,O){if(!(w instanceof O))throw new TypeError("Cannot call a class as a function")}function y(w,O){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:w}function j(w,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);w.prototype=Object.create(O&&O.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(w,O):w.__proto__=O)}var _=function(w){j(O,w);function O(){return b(this,O),y(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return a(O,[{key:"format",value:function(E,C){E===S.blotName&&!C?this.replaceWith(c.default.create(this.statics.scope)):o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"format",this).call(this,E,C)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,C){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,C),this):(this.parent.unwrap(),o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replaceWith",this).call(this,E,C))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:o(O.__proto__||Object.getPrototypeOf(O),"formats",this).call(this,E)}}]),O}(p.default);_.blotName="list-item",_.tagName="LI";var S=function(w){j(O,w),a(O,null,[{key:"create",value:function(E){var C=E==="ordered"?"OL":"UL",I=o(O.__proto__||Object.getPrototypeOf(O),"create",this).call(this,C);return(E==="checked"||E==="unchecked")&&I.setAttribute("data-checked",E==="checked"),I}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function O(k){b(this,O);var E=y(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,k)),C=function(P){if(P.target.parentNode===k){var A=E.statics.formats(k),T=c.default.find(P.target);A==="checked"?T.format("list","unchecked"):A==="unchecked"&&T.format("list","checked")}};return k.addEventListener("touchstart",C),k.addEventListener("mousedown",C),E}return a(O,[{key:"format",value:function(E,C){this.children.length>0&&this.children.tail.format(E,C)}},{key:"formats",value:function(){return x({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,C){if(E instanceof _)o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertBefore",this).call(this,E,C);else{var I=C==null?this.length():C.offset(this),P=this.split(I);P.parent.insertBefore(E,P)}}},{key:"optimize",value:function(E){o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"optimize",this).call(this,E);var C=this.next;C!=null&&C.prev===this&&C.statics.blotName===this.statics.blotName&&C.domNode.tagName===this.domNode.tagName&&C.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(C.moveChildren(this),C.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var C=c.default.create(this.statics.defaultChild);E.moveChildren(C),this.appendChild(C)}o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replace",this).call(this,E)}}]),O}(m.default);S.blotName="list",S.scope=c.default.Scope.BLOCK_BLOT,S.tagName=["OL","UL"],S.defaultChild="list-item",S.allowedChildren=[_],n.ListItem=_,n.default=S},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(56),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function c(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function d(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:m}function p(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}var h=function(m){p(v,m);function v(){return c(this,v),d(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);h.blotName="italic",h.tagName=["EM","I"],n.default=h},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(b,y){for(var j=0;j<y.length;j++){var _=y[j];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(b,_.key,_)}}return function(b,y,j){return y&&x(b.prototype,y),j&&x(b,j),b}}(),o=function x(b,y,j){b===null&&(b=Function.prototype);var _=Object.getOwnPropertyDescriptor(b,y);if(_===void 0){var S=Object.getPrototypeOf(b);return S===null?void 0:x(S,y,j)}else{if("value"in _)return _.value;var w=_.get;return w===void 0?void 0:w.call(j)}},l=i(6),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function p(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function h(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function m(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=function(x){m(b,x);function b(){return p(this,b),h(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return a(b,null,[{key:"create",value:function(j){return j==="super"?document.createElement("sup"):j==="sub"?document.createElement("sub"):o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,j)}},{key:"formats",value:function(j){if(j.tagName==="SUB")return"sub";if(j.tagName==="SUP")return"super"}}]),b}(c.default);v.blotName="script",v.tagName=["SUB","SUP"],n.default=v},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(6),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function c(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function d(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:m}function p(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}var h=function(m){p(v,m);function v(){return c(this,v),d(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);h.blotName="strike",h.tagName="S",n.default=h},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(6),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function c(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function d(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:m}function p(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}var h=function(m){p(v,m);function v(){return c(this,v),d(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);h.blotName="underline",h.tagName="U",n.default=h},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function y(j,_){for(var S=0;S<_.length;S++){var w=_[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(j,w.key,w)}}return function(j,_,S){return _&&y(j.prototype,_),S&&y(j,S),j}}(),o=function y(j,_,S){j===null&&(j=Function.prototype);var w=Object.getOwnPropertyDescriptor(j,_);if(w===void 0){var O=Object.getPrototypeOf(j);return O===null?void 0:y(O,_,S)}else{if("value"in w)return w.value;var k=w.get;return k===void 0?void 0:k.call(S)}},l=i(0),c=p(l),d=i(27);function p(y){return y&&y.__esModule?y:{default:y}}function h(y,j){if(!(y instanceof j))throw new TypeError("Cannot call a class as a function")}function m(y,j){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:y}function v(y,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);y.prototype=Object.create(j&&j.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(y,j):y.__proto__=j)}var x=["alt","height","width"],b=function(y){v(j,y);function j(){return h(this,j),m(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return a(j,[{key:"format",value:function(S,w){x.indexOf(S)>-1?w?this.domNode.setAttribute(S,w):this.domNode.removeAttribute(S):o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"format",this).call(this,S,w)}}],[{key:"create",value:function(S){var w=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,S);return typeof S=="string"&&w.setAttribute("src",this.sanitize(S)),w}},{key:"formats",value:function(S){return x.reduce(function(w,O){return S.hasAttribute(O)&&(w[O]=S.getAttribute(O)),w},{})}},{key:"match",value:function(S){return/\.(jpe?g|gif|png)$/.test(S)||/^data:image\/.+;base64/.test(S)}},{key:"sanitize",value:function(S){return(0,d.sanitize)(S,["http","https","data"])?S:"//:0"}},{key:"value",value:function(S){return S.getAttribute("src")}}]),j}(c.default.Embed);b.blotName="image",b.tagName="IMG",n.default=b},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function y(j,_){for(var S=0;S<_.length;S++){var w=_[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(j,w.key,w)}}return function(j,_,S){return _&&y(j.prototype,_),S&&y(j,S),j}}(),o=function y(j,_,S){j===null&&(j=Function.prototype);var w=Object.getOwnPropertyDescriptor(j,_);if(w===void 0){var O=Object.getPrototypeOf(j);return O===null?void 0:y(O,_,S)}else{if("value"in w)return w.value;var k=w.get;return k===void 0?void 0:k.call(S)}},l=i(4),c=i(27),d=p(c);function p(y){return y&&y.__esModule?y:{default:y}}function h(y,j){if(!(y instanceof j))throw new TypeError("Cannot call a class as a function")}function m(y,j){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:y}function v(y,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);y.prototype=Object.create(j&&j.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(y,j):y.__proto__=j)}var x=["height","width"],b=function(y){v(j,y);function j(){return h(this,j),m(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return a(j,[{key:"format",value:function(S,w){x.indexOf(S)>-1?w?this.domNode.setAttribute(S,w):this.domNode.removeAttribute(S):o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"format",this).call(this,S,w)}}],[{key:"create",value:function(S){var w=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,S);return w.setAttribute("frameborder","0"),w.setAttribute("allowfullscreen",!0),w.setAttribute("src",this.sanitize(S)),w}},{key:"formats",value:function(S){return x.reduce(function(w,O){return S.hasAttribute(O)&&(w[O]=S.getAttribute(O)),w},{})}},{key:"sanitize",value:function(S){return d.default.sanitize(S)}},{key:"value",value:function(S){return S.getAttribute("src")}}]),j}(l.BlockEmbed);b.blotName="video",b.className="ql-video",b.tagName="IFRAME",n.default=b},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var a=function(){function S(w,O){for(var k=0;k<O.length;k++){var E=O[k];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,O,k){return O&&S(w.prototype,O),k&&S(w,k),w}}(),o=function S(w,O,k){w===null&&(w=Function.prototype);var E=Object.getOwnPropertyDescriptor(w,O);if(E===void 0){var C=Object.getPrototypeOf(w);return C===null?void 0:S(C,O,k)}else{if("value"in E)return E.value;var I=E.get;return I===void 0?void 0:I.call(k)}},l=i(35),c=v(l),d=i(5),p=v(d),h=i(9),m=v(h);function v(S){return S&&S.__esModule?S:{default:S}}function x(S,w){if(!(S instanceof w))throw new TypeError("Cannot call a class as a function")}function b(S,w){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:S}function y(S,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);S.prototype=Object.create(w&&w.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(S,w):S.__proto__=w)}var j=function(S){y(w,S);function w(){return x(this,w),b(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return a(w,null,[{key:"create",value:function(k){var E=o(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,k);return typeof k=="string"&&(window.katex.render(k,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",k)),E}},{key:"value",value:function(k){return k.getAttribute("data-value")}}]),w}(c.default);j.blotName="formula",j.className="ql-formula",j.tagName="SPAN";var _=function(S){y(w,S),a(w,null,[{key:"register",value:function(){p.default.register(j,!0)}}]);function w(){x(this,w);var O=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return O}return w}(m.default);n.FormulaBlot=j,n.default=_},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var a=function(){function k(E,C){for(var I=0;I<C.length;I++){var P=C[I];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(E,P.key,P)}}return function(E,C,I){return C&&k(E.prototype,C),I&&k(E,I),E}}(),o=function k(E,C,I){E===null&&(E=Function.prototype);var P=Object.getOwnPropertyDescriptor(E,C);if(P===void 0){var A=Object.getPrototypeOf(E);return A===null?void 0:k(A,C,I)}else{if("value"in P)return P.value;var T=P.get;return T===void 0?void 0:T.call(I)}},l=i(0),c=b(l),d=i(5),p=b(d),h=i(9),m=b(h),v=i(13),x=b(v);function b(k){return k&&k.__esModule?k:{default:k}}function y(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function j(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function _(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var S=function(k){_(E,k);function E(){return y(this,E),j(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return a(E,[{key:"replaceWith",value:function(I){this.domNode.textContent=this.domNode.textContent,this.attach(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,I)}},{key:"highlight",value:function(I){var P=this.domNode.textContent;this.cachedText!==P&&((P.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=I(P),this.domNode.normalize(),this.attach()),this.cachedText=P)}}]),E}(x.default);S.className="ql-syntax";var w=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),O=function(k){_(E,k),a(E,null,[{key:"register",value:function(){p.default.register(w,!0),p.default.register(S,!0)}}]);function E(C,I){y(this,E);var P=j(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,C,I));if(typeof P.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var A=null;return P.quill.on(p.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(A),A=setTimeout(function(){P.highlight(),A=null},P.options.interval)}),P.highlight(),P}return a(E,[{key:"highlight",value:function(){var I=this;if(!this.quill.selection.composing){this.quill.update(p.default.sources.USER);var P=this.quill.getSelection();this.quill.scroll.descendants(S).forEach(function(A){A.highlight(I.options.highlight)}),this.quill.update(p.default.sources.SILENT),P!=null&&this.quill.setSelection(P,p.default.sources.SILENT)}}}]),E}(m.default);O.DEFAULTS={highlight:function(){return window.hljs==null?null:function(k){var E=window.hljs.highlightAuto(k);return E.value}}(),interval:1e3},n.CodeBlock=S,n.CodeToken=w,n.default=O},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var a=function E(C,I,P){C===null&&(C=Function.prototype);var A=Object.getOwnPropertyDescriptor(C,I);if(A===void 0){var T=Object.getPrototypeOf(C);return T===null?void 0:E(T,I,P)}else{if("value"in A)return A.value;var L=A.get;return L===void 0?void 0:L.call(P)}},o=function(){function E(C,I){for(var P=0;P<I.length;P++){var A=I[P];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(C,A.key,A)}}return function(C,I,P){return I&&E(C.prototype,I),P&&E(C,P),C}}(),l=i(3),c=y(l),d=i(8),p=y(d),h=i(43),m=y(h),v=i(15),x=i(41),b=y(x);function y(E){return E&&E.__esModule?E:{default:E}}function j(E,C){if(!(E instanceof C))throw new TypeError("Cannot call a class as a function")}function _(E,C){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:E}function S(E,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);E.prototype=Object.create(C&&C.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(E,C):E.__proto__=C)}var w=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],O=function(E){S(C,E);function C(I,P){j(this,C),P.modules.toolbar!=null&&P.modules.toolbar.container==null&&(P.modules.toolbar.container=w);var A=_(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,I,P));return A.quill.container.classList.add("ql-bubble"),A}return o(C,[{key:"extendToolbar",value:function(P){this.tooltip=new k(this.quill,this.options.bounds),this.tooltip.root.appendChild(P.container),this.buildButtons([].slice.call(P.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(P.container.querySelectorAll("select")),b.default)}}]),C}(m.default);O.DEFAULTS=(0,c.default)(!0,{},m.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(C){C?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var k=function(E){S(C,E);function C(I,P){j(this,C);var A=_(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,I,P));return A.quill.on(p.default.events.EDITOR_CHANGE,function(T,L,$,B){if(T===p.default.events.SELECTION_CHANGE)if(L!=null&&L.length>0&&B===p.default.sources.USER){A.show(),A.root.style.left="0px",A.root.style.width="",A.root.style.width=A.root.offsetWidth+"px";var U=A.quill.getLines(L.index,L.length);if(U.length===1)A.position(A.quill.getBounds(L));else{var V=U[U.length-1],X=A.quill.getIndex(V),G=Math.min(V.length()-1,L.index+L.length-X),F=A.quill.getBounds(new v.Range(X,G));A.position(F)}}else document.activeElement!==A.textbox&&A.quill.hasFocus()&&A.hide()}),A}return o(C,[{key:"listen",value:function(){var P=this;a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){P.root.classList.remove("ql-editing")}),this.quill.on(p.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!P.root.classList.contains("ql-hidden")){var A=P.quill.getSelection();A!=null&&P.position(P.quill.getBounds(A))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(P){var A=a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"position",this).call(this,P),T=this.root.querySelector(".ql-tooltip-arrow");if(T.style.marginLeft="",A===0)return A;T.style.marginLeft=-1*A-T.offsetWidth/2+"px"}}]),C}(h.BaseTooltip);k.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=k,n.default=O},function(r,n,i){r.exports=i(63)}]).default})}(Pf)),Pf.exports}var cn,DP;function Iee(){if(DP)return cn;DP=1;var t=cn&&cn.__extends||function(){var p=function(h,m){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,x){v.__proto__=x}||function(v,x){for(var b in x)x.hasOwnProperty(b)&&(v[b]=x[b])},p(h,m)};return function(h,m){p(h,m);function v(){this.constructor=h}h.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),e=cn&&cn.__assign||function(){return e=Object.assign||function(p){for(var h,m=1,v=arguments.length;m<v;m++){h=arguments[m];for(var x in h)Object.prototype.hasOwnProperty.call(h,x)&&(p[x]=h[x])}return p},e.apply(this,arguments)},r=cn&&cn.__spreadArrays||function(){for(var p=0,h=0,m=arguments.length;h<m;h++)p+=arguments[h].length;for(var v=Array(p),x=0,h=0;h<m;h++)for(var b=arguments[h],y=0,j=b.length;y<j;y++,x++)v[x]=b[y];return v},n=cn&&cn.__importDefault||function(p){return p&&p.__esModule?p:{default:p}},i=n(Ld()),a=n(jx()),o=n(dM()),l=n(Mee()),c=function(p){t(h,p);function h(m){var v=p.call(this,m)||this;v.dirtyProps=["modules","formats","bounds","theme","children"],v.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],v.state={generation:0},v.selection=null,v.onEditorChange=function(b,y,j,_){var S,w,O,k;b==="text-change"?(w=(S=v).onEditorChangeText)===null||w===void 0||w.call(S,v.editor.root.innerHTML,y,_,v.unprivilegedEditor):b==="selection-change"&&((k=(O=v).onEditorChangeSelection)===null||k===void 0||k.call(O,y,_,v.unprivilegedEditor))};var x=v.isControlled()?m.value:m.defaultValue;return v.value=x??"",v}return h.prototype.validateProps=function(m){var v;if(i.default.Children.count(m.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(m.children)){var x=i.default.Children.only(m.children);if(((v=x)===null||v===void 0?void 0:v.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&m.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},h.prototype.shouldComponentUpdate=function(m,v){var x=this,b;if(this.validateProps(m),!this.editor||this.state.generation!==v.generation)return!0;if("value"in m){var y=this.getEditorContents(),j=(b=m.value,b??"");this.isEqualValue(j,y)||this.setEditorContents(this.editor,j)}return m.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,m.readOnly),r(this.cleanProps,this.dirtyProps).some(function(_){return!o.default(m[_],x.props[_])})},h.prototype.shouldComponentRegenerate=function(m){var v=this;return this.dirtyProps.some(function(x){return!o.default(m[x],v.props[x])})},h.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},h.prototype.componentWillUnmount=function(){this.destroyEditor()},h.prototype.componentDidUpdate=function(m,v){var x=this;if(this.editor&&this.shouldComponentRegenerate(m)){var b=this.editor.getContents(),y=this.editor.getSelection();this.regenerationSnapshot={delta:b,selection:y},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==v.generation){var j=this.regenerationSnapshot,b=j.delta,_=j.selection;delete this.regenerationSnapshot,this.instantiateEditor();var S=this.editor;S.setContents(b),d(function(){return x.setEditorSelection(S,_)})}},h.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},h.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},h.prototype.isControlled=function(){return"value"in this.props},h.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},h.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},h.prototype.createEditor=function(m,v){var x=new l.default(m,v);return v.tabIndex!=null&&this.setEditorTabIndex(x,v.tabIndex),this.hookEditor(x),x},h.prototype.hookEditor=function(m){this.unprivilegedEditor=this.makeUnprivilegedEditor(m),m.on("editor-change",this.onEditorChange)},h.prototype.unhookEditor=function(m){m.off("editor-change",this.onEditorChange)},h.prototype.getEditorContents=function(){return this.value},h.prototype.getEditorSelection=function(){return this.selection},h.prototype.isDelta=function(m){return m&&m.ops},h.prototype.isEqualValue=function(m,v){return this.isDelta(m)&&this.isDelta(v)?o.default(m.ops,v.ops):o.default(m,v)},h.prototype.setEditorContents=function(m,v){var x=this;this.value=v;var b=this.getEditorSelection();typeof v=="string"?m.setContents(m.clipboard.convert(v)):m.setContents(v),d(function(){return x.setEditorSelection(m,b)})},h.prototype.setEditorSelection=function(m,v){if(this.selection=v,v){var x=m.getLength();v.index=Math.max(0,Math.min(v.index,x-1)),v.length=Math.max(0,Math.min(v.length,x-1-v.index)),m.setSelection(v)}},h.prototype.setEditorTabIndex=function(m,v){var x,b;!((b=(x=m)===null||x===void 0?void 0:x.scroll)===null||b===void 0)&&b.domNode&&(m.scroll.domNode.tabIndex=v)},h.prototype.setEditorReadOnly=function(m,v){v?m.disable():m.enable()},h.prototype.makeUnprivilegedEditor=function(m){var v=m;return{getHTML:function(){return v.root.innerHTML},getLength:v.getLength.bind(v),getText:v.getText.bind(v),getContents:v.getContents.bind(v),getSelection:v.getSelection.bind(v),getBounds:v.getBounds.bind(v)}},h.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var m=a.default.findDOMNode(this.editingArea);if(!m)throw new Error("Cannot find element for editing area");if(m.nodeType===3)throw new Error("Editing area cannot be a text node");return m},h.prototype.renderEditingArea=function(){var m=this,v=this.props,x=v.children,b=v.preserveWhitespace,y=this.state.generation,j={key:y,ref:function(_){m.editingArea=_}};return i.default.Children.count(x)?i.default.cloneElement(i.default.Children.only(x),j):b?i.default.createElement("pre",e({},j)):i.default.createElement("div",e({},j))},h.prototype.render=function(){var m;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(m=this.props.className,m??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},h.prototype.onEditorChangeText=function(m,v,x,b){var y,j;if(this.editor){var _=this.isDelta(this.value)?b.getContents():b.getHTML();_!==this.getEditorContents()&&(this.lastDeltaChangeSet=v,this.value=_,(j=(y=this.props).onChange)===null||j===void 0||j.call(y,m,v,x,b))}},h.prototype.onEditorChangeSelection=function(m,v,x){var b,y,j,_,S,w;if(this.editor){var O=this.getEditorSelection(),k=!O&&m,E=O&&!m;o.default(m,O)||(this.selection=m,(y=(b=this.props).onChangeSelection)===null||y===void 0||y.call(b,m,v,x),k?(_=(j=this.props).onFocus)===null||_===void 0||_.call(j,m,v,x):E&&((w=(S=this.props).onBlur)===null||w===void 0||w.call(S,O,v,x)))}},h.prototype.focus=function(){this.editor&&this.editor.focus()},h.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},h.displayName="React Quill",h.Quill=l.default,h.defaultProps={theme:"snow",modules:{},readOnly:!1},h}(i.default.Component);function d(p){Promise.resolve().then(p)}return cn=c,cn}var Ree=Iee();const Dee=et(Ree);function LP(){const{id:t}=ni(),e=!!t,r=z.useRef(null),[n,i]=z.useState(null),[a,o]=z.useState(""),[l,c]=z.useState(null),[d,p]=z.useState(e),[h,m]=z.useState(!1),[v,x]=z.useState({wordCount:0,characterCount:0,readingTime:0,paragraphs:0});z.useEffect(()=>{e&&t&&b()},[e,t]),z.useEffect(()=>{y(a)},[a]);const b=async()=>{if(t)try{const{data:O,error:k}=await we.from("documents").select("*").eq("content_item_id",t).maybeSingle();if(k)throw k;O&&(i(O),o(O.content_html||""),c(O.content_json))}catch(O){console.error("Error fetching document:",O)}finally{p(!1)}},y=O=>{const k=O.replace(/<[^>]*>/g,"").trim(),E=k?k.split(/\s+/).length:0,C=k.length,I=Math.ceil(E/200),P=O.split(/<\/p>/gi).length-1||(k?1:0);x({wordCount:E,characterCount:C,readingTime:Math.max(1,I),paragraphs:P})},j=async O=>{try{const k={content_item_id:O,content_html:a,content_json:l,word_count:v.wordCount,reading_time_minutes:v.readingTime};if(n){const{error:E}=await we.from("documents").update({...k,updated_at:new Date().toISOString()}).eq("id",n.id);if(E)throw E}else{const{error:E}=await we.from("documents").insert([k]);if(E)throw E}}catch(k){throw console.error("Error saving document data:",k),k}},_=(O,k,E,C)=>{o(O),c(C.getContents())},S={toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]},{size:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{align:[]}],["blockquote","code-block"],["link","image","video"],["clean"]]},clipboard:{matchVisual:!1}},w=["header","font","size","bold","italic","underline","strike","color","background","script","list","bullet","indent","align","blockquote","code-block","link","image","video"];return d?f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading document..."})]})}):f.jsx(Ku,{contentType:"document",isEdit:e,onSaveContent:j,title:"Documents",description:"Rich text documents and guides",color:"#10B981",icon:nr,children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(If,{className:"h-5 w-5 mr-2 text-green-500"}),"Document Statistics"]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v.wordCount.toLocaleString()}),f.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide font-medium",children:"Words"})]}),f.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:v.characterCount.toLocaleString()}),f.jsx("div",{className:"text-xs text-green-600 uppercase tracking-wide font-medium",children:"Characters"})]}),f.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-purple-600",children:v.readingTime}),f.jsx("div",{className:"text-xs text-purple-600 uppercase tracking-wide font-medium",children:"Min Read"})]}),f.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-orange-600",children:v.paragraphs}),f.jsx("div",{className:"text-xs text-orange-600 uppercase tracking-wide font-medium",children:"Paragraphs"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[f.jsx(g$,{className:"h-5 w-5 mr-2 text-green-500"}),"Document Content"]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:()=>m(!1),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${h?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-green-100 text-green-700"}`,children:[f.jsx(i$,{className:"h-4 w-4 mr-1 inline"}),"Edit"]}),f.jsxs("button",{onClick:()=>m(!0),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${h?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[f.jsx(Bi,{className:"h-4 w-4 mr-1 inline"}),"Preview"]})]})]}),h?f.jsx("div",{className:"prose max-w-none",children:f.jsx("div",{className:"min-h-96 p-6 border border-gray-200 rounded-lg bg-gray-50",children:a?f.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:a}}):f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(nr,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),f.jsx("p",{children:"No content to preview"}),f.jsx("p",{className:"text-sm mt-1",children:"Switch to Edit mode to start writing"})]})})}):f.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:f.jsx(Dee,{ref:r,theme:"snow",value:a,onChange:_,modules:S,formats:w,placeholder:"Start writing your document content here...\\n\\nYou can use the toolbar above to format text, add images, create lists, and more. This editor supports rich text formatting similar to Google Docs or Microsoft Word.",style:{minHeight:"400px",fontSize:"16px",lineHeight:"1.6"}})}),f.jsx("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx(nr,{className:"h-4 w-4 text-green-600 mt-0.5"}),f.jsxs("div",{className:"text-sm text-green-700",children:[f.jsx("p",{className:"font-medium mb-1",children:"Professional Document Editor"}),f.jsx("p",{className:"text-xs leading-relaxed",children:"This rich-text editor supports all standard formatting options including headers, lists, links, images, and code blocks. Content is automatically saved and can be exported or shared with clients."})]})]})})]}),n&&f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Metadata"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Word Count"}),f.jsxs("p",{className:"text-gray-900",children:[v.wordCount.toLocaleString()," words"]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Reading Time"}),f.jsxs("p",{className:"text-gray-900",children:[v.readingTime," minute",v.readingTime!==1?"s":""]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Last Updated"}),f.jsx("p",{className:"text-gray-900",children:new Date(n.updated_at).toLocaleString()})]}),f.jsxs("div",{children:[f.jsx("label",{className:"font-medium text-gray-700",children:"Document ID"}),f.jsx("p",{className:"text-gray-900 font-mono text-xs",children:n.id})]})]})]})]})})}const Lee=["General","Creative Writing","Business","Technical","Educational","Marketing","Customer Support","Data Analysis","Programming","Research","Social Media","Email","Other"];function $P(){const{id:t}=ni(),e=!!t,[r,n]=z.useState(null),[i,a]=z.useState(""),[o,l]=z.useState("General"),[c,d]=z.useState(e),[p,h]=z.useState(!1),[m,v]=z.useState({characterCount:0,wordCount:0,lineCount:0,variables:[]});z.useEffect(()=>{e&&t&&x()},[e,t]),z.useEffect(()=>{b(i)},[i]);const x=async()=>{if(t)try{const{data:S,error:w}=await we.from("prompts").select("*").eq("content_item_id",t).maybeSingle();if(w)throw w;S&&(n(S),a(S.prompt_text||""),l(S.prompt_category||"General"))}catch(S){console.error("Error fetching prompt:",S)}finally{d(!1)}},b=S=>{const w=S.length,O=S.trim()?S.trim().split(/\s+/).length:0,k=S.split(`
`).length,E=S.match(/\{([^}]+)\}|\[([^\]]+)\]/g)||[],C=[...new Set(E.map(I=>I.replace(/[{}\[\]]/g,"")))];v({characterCount:w,wordCount:O,lineCount:k,variables:C})},y=async()=>{try{await navigator.clipboard.writeText(i),h(!0),setTimeout(()=>h(!1),2e3),r&&(await we.from("prompts").update({usage_count:(r.usage_count||0)+1,last_copied_at:new Date().toISOString()}).eq("id",r.id),n(S=>S?{...S,usage_count:(S.usage_count||0)+1,last_copied_at:new Date().toISOString()}:null))}catch(S){console.error("Failed to copy prompt:",S)}},j=S=>{const w=document.getElementById("promptText");if(w){const O=w.selectionStart,k=w.selectionEnd,E=i.substring(0,O)+`{${S}}`+i.substring(k);a(E),setTimeout(()=>{w.focus(),w.setSelectionRange(O+S.length+2,O+S.length+2)},0)}},_=async S=>{try{const w={content_item_id:S,prompt_text:i,prompt_category:o,usage_count:(r==null?void 0:r.usage_count)||0,last_copied_at:(r==null?void 0:r.last_copied_at)||null};if(r){const{error:O}=await we.from("prompts").update({...w,updated_at:new Date().toISOString()}).eq("id",r.id);if(O)throw O}else{const{error:O}=await we.from("prompts").insert([w]);if(O)throw O}}catch(w){throw console.error("Error saving prompt data:",w),w}};return c?f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading prompt..."})]})}):f.jsx(Ku,{contentType:"prompt",isEdit:e,onSaveContent:_,title:"Prompts",description:"Reusable prompt templates",color:"#8B5CF6",icon:wr,children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(If,{className:"h-5 w-5 mr-2 text-purple-500"}),"Prompt Statistics"]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.characterCount.toLocaleString()}),f.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide font-medium",children:"Characters"})]}),f.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.wordCount.toLocaleString()}),f.jsx("div",{className:"text-xs text-green-600 uppercase tracking-wide font-medium",children:"Words"})]}),f.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-purple-600",children:m.lineCount}),f.jsx("div",{className:"text-xs text-purple-600 uppercase tracking-wide font-medium",children:"Lines"})]}),f.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.variables.length}),f.jsx("div",{className:"text-xs text-orange-600 uppercase tracking-wide font-medium",children:"Variables"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(En,{className:"h-5 w-5 mr-2 text-purple-500"}),"Category & Classification"]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Prompt Category"}),f.jsx("select",{id:"category",value:o,onChange:S=>l(S.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:Lee.map(S=>f.jsx("option",{value:S,children:S},S))}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Categorize your prompt to make it easier to find and organize"})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[f.jsx(wr,{className:"h-5 w-5 mr-2 text-purple-500"}),"Prompt Content"]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:y,disabled:!i.trim(),className:`inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md transition-all ${p?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700 hover:bg-purple-200"} disabled:opacity-50`,children:p?f.jsxs(f.Fragment,{children:[f.jsx(Yn,{className:"h-4 w-4 mr-1"}),"Copied!"]}):f.jsxs(f.Fragment,{children:[f.jsx(Q0,{className:"h-4 w-4 mr-1"}),"Copy"]})}),f.jsxs("div",{className:"text-sm text-gray-500",children:[m.characterCount," / ",m.wordCount," words"]})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("textarea",{id:"promptText",value:i,onChange:S=>a(S.target.value),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm leading-relaxed",placeholder:"Enter your prompt template here...\\n\\nYou can use variables like {name}, {topic}, or [variable] to make your prompts reusable.\\n\\nExample:\\nYou are a helpful AI assistant specialized in {field}. Please help me with {task} by providing {output_format} that is {tone} and {length}."}),m.variables.length>0&&f.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[f.jsxs("h4",{className:"text-sm font-medium text-purple-900 mb-2 flex items-center",children:[f.jsx(xS,{className:"h-4 w-4 mr-1"}),"Detected Variables (",m.variables.length,")"]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:m.variables.map((S,w)=>f.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-md font-mono",children:[f.jsx(xS,{className:"h-3 w-3 mr-1"}),S]},w))}),f.jsx("p",{className:"text-xs text-purple-700 mt-2",children:"These variables can be replaced when using the prompt"})]}),f.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Quick Variables"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:["name","topic","context","tone","format","length","audience","goal"].map(S=>f.jsxs("button",{onClick:()=>j(S),className:"inline-flex items-center px-2 py-1 bg-white border border-gray-200 text-gray-700 text-xs rounded-md hover:bg-gray-100 transition-colors",children:["+ ",S]},S))}),f.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Click to insert common variables into your prompt"})]}),f.jsx("div",{className:"p-4 bg-purple-50 rounded-lg",children:f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx(wr,{className:"h-4 w-4 text-purple-600 mt-0.5"}),f.jsxs("div",{className:"text-sm text-purple-700",children:[f.jsx("p",{className:"font-medium mb-1",children:"Prompt Template Tips"}),f.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[f.jsxs("li",{children:["Use ","{variable}"," or [variable] syntax for replaceable parts"]}),f.jsx("li",{children:"Be specific about the desired output format and style"}),f.jsx("li",{children:"Include context and constraints to guide the AI response"}),f.jsx("li",{children:"Test your prompts with different variables to ensure consistency"})]})]})]})})]})]}),r&&f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(Kl,{className:"h-5 w-5 mr-2 text-blue-500"}),"Usage Statistics"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.usage_count||0}),f.jsx("div",{className:"text-sm text-blue-600",children:"Times Copied"})]}),f.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-green-600",children:r.last_copied_at?new Date(r.last_copied_at).toLocaleDateString():"Never"}),f.jsx("div",{className:"text-sm text-green-600",children:"Last Copied"})]})]})]}),i.trim()&&f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prompt Preview"}),f.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:f.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono leading-relaxed",children:i})}),f.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm text-gray-600",children:[f.jsx("span",{children:"This is how your prompt will appear when copied"}),f.jsxs("button",{onClick:y,className:"inline-flex items-center px-3 py-1 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors",children:[f.jsx(Q0,{className:"h-3 w-3 mr-1"}),"Copy Preview"]})]})]})]})})}const $ee=["Zapier","Make (Integromat)","Microsoft Power Automate","IFTTT","n8n","Bubble","Airtable","Google Sheets","Slack","Discord","Trello","Asana","Notion","Monday.com","HubSpot","Salesforce","Gmail","Outlook","Google Drive","Dropbox","AWS Lambda","GitHub Actions","Custom API","Other"];function qP(){const{id:t}=ni(),e=!!t,[r,n]=z.useState(null),[i,a]=z.useState(""),[o,l]=z.useState([]),[c,d]=z.useState(""),[p,h]=z.useState(""),[m,v]=z.useState(""),[x,b]=z.useState(e),[y,j]=z.useState(!1),[_,S]=z.useState(null);z.useEffect(()=>{e&&t&&w()},[e,t]),z.useEffect(()=>{i.trim()?O(i.trim()):S(null)},[i]);const w=async()=>{if(t)try{const{data:P,error:A}=await we.from("automations").select("*").eq("content_item_id",t).maybeSingle();if(A)throw A;P&&(n(P),a(P.automation_url||""),l(P.required_tools||[]),d(P.tool_description||""),h(P.setup_instructions||""))}catch(P){console.error("Error fetching automation:",P)}finally{b(!1)}},O=async P=>{j(!0);try{const A=new URL(P);let T="Unknown";A.hostname.includes("zapier.com")?T="Zapier":A.hostname.includes("make.com")||A.hostname.includes("integromat.com")?T="Make (Integromat)":A.hostname.includes("flow.microsoft.com")?T="Microsoft Power Automate":A.hostname.includes("ifttt.com")?T="IFTTT":A.hostname.includes("n8n.io")?T="n8n":A.hostname.includes("bubble.io")&&(T="Bubble"),S({isValid:!0,isReachable:!0,platform:T,title:`${T} Automation`,description:`Automation workflow hosted on ${T}`})}catch{S({isValid:!1,isReachable:!1})}finally{j(!1)}},k=P=>{const A=P.trim();A&&!o.includes(A)&&l([...o,A]),v("")},E=P=>{l(o.filter(A=>A!==P))},C=P=>{o.includes(P)||l([...o,P])},I=async P=>{try{const A={content_item_id:P,automation_url:i.trim(),required_tools:o,tool_description:c.trim()||null,setup_instructions:p.trim()||null};if(r){const{error:T}=await we.from("automations").update({...A,updated_at:new Date().toISOString()}).eq("id",r.id);if(T)throw T}else{const{error:T}=await we.from("automations").insert([A]);if(T)throw T}}catch(A){throw console.error("Error saving automation data:",A),A}};return x?f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Nt,{size:"lg"}),f.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading automation..."})]})}):f.jsx(Ku,{contentType:"automation",isEdit:e,onSaveContent:I,title:"Automations",description:"Process automations and workflows",color:"#F59E0B",icon:Fo,children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(J0,{className:"h-5 w-5 mr-2 text-orange-500"}),"Automation Link"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"automationUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"Automation URL *"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"url",id:"automationUrl",value:i,onChange:P=>a(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"https://zapier.com/shared/... or https://make.com/template/...",required:!0}),y&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx(Nt,{size:"sm"})})]}),_&&f.jsxs("div",{className:`mt-2 p-3 rounded-lg border ${_.isValid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[_.isValid?f.jsx(Yn,{className:"h-4 w-4 text-green-600"}):f.jsx(Rx,{className:"h-4 w-4 text-red-600"}),f.jsx("p",{className:`text-sm font-medium ${_.isValid?"text-green-700":"text-red-700"}`,children:_.isValid?`Valid ${_.platform} automation URL`:"Invalid URL format"})]}),_.isValid&&_.platform&&f.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:["Platform: ",f.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:_.platform})]})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Link to the automation template, workflow, or shared automation"})]}),i.trim()&&(_==null?void 0:_.isValid)&&f.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("h4",{className:"font-medium text-orange-900",children:"Automation Preview"}),f.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-orange-600 hover:text-orange-800",children:[f.jsx(_T,{className:"h-4 w-4 mr-1"}),"Open in New Tab"]})]}),f.jsxs("div",{className:"text-sm text-orange-800",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"URL:"})," ",f.jsx("span",{className:"font-mono text-xs break-all",children:i})]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Platform:"})," ",_.platform]})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(y$,{className:"h-5 w-5 mr-2 text-orange-500"}),"Required Tools & Services"]}),f.jsxs("div",{className:"space-y-4",children:[o.length>0&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Selected Tools (",o.length,")"]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:o.map((P,A)=>f.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-orange-100 text-orange-800 border border-orange-200",children:[P,f.jsx("button",{onClick:()=>E(P),className:"ml-2 text-orange-600 hover:text-orange-800",children:f.jsx(Iu,{className:"h-3 w-3"})})]},A))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Custom Tool"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{type:"text",value:m,onChange:P=>v(P.target.value),onKeyPress:P=>P.key==="Enter"&&k(m),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter tool or service name..."}),f.jsxs("button",{onClick:()=>k(m),disabled:!m.trim()||o.includes(m.trim()),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:[f.jsx(Qr,{className:"h-4 w-4 mr-1"}),"Add"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Add - Common Tools"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:$ee.map(P=>f.jsxs("button",{onClick:()=>C(P),disabled:o.includes(P),className:`px-3 py-2 text-sm border rounded-lg transition-colors ${o.includes(P)?"bg-green-50 border-green-200 text-green-700 cursor-default":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[o.includes(P)?f.jsx(Yn,{className:"h-3 w-3 inline mr-1"}):f.jsx(Qr,{className:"h-3 w-3 inline mr-1"}),P]},P))})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(ko,{className:"h-5 w-5 mr-2 text-blue-500"}),"Tools Description"]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"toolDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description of Required Tools"}),f.jsx("textarea",{id:"toolDescription",rows:4,value:c,onChange:P=>d(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Explain what each tool is used for in this automation...\\n\\nExample:\\n- Zapier: Connects different apps and triggers actions\\n- Google Sheets: Stores and manages data\\n- Slack: Sends notifications to the team"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Help users understand what each tool does in the automation workflow"})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(Fo,{className:"h-5 w-5 mr-2 text-orange-500"}),"Setup Instructions"]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"setupInstructions",className:"block text-sm font-medium text-gray-700 mb-2",children:"Step-by-Step Setup Guide"}),f.jsx("textarea",{id:"setupInstructions",rows:8,value:p,onChange:P=>h(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 font-mono text-sm",placeholder:"Provide detailed setup instructions...\\n\\nExample:\\n1. Click the automation link above\\n2. Sign up for a Zapier account if you don't have one\\n3. Connect your Google Sheets and Slack accounts\\n4. Configure the trigger conditions\\n5. Test the automation\\n6. Turn on the automation\\n\\nTroubleshooting:\\n- If connection fails, check API permissions\\n- Make sure all required fields are filled"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Provide clear, step-by-step instructions for setting up this automation"})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Automation Summary"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Configuration"}),f.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"URL:"})," ",i?"Configured":"Not set"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Required Tools:"})," ",o.length," tool",o.length!==1?"s":""]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Instructions:"})," ",p.trim()?"Provided":"None"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Tool Description:"})," ",c.trim()?"Provided":"None"]})]})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Tools Required"}),f.jsx("div",{className:"space-y-1",children:o.length>0?f.jsx("ul",{className:"text-sm text-gray-600 space-y-0.5",children:o.map((P,A)=>f.jsxs("li",{className:"flex items-center",children:[f.jsx("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full mr-2"}),P]},A))}):f.jsx("p",{className:"text-sm text-gray-500 italic",children:"No tools specified"})})]})]})]})]})})}function qee(){return f.jsx(bL,{children:f.jsx(f5,{children:f.jsx("div",{className:"App",children:f.jsxs(i5,{children:[f.jsx(nt,{path:"/login",element:f.jsx(b$,{})}),f.jsx(nt,{path:"/",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(Ex,{to:"/dashboard",replace:!0})})}),f.jsx(nt,{path:"/dashboard",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(lZ,{})})}),f.jsx(nt,{path:"/clients",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(cZ,{})})}),f.jsx(nt,{path:"/clients/:clientId",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(vZ,{})})}),f.jsx(nt,{path:"/users/:userId",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(gZ,{})})}),f.jsx(nt,{path:"/users",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(fZ,{})})}),f.jsx(nt,{path:"/tags",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(pZ,{})})}),f.jsx(nt,{path:"/content",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(yZ,{})})}),f.jsx(nt,{path:"/content/articles",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(bZ,{})})}),f.jsx(nt,{path:"/content/ai-agents",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(xZ,{})})}),f.jsx(nt,{path:"/content/videos",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(wZ,{})})}),f.jsx(nt,{path:"/content/documents",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(_Z,{})})}),f.jsx(nt,{path:"/content/prompts",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(jZ,{})})}),f.jsx(nt,{path:"/content/automations",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(SZ,{})})}),f.jsx(nt,{path:"/content/articles/create",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(NP,{})})}),f.jsx(nt,{path:"/content/articles/:id/edit",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(NP,{})})}),f.jsx(nt,{path:"/content/ai-agents/create",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(MP,{})})}),f.jsx(nt,{path:"/content/ai-agents/:id/edit",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(MP,{})})}),f.jsx(nt,{path:"/content/videos/create",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(IP,{})})}),f.jsx(nt,{path:"/content/videos/:id/edit",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(IP,{})})}),f.jsx(nt,{path:"/content/documents/create",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(LP,{})})}),f.jsx(nt,{path:"/content/documents/:id/edit",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(LP,{})})}),f.jsx(nt,{path:"/content/prompts/create",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx($P,{})})}),f.jsx(nt,{path:"/content/prompts/:id/edit",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx($P,{})})}),f.jsx(nt,{path:"/content/automations/create",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(qP,{})})}),f.jsx(nt,{path:"/content/automations/:id/edit",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx(qP,{})})}),f.jsx(nt,{path:"/settings",element:f.jsx(lt,{requireAdmin:!0,children:f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Settings"}),f.jsx("p",{className:"text-gray-600",children:"Settings page coming soon..."})]})})})}),f.jsx(nt,{path:"*",element:f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Page Not Found"}),f.jsx("p",{className:"text-gray-600",children:"The page you're looking for doesn't exist."})]})})})]})})})})}h3.createRoot(document.getElementById("root")).render(f.jsx(te.StrictMode,{children:f.jsx(qee,{})}));
