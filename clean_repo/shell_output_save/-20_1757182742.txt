 */function Uk(){return Uk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Uk.apply(this,arguments)}function pG(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function mG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function gG(t,e){return t.button===0&&(!e||e==="_self")&&!mG(t)}const yG=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],vG="6";try{window.__reactRouterVersion=vG}catch{}const xG="startTransition",zP=eB[xG];function bG(t){let{basename:e,children:r,future:n,window:i}=t,s=O.useRef();s.current==null&&(s.current=SK({window:i,v5Compat:!0}));let o=s.current,[l,c]=O.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},f=O.useCallback(d=>{u&&zP?zP(()=>c(d)):c(d)},[c,u]);return O.useLayoutEffect(()=>o.listen(f),[o,f]),O.useEffect(()=>dG(n),[n]),O.createElement(fG,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const wG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qn=O.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:f,viewTransition:d}=e,p=pG(e,yG),{basename:m}=O.useContext($a),x,y=!1;if(typeof u=="string"&&jG.test(u)&&(x=u,wG))try{let N=new URL(window.location.href),j=u.startsWith("//")?new URL(N.protocol+u):new URL(u),k=bO(j.pathname,m);j.origin===N.origin&&k!=null?u=k+j.search+j.hash:y=!0}catch{}let v=XK(u,{relative:i}),b=SG(u,{replace:o,state:l,target:c,preventScrollReset:f,relative:i,viewTransition:d});function w(N){n&&n(N),N.defaultPrevented||b(N)}return O.createElement("a",Uk({},p,{href:x||v,onClick:y||s?n:w,ref:r,target:c}))});var UP;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(UP||(UP={}));var HP;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(HP||(HP={}));function SG(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l}=e===void 0?{}:e,c=Ti(),u=rc(),f=lB(t,{relative:o});return O.useCallback(d=>{if(gG(d,r)){d.preventDefault();let p=n!==void 0?n:dy(u)===dy(f);c(t,{replace:p,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,f,n,i,r,t,s,o,l])}const NG="modulepreload",kG=function(t){return"/"+t},WP={},_p=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=kG(c),c in WP)return;WP[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":NG,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((p,m)=>{d.addEventListener("load",p),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},_G=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>_p(async()=>{const{default:n}=await Promise.resolve().then(()=>ud);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class NO extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class OG extends NO{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class VP extends NO{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class KP extends NO{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Hk;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Hk||(Hk={}));var EG=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class CG{constructor(e,{headers:r={},customFetch:n,region:i=Hk.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=_G(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return EG(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let f;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=o):typeof o=="string"?(l["Content-Type"]="text/plain",f=o):typeof FormData<"u"&&o instanceof FormData?f=o:(l["Content-Type"]="application/json",f=JSON.stringify(o)));const d=yield this.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:f}).catch(y=>{throw new OG(y)}),p=d.headers.get("x-relay-error");if(p&&p==="true")throw new VP(d);if(!d.ok)throw new KP(d);let m=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield d.json():m==="application/octet-stream"?x=yield d.blob():m==="text/event-stream"?x=d:m==="multipart/form-data"?x=yield d.formData():x=yield d.text(),{data:x,error:null,response:d}}catch(i){return{data:null,error:i,response:i instanceof KP||i instanceof VP?i.context:void 0}}})}}var Ar={},Lc={},$c={},Bc={},Fc={},qc={},AG=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_u=AG();const TG=_u.fetch,fB=_u.fetch.bind(_u),hB=_u.Headers,PG=_u.Request,MG=_u.Response,ud=Object.freeze(Object.defineProperty({__proto__:null,Headers:hB,Request:PG,Response:MG,default:fB,fetch:TG},Symbol.toStringTag,{value:"Module"})),RG=hK(ud);var cg={},GP;function pB(){if(GP)return cg;GP=1,Object.defineProperty(cg,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return cg.default=t,cg}var YP;function mB(){if(YP)return qc;YP=1;var t=qc&&qc.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(qc,"__esModule",{value:!0});const e=t(RG),r=t(pB());class n{constructor(s){var o,l;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(o=s.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=s.signal,this.isMaybeSingle=(l=s.isMaybeSingle)!==null&&l!==void 0?l:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,o){return this.headers=new Headers(this.headers),this.headers.set(s,o),this}then(s,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let c=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var f,d,p,m;let x=null,y=null,v=null,b=u.status,w=u.statusText;if(u.ok){if(this.method!=="HEAD"){const _=await u.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?y=_:y=JSON.parse(_))}const j=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),k=(p=u.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");j&&k&&k.length>1&&(v=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(x={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,v=null,b=406,w="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const j=await u.text();try{x=JSON.parse(j),Array.isArray(x)&&u.status===404&&(y=[],x=null,b=200,w="OK")}catch{u.status===404&&j===""?(b=204,w="No Content"):x={message:j}}if(x&&this.isMaybeSingle&&(!((m=x==null?void 0:x.details)===null||m===void 0)&&m.includes("0 rows"))&&(x=null,b=200,w="OK"),x&&this.shouldThrowOnError)throw new r.default(x)}return{error:x,data:y,count:v,status:b,statusText:w}});return this.shouldThrowOnError||(c=c.catch(u=>{var f,d,p;return{error:{message:`${(f=u==null?void 0:u.name)!==null&&f!==void 0?f:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(d=u==null?void 0:u.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(p=u==null?void 0:u.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),c.then(s,o)}returns(){return this}overrideTypes(){return this}}return qc.default=n,qc}var XP;function gB(){if(XP)return Fc;XP=1;var t=Fc&&Fc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Fc,"__esModule",{value:!0});const e=t(mB());class r extends e.default{select(i){let s=!1;const o=(i??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",f=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${f?`${f},`:""}${i}.${s?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:o=s}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,s,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(u,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var f;const d=[i?"analyze":null,s?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),p=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${p}"; options=${d};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Fc.default=r,Fc}var JP;function kO(){if(JP)return Bc;JP=1;var t=Bc&&Bc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Bc,"__esModule",{value:!0});const e=t(gB());class r extends e.default{eq(i,s){return this.url.searchParams.append(i,`eq.${s}`),this}neq(i,s){return this.url.searchParams.append(i,`neq.${s}`),this}gt(i,s){return this.url.searchParams.append(i,`gt.${s}`),this}gte(i,s){return this.url.searchParams.append(i,`gte.${s}`),this}lt(i,s){return this.url.searchParams.append(i,`lt.${s}`),this}lte(i,s){return this.url.searchParams.append(i,`lte.${s}`),this}like(i,s){return this.url.searchParams.append(i,`like.${s}`),this}likeAllOf(i,s){return this.url.searchParams.append(i,`like(all).{${s.join(",")}}`),this}likeAnyOf(i,s){return this.url.searchParams.append(i,`like(any).{${s.join(",")}}`),this}ilike(i,s){return this.url.searchParams.append(i,`ilike.${s}`),this}ilikeAllOf(i,s){return this.url.searchParams.append(i,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(i,s){return this.url.searchParams.append(i,`ilike(any).{${s.join(",")}}`),this}is(i,s){return this.url.searchParams.append(i,`is.${s}`),this}in(i,s){const o=Array.from(new Set(s)).map(l=>typeof l=="string"&&new RegExp("[,()]").test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(i,`in.(${o})`),this}contains(i,s){return typeof s=="string"?this.url.searchParams.append(i,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(i,`cs.{${s.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(s)}`),this}containedBy(i,s){return typeof s=="string"?this.url.searchParams.append(i,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(i,`cd.{${s.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(s)}`),this}rangeGt(i,s){return this.url.searchParams.append(i,`sr.${s}`),this}rangeGte(i,s){return this.url.searchParams.append(i,`nxl.${s}`),this}rangeLt(i,s){return this.url.searchParams.append(i,`sl.${s}`),this}rangeLte(i,s){return this.url.searchParams.append(i,`nxr.${s}`),this}rangeAdjacent(i,s){return this.url.searchParams.append(i,`adj.${s}`),this}overlaps(i,s){return typeof s=="string"?this.url.searchParams.append(i,`ov.${s}`):this.url.searchParams.append(i,`ov.{${s.join(",")}}`),this}textSearch(i,s,{config:o,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const u=o===void 0?"":`(${o})`;return this.url.searchParams.append(i,`${c}fts${u}.${s}`),this}match(i){return Object.entries(i).forEach(([s,o])=>{this.url.searchParams.append(s,`eq.${o}`)}),this}not(i,s,o){return this.url.searchParams.append(i,`not.${s}.${o}`),this}or(i,{foreignTable:s,referencedTable:o=s}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${i})`),this}filter(i,s,o){return this.url.searchParams.append(i,`${s}.${o}`),this}}return Bc.default=r,Bc}var QP;function yB(){if(QP)return $c;QP=1;var t=$c&&$c.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty($c,"__esModule",{value:!0});const e=t(kO());class r{constructor(i,{headers:s={},schema:o,fetch:l}){this.url=i,this.headers=new Headers(s),this.schema=o,this.fetch=l}select(i,{head:s=!1,count:o}={}){const l=s?"HEAD":"GET";let c=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",u),o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:o=!0}={}){var l;const c="POST";if(s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const u=i.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(u.length>0){const f=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var u;const f="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(d.length>0){const p=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(i,{count:s}={}){var o;const l="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:i}={}){var s;const o="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return $c.default=r,$c}var ZP;function IG(){if(ZP)return Lc;ZP=1;var t=Lc&&Lc.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Lc,"__esModule",{value:!0});const e=t(yB()),r=t(kO());class n{constructor(s,{headers:o={},schema:l,fetch:c}={}){this.url=s,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(s){const o=new URL(`${this.url}/${s}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,o={},{head:l=!1,get:c=!1,count:u}={}){var f;let d;const p=new URL(`${this.url}/rpc/${s}`);let m;l||c?(d=l?"HEAD":"GET",Object.entries(o).filter(([y,v])=>v!==void 0).map(([y,v])=>[y,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([y,v])=>{p.searchParams.append(y,v)})):(d="POST",m=o);const x=new Headers(this.headers);return u&&x.set("Prefer",`count=${u}`),new r.default({method:d,url:p,headers:x,schema:this.schemaName,body:m,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}}return Lc.default=n,Lc}var eM;function DG(){if(eM)return Ar;eM=1;var t=Ar&&Ar.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.PostgrestError=Ar.PostgrestBuilder=Ar.PostgrestTransformBuilder=Ar.PostgrestFilterBuilder=Ar.PostgrestQueryBuilder=Ar.PostgrestClient=void 0;const e=t(IG());Ar.PostgrestClient=e.default;const r=t(yB());Ar.PostgrestQueryBuilder=r.default;const n=t(kO());Ar.PostgrestFilterBuilder=n.default;const i=t(gB());Ar.PostgrestTransformBuilder=i.default;const s=t(mB());Ar.PostgrestBuilder=s.default;const o=t(pB());return Ar.PostgrestError=o.default,Ar.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:s.default,PostgrestError:o.default},Ar}var LG=DG();const $G=ht(LG),{PostgrestClient:BG,PostgrestQueryBuilder:SEe,PostgrestFilterBuilder:NEe,PostgrestTransformBuilder:kEe,PostgrestBuilder:_Ee,PostgrestError:OEe}=$G;class FG{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const qG="2.15.1",zG=`realtime-js/${qG}`,UG="1.0.0",Wk=1e4,HG=1e3,WG=100;var Xf;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Xf||(Xf={}));var wr;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(wr||(wr={}));var Yi;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Yi||(Yi={}));var Vk;(function(t){t.websocket="websocket"})(Vk||(Vk={}));var wl;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(wl||(wl={}));class VG{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(e.slice(o,o+i));o=o+i;const c=n.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class vB{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Rt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Rt||(Rt={}));const tM=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,o)=>(s[o]=KG(o,t,e,i),s),{})},KG=(t,e,r,n)=>{const i=e.find(l=>l.name===t),s=i==null?void 0:i.type,o=r[t];return s&&!n.includes(s)?xB(s,o):Kk(o)},xB=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return JG(e,r)}switch(t){case Rt.bool:return GG(e);case Rt.float4:case Rt.float8:case Rt.int2:case Rt.int4:case Rt.int8:case Rt.numeric:case Rt.oid:return YG(e);case Rt.json:case Rt.jsonb:return XG(e);case Rt.timestamp:return QG(e);case Rt.abstime:case Rt.date:case Rt.daterange:case Rt.int4range:case Rt.int8range:case Rt.money:case Rt.reltime:case Rt.text:case Rt.time:case Rt.timestamptz:case Rt.timetz:case Rt.tsrange:case Rt.tstzrange:return Kk(e);default:return Kk(e)}},Kk=t=>t,GG=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},YG=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},XG=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},JG=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const o=t.slice(1,r);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>xB(e,l))}return t},QG=t=>typeof t=="string"?t.replace(" ","T"):t,bB=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Pw{constructor(e,r,n={},i=Wk){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var rM;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(rM||(rM={}));class Jf{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Jf.syncState(this.state,i,s,o),this.pendingDiffs.forEach(c=>{this.state=Jf.syncDiff(this.state,c,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Jf.syncDiff(this.state,i,s,o),l())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const s=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(s,(u,f)=>{o[u]||(c[u]=f)}),this.map(o,(u,f)=>{const d=s[u];if(d){const p=f.map(v=>v.presence_ref),m=d.map(v=>v.presence_ref),x=f.filter(v=>m.indexOf(v.presence_ref)<0),y=d.filter(v=>p.indexOf(v.presence_ref)<0);x.length>0&&(l[u]=x),y.length>0&&(c[u]=y)}else l[u]=f}),this.syncDiff(s,{joins:l,leaves:c},n,i)}static syncDiff(e,r,n,i){const{joins:s,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(l,c)=>{var u;const f=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),f.length>0){const d=e[l].map(m=>m.presence_ref),p=f.filter(m=>d.indexOf(m.presence_ref)<0);e[l].unshift(...p)}n(l,f,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const f=c.map(d=>d.presence_ref);u=u.filter(d=>f.indexOf(d.presence_ref)<0),e[l]=u,i(l,u,c),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var nM;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(nM||(nM={}));var Qf;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Qf||(Qf={}));var to;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(to||(to={}));class _O{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=wr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Pw(this,Yi.join,this.params,this.timeout),this.rejoinTimer=new vB(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yi.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Jf(this),this.broadcastEndpointURL=bB(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==wr.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Qf.PRESENCE]&&this.bindings[Qf.PRESENCE].length>0,f={},d={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(to.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(to.CLOSED)),this.updateJoinPayload(Object.assign({config:d},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket.setAuth(),p===void 0){e==null||e(to.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,y=(m=x==null?void 0:x.length)!==null&&m!==void 0?m:0,v=[];for(let b=0;b<y;b++){const w=x[b],{filter:{event:N,schema:j,table:k,filter:_}}=w,E=p&&p[b];if(E&&E.event===N&&E.schema===j&&E.table===k&&E.filter===_)v.push(Object.assign(Object.assign({},w),{id:E.id}));else{this.unsubscribe(),this.state=wr.errored,e==null||e(to.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(to.SUBSCRIBED);return}}).receive("error",p=>{this.state=wr.errored,e==null||e(to.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(to.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===wr.joined&&e===Qf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yi.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Pw(this,Yi.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wr.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Pw(this,e,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>WG){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,s;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:f}=Yi;if(n&&[l,c,u,f].indexOf(o)>=0&&n!==this._joinRef())return;let p=this._onMessage(o,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var x,y,v;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(y=m.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(m=>m.callback(p,n)):(s=this.bindings[o])===null||s===void 0||s.filter(m=>{var x,y,v,b,w,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const j=m.id,k=(x=m.filter)===null||x===void 0?void 0:x.event;return j&&((y=r.ids)===null||y===void 0?void 0:y.includes(j))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const j=(w=(b=m==null?void 0:m.filter)===null||b===void 0?void 0:b.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return j==="*"||j===((N=r==null?void 0:r.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof p=="object"&&"ids"in p){const x=p.data,{schema:y,table:v,commit_timestamp:b,type:w,errors:N}=x;p=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:b,eventType:w,new:{},old:{},errors:N}),this._getPayloadRecords(x))}m.callback(p,n)})}_isClosed(){return this.state===wr.closed}_isJoined(){return this.state===wr.joined}_isJoining(){return this.state===wr.joining}_isLeaving(){return this.state===wr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&_O.isEqual(i.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yi.close,{},e)}_onError(e){this._on(Yi.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=tM(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=tM(e.columns,e.old_record)),r}}const iM=()=>{},ug={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ZG=[1e3,2e3,5e3,1e4],eY=1e4,tY=`
  });`;class rY{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Wk,this.transport=null,this.heartbeatIntervalMs=ug.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=iM,this.ref=0,this.reconnectTimer=null,this.logger=iM,this.conn=null,this.sendBuffer=[],this.serializer=new VG,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>_p(async()=>{const{default:l}=await Promise.resolve().then(()=>ud);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...o)=>s(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Vk.websocket}`,this.httpEndpoint=bB(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=FG.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:UG}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Xf.connecting:return wl.Connecting;case Xf.open:return wl.Open;case Xf.closing:return wl.Closing;default:return wl.Closed}}isConnected(){return this.connectionState()===wl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new _O(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(HG,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ug.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:o}=r,l=o?`(${o})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yi.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([tY],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:zG};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Yi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new vB(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ug.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,s,o,l,c,u;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Wk,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:ug.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:f=>ZG[f-1]||eY,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(f,d)=>d(JSON.stringify(f)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class OO extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class nY extends OO{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Gk extends OO{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var iY=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const wB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>_p(async()=>{const{default:n}=await Promise.resolve().then(()=>ud);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},sY=()=>iY(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _p(()=>Promise.resolve().then(()=>ud),void 0)).Response:Response}),Yk=t=>{if(Array.isArray(t))return t.map(r=>Yk(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Yk(n)}),e},oY=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var nc=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Mw=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),aY=(t,e,r)=>nc(void 0,void 0,void 0,function*(){const n=yield sY();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const s=t.status||500,o=(i==null?void 0:i.statusCode)||s+"";e(new nY(Mw(i),s,o))}).catch(i=>{e(new Gk(Mw(i),i))}):e(new Gk(Mw(t),t))}),lY=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(oY(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function Op(t,e,r,n,i,s){return nc(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,lY(e,n,i,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>aY(c,l,n))})})}function fy(t,e,r,n){return nc(this,void 0,void 0,function*(){return Op(t,"GET",e,r,n)})}function vs(t,e,r,n,i){return nc(this,void 0,void 0,function*(){return Op(t,"POST",e,n,i,r)})}function Xk(t,e,r,n,i){return nc(this,void 0,void 0,function*(){return Op(t,"PUT",e,n,i,r)})}function cY(t,e,r,n){return nc(this,void 0,void 0,function*(){return Op(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function jB(t,e,r,n,i){return nc(this,void 0,void 0,function*(){return Op(t,"DELETE",e,n,i,r)})}var hn=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const uY={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},sM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dY{constructor(e,r={},n,i){this.url=e,this.headers=r,this.bucketId=n,this.fetch=wB(i)}uploadOrUpdate(e,r,n,i){return hn(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},sM),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),d=yield(e=="PUT"?Xk:vs)(this.fetch,`${this.url}/object/${f}`,s,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(jr(s))return{data:null,error:s};throw s}})}upload(e,r,n){return hn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return hn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:sM.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const d=yield Xk(this.fetch,l.toString(),c,{headers:f});return{data:{path:s,fullPath:d.Key},error:null}}catch(c){if(jr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return hn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield vs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new OO("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}update(e,r,n){return hn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return hn(this,void 0,void 0,function*(){try{return{data:yield vs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}copy(e,r,n){return hn(this,void 0,void 0,function*(){try{return{data:{path:(yield vs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return hn(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield vs(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return hn(this,void 0,void 0,function*(){try{const i=yield vs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}download(e,r){return hn(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield fy(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(jr(l))return{data:null,error:l};throw l}})}info(e){return hn(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield fy(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Yk(n),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}exists(e){return hn(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield cY(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(jr(n)&&n instanceof Gk){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(e){return hn(this,void 0,void 0,function*(){try{return{data:yield jB(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}list(e,r,n){return hn(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},uY),r),{prefix:e||""});return{data:yield vs(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(jr(i))return{data:null,error:i};throw i}})}listV2(e,r){return hn(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield vs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const fY="2.11.0",hY={"X-Client-Info":`storage-js/${fY}`};var zc=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class pY{constructor(e,r={},n,i){const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},hY),r),this.fetch=wB(n)}listBuckets(){return zc(this,void 0,void 0,function*(){try{return{data:yield fy(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(jr(e))return{data:null,error:e};throw e}})}getBucket(e){return zc(this,void 0,void 0,function*(){try{return{data:yield fy(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return zc(this,void 0,void 0,function*(){try{return{data:yield vs(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return zc(this,void 0,void 0,function*(){try{return{data:yield Xk(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(jr(n))return{data:null,error:n};throw n}})}emptyBucket(e){return zc(this,void 0,void 0,function*(){try{return{data:yield vs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}deleteBucket(e){return zc(this,void 0,void 0,function*(){try{return{data:yield jB(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(jr(r))return{data:null,error:r};throw r}})}}class mY extends pY{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new dY(this.url,this.headers,e,this.fetch)}}const gY="2.56.0";let Df="";typeof Deno<"u"?Df="deno":typeof document<"u"?Df="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Df="react-native":Df="node";const yY={"X-Client-Info":`supabase-js-${Df}/${gY}`},vY={headers:yY},xY={schema:"public"},bY={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wY={};var jY=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const SY=t=>{let e;return t?e=t:typeof fetch>"u"?e=fB:e=fetch,(...r)=>e(...r)},NY=()=>typeof Headers>"u"?hB:Headers,kY=(t,e,r)=>{const n=SY(r),i=NY();return(s,o)=>jY(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},o),{headers:u}))})};var _Y=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};function OY(t){return t.endsWith("/")?t:t+"/"}function EY(t,e){var r,n;const{db:i,auth:s,realtime:o,global:l}=t,{db:c,auth:u,realtime:f,global:d}=e,p={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},f),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>_Y(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}const SB="2.71.1",nu=30*1e3,Jk=3,Rw=Jk*nu,CY="http://localhost:9999",AY="supabase.auth.token",TY={"X-Client-Info":`gotrue-js/${SB}`},Qk="X-Supabase-Api-Version",NB={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},PY=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,MY=10*60*1e3;class EO extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function nt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class RY extends EO{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function IY(t){return nt(t)&&t.name==="AuthApiError"}class kB extends EO{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Ba extends EO{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class na extends Ba{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function DY(t){return nt(t)&&t.name==="AuthSessionMissingError"}class dg extends Ba{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fg extends Ba{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class hg extends Ba{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function LY(t){return nt(t)&&t.name==="AuthImplicitGrantRedirectError"}class oM extends Ba{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zk extends Ba{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Iw(t){return nt(t)&&t.name==="AuthRetryableFetchError"}class aM extends Ba{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class e_ extends Ba{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lM=` 	
\r=`.split(""),$Y=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<lM.length;e+=1)t[lM[e].charCodeAt(0)]=-2;for(let e=0;e<hy.length;e+=1)t[hy[e].charCodeAt(0)]=e;return t})();function cM(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(hy[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(hy[n]),e.queuedBits-=6}}function _B(t,e,r){const n=$Y[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function uM(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{qY(o,n,r)};for(let o=0;o<t.length;o+=1)_B(t.charCodeAt(o),i,s);return e.join("")}function BY(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function FY(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}BY(n,e)}}function qY(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function zY(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)_B(t.charCodeAt(i),r,n);return new Uint8Array(e)}function UY(t){const e=[];return FY(t,r=>e.push(r)),new Uint8Array(e)}function HY(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>cM(i,r,n)),cM(null,r,n),e.join("")}function WY(t){return Math.round(Date.now()/1e3)+t}function VY(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Ki=()=>typeof window<"u"&&typeof document<"u",ll={tested:!1,writable:!1},OB=()=>{if(!Ki())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ll.tested)return ll.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ll.tested=!0,ll.writable=!0}catch{ll.tested=!0,ll.writable=!1}return ll.writable};function KY(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const EB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>_p(async()=>{const{default:n}=await Promise.resolve().then(()=>ud);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},GY=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",iu=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},cl=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Jo=async(t,e)=>{await t.removeItem(e)};class O0{constructor(){this.promise=new O0.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}O0.promiseConstructor=Promise;function Dw(t){const e=t.split(".");if(e.length!==3)throw new e_("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!PY.test(e[n]))throw new e_("JWT not in base64url format");return{header:JSON.parse(uM(e[0])),payload:JSON.parse(uM(e[1])),signature:zY(e[2]),raw:{header:e[0],payload:e[1]}}}async function YY(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function XY(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function JY(t){return("0"+t.toString(16)).substr(-2)}function QY(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,JY).join("")}async function ZY(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function eX(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await ZY(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Uc(t,e,r=!1){const n=QY();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await iu(t,`${e}-code-verifier`,i);const s=await eX(n);return[s,n===s?"plain":"s256"]}const tX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rX(t){const e=t.headers.get(Qk);if(!e||!e.match(tX))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function nX(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function iX(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sX=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hc(t){if(!sX.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Lw(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function dM(t){return JSON.parse(JSON.stringify(t))}var oX=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const yl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),aX=[502,503,504];async function fM(t){var e;if(!GY(t))throw new Zk(yl(t),0);if(aX.includes(t.status))throw new Zk(yl(t),t.status);let r;try{r=await t.json()}catch(s){throw new kB(yl(s),s)}let n;const i=rX(t);if(i&&i.getTime()>=NB["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new aM(yl(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new na}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new aM(yl(r),t.status,r.weak_password.reasons);throw new RY(yl(r),t.status||500,n)}const lX=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function dt(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Qk]||(s[Qk]=NB["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await cX(t,e,r+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function cX(t,e,r,n,i,s){const o=lX(e,n,i,s);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new Zk(yl(c),0)}if(l.ok||await fM(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await fM(c)}}function Zs(t){var e;let r=null;hX(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=WY(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function hM(t){const e=Zs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function fa(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function uX(t){return{data:t,error:null}}function dX(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,o=oX(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function fX(t){return t}function hX(t){return t.access_token&&t.refresh_token&&t.expires_in}const $w=["global","local","others"];var pX=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class mX{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=EB(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=$w[0]){if($w.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$w.join(", ")}`);try{return await dt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(nt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:fa})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=pX(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:dX,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(nt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await dt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:fa})}catch(r){if(nt(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},f=await dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:fX});if(f.error)throw f.error;const d=await f.json(),p=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const y=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);u[`${v}Page`]=y}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(nt(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Hc(e);try{return await dt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:fa})}catch(r){if(nt(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Hc(e);try{return await dt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:fa})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Hc(e);try{return await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:fa})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Hc(e.userId);try{const{data:r,error:n}=await dt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Hc(e.userId),Hc(e.id);try{return{data:await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(nt(r))return{data:null,error:r};throw r}}}function pM(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function gX(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Wc={debug:!!(globalThis&&OB()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class CB extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class yX extends CB{}async function vX(t,e,r){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new yX(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Wc.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}gX();const xX={url:CY,storageKey:AY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:TY,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function mM(t,e,r){return await r()}const Vc={};class wh{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wh.nextInstanceID,wh.nextInstanceID+=1,this.instanceID>0&&Ki()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},xX),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new mX({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=EB(i.fetch),this.lock=i.lock||mM,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Ki()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=vX:this.lock=mM,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:OB()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pM(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=pM(this.memoryStorage)),Ki()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Vc[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Vc[this.storageKey]=Object.assign(Object.assign({},Vc[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Vc[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Vc[this.storageKey]=Object.assign(Object.assign({},Vc[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${SB}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=KY(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ki()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),LY(s)){const c=(e=s.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return nt(r)?{error:r}:{error:new kB("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Zs}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(nt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:f,password:d,options:p}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Uc(this.storage,this.storageKey)),s=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:f,password:d,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:x},xform:Zs})}else if("phone"in e){const{phone:f,password:d,options:p}=e;s=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Zs})}else throw new fg("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(nt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:o,options:l}=e;r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:hM})}else if("phone"in e){const{phone:s,password:o,options:l}=e;r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:hM})}else throw new fg("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new dg}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,i,s,o,l,c,u,f,d,p,m;let x,y;if("message"in e)x=e.message,y=e.signature;else{const{chain:v,wallet:b,statement:w,options:N}=e;let j;if(Ki())if(typeof b=="object")j=b;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))j=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=b}const k=new URL((r=N==null?void 0:N.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const _=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let E;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")E=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)E=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)x=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),y=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${k.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(i=(n=N==null?void 0:N.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=N==null?void 0:N.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((d=(f=N==null?void 0:N.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...N.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const _=await j.signMessage(new TextEncoder().encode(x),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=_}}try{const{data:v,error:b}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:HY(y)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Zs});if(b)throw b;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new dg}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:b})}catch(v){if(nt(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const r=await cl(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:o}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Zs});if(await Jo(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new dg}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(nt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:o}=e,l=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Zs}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new dg}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,s,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await Uc(this.storage,this.storageKey));const{error:d}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:f}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f}}throw new fg("You must provide either an email or phone number.")}catch(l){if(nt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Zs});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(nt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Uc(this.storage,this.storageKey)),await dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:uX})}catch(s){if(nt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new na;const{error:i}=await dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(nt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await dt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:l}=await dt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new fg("You must provide either an email or phone number and a type")}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await cl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Rw:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await cl(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Lw()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,f)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,f))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:fa}):await this._useSession(async r=>{var n,i,s;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new na}:await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:fa})})}catch(r){if(nt(r))return DY(r)&&(await this._removeSession(),await Jo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new na;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Uc(this.storage,this.storageKey));const{data:u,error:f}=await dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:fa});if(f)throw f;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(nt(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new na;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:o}=Dw(e.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(nt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new na;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(nt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Ki())throw new hg("No browser detected.");if(e.error||e.error_description||e.error_code)throw new hg(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new oM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hg("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new oM("No code detected.");const{data:w,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!s||!l||!o||!u)throw new hg("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(l);let p=f+d;c&&(p=parseInt(c));const m=p-f;m*1e3<=nu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const x=p-d;f-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,p,f):f-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,p,f);const{data:y,error:v}=await this._getUser(s);if(v)throw v;const b={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:p,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(nt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await cl(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(IY(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Jo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=VY(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Uc(this.storage,this.storageKey,!0));try{return await dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(nt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(nt(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var o,l,c,u,f;const{data:d,error:p}=s;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await dt(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return Ki()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(nt(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)throw o;return await dt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await XY(async i=>(i>0&&await YY(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Zs})),(i,s)=>{const o=200*Math.pow(2,i);return s&&Iw(s)&&Date.now()+o-n<nu})}catch(n){if(this._debug(r,"error",n),nt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Ki()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await cl(this.storage,this.storageKey);if(i&&this.userStorage){let o=await cl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await iu(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Lw()}else if(i&&!i.user&&!i.user){const o=await cl(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Jo(this.storage,this.storageKey+"-user"),await iu(this.storage,this.storageKey,i)):i.user=Lw()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Rw;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Rw}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Iw(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new na;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new O0;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new na;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),nt(s)){const o={session:null,error:s};return Iw(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){s.push(c)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await iu(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=dM(i);await iu(this.storage,this.storageKey,s)}else{const i=dM(r);await iu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Jo(this.storage,this.storageKey),await Jo(this.storage,this.storageKey+"-code-verifier"),await Jo(this.storage,this.storageKey+"-user"),this.userStorage&&await Jo(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ki()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),nu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/nu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${nu}ms, refresh threshold is ${Jk} ticks`),i<=Jk&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof CB)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ki()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await Uc(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await dt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await dt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(nt(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(nt(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(nt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Dw(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const f=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+MY>i)return n;const{data:s,error:o}=await dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};n=m.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:c}}=Dw(n);r!=null&&r.allowExpired||nX(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:i,signature:o},error:null}}const f=iX(i.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,o,UY(`${l}.${c}`)))throw new e_("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(nt(n))return{data:null,error:n};throw n}}}wh.nextInstanceID=0;const bX=wh;class wX extends bX{constructor(e){super(e)}}var jX=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(f){try{u(n.next(f))}catch(d){o(d)}}function c(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):i(f.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class SX{constructor(e,r,n){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=OY(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:xY,realtime:wY,auth:Object.assign(Object.assign({},bY),{storageKey:u}),global:vY},d=EY(n??{},f);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=kY(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new BG(new URL("rest/v1",c).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new mY(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new CG(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return jX(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:o,lock:l,debug:c},u,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wX({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,flowType:o,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new rY(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const NX=(t,e,r)=>new SX(t,e,r);function kX(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}kX()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const _X="https://givgsxytkbsdrlmoxzkp.supabase.co",OX="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA",pe=NX(_X,OX),xn={ai_agent:{label:"AI Agents",color:"#3B82F6",description:"Intelligent AI agents with custom prompts"},video:{label:"Videos",color:"#EF4444",description:"Educational videos with transcriptions"},document:{label:"Documents",color:"#10B981",description:"Rich text documents and guides"},prompt:{label:"Prompts",color:"#8B5CF6",description:"Reusable prompt templates"},automation:{label:"Automations",color:"#F59E0B",description:"Process automations and workflows"}},AB=O.createContext(void 0);function Ln(){const t=O.useContext(AB);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function EX({children:t}){const[e,r]=O.useState(null),[n,i]=O.useState(null),[s,o]=O.useState(!0),[l,c]=O.useState(!1),u=O.useRef(!0),f=O.useRef(null);O.useEffect(()=>{const y=setTimeout(()=>{u.current&&(console.warn("Auth loading timeout reached - switching to production auth"),c(!0),o(!1))},1e4);return()=>clearTimeout(y)},[]);const d=O.useCallback(async y=>{console.log("🔍 Fetching admin data for user:",y);try{const{data:v,error:b}=await pe.from("admins").select("*").eq("id",y).maybeSingle();return console.log("🔍 Admin query result:",{data:v,error:b}),b?(console.error("❌ Admin lookup error:",b),null):(v?console.log("✅ Admin data found:",v):console.log("❌ No admin data found for user:",y),v)}catch(v){return console.error("❌ Admin fetch failed with exception:",v),null}},[]);O.useEffect(()=>{let y=!0;const v=new AbortController;(async()=>{var N;try{o(!0);const{data:{user:j},error:k}=await pe.auth.getUser();if(!y)return;k&&!((N=k.message)!=null&&N.includes("Auth session missing"))&&console.error("Auth initialization error:",k);const _=j||null;if(r(_),_){const E=await d(_.id);y&&i(E)}else i(null);y&&o(!1)}catch(j){console.error("Auth initialization failed:",j),y&&(r(null),i(null),o(!1))}})();const{data:{subscription:w}}=pe.auth.onAuthStateChange(async(N,j)=>{var _;if(!y)return;console.log("Auth state change:",N,(_=j==null?void 0:j.user)==null?void 0:_.id);const k=(j==null?void 0:j.user)||null;if(console.log("🔄 Processing auth state change:",{event:N,userId:k==null?void 0:k.id}),r(k),k){console.log("👤 User authenticated, fetching admin data...");try{const E=await d(k.id);y&&(console.log("✅ Setting admin data:",E),i(E))}catch(E){console.error("❌ Failed to fetch admin data:",E),y&&i(null)}}else console.log("❌ No user, clearing admin data"),i(null);y&&o(!1)});return()=>{y=!1,v.abort(),w.unsubscribe()}},[d]),O.useEffect(()=>()=>{u.current=!1,f.current&&clearTimeout(f.current)},[]);const p=O.useCallback(async(y,v)=>{try{o(!0);const{error:b}=await pe.auth.signInWithPassword({email:y,password:v});return b?(o(!1),{error:b.message}):{}}catch{return o(!1),{error:"Sign in failed"}}},[]),m=O.useCallback(async()=>{try{o(!0),await pe.auth.signOut()}catch(y){console.error("Sign out error:",y),o(!1)}},[]),x=O.useMemo(()=>({user:e,admin:n,loading:s,signIn:p,signOut:m}),[e==null?void 0:e.id,n==null?void 0:n.id,s,p,m]);return a.jsx(AB.Provider,{value:x,children:t})}/**
 */const NM=ke("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);class Nh extends Z.Component{constructor(r){super(r);vf(this,"retryCount",0);vf(this,"maxRetries",3);vf(this,"handleRetry",()=>{this.retryCount<this.maxRetries?(this.retryCount++,console.log(`🔄 Error Boundary Retry Attempt ${this.retryCount}/${this.maxRetries}`),this.setState({hasError:!1,error:null,errorId:Date.now().toString(36)})):(console.warn("⚠️ Max retry attempts reached, manual intervention required"),window.location.reload())});vf(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorId:Date.now().toString(36)}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorId:Date.now().toString(36)}}componentDidCatch(r,n){var i,s;console.group("🚨 Error Boundary Caught Error"),console.error("Error:",r),console.error("Error Info:",n),console.error("Component Stack:",n.componentStack),console.groupEnd(),(s=(i=this.props).onError)==null||s.call(i,r,n),console.warn("Production error reporting not configured")}render(){var r,n,i,s,o,l;if(this.state.hasError){if(this.props.fallback){const f=this.props.fallback;return a.jsx(f,{error:this.state.error,retry:this.handleRetry})}const c=(n=(r=this.state.error)==null?void 0:r.message)==null?void 0:n.includes("Maximum update depth exceeded"),u=((s=(i=this.state.error)==null?void 0:i.message)==null?void 0:s.includes("navigate"))||((l=(o=this.state.error)==null?void 0:o.message)==null?void 0:l.includes("router"));return a.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:a.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:a.jsxs("div",{className:"bg-white py-8 px-4 shadow-lg sm:rounded-lg sm:px-10",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(Pl,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:c?"System Stability Error":u?"Navigation Error":"Something went wrong"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:c?"The application encountered a rendering loop. This has been automatically contained.":u?"There was an issue with page navigation. You can safely continue using the application.":"An unexpected error occurred, but the system remains stable."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{onClick:this.handleRetry,disabled:this.retryCount>=this.maxRetries,className:"w-full flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(IO,{className:"h-4 w-4 mr-2"}),this.retryCount>=this.maxRetries?"Max Retries Reached":`Try Again (${this.retryCount}/${this.maxRetries})`]}),a.jsxs("button",{onClick:this.handleGoHome,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(PO,{className:"h-4 w-4 mr-2"}),"Go to Dashboard"]})]}),!1]})})})}return this.props.children}}function HB(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=HB(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function it(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=HB(t))&&(n&&(n+=" "),n+=e);return n}const LO="-",GX=t=>{const e=XX(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const l=o.split(LO);return l[0]===""&&l.length!==1&&l.shift(),WB(l,e)||YX(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},WB=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?WB(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(LO);return(o=e.validators.find(({validator:l})=>l(s)))==null?void 0:o.classGroupId},kM=/^\[(.+)\]$/,YX=t=>{if(kM.test(t)){const e=kM.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},XX=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return QX(Object.entries(t.classGroups),r).forEach(([s,o])=>{o_(o,n,s,e)}),n},o_=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:_M(e,i);s.classGroupId=r;return}if(typeof i=="function"){if(JX(i)){o_(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([s,o])=>{o_(o,_M(e,s),r,n)})})},_M=(t,e)=>{let r=t;return e.split(LO).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},JX=t=>t.isThemeGetter,QX=(t,e)=>e?t.map(([r,n])=>{const i=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,l])=>[e+o,l])):s);return[r,i]}):t,ZX=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(s,o)=>{r.set(s,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(s){let o=r.get(s);if(o!==void 0)return o;if((o=n.get(s))!==void 0)return i(s,o),o},set(s,o){r.has(s)?r.set(s,o):i(s,o)}}},VB="!",eJ=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],s=e.length,o=l=>{const c=[];let u=0,f=0,d;for(let v=0;v<l.length;v++){let b=l[v];if(u===0){if(b===i&&(n||l.slice(v,v+s)===e)){c.push(l.slice(f,v)),f=v+s;continue}if(b==="/"){d=v;continue}}b==="["?u++:b==="]"&&u--}const p=c.length===0?l:l.substring(f),m=p.startsWith(VB),x=m?p.substring(1):p,y=d&&d>f?d-f:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:y}};return r?l=>r({className:l,parseClassName:o}):o},tJ=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},rJ=t=>({cache:ZX(t.cacheSize),parseClassName:eJ(t),...GX(t)}),nJ=/\s+/,iJ=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,s=[],o=t.trim().split(nJ);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:f,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:m}=r(u);let x=!!m,y=n(x?p.substring(0,m):p);if(!y){if(!x){l=u+(l.length>0?" "+l:l);continue}if(y=n(p),!y){l=u+(l.length>0?" "+l:l);continue}x=!1}const v=tJ(f).join(":"),b=d?v+VB:v,w=b+y;if(s.includes(w))continue;s.push(w);const N=i(y,x);for(let j=0;j<N.length;++j){const k=N[j];s.push(b+k)}l=u+(l.length>0?" "+l:l)}return l};function sJ(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=KB(e))&&(n&&(n+=" "),n+=r);return n}const KB=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=KB(t[n]))&&(r&&(r+=" "),r+=e);return r};function oJ(t,...e){let r,n,i,s=o;function o(c){const u=e.reduce((f,d)=>d(f),t());return r=rJ(u),n=r.cache.get,i=r.cache.set,s=l,l(c)}function l(c){const u=n(c);if(u)return u;const f=iJ(c,r);return i(c,f),f}return function(){return s(sJ.apply(null,arguments))}}const qt=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},GB=/^\[(?:([a-z-]+):)?(.+)\]$/i,aJ=/^\d+\/\d+$/,lJ=new Set(["px","full","screen"]),cJ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uJ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dJ=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,fJ=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,hJ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Gs=t=>gu(t)||lJ.has(t)||aJ.test(t),Qo=t=>fd(t,"length",wJ),gu=t=>!!t&&!Number.isNaN(Number(t)),qw=t=>fd(t,"number",gu),bf=t=>!!t&&Number.isInteger(Number(t)),pJ=t=>t.endsWith("%")&&gu(t.slice(0,-1)),st=t=>GB.test(t),Zo=t=>cJ.test(t),mJ=new Set(["length","size","percentage"]),gJ=t=>fd(t,mJ,YB),yJ=t=>fd(t,"position",YB),vJ=new Set(["image","url"]),xJ=t=>fd(t,vJ,SJ),bJ=t=>fd(t,"",jJ),wf=()=>!0,fd=(t,e,r)=>{const n=GB.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},wJ=t=>uJ.test(t)&&!dJ.test(t),YB=()=>!1,jJ=t=>fJ.test(t),SJ=t=>hJ.test(t),NJ=()=>{const t=qt("colors"),e=qt("spacing"),r=qt("blur"),n=qt("brightness"),i=qt("borderColor"),s=qt("borderRadius"),o=qt("borderSpacing"),l=qt("borderWidth"),c=qt("contrast"),u=qt("grayscale"),f=qt("hueRotate"),d=qt("invert"),p=qt("gap"),m=qt("gradientColorStops"),x=qt("gradientColorStopPositions"),y=qt("inset"),v=qt("margin"),b=qt("opacity"),w=qt("padding"),N=qt("saturate"),j=qt("scale"),k=qt("sepia"),_=qt("skew"),E=qt("space"),A=qt("translate"),T=()=>["auto","contain","none"],M=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",st,e],R=()=>[st,e],L=()=>["",Gs,Qo],$=()=>["auto",gu,st],F=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],q=()=>["","0",st],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[gu,st];return{cacheSize:500,separator:":",theme:{colors:[wf],spacing:[Gs,Qo],blur:["none","",Zo,st],brightness:D(),borderColor:[t],borderRadius:["none","","full",Zo,st],borderSpacing:R(),borderWidth:L(),contrast:D(),grayscale:q(),hueRotate:D(),invert:q(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[pJ,Qo],inset:P(),margin:P(),opacity:D(),padding:R(),saturate:D(),scale:D(),sepia:q(),skew:D(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",st]}],container:["container"],columns:[{columns:[Zo]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...F(),st]}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bf,st]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",st]}],grow:[{grow:q()}],shrink:[{shrink:q()}],order:[{order:["first","last","none",bf,st]}],"grid-cols":[{"grid-cols":[wf]}],"col-start-end":[{col:["auto",{span:["full",bf,st]},st]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[wf]}],"row-start-end":[{row:["auto",{span:[bf,st]},st]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",st]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",st]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",st,e]}],"min-w":[{"min-w":[st,e,"min","max","fit"]}],"max-w":[{"max-w":[st,e,"none","full","min","max","fit","prose",{screen:[Zo]},Zo]}],h:[{h:[st,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[st,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[st,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[st,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Zo,Qo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qw]}],"font-family":[{font:[wf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",st]}],"line-clamp":[{"line-clamp":["none",gu,qw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Gs,st]}],"list-image":[{"list-image":["none",st]}],"list-style-type":[{list:["none","disc","decimal",st]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Gs,Qo]}],"underline-offset":[{"underline-offset":["auto",Gs,st]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",st]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",st]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...F(),yJ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gJ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},xJ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:z()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Gs,st]}],"outline-w":[{outline:[Gs,Qo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[Gs,Qo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Zo,bJ]}],"shadow-color":[{shadow:[wf]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Zo,st]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[N]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",st]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",st]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",st]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[bf,st]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",st]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",st]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",st]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Gs,Qo,qw]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},kJ=oJ(NJ);function ge(...t){return kJ(it(t))}function cr({size:t="md",className:e}){const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return a.jsx("div",{className:ge("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",r[t],e)})}function ft({children:t,requireAdmin:e=!1}){const{user:r,admin:n,loading:i}=Ln(),[s,o]=O.useState(!1),l=O.useRef(null),c=O.useRef(!0);if(O.useEffect(()=>(i?l.current=setTimeout(()=>{c.current&&(console.warn("ProtectedRoute: Loading timeout reached - authentication may have failed"),o(!0))},15e3):(l.current&&(clearTimeout(l.current),l.current=null),o(!1)),()=>{l.current&&clearTimeout(l.current)}),[i]),O.useEffect(()=>()=>{c.current=!1,l.current&&clearTimeout(l.current)},[]),i&&!s)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Verifying authentication..."})]})});if(s)return console.warn("ProtectedRoute: Authentication timeout - redirecting to login"),a.jsx(da,{to:"/login",replace:!0});if(!r)return a.jsx(da,{to:"/login",replace:!0});if(e){if(console.log("🔒 Checking admin access:",{user:!!r,admin:n,loading:i}),n===null)return console.log("❌ Access denied - user is not an admin"),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."}),a.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["User ID: ",r==null?void 0:r.id]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Admin Status: ",n===null?"Not Admin":n===void 0?"Loading...":"Admin"]}),a.jsx("button",{onClick:()=>window.location.href="/login",className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Return to Login"})]})});if(n===void 0)return console.log("⏳ Admin status still loading..."),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Verifying admin permissions..."})]})});console.log("✅ Admin access granted:",n)}return a.jsx(a.Fragment,{children:t})}function _J(){var y,v;const[t,e]=O.useState(""),[r,n]=O.useState(""),[i,s]=O.useState(!1),[o,l]=O.useState(""),[c,u]=O.useState(!1),{user:f,signIn:d}=Ln(),m=((v=(y=rc().state)==null?void 0:y.from)==null?void 0:v.pathname)||"/dashboard";if(f)return a.jsx(da,{to:m,replace:!0});const x=async b=>{b.preventDefault(),l(""),u(!0);const{error:w}=await d(t,r);w&&l(w),u(!1)};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center mb-4",children:a.jsx(Ou,{className:"h-8 w-8 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"AI GYM"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Training Zone Access Portal"})]}),a.jsx("div",{className:"bg-white shadow-lg rounded-xl border border-gray-200 p-8",children:a.jsxs("form",{className:"space-y-6",onSubmit:x,children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:b=>e(b.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"admin@example.com",disabled:c})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"password",name:"password",type:i?"text":"password",autoComplete:"current-password",required:!0,value:r,onChange:b=>n(b.target.value),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",disabled:c}),a.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!i),disabled:c,children:i?a.jsx(TO,{className:"h-5 w-5 text-gray-400"}):a.jsx(ii,{className:"h-5 w-5 text-gray-400"})})]})]}),o&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-red-800",children:o})}),a.jsx("button",{type:"submit",disabled:c,className:"w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?a.jsxs(a.Fragment,{children:[a.jsx(cr,{size:"sm",className:"mr-2"}),"Signing in..."]}):"Sign In"})]})})]})})}function OJ(){var d;const{admin:t,signOut:e}=Ln(),[r,n]=O.useState(!1),[i,s]=O.useState(!1),o=rc(),l=[{name:"Dashboard",href:"/dashboard",icon:PO},{name:"Clients",href:"/clients",icon:Ou},{name:"Users",href:"/users",icon:oi},{name:"Tags",href:"/tags",icon:Es},{name:"Training Zone",href:"/training-zone",icon:Sh}],c=[{name:"AI Agents",href:"/content/ai-agents",icon:Kr,color:"#3B82F6"},{name:"Videos",href:"/content/videos",icon:si,color:"#EF4444"},{name:"Documents",href:"/content/documents",icon:Ot,color:"#10B981"},{name:"Prompts",href:"/content/prompts",icon:Gr,color:"#8B5CF6"},{name:"Automations",href:"/content/automations",icon:Ei,color:"#F59E0B"}],u=async()=>{await e()},f=o.pathname.startsWith("/content");return a.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsxs(Qn,{to:"/dashboard",className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center",children:a.jsx(Ou,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"AI GYM"}),a.jsx("p",{className:"text-xs text-gray-500",children:"by AI Workify"})]})]})}),a.jsxs("nav",{className:"hidden md:flex space-x-8",children:[l.map(p=>{const m=o.pathname===p.href,x=p.icon;return a.jsxs(Qn,{to:p.href,className:`inline-flex items-center space-x-1 px-1 pt-1 text-sm font-medium transition-colors ${m?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[a.jsx(x,{className:"h-4 w-4"}),a.jsx("span",{children:p.name})]},p.name)}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!i),className:`inline-flex items-center space-x-1 px-1 pt-1 text-sm font-medium transition-colors ${f?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Ot,{className:"h-4 w-4"}),a.jsx("span",{children:"Content"}),a.jsx(mo,{className:"h-3 w-3"})]}),i&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),a.jsx("div",{className:"absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:a.jsxs("div",{className:"py-2",children:[a.jsx("div",{className:"px-3 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Repositories"}),c.map(p=>{const m=p.icon,x=o.pathname===p.href;return a.jsxs(Qn,{to:p.href,className:`flex items-center px-3 py-2 text-sm transition-colors ${x?"bg-blue-50 text-blue-700 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[a.jsx(m,{className:"mr-3 h-4 w-4",style:{color:p.color}}),p.name]},p.name)})]})})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>n(!r),className:"flex items-center space-x-3 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-sm font-medium",children:t==null?void 0:t.email.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"hidden md:block text-left",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.email}),a.jsx("p",{className:"text-xs text-gray-500 capitalize",children:(d=t==null?void 0:t.role)==null?void 0:d.replace("_"," ")})]}),a.jsx(mo,{className:"h-4 w-4 text-gray-400"})]})}),r&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:a.jsxs("div",{className:"py-1",children:[a.jsxs(Qn,{to:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>n(!1),children:[a.jsx(Dn,{className:"mr-3 h-4 w-4"}),"Settings"]}),a.jsxs("button",{onClick:u,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[a.jsx(LB,{className:"mr-3 h-4 w-4"}),"Sign Out"]})]})})]})]})]})})})}function pr({children:t}){return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(OJ,{}),a.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:t})]})}var zw,OM;function $n(){if(OM)return zw;OM=1;var t=Array.isArray;return zw=t,zw}var Uw,EM;function XB(){if(EM)return Uw;EM=1;var t=typeof ag=="object"&&ag&&ag.Object===Object&&ag;return Uw=t,Uw}var Hw,CM;function Is(){if(CM)return Hw;CM=1;var t=XB(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return Hw=r,Hw}var Ww,AM;function Ap(){if(AM)return Ww;AM=1;var t=Is(),e=t.Symbol;return Ww=e,Ww}var Vw,TM;function EJ(){if(TM)return Vw;TM=1;var t=Ap(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function s(o){var l=r.call(o,i),c=o[i];try{o[i]=void 0;var u=!0}catch{}var f=n.call(o);return u&&(l?o[i]=c:delete o[i]),f}return Vw=s,Vw}var Kw,PM;function CJ(){if(PM)return Kw;PM=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return Kw=r,Kw}var Gw,MM;function _o(){if(MM)return Gw;MM=1;var t=Ap(),e=EJ(),r=CJ(),n="[object Null]",i="[object Undefined]",s=t?t.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?e(l):r(l)}return Gw=o,Gw}var Yw,RM;function Oo(){if(RM)return Yw;RM=1;function t(e){return e!=null&&typeof e=="object"}return Yw=t,Yw}var Xw,IM;function hd(){if(IM)return Xw;IM=1;var t=_o(),e=Oo(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return Xw=n,Xw}var Jw,DM;function $O(){if(DM)return Jw;DM=1;var t=$n(),e=hd(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){if(t(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||e(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Jw=i,Jw}var Qw,LM;function Fa(){if(LM)return Qw;LM=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return Qw=t,Qw}var Zw,$M;function BO(){if($M)return Zw;$M=1;var t=_o(),e=Fa(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var c=t(l);return c==n||c==i||c==r||c==s}return Zw=o,Zw}var e1,BM;function AJ(){if(BM)return e1;BM=1;var t=Is(),e=t["__core-js_shared__"];return e1=e,e1}var t1,FM;function TJ(){if(FM)return t1;FM=1;var t=AJ(),e=function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!e&&e in n}return t1=r,t1}var r1,qM;function JB(){if(qM)return r1;qM=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return r1=r,r1}var n1,zM;function PJ(){if(zM)return n1;zM=1;var t=BO(),e=TJ(),r=Fa(),n=JB(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,f=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!r(p)||e(p))return!1;var m=t(p)?f:s;return m.test(n(p))}return n1=d,n1}var i1,UM;function MJ(){if(UM)return i1;UM=1;function t(e,r){return e==null?void 0:e[r]}return i1=t,i1}var s1,HM;function ic(){if(HM)return s1;HM=1;var t=PJ(),e=MJ();function r(n,i){var s=e(n,i);return t(s)?s:void 0}return s1=r,s1}var o1,WM;function A0(){if(WM)return o1;WM=1;var t=ic(),e=t(Object,"create");return o1=e,o1}var a1,VM;function RJ(){if(VM)return a1;VM=1;var t=A0();function e(){this.__data__=t?t(null):{},this.size=0}return a1=e,a1}var l1,KM;function IJ(){if(KM)return l1;KM=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return l1=t,l1}var c1,GM;function DJ(){if(GM)return c1;GM=1;var t=A0(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(s){var o=this.__data__;if(t){var l=o[s];return l===e?void 0:l}return n.call(o,s)?o[s]:void 0}return c1=i,c1}var u1,YM;function LJ(){if(YM)return u1;YM=1;var t=A0(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var s=this.__data__;return t?s[i]!==void 0:r.call(s,i)}return u1=n,u1}var d1,XM;function $J(){if(XM)return d1;XM=1;var t=A0(),e="__lodash_hash_undefined__";function r(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=t&&i===void 0?e:i,this}return d1=r,d1}var f1,JM;function BJ(){if(JM)return f1;JM=1;var t=RJ(),e=IJ(),r=DJ(),n=LJ(),i=$J();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,f1=s,f1}var h1,QM;function FJ(){if(QM)return h1;QM=1;function t(){this.__data__=[],this.size=0}return h1=t,h1}var p1,ZM;function FO(){if(ZM)return p1;ZM=1;function t(e,r){return e===r||e!==e&&r!==r}return p1=t,p1}var m1,eR;function T0(){if(eR)return m1;eR=1;var t=FO();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return m1=e,m1}var g1,tR;function qJ(){if(tR)return g1;tR=1;var t=T0(),e=Array.prototype,r=e.splice;function n(i){var s=this.__data__,o=t(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return g1=n,g1}var y1,rR;function zJ(){if(rR)return y1;rR=1;var t=T0();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return y1=e,y1}var v1,nR;function UJ(){if(nR)return v1;nR=1;var t=T0();function e(r){return t(this.__data__,r)>-1}return v1=e,v1}var x1,iR;function HJ(){if(iR)return x1;iR=1;var t=T0();function e(r,n){var i=this.__data__,s=t(i,r);return s<0?(++this.size,i.push([r,n])):i[s][1]=n,this}return x1=e,x1}var b1,sR;function P0(){if(sR)return b1;sR=1;var t=FJ(),e=qJ(),r=zJ(),n=UJ(),i=HJ();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,b1=s,b1}var w1,oR;function qO(){if(oR)return w1;oR=1;var t=ic(),e=Is(),r=t(e,"Map");return w1=r,w1}var j1,aR;function WJ(){if(aR)return j1;aR=1;var t=BJ(),e=P0(),r=qO();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return j1=n,j1}var S1,lR;function VJ(){if(lR)return S1;lR=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return S1=t,S1}var N1,cR;function M0(){if(cR)return N1;cR=1;var t=VJ();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return N1=e,N1}var k1,uR;function KJ(){if(uR)return k1;uR=1;var t=M0();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return k1=e,k1}var _1,dR;function GJ(){if(dR)return _1;dR=1;var t=M0();function e(r){return t(this,r).get(r)}return _1=e,_1}var O1,fR;function YJ(){if(fR)return O1;fR=1;var t=M0();function e(r){return t(this,r).has(r)}return O1=e,O1}var E1,hR;function XJ(){if(hR)return E1;hR=1;var t=M0();function e(r,n){var i=t(this,r),s=i.size;return i.set(r,n),this.size+=i.size==s?0:1,this}return E1=e,E1}var C1,pR;function zO(){if(pR)return C1;pR=1;var t=WJ(),e=KJ(),r=GJ(),n=YJ(),i=XJ();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,C1=s,C1}var A1,mR;function QB(){if(mR)return A1;mR=1;var t=zO(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var u=n.apply(this,o);return s.cache=c.set(l,u)||c,u};return s.cache=new(r.Cache||t),s}return r.Cache=t,A1=r,A1}var T1,gR;function JJ(){if(gR)return T1;gR=1;var t=QB(),e=500;function r(n){var i=t(n,function(o){return s.size===e&&s.clear(),o}),s=i.cache;return i}return T1=r,T1}var P1,yR;function QJ(){if(yR)return P1;yR=1;var t=JJ(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(e,function(o,l,c,u){s.push(c?u.replace(r,"$1"):l||o)}),s});return P1=n,P1}var M1,vR;function UO(){if(vR)return M1;vR=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,s=Array(i);++n<i;)s[n]=r(e[n],n,e);return s}return M1=t,M1}var R1,xR;function ZJ(){if(xR)return R1;xR=1;var t=Ap(),e=UO(),r=$n(),n=hd(),i=t?t.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return e(l,o)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return R1=o,R1}var I1,bR;function ZB(){if(bR)return I1;bR=1;var t=ZJ();function e(r){return r==null?"":t(r)}return I1=e,I1}var D1,wR;function eF(){if(wR)return D1;wR=1;var t=$n(),e=$O(),r=QJ(),n=ZB();function i(s,o){return t(s)?s:e(s,o)?[s]:r(n(s))}return D1=i,D1}var L1,jR;function R0(){if(jR)return L1;jR=1;var t=hd();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return L1=e,L1}var $1,SR;function HO(){if(SR)return $1;SR=1;var t=eF(),e=R0();function r(n,i){i=t(i,n);for(var s=0,o=i.length;n!=null&&s<o;)n=n[e(i[s++])];return s&&s==o?n:void 0}return $1=r,$1}var B1,NR;function tF(){if(NR)return B1;NR=1;var t=HO();function e(r,n,i){var s=r==null?void 0:t(r,n);return s===void 0?i:s}return B1=e,B1}var eQ=tF();const ei=ht(eQ);var F1,kR;function tQ(){if(kR)return F1;kR=1;function t(e){return e==null}return F1=t,F1}var rQ=tQ();const tt=ht(rQ);var q1,_R;function nQ(){if(_R)return q1;_R=1;var t=_o(),e=$n(),r=Oo(),n="[object String]";function i(s){return typeof s=="string"||!e(s)&&r(s)&&t(s)==n}return q1=i,q1}var iQ=nQ();const Tp=ht(iQ);var sQ=BO();const Ze=ht(sQ);var oQ=Fa();const pd=ht(oQ);var z1={exports:{}},xt={};/**
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h8(t,e){if(t){if(typeof t=="string")return O2(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O2(t,e)}}function Upe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hpe(t){if(Array.isArray(t))return O2(t)}function O2(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b5(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?b5(Object(r),!0).forEach(function(n){Xe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b5(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xe(t,e,r){return e=p8(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p8(t){var e=Wpe(t,"string");return Qu(e)=="symbol"?e:e+""}function Wpe(t,e){if(Qu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vpe={xAxis:["bottom","top"],yAxis:["left","right"]},Kpe={width:"100%",height:"100%"},m8={x:0,y:0};function _g(t){return t}var Gpe=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},Ype=function(e,r,n,i){var s=r.find(function(f){return f&&f.index===n});if(s){if(e==="horizontal")return{x:s.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:s.coordinate};if(e==="centric"){var o=s.coordinate,l=i.radius;return xe(xe(xe({},i),Lt(i.cx,i.cy,l,o)),{},{angle:o,radius:l})}var c=s.coordinate,u=i.angle;return xe(xe(xe({},i),Lt(i.cx,i.cy,c,u)),{},{angle:u,radius:c})}return m8},fx=function(e,r){var n=r.graphicalItems,i=r.dataStartIndex,s=r.dataEndIndex,o=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(Zu(l),Zu(u)):l},[]);return o.length>0?o:e&&e.length&&Pe(i)&&Pe(s)?e.slice(i,s+1):[]};function g8(t){return t==="number"?[0,"auto"]:void 0}var E2=function(e,r,n,i){var s=e.graphicalItems,o=e.tooltipAxis,l=fx(r,e);return n<0||!s||!s.length||n>=l.length?null:s.reduce(function(c,u){var f,d=(f=u.props.data)!==null&&f!==void 0?f:r;d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1));var p;if(o.dataKey&&!o.allowDuplicatedCategory){var m=d===void 0?l:d;p=by(m,o.dataKey,i)}else p=d&&d[n]||l[n];return p?[].concat(Zu(c),[oz(u,p)]):c},[])},w5=function(e,r,n,i){var s=i||{x:e.chartX,y:e.chartY},o=Gpe(s,n),l=e.orderedTooltipTicks,c=e.tooltipAxis,u=e.tooltipTicks,f=boe(o,l,u,c);if(f>=0&&u){var d=u[f]&&u[f].value,p=E2(e,r,f,d),m=Ype(n,l,f,s);return{activeTooltipIndex:f,activeLabel:d,activePayload:p,activeCoordinate:m}}return null},Xpe=function(e,r){var n=r.axes,i=r.graphicalItems,s=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=e.layout,d=e.children,p=e.stackOffset,m=ez(f,s);return n.reduce(function(x,y){var v,b=y.type.defaultProps!==void 0?xe(xe({},y.type.defaultProps),y.props):y.props,w=b.type,N=b.dataKey,j=b.allowDataOverflow,k=b.allowDuplicatedCategory,_=b.scale,E=b.ticks,A=b.includeHidden,T=b[o];if(x[T])return x;var M=fx(e.data,{graphicalItems:i.filter(function(U){var G,ee=o in U.props?U.props[o]:(G=U.type.defaultProps)===null||G===void 0?void 0:G[o];return ee===T}),dataStartIndex:c,dataEndIndex:u}),P=M.length,R,L,$;jpe(b.domain,j,w)&&(R=z_(b.domain,null,j),m&&(w==="number"||_!=="auto")&&($=th(M,N,"category")));var F=g8(w);if(!R||R.length===0){var z,W=(z=b.domain)!==null&&z!==void 0?z:F;if(N){if(R=th(M,N,w),w==="category"&&m){var K=mQ(R);k&&K?(L=R,R=iv(0,P)):k||(R=w3(W,R,y).reduce(function(U,G){return U.indexOf(G)>=0?U:[].concat(Zu(U),[G])},[]))}else if(w==="category")k?R=R.filter(function(U){return U!==""&&!tt(U)}):R=w3(W,R,y).reduce(function(U,G){return U.indexOf(G)>=0||G===""||tt(G)?U:[].concat(Zu(U),[G])},[]);else if(w==="number"){var q=koe(M,i.filter(function(U){var G,ee,Q=o in U.props?U.props[o]:(G=U.type.defaultProps)===null||G===void 0?void 0:G[o],H="hide"in U.props?U.props.hide:(ee=U.type.defaultProps)===null||ee===void 0?void 0:ee.hide;return Q===T&&(A||!H)}),N,s,f);q&&(R=q)}m&&(w==="number"||_!=="auto")&&($=th(M,N,"category"))}else m?R=iv(0,P):l&&l[T]&&l[T].hasStack&&w==="number"?R=p==="expand"?[0,1]:sz(l[T].stackGroups,c,u):R=Zq(M,i.filter(function(U){var G=o in U.props?U.props[o]:U.type.defaultProps[o],ee="hide"in U.props?U.props.hide:U.type.defaultProps.hide;return G===T&&(A||!ee)}),w,f,!0);if(w==="number")R=k2(d,R,T,s,E),W&&(R=z_(W,R,j));else if(w==="category"&&W){var V=W,D=R.every(function(U){return V.indexOf(U)>=0});D&&(R=V)}}return xe(xe({},x),{},Xe({},T,xe(xe({},b),{},{axisType:s,domain:R,categoricalDomain:$,duplicateDomain:L,originalDomain:(v=b.domain)!==null&&v!==void 0?v:F,isCategorical:m,layout:f})))},{})},Jpe=function(e,r){var n=r.graphicalItems,i=r.Axis,s=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=e.layout,d=e.children,p=fx(e.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),m=p.length,x=ez(f,s),y=-1;return n.reduce(function(v,b){var w=b.type.defaultProps!==void 0?xe(xe({},b.type.defaultProps),b.props):b.props,N=w[o],j=g8("number");if(!v[N]){y++;var k;return x?k=iv(0,m):l&&l[N]&&l[N].hasStack?(k=sz(l[N].stackGroups,c,u),k=k2(d,k,N,s)):(k=z_(j,Zq(p,n.filter(function(_){var E,A,T=o in _.props?_.props[o]:(E=_.type.defaultProps)===null||E===void 0?void 0:E[o],M="hide"in _.props?_.props.hide:(A=_.type.defaultProps)===null||A===void 0?void 0:A.hide;return T===N&&!M}),"number",f),i.defaultProps.allowDataOverflow),k=k2(d,k,N,s)),xe(xe({},v),{},Xe({},N,xe(xe({axisType:s},i.defaultProps),{},{hide:!0,orientation:ei(Vpe,"".concat(s,".").concat(y%2),null),domain:k,originalDomain:j,isCategorical:x,layout:f})))}return v},{})},Qpe=function(e,r){var n=r.axisType,i=n===void 0?"xAxis":n,s=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=e.children,d="".concat(i,"Id"),p=ti(f,s),m={};return p&&p.length?m=Xpe(e,{axes:p,graphicalItems:o,axisType:i,axisIdKey:d,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):o&&o.length&&(m=Jpe(e,{Axis:s,graphicalItems:o,axisType:i,axisIdKey:d,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),m},Zpe=function(e){var r=ha(e),n=oo(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:iE(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Wy(r,n)}},j5=function(e){var r=e.children,n=e.defaultShowTooltip,i=Vn(r,Uu),s=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(s=i.props.startIndex),i.props.endIndex>=0&&(o=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},eme=function(e){return!e||!e.length?!1:e.some(function(r){var n=co(r&&r.type);return n&&n.indexOf("Bar")>=0})},S5=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},tme=function(e,r){var n=e.props,i=e.graphicalItems,s=e.xAxisMap,o=s===void 0?{}:s,l=e.yAxisMap,c=l===void 0?{}:l,u=n.width,f=n.height,d=n.children,p=n.margin||{},m=Vn(d,Uu),x=Vn(d,vu),y=Object.keys(c).reduce(function(k,_){var E=c[_],A=E.orientation;return!E.mirror&&!E.hide?xe(xe({},k),{},Xe({},A,k[A]+E.width)):k},{left:p.left||0,right:p.right||0}),v=Object.keys(o).reduce(function(k,_){var E=o[_],A=E.orientation;return!E.mirror&&!E.hide?xe(xe({},k),{},Xe({},A,ei(k,"".concat(A))+E.height)):k},{top:p.top||0,bottom:p.bottom||0}),b=xe(xe({},v),y),w=b.bottom;m&&(b.bottom+=m.props.height||Uu.defaultProps.height),x&&r&&(b=Soe(b,i,n,r));var N=u-b.left-b.right,j=f-b.top-b.bottom;return xe(xe({brushBottom:w},b),{},{width:Math.max(N,0),height:Math.max(j,0)})},rme=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},zE=function(e){var r=e.chartName,n=e.GraphicalChild,i=e.defaultTooltipEventType,s=i===void 0?"axis":i,o=e.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=e.axisComponents,u=e.legendContent,f=e.formatAxisMap,d=e.defaultProps,p=function(b,w){var N=w.graphicalItems,j=w.stackGroups,k=w.offset,_=w.updateId,E=w.dataStartIndex,A=w.dataEndIndex,T=b.barSize,M=b.layout,P=b.barGap,R=b.barCategoryGap,L=b.maxBarSize,$=S5(M),F=$.numericAxisName,z=$.cateAxisName,W=eme(N),K=[];return N.forEach(function(q,V){var D=fx(b.data,{graphicalItems:[q],dataStartIndex:E,dataEndIndex:A}),U=q.type.defaultProps!==void 0?xe(xe({},q.type.defaultProps),q.props):q.props,G=U.dataKey,ee=U.maxBarSize,Q=U["".concat(F,"Id")],H=U["".concat(z,"Id")],Y={},re=c.reduce(function(Oe,be){var We=w["".concat(be.axisType,"Map")],Je=U["".concat(be.axisType,"Id")];We&&We[Je]||be.axisType==="zAxis"||Wl();var Ye=We[Je];return xe(xe({},Oe),{},Xe(Xe({},be.axisType,Ye),"".concat(be.axisType,"Ticks"),oo(Ye)))},Y),J=re[z],ne=re["".concat(z,"Ticks")],te=j&&j[Q]&&j[Q].hasStack&&Roe(q,j[Q].stackGroups),se=co(q.type).indexOf("Bar")>=0,ve=Wy(J,ne),ie=[],ye=W&&woe({barSize:T,stackGroups:j,totalSize:rme(re,z)});if(se){var Te,Le,ue=tt(ee)?L:ee,he=(Te=(Le=Wy(J,ne,!0))!==null&&Le!==void 0?Le:ue)!==null&&Te!==void 0?Te:0;ie=joe({barGap:P,barCategoryGap:R,bandSize:he!==ve?he:ve,sizeList:ye[H],maxBarSize:ue}),he!==ve&&(ie=ie.map(function(Oe){return xe(xe({},Oe),{},{position:xe(xe({},Oe.position),{},{offset:Oe.position.offset-he/2})})}))}var we=q&&q.type&&q.type.getComposedData;we&&K.push({props:xe(xe({},we(xe(xe({},re),{},{displayedData:D,props:b,dataKey:G,item:q,bandSize:ve,barPosition:ie,offset:k,stackedData:te,layout:M,dataStartIndex:E,dataEndIndex:A}))),{},Xe(Xe(Xe({key:q.key||"item-".concat(V)},F,re[F]),z,re[z]),"animationId",_)),childIndex:OQ(q,b.children),item:q})}),K},m=function(b,w){var N=b.props,j=b.dataStartIndex,k=b.dataEndIndex,_=b.updateId;if(!IR({props:N}))return null;var E=N.children,A=N.layout,T=N.stackOffset,M=N.data,P=N.reverseStackOrder,R=S5(A),L=R.numericAxisName,$=R.cateAxisName,F=ti(E,n),z=Poe(M,F,"".concat(L,"Id"),"".concat($,"Id"),T,P),W=c.reduce(function(U,G){var ee="".concat(G.axisType,"Map");return xe(xe({},U),{},Xe({},ee,Qpe(N,xe(xe({},G),{},{graphicalItems:F,stackGroups:G.axisType===L&&z,dataStartIndex:j,dataEndIndex:k}))))},{}),K=tme(xe(xe({},W),{},{props:N,graphicalItems:F}),w==null?void 0:w.legendBBox);Object.keys(W).forEach(function(U){W[U]=f(N,W[U],K,U.replace("Map",""),r)});var q=W["".concat($,"Map")],V=Zpe(q),D=p(N,xe(xe({},W),{},{dataStartIndex:j,dataEndIndex:k,updateId:_,graphicalItems:F,stackGroups:z,offset:K}));return xe(xe({formattedGraphicalItems:D,graphicalItems:F,offset:K,stackGroups:z},V),W)},x=function(v){function b(w){var N,j,k;return Ipe(this,b),k=$pe(this,b,[w]),Xe(k,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Xe(k,"accessibilityManager",new wpe),Xe(k,"handleLegendBBoxUpdate",function(_){if(_){var E=k.state,A=E.dataStartIndex,T=E.dataEndIndex,M=E.updateId;k.setState(xe({legendBBox:_},m({props:k.props,dataStartIndex:A,dataEndIndex:T,updateId:M},xe(xe({},k.state),{},{legendBBox:_}))))}}),Xe(k,"handleReceiveSyncEvent",function(_,E,A){if(k.props.syncId===_){if(A===k.eventEmitterSymbol&&typeof k.props.syncMethod!="function")return;k.applySyncEvent(E)}}),Xe(k,"handleBrushChange",function(_){var E=_.startIndex,A=_.endIndex;if(E!==k.state.dataStartIndex||A!==k.state.dataEndIndex){var T=k.state.updateId;k.setState(function(){return xe({dataStartIndex:E,dataEndIndex:A},m({props:k.props,dataStartIndex:E,dataEndIndex:A,updateId:T},k.state))}),k.triggerSyncEvent({dataStartIndex:E,dataEndIndex:A})}}),Xe(k,"handleMouseEnter",function(_){var E=k.getMouseInfo(_);if(E){var A=xe(xe({},E),{},{isTooltipActive:!0});k.setState(A),k.triggerSyncEvent(A);var T=k.props.onMouseEnter;Ze(T)&&T(A,_)}}),Xe(k,"triggeredAfterMouseMove",function(_){var E=k.getMouseInfo(_),A=E?xe(xe({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};k.setState(A),k.triggerSyncEvent(A);var T=k.props.onMouseMove;Ze(T)&&T(A,_)}),Xe(k,"handleItemMouseEnter",function(_){k.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),Xe(k,"handleItemMouseLeave",function(){k.setState(function(){return{isTooltipActive:!1}})}),Xe(k,"handleMouseMove",function(_){_.persist(),k.throttleTriggeredAfterMouseMove(_)}),Xe(k,"handleMouseLeave",function(_){k.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};k.setState(E),k.triggerSyncEvent(E);var A=k.props.onMouseLeave;Ze(A)&&A(E,_)}),Xe(k,"handleOuterEvent",function(_){var E=_Q(_),A=ei(k.props,"".concat(E));if(E&&Ze(A)){var T,M;/.*touch.*/i.test(E)?M=k.getMouseInfo(_.changedTouches[0]):M=k.getMouseInfo(_),A((T=M)!==null&&T!==void 0?T:{},_)}}),Xe(k,"handleClick",function(_){var E=k.getMouseInfo(_);if(E){var A=xe(xe({},E),{},{isTooltipActive:!0});k.setState(A),k.triggerSyncEvent(A);var T=k.props.onClick;Ze(T)&&T(A,_)}}),Xe(k,"handleMouseDown",function(_){var E=k.props.onMouseDown;if(Ze(E)){var A=k.getMouseInfo(_);E(A,_)}}),Xe(k,"handleMouseUp",function(_){var E=k.props.onMouseUp;if(Ze(E)){var A=k.getMouseInfo(_);E(A,_)}}),Xe(k,"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&k.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),Xe(k,"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&k.handleMouseDown(_.changedTouches[0])}),Xe(k,"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&k.handleMouseUp(_.changedTouches[0])}),Xe(k,"handleDoubleClick",function(_){var E=k.props.onDoubleClick;if(Ze(E)){var A=k.getMouseInfo(_);E(A,_)}}),Xe(k,"handleContextMenu",function(_){var E=k.props.onContextMenu;if(Ze(E)){var A=k.getMouseInfo(_);E(A,_)}}),Xe(k,"triggerSyncEvent",function(_){k.props.syncId!==void 0&&FN.emit(qN,k.props.syncId,_,k.eventEmitterSymbol)}),Xe(k,"applySyncEvent",function(_){var E=k.props,A=E.layout,T=E.syncMethod,M=k.state.updateId,P=_.dataStartIndex,R=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)k.setState(xe({dataStartIndex:P,dataEndIndex:R},m({props:k.props,dataStartIndex:P,dataEndIndex:R,updateId:M},k.state)));else if(_.activeTooltipIndex!==void 0){var L=_.chartX,$=_.chartY,F=_.activeTooltipIndex,z=k.state,W=z.offset,K=z.tooltipTicks;if(!W)return;if(typeof T=="function")F=T(K,_);else if(T==="value"){F=-1;for(var q=0;q<K.length;q++)if(K[q].value===_.activeLabel){F=q;break}}var V=xe(xe({},W),{},{x:W.left,y:W.top}),D=Math.min(L,V.x+V.width),U=Math.min($,V.y+V.height),G=K[F]&&K[F].value,ee=E2(k.state,k.props.data,F),Q=K[F]?{x:A==="horizontal"?K[F].coordinate:D,y:A==="horizontal"?U:K[F].coordinate}:m8;k.setState(xe(xe({},_),{},{activeLabel:G,activeCoordinate:Q,activePayload:ee,activeTooltipIndex:F}))}else k.setState(_)}),Xe(k,"renderCursor",function(_){var E,A=k.state,T=A.isTooltipActive,M=A.activeCoordinate,P=A.activePayload,R=A.offset,L=A.activeTooltipIndex,$=A.tooltipAxisBandSize,F=k.getTooltipEventType(),z=(E=_.props.active)!==null&&E!==void 0?E:T,W=k.props.layout,K=_.key||"_recharts-cursor";return Z.createElement(Epe,{key:K,activeCoordinate:M,activePayload:P,activeTooltipIndex:L,chartName:r,element:_,isActive:z,layout:W,offset:R,tooltipAxisBandSize:$,tooltipEventType:F})}),Xe(k,"renderPolarAxis",function(_,E,A){var T=ei(_,"type.axisType"),M=ei(k.state,"".concat(T,"Map")),P=_.type.defaultProps,R=P!==void 0?xe(xe({},P),_.props):_.props,L=M&&M[R["".concat(T,"Id")]];return O.cloneElement(_,xe(xe({},L),{},{className:it(T,L.className),key:_.key||"".concat(E,"-").concat(A),ticks:oo(L,!0)}))}),Xe(k,"renderPolarGrid",function(_){var E=_.props,A=E.radialLines,T=E.polarAngles,M=E.polarRadius,P=k.state,R=P.radiusAxisMap,L=P.angleAxisMap,$=ha(R),F=ha(L),z=F.cx,W=F.cy,K=F.innerRadius,q=F.outerRadius;return O.cloneElement(_,{polarAngles:Array.isArray(T)?T:oo(F,!0).map(function(V){return V.coordinate}),polarRadius:Array.isArray(M)?M:oo($,!0).map(function(V){return V.coordinate}),cx:z,cy:W,innerRadius:K,outerRadius:q,key:_.key||"polar-grid",radialLines:A})}),Xe(k,"renderLegend",function(){var _=k.state.formattedGraphicalItems,E=k.props,A=E.children,T=E.width,M=E.height,P=k.props.margin||{},R=T-(P.left||0)-(P.right||0),L=Jq({children:A,formattedGraphicalItems:_,legendWidth:R,legendContent:u});if(!L)return null;var $=L.item,F=x5(L,Cpe);return O.cloneElement($,xe(xe({},F),{},{chartWidth:T,chartHeight:M,margin:P,onBBoxUpdate:k.handleLegendBBoxUpdate}))}),Xe(k,"renderTooltip",function(){var _,E=k.props,A=E.children,T=E.accessibilityLayer,M=Vn(A,wi);if(!M)return null;var P=k.state,R=P.isTooltipActive,L=P.activeCoordinate,$=P.activePayload,F=P.activeLabel,z=P.offset,W=(_=M.props.active)!==null&&_!==void 0?_:R;return O.cloneElement(M,{viewBox:xe(xe({},z),{},{x:z.left,y:z.top}),active:W,label:F,payload:W?$:[],coordinate:L,accessibilityLayer:T})}),Xe(k,"renderBrush",function(_){var E=k.props,A=E.margin,T=E.data,M=k.state,P=M.offset,R=M.dataStartIndex,L=M.dataEndIndex,$=M.updateId;return O.cloneElement(_,{key:_.key||"_recharts-brush",onChange:wg(k.handleBrushChange,_.props.onChange),data:T,x:Pe(_.props.x)?_.props.x:P.left,y:Pe(_.props.y)?_.props.y:P.top+P.height+P.brushBottom-(A.bottom||0),width:Pe(_.props.width)?_.props.width:P.width,startIndex:R,endIndex:L,updateId:"brush-".concat($)})}),Xe(k,"renderReferenceElement",function(_,E,A){if(!_)return null;var T=k,M=T.clipPathId,P=k.state,R=P.xAxisMap,L=P.yAxisMap,$=P.offset,F=_.type.defaultProps||{},z=_.props,W=z.xAxisId,K=W===void 0?F.xAxisId:W,q=z.yAxisId,V=q===void 0?F.yAxisId:q;return O.cloneElement(_,{key:_.key||"".concat(E,"-").concat(A),xAxis:R[K],yAxis:L[V],viewBox:{x:$.left,y:$.top,width:$.width,height:$.height},clipPathId:M})}),Xe(k,"renderActivePoints",function(_){var E=_.item,A=_.activePoint,T=_.basePoint,M=_.childIndex,P=_.isRange,R=[],L=E.props.key,$=E.item.type.defaultProps!==void 0?xe(xe({},E.item.type.defaultProps),E.item.props):E.item.props,F=$.activeDot,z=$.dataKey,W=xe(xe({index:M,dataKey:z,cx:A.x,cy:A.y,r:4,fill:AE(E.item),strokeWidth:2,stroke:"#fff",payload:A.payload,value:A.value},Ge(F,!1)),wy(F));return R.push(b.renderActiveDot(F,W,"".concat(L,"-activePoint-").concat(M))),T?R.push(b.renderActiveDot(F,xe(xe({},W),{},{cx:T.x,cy:T.y}),"".concat(L,"-basePoint-").concat(M))):P&&R.push(null),R}),Xe(k,"renderGraphicChild",function(_,E,A){var T=k.filterFormatItem(_,E,A);if(!T)return null;var M=k.getTooltipEventType(),P=k.state,R=P.isTooltipActive,L=P.tooltipAxis,$=P.activeTooltipIndex,F=P.activeLabel,z=k.props.children,W=Vn(z,wi),K=T.props,q=K.points,V=K.isRange,D=K.baseLine,U=T.item.type.defaultProps!==void 0?xe(xe({},T.item.type.defaultProps),T.item.props):T.item.props,G=U.activeDot,ee=U.hide,Q=U.activeBar,H=U.activeShape,Y=!!(!ee&&R&&W&&(G||Q||H)),re={};M!=="axis"&&W&&W.props.trigger==="click"?re={onClick:wg(k.handleItemMouseEnter,_.props.onClick)}:M!=="axis"&&(re={onMouseLeave:wg(k.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:wg(k.handleItemMouseEnter,_.props.onMouseEnter)});var J=O.cloneElement(_,xe(xe({},T.props),re));function ne(be){return typeof L.dataKey=="function"?L.dataKey(be.payload):null}if(Y)if($>=0){var te,se;if(L.dataKey&&!L.allowDuplicatedCategory){var ve=typeof L.dataKey=="function"?ne:"payload.".concat(L.dataKey.toString());te=by(q,ve,F),se=V&&D&&by(D,ve,F)}else te=q==null?void 0:q[$],se=V&&D&&D[$];if(H||Q){var ie=_.props.activeIndex!==void 0?_.props.activeIndex:$;return[O.cloneElement(_,xe(xe(xe({},T.props),re),{},{activeIndex:ie})),null,null]}if(!tt(te))return[J].concat(Zu(k.renderActivePoints({item:T,activePoint:te,basePoint:se,childIndex:$,isRange:V})))}else{var ye,Te=(ye=k.getItemByXY(k.state.activeCoordinate))!==null&&ye!==void 0?ye:{graphicalItem:J},Le=Te.graphicalItem,ue=Le.item,he=ue===void 0?_:ue,we=Le.childIndex,Oe=xe(xe(xe({},T.props),re),{},{activeIndex:we});return[O.cloneElement(he,Oe),null,null]}return V?[J,null,null]:[J,null]}),Xe(k,"renderCustomized",function(_,E,A){return O.cloneElement(_,xe(xe({key:"recharts-customized-".concat(A)},k.props),k.state))}),Xe(k,"renderMap",{CartesianGrid:{handler:_g,once:!0},ReferenceArea:{handler:k.renderReferenceElement},ReferenceLine:{handler:_g},ReferenceDot:{handler:k.renderReferenceElement},XAxis:{handler:_g},YAxis:{handler:_g},Brush:{handler:k.renderBrush,once:!0},Bar:{handler:k.renderGraphicChild},Line:{handler:k.renderGraphicChild},Area:{handler:k.renderGraphicChild},Radar:{handler:k.renderGraphicChild},RadialBar:{handler:k.renderGraphicChild},Scatter:{handler:k.renderGraphicChild},Pie:{handler:k.renderGraphicChild},Funnel:{handler:k.renderGraphicChild},Tooltip:{handler:k.renderCursor,once:!0},PolarGrid:{handler:k.renderPolarGrid,once:!0},PolarAngleAxis:{handler:k.renderPolarAxis},PolarRadiusAxis:{handler:k.renderPolarAxis},Customized:{handler:k.renderCustomized}}),k.clipPathId="".concat((N=w.id)!==null&&N!==void 0?N:md("recharts"),"-clip"),k.throttleTriggeredAfterMouseMove=YF(k.triggeredAfterMouseMove,(j=w.throttleDelay)!==null&&j!==void 0?j:1e3/60),k.state={},k}return qpe(b,v),Lpe(b,[{key:"componentDidMount",value:function(){var N,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(N=this.props.margin.left)!==null&&N!==void 0?N:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var N=this.props,j=N.children,k=N.data,_=N.height,E=N.layout,A=Vn(j,wi);if(A){var T=A.props.defaultIndex;if(!(typeof T!="number"||T<0||T>this.state.tooltipTicks.length-1)){var M=this.state.tooltipTicks[T]&&this.state.tooltipTicks[T].value,P=E2(this.state,k,T,M),R=this.state.tooltipTicks[T].coordinate,L=(this.state.offset.top+_)/2,$=E==="horizontal",F=$?{x:R,y:L}:{y:R,x:L},z=this.state.formattedGraphicalItems.find(function(K){var q=K.item;return q.type.name==="Scatter"});z&&(F=xe(xe({},F),z.props.points[T].tooltipPosition),P=z.props.points[T].tooltipPayload);var W={activeTooltipIndex:T,isTooltipActive:!0,activeLabel:M,activePayload:P,activeCoordinate:F};this.setState(W),this.renderCursor(A),this.accessibilityManager.setIndex(T)}}}},{key:"getSnapshotBeforeUpdate",value:function(N,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==N.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==N.margin){var k,_;this.accessibilityManager.setDetails({offset:{left:(k=this.props.margin.left)!==null&&k!==void 0?k:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0}})}return null}},{key:"componentDidUpdate",value:function(N){c_([Vn(N.children,wi)],[Vn(this.props.children,wi)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var N=Vn(this.props.children,wi);if(N&&typeof N.props.shared=="boolean"){var j=N.props.shared?"axis":"item";return l.indexOf(j)>=0?j:s}return s}},{key:"getMouseInfo",value:function(N){if(!this.container)return null;var j=this.container,k=j.getBoundingClientRect(),_=hre(k),E={chartX:Math.round(N.pageX-_.left),chartY:Math.round(N.pageY-_.top)},A=k.width/j.offsetWidth||1,T=this.inRange(E.chartX,E.chartY,A);if(!T)return null;var M=this.state,P=M.xAxisMap,R=M.yAxisMap,L=this.getTooltipEventType(),$=w5(this.state,this.props.data,this.props.layout,T);if(L!=="axis"&&P&&R){var F=ha(P).scale,z=ha(R).scale,W=F&&F.invert?F.invert(E.chartX):null,K=z&&z.invert?z.invert(E.chartY):null;return xe(xe({},E),{},{xValue:W,yValue:K},$)}return $?xe(xe({},E),$):null}},{key:"inRange",value:function(N,j){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=this.props.layout,E=N/k,A=j/k;if(_==="horizontal"||_==="vertical"){var T=this.state.offset,M=E>=T.left&&E<=T.left+T.width&&A>=T.top&&A<=T.top+T.height;return M?{x:E,y:A}:null}var P=this.state,R=P.angleAxisMap,L=P.radiusAxisMap;if(R&&L){var $=ha(R);return N3({x:E,y:A},$)}return null}},{key:"parseEventsOfWrapper",value:function(){var N=this.props.children,j=this.getTooltipEventType(),k=Vn(N,wi),_={};k&&j==="axis"&&(k.props.trigger==="click"?_={onClick:this.handleClick}:_={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var E=wy(this.props,this.handleOuterEvent);return xe(xe({},E),_)}},{key:"addListener",value:function(){FN.on(qN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){FN.removeListener(qN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(N,j,k){for(var _=this.state.formattedGraphicalItems,E=0,A=_.length;E<A;E++){var T=_[E];if(T.item===N||T.props.key===N.key||j===co(T.item.type)&&k===T.childIndex)return T}return null}},{key:"renderClipPath",value:function(){var N=this.clipPathId,j=this.state.offset,k=j.left,_=j.top,E=j.height,A=j.width;return Z.createElement("defs",null,Z.createElement("clipPath",{id:N},Z.createElement("rect",{x:k,y:_,height:E,width:A})))}},{key:"getXScales",value:function(){var N=this.state.xAxisMap;return N?Object.entries(N).reduce(function(j,k){var _=v5(k,2),E=_[0],A=_[1];return xe(xe({},j),{},Xe({},E,A.scale))},{}):null}},{key:"getYScales",value:function(){var N=this.state.yAxisMap;return N?Object.entries(N).reduce(function(j,k){var _=v5(k,2),E=_[0],A=_[1];return xe(xe({},j),{},Xe({},E,A.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(N){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[N])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(N){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[N])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(N){var j=this.state,k=j.formattedGraphicalItems,_=j.activeItem;if(k&&k.length)for(var E=0,A=k.length;E<A;E++){var T=k[E],M=T.props,P=T.item,R=P.type.defaultProps!==void 0?xe(xe({},P.type.defaultProps),P.props):P.props,L=co(P.type);if(L==="Bar"){var $=(M.data||[]).find(function(K){return Cce(N,K)});if($)return{graphicalItem:T,payload:$}}else if(L==="RadialBar"){var F=(M.data||[]).find(function(K){return N3(N,K)});if(F)return{graphicalItem:T,payload:F}}else if(sx(T,_)||ox(T,_)||Zh(T,_)){var z=Zue({graphicalItem:T,activeTooltipItem:_,itemData:R.data}),W=R.activeIndex===void 0?z:R.activeIndex;return{graphicalItem:xe(xe({},T),{},{childIndex:W}),payload:Zh(T,_)?R.data[z]:T.props.data[z]}}}return null}},{key:"render",value:function(){var N=this;if(!IR(this))return null;var j=this.props,k=j.children,_=j.className,E=j.width,A=j.height,T=j.style,M=j.compact,P=j.title,R=j.desc,L=x5(j,Ape),$=Ge(L,!1);if(M)return Z.createElement(ZL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement(d_,hu({},$,{width:E,height:A,title:P,desc:R}),this.renderClipPath(),LR(k,this.renderMap)));if(this.props.accessibilityLayer){var F,z;$.tabIndex=(F=this.props.tabIndex)!==null&&F!==void 0?F:0,$.role=(z=this.props.role)!==null&&z!==void 0?z:"application",$.onKeyDown=function(K){N.accessibilityManager.keyboardEvent(K)},$.onFocus=function(){N.accessibilityManager.focus()}}var W=this.parseEventsOfWrapper();return Z.createElement(ZL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement("div",hu({className:it("recharts-wrapper",_),style:xe({position:"relative",cursor:"default",width:E,height:A},T)},W,{ref:function(q){N.container=q}}),Z.createElement(d_,hu({},$,{width:E,height:A,title:P,desc:R,style:Kpe}),this.renderClipPath(),LR(k,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(O.Component);Xe(x,"displayName",r),Xe(x,"defaultProps",xe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),Xe(x,"getDerivedStateFromProps",function(v,b){var w=v.dataKey,N=v.data,j=v.children,k=v.width,_=v.height,E=v.layout,A=v.stackOffset,T=v.margin,M=b.dataStartIndex,P=b.dataEndIndex;if(b.updateId===void 0){var R=j5(v);return xe(xe(xe({},R),{},{updateId:0},m(xe(xe({props:v},R),{},{updateId:0}),b)),{},{prevDataKey:w,prevData:N,prevWidth:k,prevHeight:_,prevLayout:E,prevStackOffset:A,prevMargin:T,prevChildren:j})}if(w!==b.prevDataKey||N!==b.prevData||k!==b.prevWidth||_!==b.prevHeight||E!==b.prevLayout||A!==b.prevStackOffset||!yu(T,b.prevMargin)){var L=j5(v),$={chartX:b.chartX,chartY:b.chartY,isTooltipActive:b.isTooltipActive},F=xe(xe({},w5(b,N,E)),{},{updateId:b.updateId+1}),z=xe(xe(xe({},L),$),F);return xe(xe(xe({},z),m(xe({props:v},z),b)),{},{prevDataKey:w,prevData:N,prevWidth:k,prevHeight:_,prevLayout:E,prevStackOffset:A,prevMargin:T,prevChildren:j})}if(!c_(j,b.prevChildren)){var W,K,q,V,D=Vn(j,Uu),U=D&&(W=(K=D.props)===null||K===void 0?void 0:K.startIndex)!==null&&W!==void 0?W:M,G=D&&(q=(V=D.props)===null||V===void 0?void 0:V.endIndex)!==null&&q!==void 0?q:P,ee=U!==M||G!==P,Q=!tt(N),H=Q&&!ee?b.updateId:b.updateId+1;return xe(xe({updateId:H},m(xe(xe({props:v},b),{},{updateId:H,dataStartIndex:U,dataEndIndex:G}),b)),{},{prevChildren:j,dataStartIndex:U,dataEndIndex:G})}return null}),Xe(x,"renderActiveDot",function(v,b,w){var N;return O.isValidElement(v)?N=O.cloneElement(v,b):Ze(v)?N=v(b):N=Z.createElement(ex,b),Z.createElement(gt,{className:"recharts-active-dot",key:w},N)});var y=O.forwardRef(function(b,w){return Z.createElement(x,hu({},b,{ref:w}))});return y.displayName=x.displayName,y},nme=zE({chartName:"LineChart",GraphicalChild:Fp,axisComponents:[{axisType:"xAxis",AxisComp:wd},{axisType:"yAxis",AxisComp:jd}],formatAxisMap:Dz}),ime=zE({chartName:"BarChart",GraphicalChild:cc,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:wd},{axisType:"yAxis",AxisComp:jd}],formatAxisMap:Dz}),sme=zE({chartName:"PieChart",GraphicalChild:Co,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:ix},{axisType:"radiusAxis",AxisComp:rx}],formatAxisMap:Hoe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function ai(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Aa(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function ome(t,e){const r=ai(t);return isNaN(e)?Aa(t,NaN):(r.setDate(r.getDate()+e),r)}const y8=6048e5,ame=864e5;let lme={};function hx(){return lme}function op(t,e){var l,c,u,f;const r=hx(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,i=ai(t),s=i.getDay(),o=(s<n?7:0)+s-n;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function vv(t){return op(t,{weekStartsOn:1})}function v8(t){const e=ai(t),r=e.getFullYear(),n=Aa(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=vv(n),s=Aa(t,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const o=vv(s);return e.getTime()>=i.getTime()?r+1:e.getTime()>=o.getTime()?r:r-1}function C2(t){const e=ai(t);return e.setHours(0,0,0,0),e}function N5(t){const e=ai(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function cme(t,e){const r=C2(t),n=C2(e),i=+r-N5(r),s=+n-N5(n);return Math.round((i-s)/ame)}function ume(t){const e=v8(t),r=Aa(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),vv(r)}function dme(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function fme(t){if(!dme(t)&&typeof t!="number")return!1;const e=ai(t);return!isNaN(Number(e))}function hme(t){const e=ai(t);return e.setHours(23,59,59,999),e}function pme(t){const e=ai(t),r=Aa(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}const mme={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gme=(t,e,r)=>{let n;const i=mme[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function UN(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const yme={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},vme={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},xme={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bme={date:UN({formats:yme,defaultWidth:"full"}),time:UN({formats:vme,defaultWidth:"full"}),dateTime:UN({formats:xme,defaultWidth:"full"})},wme={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},jme=(t,e,r,n)=>wme[t];function Tf(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;i=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return i[s]}}const Sme={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Nme={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kme={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_me={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ome={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Eme={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Cme=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Ame={ordinalNumber:Cme,era:Tf({values:Sme,defaultWidth:"wide"}),quarter:Tf({values:Nme,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Tf({values:kme,defaultWidth:"wide"}),day:Tf({values:_me,defaultWidth:"wide"}),dayPeriod:Tf({values:Ome,defaultWidth:"wide",formattingValues:Eme,defaultFormattingWidth:"wide"})};function Pf(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Pme(l,d=>d.test(o)):Tme(l,d=>d.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const f=e.slice(o.length);return{value:u,rest:f}}}function Tme(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function Pme(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Mme(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(i.length);return{value:o,rest:l}}}const Rme=/^(\d+)(th|st|nd|rd)?/i,Ime=/\d+/i,Dme={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Lme={any:[/^b/i,/^(a|c)/i]},$me={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Bme={any:[/1/i,/2/i,/3/i,/4/i]},Fme={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},qme={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},zme={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ume={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Hme={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Wme={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Vme={ordinalNumber:Mme({matchPattern:Rme,parsePattern:Ime,valueCallback:t=>parseInt(t,10)}),era:Pf({matchPatterns:Dme,defaultMatchWidth:"wide",parsePatterns:Lme,defaultParseWidth:"any"}),quarter:Pf({matchPatterns:$me,defaultMatchWidth:"wide",parsePatterns:Bme,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Pf({matchPatterns:Fme,defaultMatchWidth:"wide",parsePatterns:qme,defaultParseWidth:"any"}),day:Pf({matchPatterns:zme,defaultMatchWidth:"wide",parsePatterns:Ume,defaultParseWidth:"any"}),dayPeriod:Pf({matchPatterns:Hme,defaultMatchWidth:"any",parsePatterns:Wme,defaultParseWidth:"any"})},Kme={code:"en-US",formatDistance:gme,formatLong:bme,formatRelative:jme,localize:Ame,match:Vme,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Gme(t){const e=ai(t);return cme(e,pme(e))+1}function Yme(t){const e=ai(t),r=+vv(e)-+ume(e);return Math.round(r/y8)+1}function x8(t,e){var f,d,p,m;const r=ai(t),n=r.getFullYear(),i=hx(),s=(e==null?void 0:e.firstWeekContainsDate)??((d=(f=e==null?void 0:e.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((m=(p=i.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,o=Aa(t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=op(o,e),c=Aa(t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=op(c,e);return r.getTime()>=l.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function Xme(t,e){var l,c,u,f;const r=hx(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,i=x8(t,e),s=Aa(t,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),op(s,e)}function Jme(t,e){const r=ai(t),n=+op(r,e)-+Xme(r,e);return Math.round(n/y8)+1}function Nt(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const ea={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Nt(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Nt(r+1,2)},d(t,e){return Nt(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Nt(t.getHours()%12||12,e.length)},H(t,e){return Nt(t.getHours(),e.length)},m(t,e){return Nt(t.getMinutes(),e.length)},s(t,e){return Nt(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Nt(i,e.length)}},Jc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},k5={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return ea.y(t,e)},Y:function(t,e,r,n){const i=x8(t,n),s=i>0?i:1-i;if(e==="YY"){const o=s%100;return Nt(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Nt(s,e.length)},R:function(t,e){const r=v8(t);return Nt(r,e.length)},u:function(t,e){const r=t.getFullYear();return Nt(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Nt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Nt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return ea.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Nt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const i=Jme(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):Nt(i,e.length)},I:function(t,e,r){const n=Yme(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Nt(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):ea.d(t,e)},D:function(t,e,r){const n=Gme(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Nt(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const i=t.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Nt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const i=t.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Nt(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return Nt(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let i;switch(n===12?i=Jc.noon:n===0?i=Jc.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let i;switch(n>=17?i=Jc.evening:n>=12?i=Jc.afternoon:n>=4?i=Jc.morning:i=Jc.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ea.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):ea.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Nt(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Nt(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):ea.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):ea.s(t,e)},S:function(t,e){return ea.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return O5(n);case"XXXX":case"XX":return bl(n);case"XXXXX":case"XXX":default:return bl(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return O5(n);case"xxxx":case"xx":return bl(n);case"xxxxx":case"xxx":default:return bl(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+_5(n,":");case"OOOO":default:return"GMT"+bl(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+_5(n,":");case"zzzz":default:return"GMT"+bl(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return Nt(n,e.length)},T:function(t,e,r){const n=t.getTime();return Nt(n,e.length)}};function _5(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+e+Nt(s,2)}function O5(t,e){return t%60===0?(t>0?"-":"+")+Nt(Math.abs(t)/60,2):bl(t,e)}function bl(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Nt(Math.trunc(n/60),2),s=Nt(n%60,2);return r+i+e+s}const E5=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},b8=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Qme=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return E5(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",E5(n,e)).replace("{{time}}",b8(i,e))},Zme={p:b8,P:Qme},ege=/^D+$/,tge=/^Y+$/,rge=["D","DD","YY","YYYY"];function nge(t){return ege.test(t)}function ige(t){return tge.test(t)}function sge(t,e,r){const n=oge(t,e,r);if(console.warn(n),rge.includes(t))throw new RangeError(n)}function oge(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const age=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lge=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cge=/^'([^]*?)'?$/,uge=/''/g,dge=/[a-zA-Z]/;function hl(t,e,r){var f,d,p,m;const n=hx(),i=n.locale??Kme,s=n.firstWeekContainsDate??((d=(f=n.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??1,o=n.weekStartsOn??((m=(p=n.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??0,l=ai(t);if(!fme(l))throw new RangeError("Invalid time value");let c=e.match(lge).map(x=>{const y=x[0];if(y==="p"||y==="P"){const v=Zme[y];return v(x,i.formatLong)}return x}).join("").match(age).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:fge(x)};if(k5[y])return{isToken:!0,value:x};if(y.match(dge))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});i.localize.preprocessor&&(c=i.localize.preprocessor(l,c));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:i};return c.map(x=>{if(!x.isToken)return x.value;const y=x.value;(ige(y)||nge(y))&&sge(y,e,String(t));const v=k5[y[0]];return v(l,y,i.localize,u)}).join("")}function fge(t){const e=t.match(cge);return e?e[1].replace(uge,"'"):t}function hge(t,e){return ome(t,-30)}const C5=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"],pge=()=>a.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 animate-pulse",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),a.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"})]})]})}),Og=({height:t="h-80"})=>a.jsxs("div",{className:`bg-white rounded-xl border border-gray-200 ${t} animate-pulse`,children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("div",{className:"h-6 bg-gray-200 rounded w-32"})}),a.jsx("div",{className:"p-6 space-y-4",children:[...Array(5)].map((e,r)=>a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-8 h-4 bg-gray-200 rounded"}),a.jsx("div",{className:"flex-1 h-4 bg-gray-200 rounded"}),a.jsx("div",{className:"w-12 h-4 bg-gray-200 rounded"})]},r))})]}),Eg=({title:t,description:e,icon:r})=>a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx(r,{className:"w-12 h-12 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),a.jsx("p",{className:"text-gray-500 max-w-md",children:e})]});function mge(){var T,M,P,R,L,$,F,z,W,K;const[t,e]=O.useState({}),[r,n]=O.useState([]),[i,s]=O.useState("all"),[o,l]=O.useState({start:hl(hge(new Date),"yyyy-MM-dd"),end:hl(new Date,"yyyy-MM-dd")}),[c,u]=O.useState(!0),[f,d]=O.useState(null),[p,m]=O.useState(!1),x=O.useRef(!0),y=O.useRef(""),v=O.useMemo(()=>({selectedClient:i,dateStart:o.start,dateEnd:o.end}),[i,o.start,o.end]),b=O.useCallback(async()=>{const q=new AbortController;try{const{data:V,error:D}=await pe.from("clients").select("id, name, brand_color").order("name").abortSignal(q.signal);if(D)throw D;x.current&&V&&n(V)}catch(V){V.name!=="AbortError"&&console.error("Error fetching clients:",V)}return()=>q.abort()},[]),w=O.useCallback(async(q=!1)=>{if(!x.current)return;const V=`${v.selectedClient}-${v.dateStart}-${v.dateEnd}`;if(y.current===V&&!q)return;const D=new AbortController,U=setTimeout(()=>{D.abort(),x.current&&(d("Request timed out - please try again"),u(!1),m(!1))},15e3);try{q?m(!0):u(!0),d(null),y.current=V;const{data:G,error:ee}=await pe.functions.invoke("analytics-dashboard",{body:{clientId:v.selectedClient,dateRange:{start:hl(C2(new Date(v.dateStart)),"yyyy-MM-dd'T'HH:mm:ss.SSSxxx"),end:hl(hme(new Date(v.dateEnd)),"yyyy-MM-dd'T'HH:mm:ss.SSSxxx")},metrics:["user_activity","recent_activity","content_engagement","agent_usage","summary_stats"]}});if(clearTimeout(U),ee)throw new Error(ee.message||"Failed to fetch analytics data");x.current&&e(G||{})}catch(G){if(clearTimeout(U),G.name!=="AbortError"){const ee=G instanceof Error?G.message:"Failed to load analytics data";x.current&&(d(ee),console.error("Analytics fetch error:",G))}}finally{x.current&&(u(!1),m(!1))}},[v]);O.useEffect(()=>{let q;return b().then(V=>{q=V}),()=>{q&&q()}},[b]),O.useEffect(()=>{const q=new AbortController;return w(),()=>q.abort()},[w]),O.useEffect(()=>()=>{x.current=!1},[]);const N=O.useCallback(()=>{w(!0)},[w]),j=O.useCallback(q=>{s(q)},[]),k=O.useCallback((q,V)=>{l(D=>({...D,[q]:V}))},[]),_=[{title:"Total Users",value:((T=t.summaryStats)==null?void 0:T.totalUsers)||0,icon:oi,color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-600"},{title:"Content Items",value:((M=t.summaryStats)==null?void 0:M.totalContent)||0,icon:Zn,color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-600"},{title:"Recent Activities",value:((P=t.summaryStats)==null?void 0:P.recentActivities)||0,icon:Xg,color:"bg-purple-500",bgColor:"bg-purple-50",textColor:"text-purple-600"},{title:"Active Sessions",value:((R=t.agentUsage)==null?void 0:R.reduce((q,V)=>q+V.conversation_count,0))||0,icon:Gr,color:"bg-orange-500",bgColor:"bg-orange-50",textColor:"text-orange-600"}],E=((L=t.contentEngagement)==null?void 0:L.slice(0,8).map(q=>({name:q.content_items.title.substring(0,20)+"...",engagements:q.engagement_count,type:q.content_items.content_type})))||[],A=(($=t.agentUsage)==null?void 0:$.slice(0,6).map((q,V)=>({name:q.content_items.title.substring(0,15)+"...",conversations:q.conversation_count,messages:q.total_messages,fill:C5[V%C5.length]})))||[];return c&&!p?a.jsx(pr,{children:a.jsxs("div",{className:"space-y-8",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2 animate-pulse"}),a.jsx("div",{className:"h-5 bg-gray-200 rounded w-80 animate-pulse"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((q,V)=>a.jsx(pge,{},V))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsx(Og,{}),a.jsx(Og,{}),a.jsx(Og,{}),a.jsx(Og,{})]})]})}):a.jsx(pr,{children:a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Analytics Dashboard"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Track platform performance and user engagement"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:i,onChange:q=>j(q.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 pr-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Clients"}),r.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsx(mo,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"date",value:o.start,onChange:q=>k("start",q.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"date",value:o.end,onChange:q=>k("end",q.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("button",{onClick:N,disabled:p,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[a.jsx(IO,{className:`w-4 h-4 mr-2 ${p?"animate-spin":""}`}),"Refresh"]})]})]}),f&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3",children:[a.jsx(ql,{className:"w-5 h-5 text-red-500"}),a.jsx("span",{className:"text-red-700",children:f}),a.jsx("button",{onClick:N,className:"ml-auto text-red-600 hover:text-red-700 font-medium",children:"Try Again"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:_.map(q=>{const V=q.icon;return a.jsx("div",{className:`${q.bgColor} rounded-xl p-6 border border-gray-200`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`${q.color} rounded-lg p-3 mr-4`,children:a.jsx(V,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:q.title}),a.jsx("p",{className:`text-3xl font-bold ${q.textColor}`,children:q.value.toLocaleString()})]})]})},q.title)})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(VX,{className:"w-5 h-5 text-yellow-500"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Top Active Users"})]}),a.jsx("span",{className:"text-sm text-gray-500",children:"Last 30 days"})]}),a.jsx("div",{className:"p-6",children:t.userActivity&&t.userActivity.length>0?a.jsx("div",{className:"space-y-4",children:t.userActivity.slice(0,10).map((q,V)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${V<3?"bg-yellow-100 text-yellow-800":"bg-gray-200 text-gray-600"}`,children:V+1}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[q.first_name," ",q.last_name]}),a.jsx("p",{className:"text-sm text-gray-500",children:q.email})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:q.activity_count}),a.jsx("p",{className:"text-xs text-gray-500",children:"activities"})]})]},q.user_id))}):a.jsx(Eg,{title:"No user activity data",description:"User activity will appear here once users start engaging with the platform",icon:oi})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(go,{className:"w-5 h-5 text-blue-500"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Activity"})]}),a.jsx("span",{className:"text-sm text-gray-500",children:"Live feed"})]}),a.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:t.recentActivity&&t.recentActivity.length>0?a.jsx("div",{className:"space-y-4",children:t.recentActivity.slice(0,20).map(q=>a.jsxs("div",{className:"flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(Xg,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"text-sm text-gray-900",children:[a.jsxs("span",{className:"font-medium",children:[q.users.first_name," ",q.users.last_name]})," ",q.activity_type.replace("_"," "),q.content_items&&a.jsxs("span",{className:"text-gray-600",children:[" ",'"',a.jsx("span",{className:"font-medium",children:q.content_items.title}),'"']})]}),a.jsx("p",{className:"text-xs text-gray-500",children:hl(new Date(q.created_at),"MMM d, h:mm a")})]})]},q.id))}):a.jsx(Eg,{title:"No recent activity",description:"User activities will appear here as they happen on your platform",icon:Xg})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(py,{className:"w-5 h-5 text-purple-500"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Content Engagement"})]})}),a.jsx("div",{className:"p-6",children:E.length>0?a.jsx(k_,{width:"100%",height:300,children:a.jsxs(ime,{data:E,layout:"horizontal",children:[a.jsx(qE,{strokeDasharray:"3 3"}),a.jsx(wd,{type:"number"}),a.jsx(jd,{dataKey:"name",type:"category",width:120}),a.jsx(wi,{}),a.jsx(cc,{dataKey:"engagements",fill:"#8B5CF6",radius:[0,4,4,0]})]})}):a.jsx(Eg,{title:"No engagement data",description:"Content engagement metrics will appear here once users start interacting with your content",icon:py})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(qX,{className:"w-5 h-5 text-green-500"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Agent Usage"})]})}),a.jsx("div",{className:"p-6",children:A.length>0?a.jsxs("div",{className:"flex items-center space-x-8",children:[a.jsx(k_,{width:"70%",height:300,children:a.jsxs(sme,{children:[a.jsx(Co,{data:A,cx:"50%",cy:"50%",outerRadius:100,dataKey:"conversations",children:A.map((q,V)=>a.jsx(z0,{fill:q.fill},`cell-${V}`))}),a.jsx(wi,{})]})}),a.jsx("div",{className:"space-y-2",children:A.map((q,V)=>a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:q.fill}}),a.jsx("span",{className:"text-sm text-gray-700",children:q.name})]},V))})]}):a.jsx(Eg,{title:"No agent usage data",description:"Agent conversation statistics will appear here once users start chatting with AI agents",icon:Gr})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(FB,{className:"w-5 h-5 text-blue-500"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Platform Overview"})]}),a.jsxs("span",{className:"text-sm text-gray-500",children:[hl(new Date(o.start),"MMM d")," - ",hl(new Date(o.end),"MMM d, yyyy")]})]})}),a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[((((F=t.summaryStats)==null?void 0:F.recentActivities)||0)/Math.max(((z=t.summaryStats)==null?void 0:z.totalUsers)||1,1)*100).toFixed(1),"%"]}),a.jsx("p",{className:"text-gray-600",children:"User Engagement Rate"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Activities per user in selected period"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:((W=t.contentEngagement)==null?void 0:W.length)||0}),a.jsx("p",{className:"text-gray-600",children:"Active Content Items"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Content with user interactions"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:((K=t.agentUsage)==null?void 0:K.reduce((q,V)=>q+V.total_messages,0))||0}),a.jsx("p",{className:"text-gray-600",children:"Total Messages"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Messages exchanged with AI agents"})]})]})})]})]})})}const gge=({isOpen:t,onClose:e,onClientCreated:r,editingClient:n})=>{const i=O.useRef(null),[s,o]=O.useState(!1),[l,c]=O.useState([]),[u,f]=O.useState([]),[d,p]=O.useState({}),[m,x]=O.useState({clientName:(n==null?void 0:n.name)||"",projectName:(n==null?void 0:n.project_name)||"",logoFile:null,logoPreview:(n==null?void 0:n.logo_url)||"",brandColor:(n==null?void 0:n.brand_color)||"#3B82F6",apiKeyId:(n==null?void 0:n.api_key_id)||"",forumEnabled:(n==null?void 0:n.forum_enabled)??!0,startFromTemplate:!1,templateId:"",includeContent:!1});Z.useEffect(()=>{t&&!n&&y()},[t]);const y=async()=>{try{const{data:A}=await pe.from("api_keys").select("id, name, key_type").eq("status","active").order("name");A&&c(A);const{data:T}=await pe.from("clients").select("id, name, project_name").eq("is_template",!0).eq("status","active").order("name");T&&f(T)}catch(A){console.error("Error loading options:",A)}},v=()=>{const A={};return m.clientName.trim()?m.clientName.length<2&&(A.clientName="Client name must be at least 2 characters"):A.clientName="Client name is required",/^#[0-9A-F]{6}$/i.test(m.brandColor)||(A.brandColor="Please enter a valid HEX color code"),!m.apiKeyId&&!m.startFromTemplate&&(A.apiKeyId="Please select an API key"),p(A),Object.keys(A).length===0},b=O.useCallback(A=>{if(A&&A.type.startsWith("image/")){const T=new FileReader;T.onload=M=>{x(P=>{var R;return{...P,logoFile:A,logoPreview:(R=M.target)==null?void 0:R.result}})},T.readAsDataURL(A)}},[]),w=O.useCallback(A=>{A.preventDefault();const T=Array.from(A.dataTransfer.files);T.length>0&&b(T[0])},[b]),N=O.useCallback(A=>{const T=A.target.files;T&&T.length>0&&b(T[0])},[b]),j=async()=>{if(!m.logoFile)return null;try{const A=m.logoFile.name.split(".").pop(),M=`client-logos/${`${Date.now()}-${Math.random().toString(36).substring(2)}.${A}`}`,{error:P}=await pe.storage.from("assets").upload(M,m.logoFile);if(P)throw P;const{data:R}=pe.storage.from("assets").getPublicUrl(M);return R.publicUrl}catch(A){return console.error("Error uploading logo:",A),null}},k=async A=>{if(A.preventDefault(),!!v()){o(!0);try{let T=m.logoPreview;if(m.logoFile){const R=await j();R&&(T=R)}const M={name:m.clientName.trim(),project_name:m.projectName.trim()||null,logo_url:T,brand_color:m.brandColor,api_key_id:m.apiKeyId||null,forum_enabled:m.forumEnabled,status:"active",is_template:!1};let P;if(n){const{data:R,error:L}=await pe.from("clients").update(M).eq("id",n.id).select().single();P={data:R,error:L}}else if(m.startFromTemplate&&m.templateId){const{data:R,error:L}=await pe.functions.invoke("clone-client-template",{body:{template_id:m.templateId,client_data:M,include_content:m.includeContent}});P={data:R,error:L}}else{const{data:R,error:L}=await pe.from("clients").insert([M]).select().single();P={data:R,error:L}}if(P.error){if(P.error.code==="23505"){p({clientName:"A client with this name already exists"});return}throw P.error}_(),r(),e()}catch(T){console.error("Error saving client:",T)}finally{o(!1)}}},_=()=>{x({clientName:"",projectName:"",logoFile:null,logoPreview:"",brandColor:"#3B82F6",apiKeyId:"",forumEnabled:!0,startFromTemplate:!1,templateId:"",includeContent:!1}),p({})},E=()=>{s||(_(),e())};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Client":"Create New Client"}),a.jsx("button",{onClick:E,disabled:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx($r,{size:24})})]}),a.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[!n&&a.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:m.startFromTemplate,onChange:A=>x(T=>({...T,startFromTemplate:A.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Start from Template"})]}),m.startFromTemplate&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Template"}),a.jsxs("select",{value:m.templateId,onChange:A=>x(T=>({...T,templateId:A.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:m.startFromTemplate,children:[a.jsx("option",{value:"",children:"Select a template..."}),u.map(A=>a.jsxs("option",{value:A.id,children:[A.name," ",A.project_name&&`(${A.project_name})`]},A.id))]})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:m.includeContent,onChange:A=>x(T=>({...T,includeContent:A.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Include all content (agents, documents, etc.)"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),a.jsx("input",{type:"text",value:m.clientName,onChange:A=>x(T=>({...T,clientName:A.target.value})),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.clientName?"border-red-500":"border-gray-300"}`,placeholder:"Enter client name",required:!0}),d.clientName&&a.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(Pl,{size:16,className:"mr-1"}),d.clientName]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name"}),a.jsx("input",{type:"text",value:m.projectName,onChange:A=>x(T=>({...T,projectName:A.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional project name"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Logo"}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsx("div",{className:"flex-shrink-0",children:m.logoPreview?a.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-2 border-gray-200",children:a.jsx("img",{src:m.logoPreview,alt:"Logo preview",className:"w-full h-full object-cover"})}):a.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 border-2 border-gray-200 flex items-center justify-center",children:a.jsx(Ir,{size:24,className:"text-gray-400"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{onDrop:w,onDragOver:A=>A.preventDefault(),onClick:()=>{var A;return(A=i.current)==null?void 0:A.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-blue-400 transition-colors",children:[a.jsx(Ir,{size:24,className:"mx-auto mb-2 text-gray-400"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Drag and drop an image, or ",a.jsx("span",{className:"text-blue-600",children:"click to browse"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: Square image, at least 200x200px"})]}),a.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:N,className:"hidden"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand Color *"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-md border border-gray-300 cursor-pointer",style:{backgroundColor:m.brandColor},onClick:()=>{const A=document.createElement("input");A.type="color",A.value=m.brandColor,A.onchange=T=>{x(M=>({...M,brandColor:T.target.value}))},A.click()},children:a.jsx(BX,{size:16,className:"text-white m-2"})}),a.jsx("input",{type:"text",value:m.brandColor,onChange:A=>x(T=>({...T,brandColor:A.target.value})),className:`flex-1 border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono ${d.brandColor?"border-red-500":"border-gray-300"}`,placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}),d.brandColor&&a.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(Pl,{size:16,className:"mr-1"}),d.brandColor]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["API Key ",!m.startFromTemplate&&"*"]}),a.jsxs("select",{value:m.apiKeyId,onChange:A=>x(T=>({...T,apiKeyId:A.target.value})),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.apiKeyId?"border-red-500":"border-gray-300"}`,required:!m.startFromTemplate,children:[a.jsx("option",{value:"",children:"Select an API key..."}),l.map(A=>a.jsxs("option",{value:A.id,children:[A.name," (",A.key_type,")"]},A.id))]}),d.apiKeyId&&a.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(Pl,{size:16,className:"mr-1"}),d.apiKeyId]})]})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:m.forumEnabled,onChange:A=>x(T=>({...T,forumEnabled:A.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Forum"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Allow users to participate in community discussions"})]})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:E,disabled:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 flex items-center space-x-2",children:[s&&a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:n?"Update Client":"Create Client"}),!s&&a.jsx(ko,{size:16})]})]})]})]})}):null},yge=()=>{const t=Ti(),[e,r]=O.useState([]),[n,i]=O.useState(!0),[s,o]=O.useState(""),[l,c]=O.useState("all"),[u,f]=O.useState(!1),[d,p]=O.useState(!1),[m,x]=O.useState(null),[y,v]=O.useState(null);O.useEffect(()=>{b()},[l,u]);const b=async()=>{i(!0);try{let P=pe.from("clients").select("*").order("created_at",{ascending:!1});l!=="all"&&(P=P.eq("status",l)),u||(P=P.neq("status","archived"));const{data:R,error:L}=await P;if(L)throw L;r(R||[])}catch(P){console.error("Error loading clients:",P)}finally{i(!1)}},w=()=>{x(null),p(!0)},N=P=>{x(P),p(!0)},j=P=>{t(`/clients/${P}`)},k=async P=>{const R=P.status==="archived"?"active":"archived";try{const{error:L}=await pe.from("clients").update({status:R}).eq("id",P.id);if(L)throw L;b()}catch(L){console.error("Error updating client status:",L)}},_=async P=>{if(confirm(`Are you sure you want to permanently delete "${P.name}"? This action cannot be undone.`))try{const{error:R}=await pe.from("clients").delete().eq("id",P.id);if(R)throw R;b()}catch(R){console.error("Error deleting client:",R)}},E=P=>{window.open(`/client-preview/${P.id}`,"_blank")},A=e.filter(P=>P.name.toLowerCase().includes(s.toLowerCase())||P.project_name&&P.project_name.toLowerCase().includes(s.toLowerCase())),T=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),M=P=>{const R={active:{bg:"bg-green-100",text:"text-green-800",icon:ln},archived:{bg:"bg-gray-100",text:"text-gray-800",icon:t_},inactive:{bg:"bg-yellow-100",text:"text-yellow-800",icon:null}},L=R[P]||R.active,$=L.icon;return a.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L.bg} ${L.text}`,children:[$&&a.jsx($,{size:12,className:"mr-1"}),P.charAt(0).toUpperCase()+P.slice(1)]})};return a.jsx(pr,{children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Client Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your clients and their platform configurations"})]}),a.jsxs("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 transition-colors",children:[a.jsx(Vt,{size:20}),a.jsx("span",{children:"Create New Client"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(In,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:s,onChange:P=>o(P.target.value),placeholder:"Search clients or projects...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ep,{size:16,className:"text-gray-400"}),a.jsxs("select",{value:l,onChange:P=>c(P.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"}),a.jsx("option",{value:"archived",children:"Archived"})]})]}),a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:P=>f(P.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Show Archived"})]})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.filter(P=>P.status==="active").length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Active Clients"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-600",children:e.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Clients"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(P=>P.forum_enabled).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Forum Enabled"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.filter(P=>P.is_template).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Templates"})]})]})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:n?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Loading clients..."})]}):A.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(oi,{size:48,className:"mx-auto text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No clients found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:s?"Try adjusting your search criteria.":"Get started by creating your first client."}),!s&&a.jsx("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create First Client"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Active Users"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(P=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[P.logo_url?a.jsx("img",{src:P.logo_url,alt:`${P.name} logo`,className:"w-10 h-10 rounded-full object-cover border border-gray-200"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold shadow-sm",style:{backgroundColor:P.brand_color||"#3B82F6"},children:P.name.charAt(0).toUpperCase()}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.name}),P.is_template&&a.jsx("span",{className:"inline-block px-2 py-0.5 text-xs bg-purple-100 text-purple-800 rounded-full mt-1",children:"Template"})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm text-gray-900",children:P.project_name||a.jsx("span",{className:"text-gray-400",children:"-"})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(oi,{size:16,className:"text-gray-400 mr-1"}),a.jsx("span",{className:"text-sm text-gray-900",children:"-"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Fl,{size:16,className:"text-gray-400 mr-1"}),a.jsx("span",{className:"text-sm text-gray-900",children:T(P.created_at)})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[M(P.status),P.forum_enabled&&a.jsx("span",{className:"ml-2 inline-block w-2 h-2 bg-green-400 rounded-full",title:"Forum Enabled"})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>j(P.id),className:"bg-blue-600 text-white px-3 py-1.5 rounded text-sm hover:bg-blue-700 transition-colors",children:"Manage"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>v(y===P.id?null:P.id),className:"text-gray-400 hover:text-gray-600 p-1 rounded transition-colors",children:a.jsx(RB,{size:16})}),y===P.id&&a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:a.jsxs("div",{className:"py-1",children:[a.jsxs("button",{onClick:()=>{E(P),v(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[a.jsx(ii,{size:16,className:"mr-2"}),"Preview"]}),a.jsxs("button",{onClick:()=>{N(P),v(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[a.jsx(yo,{size:16,className:"mr-2"}),"Edit"]}),a.jsxs("button",{onClick:()=>{k(P),v(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[a.jsx(t_,{size:16,className:"mr-2"}),P.status==="archived"?"Restore":"Archive"]}),P.status==="archived"&&a.jsxs("button",{onClick:()=>{_(P),v(null)},className:"flex items-center w-full px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:[a.jsx(ns,{size:16,className:"mr-2"}),"Delete Permanently"]})]})})]})]})})]},P.id))})]})})}),a.jsx(gge,{isOpen:d,onClose:()=>p(!1),onClientCreated:b,editingClient:m})]})})};function vge(){const[t,e]=O.useState([]),[r,n]=O.useState([]),[i,s]=O.useState([]),[o,l]=O.useState(!0),[c,u]=O.useState(""),[f,d]=O.useState("");O.useEffect(()=>{p()},[]);const p=async()=>{try{l(!0);const[v,b,w]=await Promise.all([pe.from("users").select("*").order("created_at",{ascending:!1}),pe.from("clients").select("*").order("name"),pe.from("user_tags").select("*").order("name")]);v.data&&e(v.data),b.data&&n(b.data),w.data&&s(w.data)}catch(v){console.error("Error fetching data:",v)}finally{l(!1)}},m=t.filter(v=>{var N,j;const b=v.email.toLowerCase().includes(c.toLowerCase())||((N=v.first_name)==null?void 0:N.toLowerCase().includes(c.toLowerCase()))||((j=v.last_name)==null?void 0:j.toLowerCase().includes(c.toLowerCase())),w=f===""||v.client_id===f;return b&&w}),x=v=>r.find(b=>b.id===v),y=v=>v.first_name&&v.last_name?`${v.first_name} ${v.last_name}`:v.first_name||v.last_name||"Unnamed User";return o?a.jsx(pr,{children:a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx(cr,{size:"lg"})})}):a.jsx(pr,{children:a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Users"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Manage users across all client organizations"})]}),a.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-4 w-4"}),"Add User"]})]}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",placeholder:"Search users by name or email...",value:c,onChange:v=>u(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("select",{value:f,onChange:v=>d(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Clients"}),r.map(v=>a.jsx("option",{value:v.id,children:v.name},v.id))]})]})}),a.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"All Users"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[m.length," users"]})]})}),a.jsx("div",{className:"divide-y divide-gray-200",children:m.map(v=>{const b=x(v.client_id);return a.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-sm font-medium",children:y(v).charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("h3",{className:"text-base font-medium text-gray-900",children:y(v)})}),a.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[a.jsx("p",{className:"text-sm text-gray-600",children:v.email}),b&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ou,{className:"h-3 w-3",style:{color:b.brand_color}}),a.jsx("span",{className:"text-xs text-gray-500",children:b.name})]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"text-right text-sm",children:[a.jsx("p",{className:"text-gray-900",children:"Created"}),a.jsx("p",{className:"text-gray-500",children:new Date(v.created_at).toLocaleDateString()})]}),v.last_active&&a.jsxs("div",{className:"text-right text-sm",children:[a.jsx("p",{className:"text-gray-900",children:"Last Active"}),a.jsx("p",{className:"text-gray-500",children:new Date(v.last_active).toLocaleDateString()})]}),a.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(RB,{className:"h-4 w-4"})})]})]})},v.id)})}),m.length===0&&a.jsxs("div",{className:"px-6 py-8 text-center",children:[a.jsx(oi,{className:"mx-auto h-12 w-12 text-gray-300"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:c||f?"No users found":"No users yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:c||f?"Try adjusting your search or filter criteria.":"Users will appear here once they are created for clients."})]})]})]})})}const xge=["#EF4444","#F97316","#F59E0B","#84CC16","#10B981","#14B8A6","#06B6D4","#3B82F6","#6366F1","#8B5CF6","#A855F7","#EC4899","#F43F5E","#6B7280"];function bge({isOpen:t,onClose:e,onSuccess:r,tag:n,clients:i}){const[s,o]=O.useState({name:"",color:"#6B7280",client_id:""}),[l,c]=O.useState(!1),[u,f]=O.useState("");O.useEffect(()=>{o(n?{name:n.name,color:n.color,client_id:n.client_id}:{name:"",color:"#6B7280",client_id:i.length>0?i[0].id:""}),f("")},[n,i,t]);const d=async x=>{if(x.preventDefault(),f(""),c(!0),!s.client_id){f("Please select a client"),c(!1);return}try{const y={name:s.name.trim(),color:s.color,client_id:s.client_id};if(n){const{error:v}=await pe.from("user_tags").update(y).eq("id",n.id);if(v)throw v}else{const{error:v}=await pe.from("user_tags").insert([y]);if(v)throw v}r()}catch(y){console.error("Error saving tag:",y),f(y.message||"An error occurred while saving the tag")}finally{c(!1)}},p=x=>{const{name:y,value:v}=x.target;o(b=>({...b,[y]:v}))},m=i.find(x=>x.id===s.client_id);return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center",style:{backgroundColor:s.color},children:a.jsx(Es,{className:"h-5 w-5 text-white"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Tag":"Create Tag"})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:l,children:a.jsx($r,{className:"h-6 w-6"})})]}),a.jsxs("form",{onSubmit:d,className:"p-6 space-y-6",children:[u&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:a.jsx("p",{className:"text-sm text-red-800",children:u})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Organization"}),a.jsxs("select",{id:"client_id",name:"client_id",required:!0,value:s.client_id,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:l||!!n,children:[a.jsx("option",{value:"",children:"Select a client..."}),i.map(x=>a.jsx("option",{value:x.id,children:x.name},x.id))]}),m&&a.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-sm text-gray-600",children:[a.jsx(Ou,{className:"h-4 w-4",style:{color:m.brand_color}}),a.jsx("span",{children:m.project_name})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tag Name"}),a.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:s.name,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Beginner, Advanced, VIP",disabled:l})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tag Color"}),a.jsx("div",{className:"grid grid-cols-7 gap-3",children:xge.map(x=>a.jsx("button",{type:"button",onClick:()=>o(y=>({...y,color:x})),className:`h-10 w-10 rounded-lg border-2 transition-all ${s.color===x?"border-gray-400 scale-110 shadow-md":"border-gray-200 hover:border-gray-300"}`,style:{backgroundColor:x},disabled:l},x))}),a.jsx("div",{className:"mt-3",children:a.jsx("input",{type:"text",value:s.color,onChange:x=>o(y=>({...y,color:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"#6B7280",pattern:"^#[0-9A-Fa-f]{6}$",disabled:l})})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",disabled:l,children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?a.jsxs(a.Fragment,{children:[a.jsx(cr,{size:"sm",className:"mr-2"}),n?"Updating...":"Creating..."]}):n?"Update Tag":"Create Tag"})]})]})]})}):null}function wge(){const[t,e]=O.useState([]),[r,n]=O.useState([]),[i,s]=O.useState(!0),[o,l]=O.useState(!1),[c,u]=O.useState(null),[f,d]=O.useState("");O.useEffect(()=>{p()},[]);const p=async()=>{try{s(!0);const[j,k]=await Promise.all([pe.from("user_tags").select("*").order("created_at",{ascending:!1}),pe.from("clients").select("*").order("name")]);j.data&&e(j.data),k.data&&n(k.data)}catch(j){console.error("Error fetching data:",j)}finally{s(!1)}},m=()=>{u(null),l(!0)},x=j=>{u(j),l(!0)},y=async j=>{if(confirm(`Are you sure you want to delete the tag "${j.name}"? This action cannot be undone.`))try{const{error:k}=await pe.from("user_tags").delete().eq("id",j.id);if(k)throw k;e(t.filter(_=>_.id!==j.id))}catch(k){console.error("Error deleting tag:",k),alert("Failed to delete tag. Please try again.")}},v=()=>{l(!1),p()},b=f?t.filter(j=>j.client_id===f):t,w=j=>{var k;return((k=r.find(_=>_.id===j))==null?void 0:k.name)||"Unknown Client"},N=b.reduce((j,k)=>{const _=w(k.client_id);return j[_]||(j[_]=[]),j[_].push(k),j},{});return i?a.jsx(pr,{children:a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx(cr,{size:"lg"})})}):a.jsxs(pr,{children:[a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Tags"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Manage user categorization tags for each client"})]}),a.jsxs("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-4 w-4"}),"Create Tag"]})]}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("label",{htmlFor:"client-filter",className:"text-sm font-medium text-gray-700",children:"Filter by Client:"}),a.jsxs("select",{id:"client-filter",value:f,onChange:j=>d(j.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Clients"}),r.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]})}),Object.keys(N).length>0?a.jsx("div",{className:"space-y-8",children:Object.entries(N).map(([j,k])=>{const _=r.find(E=>E.name===j);return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[_&&a.jsx("div",{className:"h-6 w-6 rounded flex items-center justify-center",style:{backgroundColor:_.brand_color+"20"},children:a.jsx(Ou,{className:"h-4 w-4",style:{color:_.brand_color}})}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:j}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",k.length," tags)"]})]})}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(E=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-8 w-8 rounded-full flex items-center justify-center",style:{backgroundColor:E.color},children:a.jsx(Es,{className:"h-4 w-4 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900",children:E.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",new Date(E.created_at).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:()=>x(E),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:a.jsx(C0,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>y(E),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:a.jsx(ns,{className:"h-4 w-4"})})]})]})},E.id))})})]},j)})}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Es,{className:"mx-auto h-12 w-12 text-gray-300"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:f?"No tags found for this client":"No tags yet"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:f?"This client has no user tags created yet.":"Get started by creating your first user tag."}),a.jsx("div",{className:"mt-6",children:a.jsxs("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-5 w-5"}),"Create Tag"]})})]})]}),a.jsx(bge,{isOpen:o,onClose:()=>l(!1),onSuccess:v,tag:c,clients:r})]})}const jge=({isOpen:t,onClose:e,clientId:r,onUploadComplete:n})=>{var _;const i=O.useRef(null),[s,o]=O.useState(!1),[l,c]=O.useState(null),[u,f]=O.useState(!1),[d,p]=O.useState(null),[m,x]=O.useState([]),y=O.useCallback(()=>{const E=`firstName,lastName,email,tags
        `).eq("user_id",t).eq("activity_type","content_completed").order("created_at",{ascending:!1}).limit(50),M=(T==null?void 0:T.map(P=>{var R;return{id:P.id,content_item:P.content_items||{title:"Content Item",content_type:"document",thumbnail_url:null},practiced_at:P.created_at,completion_score:((R=P.activity_data)==null?void 0:R.score)||Math.floor(Math.random()*40)+60}}))||[];d(M)}catch(T){console.error("Error loading content mastery:",T)}},N=async()=>{if(t)try{const T=[{id:"1",course_title:"AI Fundamentals",progress_percentage:75,lessons_completed:6,total_lessons:8,last_accessed:new Date(Date.now()-1728e5).toISOString()},{id:"2",course_title:"Advanced Prompt Engineering",progress_percentage:45,lessons_completed:9,total_lessons:20,last_accessed:new Date(Date.now()-432e6).toISOString()},{id:"3",course_title:"Machine Learning Basics",progress_percentage:100,lessons_completed:12,total_lessons:12,last_accessed:new Date(Date.now()-864e5).toISOString()}];m(T)}catch(T){console.error("Error loading course progress:",T)}},j=T=>{if(T.length===0)return 0;let M=0;const P=[...T].sort((R,L)=>new Date(L.date).getTime()-new Date(R.date).getTime());for(const R of P)if(R.activities>0)M++;else break;return M};O.useEffect(()=>{v()},[v]),O.useEffect(()=>{o==="content"?w():o==="courses"&&N()},[o,t]);const k=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),_=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=T=>{switch(T){case"ai_agent":return a.jsx(Gr,{size:16,className:"text-blue-500"});case"video":return a.jsx(PX,{size:16,className:"text-red-500"});case"document":return a.jsx(Ot,{size:16,className:"text-green-500"});default:return a.jsx(Zn,{size:16,className:"text-gray-500"})}},A=()=>{switch(o){case"overview":return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.totalActivities}),a.jsx("div",{className:"text-sm text-blue-800",children:"Total Activities"})]}),a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.contentCompleted}),a.jsx("div",{className:"text-sm text-green-800",children:"Content Completed"})]}),a.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.avgScore}),a.jsx("div",{className:"text-sm text-purple-800",children:"Avg Score"})]}),a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:x.streakDays}),a.jsx("div",{className:"text-sm text-orange-800",children:"Day Streak"})]}),a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[x.totalTimeSpent,"m"]}),a.jsx("div",{className:"text-sm text-gray-800",children:"Time Spent"})]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Score (Last 30 Days)"}),a.jsx("div",{className:"h-64",children:a.jsx(k_,{width:"100%",height:"100%",children:a.jsxs(nme,{data:c,children:[a.jsx(qE,{strokeDasharray:"3 3"}),a.jsx(wd,{dataKey:"date",tick:{fontSize:12},tickFormatter:T=>new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),a.jsx(jd,{tick:{fontSize:12}}),a.jsx(wi,{labelFormatter:T=>k(T),formatter:(T,M)=>[T,M==="score"?"Activity Score":"Activities Count"]}),a.jsx(Fp,{type:"monotone",dataKey:"score",stroke:"#3B82F6",strokeWidth:2,dot:{fill:"#3B82F6",strokeWidth:2,r:4}})]})})})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),f.slice(0,5).length>0?a.jsx("div",{className:"space-y-3",children:f.slice(0,5).map(T=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg",children:[E(T.content_item.content_type),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.content_item.title}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Completed ",_(T.practiced_at)]})]}),a.jsxs("div",{className:"text-sm font-semibold text-green-600",children:[T.completion_score,"%"]})]},T.id))}):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent activity"})]})]});case"content":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Content Mastery Log"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[f.length," items practiced"]})]}),f.length>0?a.jsx("div",{className:"space-y-3",children:f.map(T=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[E(T.content_item.content_type),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:T.content_item.title}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Practiced on ",_(T.practiced_at)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[T.completion_score,"%"]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Completion"})]}),T.completion_score>=90&&a.jsx(ln,{size:20,className:"text-green-500"})]})]},T.id))}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Zn,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-gray-500",children:"No content practiced yet"})]})]});case"courses":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Progress"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[p.length," courses enrolled"]})]}),p.length>0?a.jsx("div",{className:"space-y-4",children:p.map(T=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900",children:T.course_title}),a.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${T.progress_percentage===100?"bg-green-100 text-green-800":T.progress_percentage>=50?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:[T.progress_percentage,"% Complete"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[a.jsxs("span",{children:[T.lessons_completed," of ",T.total_lessons," lessons"]}),a.jsxs("span",{children:["Last accessed ",k(T.last_accessed)]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${T.progress_percentage}%`}})})]}),T.progress_percentage===100&&a.jsxs("div",{className:"flex items-center text-green-600",children:[a.jsx(ln,{size:16,className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Course Completed!"})]})]},T.id))}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Zn,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-gray-500",children:"No courses enrolled yet"})]})]});default:return null}};return i?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex items-center justify-between py-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e(-1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(lo,{size:24})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white text-xl font-semibold",style:{backgroundColor:r.client.brand_color},children:[r.first_name.charAt(0).toUpperCase(),r.last_name.charAt(0).toUpperCase()]}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r.first_name," ",r.last_name]}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(DX,{size:16}),a.jsx("span",{children:r.email})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{size:16}),a.jsxs("span",{children:["Joined ",k(r.created_at)]})]}),r.last_active&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Xg,{size:16}),a.jsxs("span",{children:["Active ",k(r.last_active)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[r.client.logo_url?a.jsx("img",{src:r.client.logo_url,alt:r.client.name,className:"w-6 h-6 rounded-full"}):a.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:r.client.brand_color}}),a.jsx("span",{className:"text-sm text-gray-700",children:r.client.name})]}),r.tags.length>0&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Es,{size:16,className:"text-gray-400"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:r.tags.map(T=>a.jsx("span",{className:"inline-block px-2 py-1 text-xs text-white rounded-full",style:{backgroundColor:T.color},children:T.name},T.id))})]})]})]})]})]})})})}),a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",label:"Overview",icon:FB},{id:"content",label:"Content Mastery",icon:Zn},{id:"courses",label:"Course Progress",icon:ln}].map(T=>{const M=T.icon;return a.jsxs("button",{onClick:()=>l(T.id),className:`flex items-center space-x-2 px-1 py-4 border-b-2 font-medium text-sm transition-colors ${o===T.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(M,{size:18}),a.jsx("span",{children:T.label})]},T.id)})})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:A()})})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User not found"}),a.jsx("button",{onClick:()=>e("/clients"),className:"mt-4 text-blue-600 hover:text-blue-800",children:"Back to Clients"})]})};function kge(){const t=Ti(),{signOut:e,loading:r}=Ln();return O.useEffect(()=>{(async()=>{try{await e(),t("/login",{replace:!0})}catch(i){console.error("Logout error:",i),t("/login",{replace:!0})}})()},[e,t]),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mb-4",children:a.jsx(LB,{className:"h-12 w-12 text-blue-500 mx-auto"})}),a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Signing out..."})]})})}const WN=[{type:"articles",label:"Articles",icon:Ot,color:"#10B981",description:"Blog posts, tutorials, and written content",count:0},{type:"ai-agents",label:"AI Agents",icon:Kr,color:"#3B82F6",description:"Intelligent AI agents with custom prompts",count:0},{type:"videos",label:"Videos",icon:si,color:"#EF4444",description:"Educational videos with transcriptions",count:0},{type:"documents",label:"Documents",icon:Ot,color:"#10B981",description:"Rich text documents and guides",count:0},{type:"prompts",label:"Prompts",icon:Gr,color:"#8B5CF6",description:"Reusable prompt templates",count:0},{type:"automations",label:"Automations",icon:Ei,color:"#F59E0B",description:"Process automations and workflows",count:0}];function _ge(){const[t,e]=O.useState(WN),[r,n]=O.useState(!0);O.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0);const{count:s}=await pe.from("content_articles").select("*",{count:"exact",head:!0}),o=WN.map(l=>{switch(l.type){case"articles":return{...l,count:s||0};default:return l}});e(o)}catch(s){console.error("Error fetching content counts:",s),e(WN)}finally{n(!1)}};return r?a.jsx(pr,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):a.jsx(pr,{children:a.jsxs("div",{className:"space-y-8",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Content Management"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Create and manage content for your AI platform"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>{const o=s.icon;return a.jsxs(Qn,{to:`/content/${s.type}`,className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow group",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",style:{backgroundColor:s.color+"20"},children:a.jsx(o,{className:"h-6 w-6",style:{color:s.color}})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:s.label}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]})]}),a.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:[s.count," items"]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs(Qn,{to:`/content/${s.type}/create`,className:"inline-flex items-center px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:l=>l.stopPropagation(),children:[a.jsx(Vt,{className:"h-4 w-4 mr-1"}),"Create"]})})]})]},s.type)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("button",{className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(In,{className:"h-5 w-5 text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Search Content"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Find existing content"})]})]}),a.jsxs("button",{className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(Ep,{className:"h-5 w-5 text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Filter by Tags"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Organize content"})]})]}),a.jsxs(Qn,{to:"/content/ai-agents/create",className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(Kr,{className:"h-5 w-5 text-blue-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Quick Agent"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Create new AI agent"})]})]}),a.jsxs(Qn,{to:"/content/articles/create",className:"flex items-center space-x-3 p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(Ot,{className:"h-5 w-5 text-green-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"New Article"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Write blog posts and tutorials"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Recent Activity"}),a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ot,{className:"mx-auto h-12 w-12 text-gray-300"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No recent activity"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Content creation and editing activity will appear here"})]})]})]})})}function Oge(){const[t,e]=O.useState([]),[r,n]=O.useState([]),[i,s]=O.useState(!0),[o,l]=O.useState(""),[c,u]=O.useState("all"),[f,d]=O.useState("all"),[p,m]=O.useState(!1);O.useEffect(()=>{x(),y()},[]);const x=async()=>{try{s(!0);const{data:j,error:k}=await pe.from("content_articles").select(`
        `).order("created_at",{ascending:!1});if(k)throw k;e(j||[])}catch(j){console.error("Error fetching articles:",j)}finally{s(!1)}},y=async()=>{try{const{data:j,error:k}=await pe.from("content_categories").select("*").order("name");if(k)throw k;n(j||[])}catch(j){console.error("Error fetching categories:",j)}},v=async j=>{if(confirm("Are you sure you want to delete this article?"))try{const{error:k}=await pe.from("content_articles").delete().eq("id",j);if(k)throw k;await x()}catch(k){console.error("Error deleting article:",k)}},b=t.filter(j=>{var A;const k=j.title.toLowerCase().includes(o.toLowerCase())||j.author.toLowerCase().includes(o.toLowerCase()),_=c==="all"||((A=j.category_id)==null?void 0:A.toString())===c,E=f==="all"||j.status===f;return k&&_&&E}),w=j=>{const _={draft:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Draft"},published:{bg:"bg-green-100",text:"text-green-800",label:"Published"},archived:{bg:"bg-gray-100",text:"text-gray-800",label:"Archived"}}[j];return a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.bg} ${_.text}`,children:_.label})},N=j=>j?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(j)):"-";return i?a.jsx(pr,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):a.jsx(pr,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Articles Management"}),a.jsx("p",{className:"text-gray-600",children:"Create and manage your content articles"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:()=>m(!p),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Ep,{className:"h-4 w-4 mr-2"}),"Filters"]}),a.jsxs(Qn,{to:"/content/articles/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Add New Article"]})]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 space-y-4",children:[a.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search articles by title or author...",value:o,onChange:j=>l(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})})}),p&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),a.jsxs("select",{value:c,onChange:j=>u(j.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),r.map(j=>a.jsx("option",{value:j.id.toString(),children:j.name},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:f,onChange:j=>d(j.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"published",children:"Published"}),a.jsx("option",{value:"archived",children:"Archived"})]})]})]})]}),a.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center",children:[a.jsx(Ot,{className:"mx-auto h-12 w-12 text-gray-300"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No articles found"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o||c!=="all"||f!=="all"?"Try adjusting your search or filters.":"Get started by creating your first article."})]})}):b.map(j=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 mb-1",children:j.title}),j.excerpt&&a.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:j.excerpt})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.content_categories?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:j.content_categories.color}}),a.jsx("span",{className:"text-sm text-gray-900",children:j.content_categories.name})]}):a.jsx("span",{className:"text-sm text-gray-500",children:"Uncategorized"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(zB,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:j.author})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:w(j.status)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Fl,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:N(j.created_at)})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx(Qn,{to:`/content/articles/${j.id}/edit`,className:"text-blue-600 hover:text-blue-900 p-1",children:a.jsx(ii,{className:"h-4 w-4"})}),a.jsx(Qn,{to:`/content/articles/${j.id}/edit`,className:"text-indigo-600 hover:text-indigo-900 p-1",children:a.jsx(yo,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>v(j.id),className:"text-red-600 hover:text-red-900 p-1",children:a.jsx(ns,{className:"h-4 w-4"})})]})})]},j.id))})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ot,{className:"h-8 w-8 text-blue-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Articles"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.length})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ii,{className:"h-8 w-8 text-green-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Published"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(j=>j.status==="published").length})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(yo,{className:"h-8 w-8 text-yellow-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Drafts"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(j=>j.status==="draft").length})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Es,{className:"h-8 w-8 text-purple-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Categories"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.length})]})]})})]})]})})}function A5(){const{id:t}=us(),e=Ti(),r=!!t,[n,i]=O.useState({title:"",content:"",excerpt:"",author:"Admin User",category_id:null,status:"draft",tags:[],featured_image_url:"",slug:"",seo_title:"",seo_description:""}),[s,o]=O.useState([]),[l,c]=O.useState(!1),[u,f]=O.useState(!1),[d,p]=O.useState(""),[m,x]=O.useState("content"),[y,v]=O.useState(null);O.useEffect(()=>{b(),r&&w()},[t]);const b=async()=>{try{const{data:T,error:M}=await pe.from("content_categories").select("*").order("name");if(M)throw M;o(T||[])}catch(T){console.error("Error fetching categories:",T)}},w=async()=>{if(t)try{c(!0);const{data:T,error:M}=await pe.from("content_articles").select("*").eq("id",parseInt(t)).single();if(M)throw M;T&&i({...T,tags:T.tags||[]})}catch(T){console.error("Error fetching article:",T)}finally{c(!1)}},N=T=>T.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),j=T=>{i(M=>({...M,title:T,slug:M.slug||N(T),seo_title:M.seo_title||T}))},k=()=>{d.trim()&&!n.tags.includes(d.trim())&&(i(T=>({...T,tags:[...T.tags,d.trim()]})),p(""))},_=T=>{i(M=>({...M,tags:M.tags.filter(P=>P!==T)}))},E=(T,M)=>{v({message:T,type:M}),setTimeout(()=>{v(null)},3e3)},A=async(T=!1)=>{try{f(!0);const M={...n,status:T?"published":n.status,published_at:T?new Date().toISOString():null,updated_at:new Date().toISOString()};if(r){const{error:P}=await pe.from("content_articles").update(M).eq("id",parseInt(t));if(P)throw P;E(T?"Article published successfully!":"Article saved successfully!","success"),setTimeout(()=>{e("/content/articles")},1500)}else{const{data:P,error:R}=await pe.from("content_articles").insert([M]).select().single();if(R)throw R;E(T?"Article published successfully!":"Article created successfully!","success"),setTimeout(()=>{P?e(`/content/articles/${P.id}/edit`,{replace:!0}):e("/content/articles")},1500)}}catch(M){console.error("Error saving article:",M),E("Failed to save article. Please try again.","error")}finally{f(!1)}};return l?a.jsx(pr,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):a.jsxs(pr,{children:[y&&a.jsx("div",{className:"fixed top-4 right-4 z-50 transition-all duration-500 ease-in-out transform translate-x-0 opacity-100",children:a.jsx("div",{className:`max-w-sm w-full ${y.type==="success"?"bg-green-500":"bg-red-500"} shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5`,children:a.jsx("div",{className:"flex-1 w-0 p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("p",{className:"text-sm font-medium text-white",children:y.message})}),a.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:a.jsxs("button",{className:"bg-transparent rounded-md inline-flex text-white hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-white",onClick:()=>v(null),children:[a.jsx("span",{className:"sr-only",children:"Close"}),a.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})})}),a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e("/content/articles"),className:"p-2 hover:bg-gray-100 rounded-md",children:a.jsx(lo,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Article":"Create New Article"}),a.jsx("p",{className:"text-gray-600",children:"Write and publish your content"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:()=>A(!1),disabled:u,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[a.jsx(Cp,{className:"h-4 w-4 mr-2"}),"Save Draft"]}),a.jsxs("button",{onClick:()=>A(!0),disabled:u,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[a.jsx(ii,{className:"h-4 w-4 mr-2"}),"Publish"]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsx("button",{onClick:()=>x("content"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="content"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Content"}),a.jsx("button",{onClick:()=>x("settings"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Settings"}),a.jsx("button",{onClick:()=>x("seo"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="seo"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"SEO"})]})}),m==="content"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",value:n.title,onChange:T=>j(T.target.value),placeholder:"Enter article title...",className:"w-full text-2xl font-bold border-0 border-b border-gray-200 focus:border-blue-500 focus:ring-0 px-0 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excerpt"}),a.jsx("textarea",{value:n.excerpt,onChange:T=>i(M=>({...M,excerpt:T.target.value})),placeholder:"Brief description of the article...",rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content *"}),a.jsx("textarea",{value:n.content,onChange:T=>i(M=>({...M,content:T.target.value})),placeholder:"Write your article content here...",rows:20,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",required:!0}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You can use HTML tags for formatting."})]})]}),m==="settings"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),a.jsxs("select",{value:n.category_id||"",onChange:T=>i(M=>({...M,category_id:T.target.value?parseInt(T.target.value):null})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"No Category"}),s.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Author"}),a.jsx("input",{type:"text",value:n.author,onChange:T=>i(M=>({...M,author:T.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:n.status,onChange:T=>i(M=>({...M,status:T.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"published",children:"Published"}),a.jsx("option",{value:"archived",children:"Archived"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Slug"}),a.jsx("input",{type:"text",value:n.slug,onChange:T=>i(M=>({...M,slug:T.target.value})),placeholder:"article-url-slug",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Featured Image URL"}),a.jsx("input",{type:"url",value:n.featured_image_url,onChange:T=>i(M=>({...M,featured_image_url:T.target.value})),placeholder:"https://example.com/image.jpg",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:n.tags.map((T,M)=>a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[T,a.jsx("button",{type:"button",onClick:()=>_(T),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full hover:bg-blue-200",children:"×"})]},M))}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"text",value:d,onChange:T=>p(T.target.value),onKeyPress:T=>T.key==="Enter"&&k(),placeholder:"Add a tag...",className:"flex-1 border border-gray-300 rounded-l-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 border border-l-0 border-gray-300 bg-gray-50 rounded-r-md hover:bg-gray-100",children:"Add"})]})]})]}),m==="seo"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SEO Title"}),a.jsx("input",{type:"text",value:n.seo_title,onChange:T=>i(M=>({...M,seo_title:T.target.value})),placeholder:"SEO optimized title...",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Recommended: 50-60 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SEO Description"}),a.jsx("textarea",{value:n.seo_description,onChange:T=>i(M=>({...M,seo_description:T.target.value})),placeholder:"Meta description for search engines...",rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Recommended: 150-160 characters"})]})]})]})]})}function qp({contentType:t,title:e,description:r,icon:n,color:i}){const s=Ti(),[o,l]=O.useState([]),[c,u]=O.useState([]),[f,d]=O.useState(!0),[p,m]=O.useState(null),[x,y]=O.useState({}),v=O.useRef(!0),b=O.useRef(""),[w,N]=O.useState({search:"",clients:[],status:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:"cards"}),[j,k]=O.useState(!1),_=O.useMemo(()=>JSON.stringify({contentType:t,search:w.search,clients:w.clients.sort(),status:w.status,sortBy:w.sortBy,sortOrder:w.sortOrder}),[t,w.search,w.clients,w.status,w.sortBy,w.sortOrder]),E=O.useCallback(async()=>{if(!v.current)return;const z=_;if(b.current!==z)try{d(!0),m(null),b.current=z;let W=pe.from("content_items").select("*").eq("content_type",t);w.search.trim()&&(W=W.or(`title.ilike.%${w.search}%,description.ilike.%${w.search}%`)),w.status!=="all"&&(W=W.eq("status",w.status)),W=W.order(w.sortBy,{ascending:w.sortOrder==="asc"});const{data:K,error:q}=await W;if(!v.current)return;if(q){console.error("Error fetching content items:",q),m("Failed to load content items"),l([]);return}let V=K||[];if(w.clients.length>0){const{data:D,error:U}=await pe.from("content_client_assignments").select("content_item_id").in("client_id",w.clients);if(U)console.error("Error fetching assignments:",U);else if(D){const G=D.map(ee=>ee.content_item_id);V=V.filter(ee=>G.includes(ee.id))}}if(!v.current)return;if(l(V),V.length>0){const D=V.map(Q=>Q.id),[U,G]=await Promise.all([pe.from("content_client_assignments").select("content_item_id").in("content_item_id",D),pe.from("content_user_assignments").select("content_item_id").in("content_item_id",D)]),ee={};D.forEach(Q=>{var re,J;const H=((re=U.data)==null?void 0:re.filter(ne=>ne.content_item_id===Q).length)||0,Y=((J=G.data)==null?void 0:J.filter(ne=>ne.content_item_id===Q).length)||0;ee[Q]=H+Y}),v.current&&y(ee)}}catch(W){console.error("Error in fetchData:",W),v.current&&(m("Failed to load content"),l([]))}finally{v.current&&d(!1)}},[t,_,w.search,w.clients,w.status,w.sortBy,w.sortOrder]),A=O.useCallback(async()=>{try{const{data:z,error:W}=await pe.from("clients").select("*").eq("status","active").order("name");W?console.error("Error fetching clients:",W):z&&v.current&&u(z)}catch(z){console.error("Error fetching clients:",z)}},[]);O.useEffect(()=>{E()},[E]),O.useEffect(()=>{A()},[A]),O.useEffect(()=>()=>{v.current=!1},[]);const T=O.useCallback(()=>({ai_agent:"ai-agents",video:"videos",document:"documents",prompt:"prompts",automation:"automations"})[t]||t,[t]),M=O.useCallback(()=>{const z=T();s(`/content/${z}/create`)},[s,T]),P=O.useCallback(z=>{const W=T();s(`/content/${W}/${z}/edit`)},[s,T]),R=O.useCallback((z,W)=>{N(K=>({...K,[z]:W}))},[]),L=O.useCallback(()=>{N(z=>({search:"",clients:[],status:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:z.viewMode}))},[]),$=O.useCallback(z=>a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${z==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:z==="published"?a.jsxs(a.Fragment,{children:[a.jsx(ii,{className:"h-3 w-3 mr-1"})," Published"]}):a.jsxs(a.Fragment,{children:[a.jsx(TO,{className:"h-3 w-3 mr-1"})," Draft"]})}),[]),F=O.useCallback(z=>new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[]);return p&&!f?a.jsx(pr,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-red-500 mb-4",children:a.jsx(n,{className:"h-12 w-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Content"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:p}),a.jsx("button",{onClick:()=>{m(null),E()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})})}):a.jsx(pr,{children:a.jsxs("div",{className:"min-h-screen flex bg-gray-50",children:[a.jsxs("div",{className:`transition-all duration-300 ${j?"w-80":"w-12"} bg-white border-r border-gray-200 flex flex-col shadow-sm`,children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("button",{onClick:()=>k(!j),className:"flex items-center justify-center w-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(Ep,{className:"h-5 w-5"}),j&&a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Filters"})]})}),j&&a.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Content"}),a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",placeholder:"Search by title or description...",value:w.search,onChange:z=>R("search",z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),a.jsxs("select",{value:w.status,onChange:z=>R("status",z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"published",children:"Published Only"}),a.jsx("option",{value:"draft",children:"Drafts Only"})]})]}),c.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Clients"}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:c.map(z=>a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:w.clients.includes(z.id),onChange:W=>{W.target.checked?R("clients",[...w.clients,z.id]):R("clients",w.clients.filter(K=>K!==z.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:z.brand_color}}),a.jsx("span",{className:"text-sm text-gray-900",children:z.name})]})]},z.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Content"}),a.jsxs("select",{value:`${w.sortBy}_${w.sortOrder}`,onChange:z=>{const[W,K]=z.target.value.split("_");R("sortBy",W),R("sortOrder",K)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[a.jsx("option",{value:"updated_at_desc",children:"Last Updated (Newest)"}),a.jsx("option",{value:"updated_at_asc",children:"Last Updated (Oldest)"}),a.jsx("option",{value:"created_at_desc",children:"Date Created (Newest)"}),a.jsx("option",{value:"created_at_asc",children:"Date Created (Oldest)"}),a.jsx("option",{value:"title_asc",children:"Title (A-Z)"}),a.jsx("option",{value:"title_desc",children:"Title (Z-A)"})]})]}),a.jsx("div",{className:"pt-4 border-t border-gray-200",children:a.jsx("button",{onClick:L,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Clear All Filters"})})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center shadow-sm",style:{backgroundColor:i+"15"},children:a.jsx(n,{className:"h-6 w-6",style:{color:i}})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r}),a.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[a.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," ",o.length===1?"item":"items"]}),w.status!=="all"&&a.jsxs("span",{className:"text-xs text-gray-500",children:["• Filtered by ",w.status]}),w.clients.length>0&&a.jsxs("span",{className:"text-xs text-gray-500",children:["• ",w.clients.length," client(s)"]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>R("viewMode","cards"),className:`p-2 rounded-md transition-colors ${w.viewMode==="cards"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Card View",children:a.jsx(dd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>R("viewMode","list"),className:`p-2 rounded-md transition-colors ${w.viewMode==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:a.jsx(rs,{className:"h-4 w-4"})})]}),a.jsxs("button",{onClick:M,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all",style:{backgroundColor:i,boxShadow:`0 4px 12px ${i}40`},children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-4 w-4"}),"Create New"]})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:f?a.jsx("div",{className:"flex justify-center items-center py-20",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-3",children:["Loading ",e.toLowerCase(),"..."]})]})}):a.jsx(a.Fragment,{children:o.length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",style:{backgroundColor:i+"10"},children:a.jsx(n,{className:"h-12 w-12",style:{color:i}})}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["No ",e.toLowerCase()," yet"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:w.search||w.status!=="all"||w.clients.length>0?`No ${e.toLowerCase()} match your current filters. Try adjusting your search criteria.`:`Get started by creating your first ${t.replace("_"," ")}.`}),a.jsx("div",{className:"mt-8",children:w.search||w.status!=="all"||w.clients.length>0?a.jsx("button",{onClick:L,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear Filters"}):a.jsxs("button",{onClick:M,className:"inline-flex items-center px-6 py-3 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2",style:{backgroundColor:i},children:[a.jsx(Vt,{className:"-ml-1 mr-2 h-5 w-5"}),"Create ",t.replace("_"," ")]})})]}):a.jsx("div",{className:w.viewMode==="cards"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-3",children:o.map(z=>a.jsx("div",{onClick:()=>P(z.id),className:`${w.viewMode==="cards"?"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md cursor-pointer transition-all hover:scale-105":"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md cursor-pointer transition-all"}`,children:w.viewMode==="cards"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"h-32 bg-gradient-to-br from-opacity-10 to-opacity-20 flex items-center justify-center relative",style:{backgroundColor:i+"08",backgroundImage:`linear-gradient(135deg, ${i}15, ${i}05)`},children:[a.jsx(n,{className:"h-8 w-8",style:{color:i}}),z.thumbnail_url&&a.jsx("img",{src:z.thumbnail_url,alt:z.title,className:"absolute inset-0 w-full h-full object-cover"})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 leading-5",children:z.title}),$(z.status)]}),z.description&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-3 leading-4",children:z.description}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{className:"h-3 w-3"}),a.jsx("span",{children:F(z.updated_at)})]}),x[z.id]>0&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(oi,{className:"h-3 w-3"}),a.jsx("span",{children:x[z.id]})]})]})]})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:i+"15"},children:a.jsx(n,{className:"h-6 w-6",style:{color:i}})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:z.title}),$(z.status)]}),z.description&&a.jsx("p",{className:"text-xs text-gray-600 truncate mt-1",children:z.description}),a.jsx("div",{className:"flex items-center justify-between mt-2",children:a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{className:"h-3 w-3"}),a.jsxs("span",{children:["Updated ",F(z.updated_at)]})]}),x[z.id]>0&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(oi,{className:"h-3 w-3"}),a.jsxs("span",{children:[x[z.id]," assignment",x[z.id]!==1?"s":""]})]})]})})]})]})},z.id))})})})]})]})})}function Ege(){return a.jsx(qp,{contentType:"ai_agent",title:xn.ai_agent.label,description:xn.ai_agent.description,icon:Kr,color:xn.ai_agent.color})}function Cge(){return a.jsx(qp,{contentType:"video",title:xn.video.label,description:xn.video.description,icon:si,color:xn.video.color})}function Age(){return a.jsx(qp,{contentType:"document",title:xn.document.label,description:xn.document.description,icon:Ot,color:xn.document.color})}function Tge(){return a.jsx(qp,{contentType:"prompt",title:xn.prompt.label,description:xn.prompt.description,icon:Gr,color:xn.prompt.color})}function Pge(){return a.jsx(qp,{contentType:"automation",title:xn.automation.label,description:xn.automation.description,icon:Ei,color:xn.automation.color})}function Mge({isOpen:t,onClose:e,client:r,contentItemId:n,onSave:i}){const[s,o]=O.useState([]),[l,c]=O.useState([]),[u,f]=O.useState([]),[d,p]=O.useState([]),[m,x]=O.useState(!1),[y,v]=O.useState(!1);O.useEffect(()=>{t&&b()},[t,r.id]);const b=async()=>{try{x(!0);const{data:N,error:j}=await pe.from("user_tags").select("*").eq("client_id",r.id).order("name");j?console.error("Error fetching tags:",j):N&&f(N);const{data:k,error:_}=await pe.from("users").select("*").eq("client_id",r.id).order("first_name");_?console.error("Error fetching users:",_):k&&p(k);const[E,A]=await Promise.all([pe.from("content_tag_assignments").select("tag_id").eq("content_item_id",n),pe.from("content_user_assignments").select("user_id").eq("content_item_id",n)]);E.data&&o(E.data.map(T=>T.tag_id)),A.data&&c(A.data.map(T=>T.user_id))}catch(N){console.error("Error fetching assignment data:",N)}finally{x(!1)}},w=async()=>{try{v(!0);const{data:{user:N}}=await pe.auth.getUser();if(!N)return;const j=[];u.length>0&&j.push(pe.from("content_tag_assignments").delete().eq("content_item_id",n).in("tag_id",u.map(_=>_.id))),d.length>0&&j.push(pe.from("content_user_assignments").delete().eq("content_item_id",n).in("user_id",d.map(_=>_.id))),await Promise.all(j);const k=[];if(s.length>0){const _=s.map(E=>({content_item_id:n,tag_id:E,assigned_by:N.id}));k.push(pe.from("content_tag_assignments").insert(_))}if(l.length>0){const _=l.map(E=>({content_item_id:n,user_id:E,assigned_by:N.id}));k.push(pe.from("content_user_assignments").insert(_))}await Promise.all(k),i(),e()}catch(N){console.error("Error saving assignments:",N)}finally{v(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-8 w-8 rounded-lg flex items-center justify-center",style:{backgroundColor:r.brand_color+"20"},children:a.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:r.brand_color}})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Assign to ",r.name]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Configure content visibility and access"})]})]}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx($r,{className:"h-5 w-5"})})]}),m?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(cr,{size:"md"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading assignment options..."})]}):a.jsxs("div",{className:"p-6 space-y-6",children:[u.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[a.jsx(Es,{className:"h-4 w-4 inline mr-2"}),"Assign to User Tags (",s.length," selected)"]}),a.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:u.map(N=>a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-50 rounded-md",children:[a.jsx("input",{type:"checkbox",checked:s.includes(N.id),onChange:j=>{j.target.checked?o([...s,N.id]):o(s.filter(k=>k!==N.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:N.color}}),a.jsx("span",{className:"text-sm text-gray-900",children:N.name})]})]},N.id))}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Content will be visible to all users with the selected tags"})]}),d.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[a.jsx(oi,{className:"h-4 w-4 inline mr-2"}),"Assign to Specific Users (",l.length," selected)"]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3",children:d.map(N=>a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-50 rounded-md",children:[a.jsx("input",{type:"checkbox",checked:l.includes(N.id),onChange:j=>{j.target.checked?c([...l,N.id]):c(l.filter(k=>k!==N.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[N.first_name," ",N.last_name]}),a.jsx("div",{className:"text-xs text-gray-500",children:N.email})]})]},N.id))}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Content will be visible to the specifically selected users"})]}),u.length===0&&d.length===0&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx(oi,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),a.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"No assignment options"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This client has no users or tags configured. Set up users and tags first."})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[a.jsx("button",{onClick:e,disabled:y,className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),a.jsxs("button",{onClick:w,disabled:y||u.length===0&&d.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[y?a.jsx(cr,{size:"sm",className:"mr-2"}):null,"Save Assignments"]})]})]})}):null}function zp({contentType:t,isEdit:e=!1,children:r,onSaveContent:n,title:i,description:s,color:o,icon:l}){const{id:c}=us(),u=Ti(),{admin:f}=Ln(),[d,p]=O.useState(null),[m,x]=O.useState([]),[y,v]=O.useState([]),[b,w]=O.useState(e),[N,j]=O.useState(!1),[k,_]=O.useState(!1),[E,A]=O.useState(null),[T,M]=O.useState(!1),[P,R]=O.useState(null),[L,$]=O.useState(""),[F,z]=O.useState(""),[W,K]=O.useState("draft"),[q,V]=O.useState(""),D=O.useRef(null),U=O.useCallback(()=>{if(!D.current)return!1;const te=D.current;return L!==te.title||F!==te.description||W!==te.status||q!==te.thumbnailUrl||JSON.stringify(y.slice().sort())!==JSON.stringify(te.assignedClients.slice().sort())},[L,F,W,q,y]);O.useEffect(()=>{const te=setTimeout(()=>{const se=U();se!==k&&_(se)},50);return()=>clearTimeout(te)},[L,F,W,q,y,k,U]),O.useEffect(()=>{let te=!0;return(async()=>{try{R(null),e&&c&&await G(),te&&await ee()}catch(ve){te&&(console.error("Error initializing ContentEditor:",ve),R(ve instanceof Error?ve.message:"Failed to load content"))}})(),()=>{te=!1}},[e,c]);const G=O.useCallback(async()=>{if(c)try{R(null);const{data:te,error:se}=await pe.from("content_items").select("*").eq("id",c).maybeSingle();if(se)throw se;if(!te){console.warn("Content item not found, redirecting to content list"),u("/content",{replace:!0});return}p(te);const ve=te.title||"",ie=te.description||"",ye=te.status||"draft",Te=te.thumbnail_url||"";$(ve),z(ie),K(ye),V(Te);const{data:Le,error:ue}=await pe.from("content_client_assignments").select("client_id").eq("content_item_id",te.id);ue&&console.error("Error fetching client assignments:",ue);const he=Le?Le.map(we=>we.client_id):[];v(he),D.current={title:ve,description:ie,status:ye,thumbnailUrl:Te,assignedClients:he},_(!1)}catch(te){console.error("Error fetching content item:",te),R(te instanceof Error?te.message:"Failed to load content item")}finally{w(!1)}},[c,u]),ee=O.useCallback(async()=>{try{R(null);const{data:te,error:se}=await pe.from("clients").select("*").eq("status","active").order("name");if(se)throw se;x(te||[]),!e&&!D.current&&(D.current={title:"",description:"",status:"draft",thumbnailUrl:"",assignedClients:[]})}catch(te){console.error("Error fetching clients:",te),R(te instanceof Error?te.message:"Failed to load clients")}},[e]),Q=O.useCallback(()=>({ai_agent:"ai-agents",video:"videos",document:"documents",prompt:"prompts",automation:"automations"})[t]||t,[t]),H=O.useCallback(async te=>{if(!f)throw new Error("Admin authentication required");try{const{error:se}=await pe.from("content_client_assignments").delete().eq("content_item_id",te);if(se)throw se;if(y.length>0){const ve=y.map(ye=>({content_item_id:te,client_id:ye,assigned_by:f.id})),{error:ie}=await pe.from("content_client_assignments").insert(ve);if(ie)throw ie}}catch(se){throw console.error("Error saving client assignments:",se),new Error("Failed to save client assignments")}},[f,y]),Y=O.useCallback(async()=>{if(!d||!f){R("Unable to delete: missing content item or admin authentication");return}if(confirm("Are you sure you want to delete this content? This action cannot be undone."))try{j(!0),R(null);const{error:te}=await pe.from("content_items").delete().eq("id",d.id);if(te)throw te;const se=Q();u(`/content/${se}`,{replace:!0})}catch(te){console.error("Error deleting content:",te);const se=te instanceof Error?te.message:"Error deleting content. Please try again.";R(se)}finally{j(!1)}},[d,f,u]),re=O.useCallback(async()=>{if(!f){R("Admin authentication required");return}try{j(!0),R(null);let te=c;const se={title:L.trim(),description:F.trim()||null,content_type:t,status:W,thumbnail_url:q.trim()||null,created_by:f.id,updated_at:new Date().toISOString()};if(e&&te){const{error:ve}=await pe.from("content_items").update(se).eq("id",te);if(ve)throw ve}else{const{data:ve,error:ie}=await pe.from("content_items").insert([{...se,created_at:new Date().toISOString()}]).select().single();if(ie)throw ie;ve&&(te=ve.id,p(ve))}if(n&&te&&await n(te),await H(te),D.current={title:L.trim(),description:F.trim(),status:W,thumbnailUrl:q.trim(),assignedClients:[...y]},_(!1),!e&&te){const ve=Q();u(`/content/${ve}/${te}/edit`,{replace:!0})}}catch(te){console.error("Error saving content:",te);const se=te instanceof Error?te.message:"Error saving content. Please try again.";R(se)}finally{j(!1)}},[f,c,L,F,t,W,q,n,y,e,u]),J=O.useCallback(async()=>{if(!f){R("Admin authentication required");return}try{j(!0),R(null);let te=c;const se={title:L.trim(),description:F.trim()||null,content_type:t,status:W,thumbnail_url:q.trim()||null,created_by:f.id,updated_at:new Date().toISOString()};if(e&&te){const{error:ie}=await pe.from("content_items").update(se).eq("id",te);if(ie)throw ie}else{const{data:ie,error:ye}=await pe.from("content_items").insert([{...se,created_at:new Date().toISOString()}]).select().single();if(ye)throw ye;ie&&(te=ie.id,p(ie))}n&&te&&await n(te),await H(te),_(!1);const ve=Q();u(`/content/${ve}`,{replace:!0})}catch(te){console.error("Error saving content:",te);const se=te instanceof Error?te.message:"Error saving content. Please try again.";R(se)}finally{j(!1)}},[f,c,L,F,t,W,q,n,y,u]),ne=O.useCallback(te=>{v(se=>se.includes(te)?se.filter(ie=>ie!==te):[...se,te])},[]);return b?a.jsx(pr,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading content..."})]})})}):P?a.jsx(pr,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"text-center max-w-md mx-auto",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"text-red-800 mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Content"}),a.jsx("p",{className:"text-sm",children:P})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:()=>{R(null),e&&c&&G(),ee()},className:"w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Try Again"}),a.jsx(Qn,{to:"/content",className:"block w-full px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500 text-center",children:"Back to Content"})]})]})})})}):a.jsx(Nh,{onError:(te,se)=>{console.error("ContentEditor Error Boundary:",te,se),R(`Component Error: ${te.message}`)},children:a.jsx(pr,{children:a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(Qn,{to:`/content/${Q()}`,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(lo,{className:"h-5 w-5"})}),a.jsx("div",{className:"h-8 w-8 rounded-lg flex items-center justify-center",style:{backgroundColor:o+"20"},children:a.jsx(l,{className:"h-5 w-5",style:{color:o}})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:[e?"Edit":"Create"," ",i.slice(0,-1)]}),a.jsx("p",{className:"text-sm text-gray-500",children:s})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[e&&a.jsxs("button",{onClick:Y,disabled:N,className:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:[a.jsx(ns,{className:"h-4 w-4 mr-1"}),"Delete"]}),!e&&a.jsxs("button",{onClick:J,disabled:N||!L.trim(),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[N?a.jsx(cr,{size:"sm",className:"mr-2"}):a.jsx(lo,{className:"h-4 w-4 mr-2"}),N?"Saving...":"Save & Return to List"]}),a.jsxs("button",{onClick:re,disabled:N||!L.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50",style:{backgroundColor:o},children:[N?a.jsx(cr,{size:"sm",className:"mr-2"}):a.jsx(Cp,{className:"h-4 w-4 mr-2"}),N?"Saving...":e?"Update":"Save & Continue Editing"]})]})]})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",id:"title",value:L,onChange:te=>$(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter ${i.slice(0,-1).toLowerCase()} title...`,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{id:"description",rows:3,value:F,onChange:te=>z(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Brief description of this ${i.slice(0,-1).toLowerCase()}...`})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Thumbnail URL"}),a.jsx("input",{type:"url",id:"thumbnail",value:q,onChange:te=>V(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/image.jpg"})]})]})]}),r]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status & Visibility"}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),a.jsxs("select",{value:W,onChange:te=>K(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"draft",children:"📝 Draft"}),a.jsx("option",{value:"published",children:"👁️ Published"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W==="draft"?"Only visible to admin users":"Visible to assigned clients and users"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Client Assignment"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[y.length," of ",m.length]})]}),m.length>0?a.jsx("div",{className:"space-y-3",children:m.map(te=>{const se=y.includes(te.id);return a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:se,onChange:()=>ne(te.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:te.brand_color}}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:te.name})]})]}),se&&a.jsx("button",{onClick:()=>A(te.id),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Configure"})]},te.id)})}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(oi,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"No clients available"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsxs("button",{onClick:()=>M(!T),className:"w-full flex items-center justify-between p-6 text-left",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Dn,{className:"h-5 w-5 text-gray-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Advanced Settings"})]}),T?a.jsx(mo,{className:"h-5 w-5 text-gray-600"}):a.jsx(jh,{className:"h-5 w-5 text-gray-600"})]}),T&&a.jsx("div",{className:"px-6 pb-6 border-t border-gray-200",children:a.jsx("div",{className:"pt-4 space-y-4",children:a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("p",{children:["Content ID: ",a.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:(d==null?void 0:d.id)||"Not created yet"})]}),a.jsxs("p",{children:["Content Type: ",a.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:t})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Created: ",new Date(d.created_at).toLocaleString()]}),a.jsxs("p",{children:["Updated: ",new Date(d.updated_at).toLocaleString()]})]})]})})})]})]})]})}),E&&a.jsx(Nh,{children:a.jsx(Mge,{isOpen:!0,onClose:()=>A(null),client:m.find(te=>te.id===E),contentItemId:(d==null?void 0:d.id)||c,onSave:()=>{}})})]})})})}function Rge(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T5(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function P5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?T5(Object(r),!0).forEach(function(n){Rge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T5(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ige(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Dge(t,e){if(t==null)return{};var r=Ige(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Lge(t,e){return $ge(t)||Bge(t,e)||Fge(t,e)||qge()}function $ge(t){if(Array.isArray(t))return t}function Bge(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,s=void 0;try{for(var o=t[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(e&&r.length===e));n=!0);}catch(c){i=!0,s=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw s}}return r}}function Fge(t,e){if(t){if(typeof t=="string")return M5(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M5(t,e)}}function M5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
  `},D5=iye(lye)(w8),cye={config:oye},uye=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(s,o){return o(s)},i)}};function j8(t,e){return Object.keys(e).forEach(function(r){e[r]instanceof Object&&t[r]&&Object.assign(e[r],j8(t[r],e[r]))}),P5(P5({},t),e)}var dye={type:"cancelation",msg:"operation is manually canceled"};function VN(t){var e=!1,r=new Promise(function(n,i){t.then(function(s){return e?i(dye):n(s)}),t.catch(i)});return r.cancel=function(){return e=!0},r}var fye=rye.create({config:nye,isInitialized:!1,resolve:null,reject:null,monaco:null}),S8=Lge(fye,2),Up=S8[0],px=S8[1];function hye(t){var e=cye.config(t),r=e.monaco,n=Dge(e,["monaco"]);px(function(i){return{config:j8(i.config,n),monaco:r}})}function pye(){var t=Up(function(e){var r=e.monaco,n=e.isInitialized,i=e.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!t.isInitialized){if(px({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),VN(KN);if(window.monaco&&window.monaco.editor)return N8(window.monaco),t.resolve(window.monaco),VN(KN);uye(mye,yye)(vye)}return VN(KN)}function mye(t){return document.body.appendChild(t)}function gye(t){var e=document.createElement("script");return t&&(e.src=t),e}function yye(t){var e=Up(function(n){var i=n.config,s=n.reject;return{config:i,reject:s}}),r=gye("".concat(e.config.paths.vs,"/loader.js"));return r.onload=function(){return t()},r.onerror=e.reject,r}function vye(){var t=Up(function(r){var n=r.config,i=r.resolve,s=r.reject;return{config:n,resolve:i,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(r){N8(r),t.resolve(r)},function(r){t.reject(r)})}function N8(t){Up().monaco||px({monaco:t})}function xye(){return Up(function(t){var e=t.monaco;return e})}var KN=new Promise(function(t,e){return px({resolve:t,reject:e})}),k8={config:hye,init:pye,__getMonacoInstance:xye},bye={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},GN=bye,wye={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},jye=wye;function Sye({children:t}){return Z.createElement("div",{style:jye.container},t)}var Nye=Sye,kye=Nye;function _ye({width:t,height:e,isEditorReady:r,loading:n,_ref:i,className:s,wrapperProps:o}){return Z.createElement("section",{style:{...GN.wrapper,width:t,height:e},...o},!r&&Z.createElement(kye,null,n),Z.createElement("div",{ref:i,style:{...GN.fullWidth,...!r&&GN.hide},className:s}))}var Oye=_ye,_8=O.memo(Oye);function Eye(t){O.useEffect(t,[])}var O8=Eye;function Cye(t,e,r=!0){let n=O.useRef(!0);O.useEffect(n.current||!r?()=>{n.current=!1}:t,e)}var Kn=Cye;function oh(){}function pu(t,e,r,n){return Aye(t,n)||Tye(t,e,r,n)}function Aye(t,e){return t.editor.getModel(E8(t,e))}function Tye(t,e,r,n){return t.editor.createModel(e,r,n?E8(t,n):void 0)}function E8(t,e){return t.Uri.parse(e)}function Pye({original:t,modified:e,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:l=!1,keepCurrentModifiedModel:c=!1,theme:u="light",loading:f="Loading...",options:d={},height:p="100%",width:m="100%",className:x,wrapperProps:y={},beforeMount:v=oh,onMount:b=oh}){let[w,N]=O.useState(!1),[j,k]=O.useState(!0),_=O.useRef(null),E=O.useRef(null),A=O.useRef(null),T=O.useRef(b),M=O.useRef(v),P=O.useRef(!1);O8(()=>{let F=k8.init();return F.then(z=>(E.current=z)&&k(!1)).catch(z=>(z==null?void 0:z.type)!=="cancelation"&&console.error("Monaco initialization: error:",z)),()=>_.current?$():F.cancel()}),Kn(()=>{if(_.current&&E.current){let F=_.current.getOriginalEditor(),z=pu(E.current,t||"",n||r||"text",s||"");z!==F.getModel()&&F.setModel(z)}},[s],w),Kn(()=>{if(_.current&&E.current){let F=_.current.getModifiedEditor(),z=pu(E.current,e||"",i||r||"text",o||"");z!==F.getModel()&&F.setModel(z)}},[o],w),Kn(()=>{let F=_.current.getModifiedEditor();F.getOption(E.current.editor.EditorOption.readOnly)?F.setValue(e||""):e!==F.getValue()&&(F.executeEdits("",[{range:F.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),F.pushUndoStop())},[e],w),Kn(()=>{var F,z;(z=(F=_.current)==null?void 0:F.getModel())==null||z.original.setValue(t||"")},[t],w),Kn(()=>{let{original:F,modified:z}=_.current.getModel();E.current.editor.setModelLanguage(F,n||r||"text"),E.current.editor.setModelLanguage(z,i||r||"text")},[r,n,i],w),Kn(()=>{var F;(F=E.current)==null||F.editor.setTheme(u)},[u],w),Kn(()=>{var F;(F=_.current)==null||F.updateOptions(d)},[d],w);let R=O.useCallback(()=>{var W;if(!E.current)return;M.current(E.current);let F=pu(E.current,t||"",n||r||"text",s||""),z=pu(E.current,e||"",i||r||"text",o||"");(W=_.current)==null||W.setModel({original:F,modified:z})},[r,e,i,t,n,s,o]),L=O.useCallback(()=>{var F;!P.current&&A.current&&(_.current=E.current.editor.createDiffEditor(A.current,{automaticLayout:!0,...d}),R(),(F=E.current)==null||F.editor.setTheme(u),N(!0),P.current=!0)},[d,u,R]);O.useEffect(()=>{w&&T.current(_.current,E.current)},[w]),O.useEffect(()=>{!j&&!w&&L()},[j,w,L]);function $(){var z,W,K,q;let F=(z=_.current)==null?void 0:z.getModel();l||((W=F==null?void 0:F.original)==null||W.dispose()),c||((K=F==null?void 0:F.modified)==null||K.dispose()),(q=_.current)==null||q.dispose()}return Z.createElement(_8,{width:m,height:p,isEditorReady:w,loading:f,_ref:A,className:x,wrapperProps:y})}var Mye=Pye;O.memo(Mye);function Rye(t){let e=O.useRef();return O.useEffect(()=>{e.current=t},[t]),e.current}var Iye=Rye,Ag=new Map;function Dye({defaultValue:t,defaultLanguage:e,defaultPath:r,value:n,language:i,path:s,theme:o="light",line:l,loading:c="Loading...",options:u={},overrideServices:f={},saveViewState:d=!0,keepCurrentModel:p=!1,width:m="100%",height:x="100%",className:y,wrapperProps:v={},beforeMount:b=oh,onMount:w=oh,onChange:N,onValidate:j=oh}){let[k,_]=O.useState(!1),[E,A]=O.useState(!0),T=O.useRef(null),M=O.useRef(null),P=O.useRef(null),R=O.useRef(w),L=O.useRef(b),$=O.useRef(),F=O.useRef(n),z=Iye(s),W=O.useRef(!1),K=O.useRef(!1);O8(()=>{let D=k8.init();return D.then(U=>(T.current=U)&&A(!1)).catch(U=>(U==null?void 0:U.type)!=="cancelation"&&console.error("Monaco initialization: error:",U)),()=>M.current?V():D.cancel()}),Kn(()=>{var U,G,ee,Q;let D=pu(T.current,t||n||"",e||i||"",s||r||"");D!==((U=M.current)==null?void 0:U.getModel())&&(d&&Ag.set(z,(G=M.current)==null?void 0:G.saveViewState()),(ee=M.current)==null||ee.setModel(D),d&&((Q=M.current)==null||Q.restoreViewState(Ag.get(s))))},[s],k),Kn(()=>{var D;(D=M.current)==null||D.updateOptions(u)},[u],k),Kn(()=>{!M.current||n===void 0||(M.current.getOption(T.current.editor.EditorOption.readOnly)?M.current.setValue(n):n!==M.current.getValue()&&(K.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),M.current.pushUndoStop(),K.current=!1))},[n],k),Kn(()=>{var U,G;let D=(U=M.current)==null?void 0:U.getModel();D&&i&&((G=T.current)==null||G.editor.setModelLanguage(D,i))},[i],k),Kn(()=>{var D;l!==void 0&&((D=M.current)==null||D.revealLine(l))},[l],k),Kn(()=>{var D;(D=T.current)==null||D.editor.setTheme(o)},[o],k);let q=O.useCallback(()=>{var D;if(!(!P.current||!T.current)&&!W.current){L.current(T.current);let U=s||r,G=pu(T.current,n||t||"",e||i||"",U||"");M.current=(D=T.current)==null?void 0:D.editor.create(P.current,{model:G,automaticLayout:!0,...u},f),d&&M.current.restoreViewState(Ag.get(U)),T.current.editor.setTheme(o),l!==void 0&&M.current.revealLine(l),_(!0),W.current=!0}},[t,e,r,n,i,s,u,f,d,o,l]);O.useEffect(()=>{k&&R.current(M.current,T.current)},[k]),O.useEffect(()=>{!E&&!k&&q()},[E,k,q]),F.current=n,O.useEffect(()=>{var D,U;k&&N&&((D=$.current)==null||D.dispose(),$.current=(U=M.current)==null?void 0:U.onDidChangeModelContent(G=>{K.current||N(M.current.getValue(),G)}))},[k,N]),O.useEffect(()=>{if(k){let D=T.current.editor.onDidChangeMarkers(U=>{var ee;let G=(ee=M.current.getModel())==null?void 0:ee.uri;if(G&&U.find(Q=>Q.path===G.path)){let Q=T.current.editor.getModelMarkers({resource:G});j==null||j(Q)}});return()=>{D==null||D.dispose()}}return()=>{}},[k,j]);function V(){var D,U;(D=$.current)==null||D.dispose(),p?d&&Ag.set(s,M.current.saveViewState()):(U=M.current.getModel())==null||U.dispose(),M.current.dispose()}return Z.createElement(_8,{width:m,height:x,isEditorReady:k,loading:c,_ref:P,className:y,wrapperProps:v})}var Lye=Dye,$ye=O.memo(Lye),Bye=$ye;function L5(){const{id:t}=us(),e=!!t,[r,n]=O.useState(null),[i,s]=O.useState(""),[o,l]=O.useState(""),[c,u]=O.useState(""),[f,d]=O.useState(e),[p,m]=O.useState(null),[x,y]=O.useState(!1);O.useEffect(()=>{let j=!0;return(async()=>{if(e&&t)try{await v()}catch(_){j&&(console.error("Error initializing AI agent:",_),m(_ instanceof Error?_.message:"Failed to load AI agent"))}else d(!1)})(),()=>{j=!1}},[e,t]);const v=O.useCallback(async()=>{if(!t){d(!1);return}try{m(null);const{data:j,error:k}=await pe.from("ai_agents").select("*").eq("content_item_id",t).maybeSingle();if(k)throw console.error("Error fetching AI agent:",k),new Error(`Database error: ${k.message}`);j&&(n(j),s(j.system_prompt||""),l(j.agent_name||""),u(j.short_description||""))}catch(j){throw console.error("Error fetching AI agent:",j),m(j instanceof Error?j.message:"Failed to load AI agent"),j}finally{d(!1)}},[t]),b=O.useCallback(async()=>{try{await navigator.clipboard.writeText(i),y(!0),setTimeout(()=>y(!1),2e3)}catch(j){console.error("Failed to copy prompt:",j),m("Failed to copy prompt to clipboard")}},[i]),w=O.useCallback(()=>{confirm("Are you sure you want to reset the system prompt? This action cannot be undone.")&&s("")},[]),N=O.useCallback(async j=>{if(!j)throw new Error("Content item ID is required for saving agent data");if(!o.trim())throw new Error("Agent name is required");if(!i.trim())throw new Error("System prompt is required");try{m(null);const k={content_item_id:j,system_prompt:i.trim(),agent_name:o.trim(),short_description:c.trim()||null,test_conversations:[],updated_at:new Date().toISOString()};let _;if(r){if(console.log("Updating existing AI agent:",r.id),_=await pe.from("ai_agents").update(k).eq("id",r.id).select().single(),_.error)throw console.error("Update error:",_.error),new Error(`Failed to update AI agent: ${_.error.message}`);console.log("AI agent updated successfully:",_.data)}else{if(console.log("Creating new AI agent for content item:",j),_=await pe.from("ai_agents").insert([{...k,created_at:new Date().toISOString()}]).select().single(),_.error)throw console.error("Insert error:",_.error),new Error(`Failed to create AI agent: ${_.error.message}`);console.log("AI agent created successfully:",_.data),n(_.data)}}catch(k){console.error("Error in saveAgentData:",k);const _=k instanceof Error?k.message:"Failed to save agent configuration";throw m(_),k}},[r,o,i,c]);return f?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading AI agent..."})]})}):a.jsx(Nh,{onError:(j,k)=>{console.error("AIAgentEditor Error Boundary:",j,k),m(`Component Error: ${j.message}`)},children:a.jsx(zp,{contentType:"ai_agent",isEdit:e,onSaveContent:N,title:"AI Agents",description:"Intelligent AI agents with custom prompts",color:"#3B82F6",icon:Kr,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Kr,{className:"h-5 w-5 mr-2 text-blue-500"}),"Agent Configuration"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"agentName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Agent Name *"}),a.jsx("input",{type:"text",id:"agentName",value:o,onChange:j=>l(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Customer Support Assistant",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"shortDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Short Description"}),a.jsx("input",{type:"text",id:"shortDescription",value:c,onChange:j=>u(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of agent capabilities"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"System Prompt *"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:b,className:`inline-flex items-center px-3 py-1.5 border rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${x?"border-green-300 text-green-700 bg-green-50 focus:ring-green-500":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-blue-500"}`,children:[a.jsx(gy,{className:"h-4 w-4 mr-1"}),x?"Copied!":"Copy"]}),a.jsxs("button",{onClick:w,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(zX,{className:"h-4 w-4 mr-1"}),"Reset"]})]})]}),a.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:a.jsx(Bye,{height:"300px",language:"markdown",value:i,onChange:j=>s(j||""),options:{minimap:{enabled:!1},wordWrap:"on",lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,fontSize:14,lineHeight:1.6,padding:{top:16,bottom:16},bracketPairColorization:{enabled:!0}},theme:"vs"})}),a.jsx("div",{className:"mt-3 text-sm text-gray-600",children:a.jsxs("p",{className:"flex items-start",children:[a.jsx(ql,{className:"h-4 w-4 mr-2 mt-0.5 text-blue-500 flex-shrink-0"}),"Define how your AI agent should behave, respond, and interact with users. Be specific about tone, knowledge domain, and constraints."]})})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"AI Agent Guidelines"}),a.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400 mt-2 mr-3 flex-shrink-0"}),a.jsx("p",{children:"Be specific about the agent's role and expertise area"})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400 mt-2 mr-3 flex-shrink-0"}),a.jsx("p",{children:"Define the tone and personality (professional, friendly, technical, etc.)"})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400 mt-2 mr-3 flex-shrink-0"}),a.jsx("p",{children:"Set clear boundaries on what the agent can and cannot do"})]}),a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400 mt-2 mr-3 flex-shrink-0"}),a.jsx("p",{children:"Include examples of good responses for consistency"})]})]})]}),p&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[a.jsx(ql,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-sm font-medium text-red-800 mb-1",children:"Error Saving AI Agent"}),a.jsx("p",{className:"text-sm text-red-700",children:p})]}),a.jsx("button",{onClick:()=>m(null),className:"text-red-400 hover:text-red-600",children:a.jsx($r,{className:"h-4 w-4"})})]})]})})})}function $5(){const{id:t}=us(),e=!!t,[r,n]=O.useState(null),[i,s]=O.useState(""),[o,l]=O.useState(""),[c,u]=O.useState(""),[f,d]=O.useState(""),[p,m]=O.useState(e),[x,y]=O.useState(!1),[v,b]=O.useState(null),[w,N]=O.useState(null);O.useEffect(()=>{e&&t&&j()},[e,t]),O.useEffect(()=>{i.trim()&&k(i.trim())},[i]);const j=async()=>{if(t)try{const{data:M,error:P}=await pe.from("videos").select("*").eq("content_item_id",t).maybeSingle();if(P)throw P;M&&(n(M),s(M.video_url),l(M.transcription||""),u(M.auto_title||""),d(M.auto_description||""),M.video_platform&&M.video_id&&N({platform:M.video_platform,videoId:M.video_id,duration:M.duration_seconds||void 0}))}catch(M){console.error("Error fetching video:",M)}finally{m(!1)}},k=async M=>{y(!0),b(null);try{const P=_(M);N(P),P.title&&u(P.title),P.description&&d(P.description)}catch(P){b(P.message||"Failed to process video URL"),N(null)}finally{y(!1)}},_=M=>{var L;const P=[/(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]+)/,/youtube\.com\/embed\/([\w-]+)/,/youtube\.com\/v\/([\w-]+)/],R=[/vimeo\.com\/(\d+)/,/player\.vimeo\.com\/video\/(\d+)/];for(const $ of P){const F=M.match($);if(F)return{platform:"youtube",videoId:F[1],title:`YouTube Video ${F[1]}`,description:"Video imported from YouTube"}}for(const $ of R){const F=M.match($);if(F)return{platform:"vimeo",videoId:F[1],title:`Vimeo Video ${F[1]}`,description:"Video imported from Vimeo"}}if(M.match(/\.(mp4|webm|ogg|mov|avi|mkv)$/i))return{platform:"other",title:((L=M.split("/").pop())==null?void 0:L.split(".")[0])||"Video File",description:"Direct video file"};throw new Error("Unsupported video URL format. Please use YouTube, Vimeo, or direct video file URLs.")},E=M=>M.platform==="youtube"&&M.videoId?`https://www.youtube.com/embed/${M.videoId}?rel=0&modestbranding=1`:M.platform==="vimeo"&&M.videoId?`https://player.vimeo.com/video/${M.videoId}?title=0&byline=0&portrait=0`:i,A=M=>{const P=M.trim().split(/\s+/).length;return Math.ceil(P/200)},T=async M=>{try{const P={content_item_id:M,video_url:i.trim(),video_platform:(w==null?void 0:w.platform)||null,video_id:(w==null?void 0:w.videoId)||null,duration_seconds:(w==null?void 0:w.duration)||null,transcription:o.trim()||null,auto_title:c.trim()||null,auto_description:f.trim()||null};if(r){const{error:R}=await pe.from("videos").update({...P,updated_at:new Date().toISOString()}).eq("id",r.id);if(R)throw R}else{const{error:R}=await pe.from("videos").insert([P]);if(R)throw R}}catch(P){throw console.error("Error saving video data:",P),P}};return p?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading video..."})]})}):a.jsx(zp,{contentType:"video",isEdit:e,onSaveContent:T,title:"Videos",description:"Educational videos with transcriptions",color:"#EF4444",icon:si,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(n_,{className:"h-5 w-5 mr-2 text-red-500"}),"Video Source"]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{htmlFor:"videoUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"Video URL *"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"url",id:"videoUrl",value:i,onChange:M=>s(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"https://www.youtube.com/watch?v=... or https://vimeo.com/...",required:!0}),x&&a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:a.jsx(cr,{size:"sm"})})]}),v&&a.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ql,{className:"h-4 w-4 text-red-600"}),a.jsx("p",{className:"text-sm text-red-700",children:v})]})}),w&&!v&&a.jsxs("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(ln,{className:"h-4 w-4 text-green-600"}),a.jsxs("p",{className:"text-sm text-green-700 font-medium",children:[w.platform.charAt(0).toUpperCase()+w.platform.slice(1)," video detected"]})]}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsxs("p",{children:["Platform: ",a.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:w.platform})]}),w.videoId&&a.jsxs("p",{children:["Video ID: ",a.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:w.videoId})]}),w.duration&&a.jsxs("p",{children:["Duration: ",a.jsxs("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:[Math.floor(w.duration/60),":",(w.duration%60).toString().padStart(2,"0")]})]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported: YouTube, Vimeo, and direct video file URLs (.mp4, .webm, .ogg, etc.)"})]})})]}),w&&i&&!v&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(si,{className:"h-5 w-5 mr-2 text-red-500"}),"Video Preview"]}),a.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden",children:w.platform==="youtube"||w.platform==="vimeo"?a.jsx("iframe",{src:E(w),title:"Video Preview",className:"w-full h-full",frameBorder:"0",allowFullScreen:!0}):a.jsx("video",{src:i,controls:!0,className:"w-full h-full object-cover",preload:"metadata"})}),a.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[w.platform&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(n_,{className:"h-4 w-4"}),a.jsx("span",{className:"capitalize",children:w.platform})]}),w.duration&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(go,{className:"h-4 w-4"}),a.jsxs("span",{children:[Math.floor(w.duration/60),":",(w.duration%60).toString().padStart(2,"0")]})]})]}),a.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-red-600 hover:text-red-800",children:[a.jsx(Os,{className:"h-4 w-4"}),a.jsx("span",{children:"Open Original"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Ot,{className:"h-5 w-5 mr-2 text-blue-500"}),"Video Metadata"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"autoTitle",className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto-detected Title"}),a.jsx("input",{type:"text",id:"autoTitle",value:c,onChange:M=>u(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Title will be auto-detected from video platform"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This can be used as a fallback title if main title is empty"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"autoDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto-detected Description"}),a.jsx("textarea",{id:"autoDescription",rows:3,value:f,onChange:M=>d(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Description will be auto-detected from video platform"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-populated from the video platform's metadata"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(Ot,{className:"h-5 w-5 mr-2 text-purple-500"}),"Video Transcription"]}),a.jsx("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:o.trim()&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ot,{className:"h-4 w-4"}),a.jsxs("span",{children:[o.trim().split(/\s+/).length," words"]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(go,{className:"h-4 w-4"}),a.jsxs("span",{children:[A(o)," min read"]})]})]})})]}),a.jsxs("div",{children:[a.jsx("textarea",{value:o,onChange:M=>l(M.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter the video transcription here...\\n\\nThis text will be searchable and can be used for generating subtitles or providing accessible content for users."}),a.jsx("div",{className:"mt-3 p-3 bg-purple-50 rounded-lg",children:a.jsxs("p",{className:"text-xs text-purple-700",children:[a.jsx("strong",{children:"Accessibility Tip:"})," Adding transcriptions makes your video content accessible to hearing-impaired users and improves SEO by making video content searchable."]})})]})]}),w&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Technical Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Platform"}),a.jsx("p",{className:"text-gray-900 capitalize",children:w.platform})]}),w.videoId&&a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Video ID"}),a.jsx("p",{className:"text-gray-900 font-mono text-xs",children:w.videoId})]}),w.duration&&a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Duration"}),a.jsxs("p",{className:"text-gray-900",children:[Math.floor(w.duration/3600),"h ",Math.floor(w.duration%3600/60),"m ",w.duration%60,"s"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"URL"}),a.jsx("p",{className:"text-gray-900 truncate",title:i,children:i})]})]})]})]})})}var Zg={exports:{}};/*!
`),K=W.shift();K.length>0&&($<this.length()-1||this.children.tail==null?o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"insertAt",this).call(this,Math.min($,this.length()-1),K):this.children.tail.insertAt(this.children.tail.length(),K),this.cache={});var q=this;W.reduce(function(V,D){return q=q.split(V,!0),q.insertAt(0,D),D.length},$+K.length)}}},{key:"insertBefore",value:function($,F){var z=this.children.head;o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"insertBefore",this).call(this,$,F),z instanceof x.default&&z.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"length",this).call(this)+E),this.cache.length}},{key:"moveChildren",value:function($,F){o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"moveChildren",this).call(this,$,F),this.cache={}}},{key:"optimize",value:function($){o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"optimize",this).call(this,$),this.cache={}}},{key:"path",value:function($){return o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"path",this).call(this,$,!0)}},{key:"removeChild",value:function($){o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"removeChild",this).call(this,$),this.cache={}}},{key:"split",value:function($){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(F&&($===0||$>=this.length()-E)){var z=this.clone();return $===0?(this.parent.insertBefore(z,this),this):(this.parent.insertBefore(z,this.next),z)}else{var W=o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"split",this).call(this,$,F);return this.cache={},W}}}]),R}(p.default.Block);T.blotName="block",T.tagName="P",T.defaultChild="break",T.allowedChildren=[v.default,p.default.Embed,w.default];function M(P){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return P==null||(typeof P.formats=="function"&&(R=(0,c.default)(R,P.formats())),P.parent==null||P.parent.blotName=="scroll"||P.parent.statics.scope!==P.statics.scope)?R:M(P.parent,R)}n.bubbleFormats=M,n.BlockEmbed=A,n.default=T},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},o=function(){function q(V,D){var U=[],G=!0,ee=!1,Q=void 0;try{for(var H=V[Symbol.iterator](),Y;!(G=(Y=H.next()).done)&&(U.push(Y.value),!(D&&U.length===D));G=!0);}catch(re){ee=!0,Q=re}finally{try{!G&&H.return&&H.return()}finally{if(ee)throw Q}}return U}return function(V,D){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return q(V,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function q(V,D){for(var U=0;U<D.length;U++){var G=D[U];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(V,G.key,G)}}return function(V,D,U){return D&&q(V.prototype,D),U&&q(V,U),V}}();i(50);var c=i(2),u=M(c),f=i(14),d=M(f),p=i(8),m=M(p),x=i(9),y=M(x),v=i(0),b=M(v),w=i(15),N=M(w),j=i(3),k=M(j),_=i(10),E=M(_),A=i(34),T=M(A);function M(q){return q&&q.__esModule?q:{default:q}}function P(q,V,D){return V in q?Object.defineProperty(q,V,{value:D,enumerable:!0,configurable:!0,writable:!0}):q[V]=D,q}function R(q,V){if(!(q instanceof V))throw new TypeError("Cannot call a class as a function")}var L=(0,E.default)("quill"),$=function(){l(q,null,[{key:"debug",value:function(D){D===!0&&(D="log"),E.default.level(D)}},{key:"find",value:function(D){return D.__quill||b.default.find(D)}},{key:"import",value:function(D){return this.imports[D]==null&&L.error("Cannot import "+D+". Are you sure it was registered?"),this.imports[D]}},{key:"register",value:function(D,U){var G=this,ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof D!="string"){var Q=D.attrName||D.blotName;typeof Q=="string"?this.register("formats/"+Q,D,U):Object.keys(D).forEach(function(H){G.register(H,D[H],U)})}else this.imports[D]!=null&&!ee&&L.warn("Overwriting "+D+" with",U),this.imports[D]=U,(D.startsWith("blots/")||D.startsWith("formats/"))&&U.blotName!=="abstract"?b.default.register(U):D.startsWith("modules")&&typeof U.register=="function"&&U.register()}}]);function q(V){var D=this,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(R(this,q),this.options=F(V,U),this.container=this.options.container,this.container==null)return L.error("Invalid Quill container",V);this.options.debug&&q.debug(this.options.debug);var G=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new m.default,this.scroll=b.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new d.default(this.scroll),this.selection=new N.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(m.default.events.EDITOR_CHANGE,function(Q){Q===m.default.events.TEXT_CHANGE&&D.root.classList.toggle("ql-blank",D.editor.isBlank())}),this.emitter.on(m.default.events.SCROLL_UPDATE,function(Q,H){var Y=D.selection.lastRange,re=Y&&Y.length===0?Y.index:void 0;z.call(D,function(){return D.editor.update(null,H,re)},Q)});var ee=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+G+"<p><br></p></div>");this.setContents(ee),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(q,[{key:"addContainer",value:function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof D=="string"){var G=D;D=document.createElement("div"),D.classList.add(G)}return this.container.insertBefore(D,U),D}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(D,U,G){var ee=this,Q=W(D,U,G),H=o(Q,4);return D=H[0],U=H[1],G=H[3],z.call(this,function(){return ee.editor.deleteText(D,U)},G,D,-1*U)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(D),this.container.classList.toggle("ql-disabled",!D)}},{key:"focus",value:function(){var D=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=D,this.scrollIntoView()}},{key:"format",value:function(D,U){var G=this,ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.default.sources.API;return z.call(this,function(){var Q=G.getSelection(!0),H=new u.default;if(Q==null)return H;if(b.default.query(D,b.default.Scope.BLOCK))H=G.editor.formatLine(Q.index,Q.length,P({},D,U));else{if(Q.length===0)return G.selection.format(D,U),H;H=G.editor.formatText(Q.index,Q.length,P({},D,U))}return G.setSelection(Q,m.default.sources.SILENT),H},ee)}},{key:"formatLine",value:function(D,U,G,ee,Q){var H=this,Y=void 0,re=W(D,U,G,ee,Q),J=o(re,4);return D=J[0],U=J[1],Y=J[2],Q=J[3],z.call(this,function(){return H.editor.formatLine(D,U,Y)},Q,D,0)}},{key:"formatText",value:function(D,U,G,ee,Q){var H=this,Y=void 0,re=W(D,U,G,ee,Q),J=o(re,4);return D=J[0],U=J[1],Y=J[2],Q=J[3],z.call(this,function(){return H.editor.formatText(D,U,Y)},Q,D,0)}},{key:"getBounds",value:function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,G=void 0;typeof D=="number"?G=this.selection.getBounds(D,U):G=this.selection.getBounds(D.index,D.length);var ee=this.container.getBoundingClientRect();return{bottom:G.bottom-ee.top,height:G.height,left:G.left-ee.left,right:G.right-ee.left,top:G.top-ee.top,width:G.width}}},{key:"getContents",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-D,G=W(D,U),ee=o(G,2);return D=ee[0],U=ee[1],this.editor.getContents(D,U)}},{key:"getFormat",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof D=="number"?this.editor.getFormat(D,U):this.editor.getFormat(D.index,D.length)}},{key:"getIndex",value:function(D){return D.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(D){return this.scroll.leaf(D)}},{key:"getLine",value:function(D){return this.scroll.line(D)}},{key:"getLines",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof D!="number"?this.scroll.lines(D.index,D.length):this.scroll.lines(D,U)}},{key:"getModule",value:function(D){return this.theme.modules[D]}},{key:"getSelection",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return D&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-D,G=W(D,U),ee=o(G,2);return D=ee[0],U=ee[1],this.editor.getText(D,U)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(D,U,G){var ee=this,Q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:q.sources.API;return z.call(this,function(){return ee.editor.insertEmbed(D,U,G)},Q,D)}},{key:"insertText",value:function(D,U,G,ee,Q){var H=this,Y=void 0,re=W(D,0,G,ee,Q),J=o(re,4);return D=J[0],Y=J[2],Q=J[3],z.call(this,function(){return H.editor.insertText(D,U,Y)},Q,D,U.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(D,U,G){this.clipboard.dangerouslyPasteHTML(D,U,G)}},{key:"removeFormat",value:function(D,U,G){var ee=this,Q=W(D,U,G),H=o(Q,4);return D=H[0],U=H[1],G=H[3],z.call(this,function(){return ee.editor.removeFormat(D,U)},G,D)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(D){var U=this,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.default.sources.API;return z.call(this,function(){D=new u.default(D);var ee=U.getLength(),Q=U.editor.deleteText(0,ee),H=U.editor.applyDelta(D),Y=H.ops[H.ops.length-1];Y!=null&&typeof Y.insert=="string"&&Y.insert[Y.insert.length-1]===`
`&&(U.editor.deleteText(U.getLength()-1,1),H.delete(1));var re=Q.compose(H);return re},G)}},{key:"setSelection",value:function(D,U,G){if(D==null)this.selection.setRange(null,U||q.sources.API);else{var ee=W(D,U,G),Q=o(ee,4);D=Q[0],U=Q[1],G=Q[3],this.selection.setRange(new w.Range(D,U),G),G!==m.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(D){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.default.sources.API,G=new u.default().insert(D);return this.setContents(G,U)}},{key:"update",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m.default.sources.USER,U=this.scroll.update(D);return this.selection.update(D),U}},{key:"updateContents",value:function(D){var U=this,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.default.sources.API;return z.call(this,function(){return D=new u.default(D),U.editor.applyDelta(D,G)},G,!0)}}]),q}();$.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},$.events=m.default.events,$.sources=m.default.sources,$.version="1.3.7",$.imports={delta:u.default,parchment:b.default,"core/module":y.default,"core/theme":T.default};function F(q,V){if(V=(0,k.default)(!0,{container:q,modules:{clipboard:!0,keyboard:!0,history:!0}},V),!V.theme||V.theme===$.DEFAULTS.theme)V.theme=T.default;else if(V.theme=$.import("themes/"+V.theme),V.theme==null)throw new Error("Invalid theme "+V.theme+". Did you register it?");var D=(0,k.default)(!0,{},V.theme.DEFAULTS);[D,V].forEach(function(ee){ee.modules=ee.modules||{},Object.keys(ee.modules).forEach(function(Q){ee.modules[Q]===!0&&(ee.modules[Q]={})})});var U=Object.keys(D.modules).concat(Object.keys(V.modules)),G=U.reduce(function(ee,Q){var H=$.import("modules/"+Q);return H==null?L.error("Cannot load "+Q+" module. Are you sure you registered it?"):ee[Q]=H.DEFAULTS||{},ee},{});return V.modules!=null&&V.modules.toolbar&&V.modules.toolbar.constructor!==Object&&(V.modules.toolbar={container:V.modules.toolbar}),V=(0,k.default)(!0,{},$.DEFAULTS,{modules:G},D,V),["bounds","container","scrollingContainer"].forEach(function(ee){typeof V[ee]=="string"&&(V[ee]=document.querySelector(V[ee]))}),V.modules=Object.keys(V.modules).reduce(function(ee,Q){return V.modules[Q]&&(ee[Q]=V.modules[Q]),ee},{}),V}function z(q,V,D,U){if(this.options.strict&&!this.isEnabled()&&V===m.default.sources.USER)return new u.default;var G=D==null?null:this.getSelection(),ee=this.editor.delta,Q=q();if(G!=null&&(D===!0&&(D=G.index),U==null?G=K(G,Q,V):U!==0&&(G=K(G,D,U,V)),this.setSelection(G,m.default.sources.SILENT)),Q.length()>0){var H,Y=[m.default.events.TEXT_CHANGE,Q,ee,V];if((H=this.emitter).emit.apply(H,[m.default.events.EDITOR_CHANGE].concat(Y)),V!==m.default.sources.SILENT){var re;(re=this.emitter).emit.apply(re,Y)}}return Q}function W(q,V,D,U,G){var ee={};return typeof q.index=="number"&&typeof q.length=="number"?typeof V!="number"?(G=U,U=D,D=V,V=q.length,q=q.index):(V=q.length,q=q.index):typeof V!="number"&&(G=U,U=D,D=V,V=0),(typeof D>"u"?"undefined":s(D))==="object"?(ee=D,G=U):typeof D=="string"&&(U!=null?ee[D]=U:G=D),G=G||m.default.sources.API,[q,V,ee,G]}function K(q,V,D,U){if(q==null)return null;var G=void 0,ee=void 0;if(V instanceof u.default){var Q=[q.index,q.index+q.length].map(function(J){return V.transformPosition(J,U!==m.default.sources.USER)}),H=o(Q,2);G=H[0],ee=H[1]}else{var Y=[q.index,q.index+q.length].map(function(J){return J<V||J===V&&U===m.default.sources.USER?J:D>=0?J+D:Math.max(V,J+D)}),re=o(Y,2);G=re[0],ee=re[1]}return new w.Range(G,ee-G)}n.expandConfig=F,n.overload=W,n.default=$},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(b,w){for(var N=0;N<w.length;N++){var j=w[N];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,w,N){return w&&v(b.prototype,w),N&&v(b,N),b}}(),o=function v(b,w,N){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,w);if(j===void 0){var k=Object.getPrototypeOf(b);return k===null?void 0:v(k,w,N)}else{if("value"in j)return j.value;var _=j.get;return _===void 0?void 0:_.call(N)}},l=i(7),c=d(l),u=i(0),f=d(u);function d(v){return v&&v.__esModule?v:{default:v}}function p(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function m(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function x(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var y=function(v){x(b,v);function b(){return p(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"formatAt",value:function(N,j,k,_){if(b.compare(this.statics.blotName,k)<0&&f.default.query(k,f.default.Scope.BLOT)){var E=this.isolate(N,j);_&&E.wrap(k,_)}else o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"formatAt",this).call(this,N,j,k,_)}},{key:"optimize",value:function(N){if(o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,N),this.parent instanceof b&&b.compare(this.statics.blotName,this.parent.statics.blotName)>0){var j=this.parent.isolate(this.offset(),this.length());this.moveChildren(j),j.wrap(this)}}}],[{key:"compare",value:function(N,j){var k=b.order.indexOf(N),_=b.order.indexOf(j);return k>=0||_>=0?k-_:N===j?0:N<j?-1:1}}]),b}(f.default.Inline);y.allowedChildren=[y,f.default.Embed,c.default],y.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=y},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default.Text);n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(N,j){for(var k=0;k<j.length;k++){var _=j[k];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(N,_.key,_)}}return function(N,j,k){return j&&w(N.prototype,j),k&&w(N,k),N}}(),o=function w(N,j,k){N===null&&(N=Function.prototype);var _=Object.getOwnPropertyDescriptor(N,j);if(_===void 0){var E=Object.getPrototypeOf(N);return E===null?void 0:w(E,j,k)}else{if("value"in _)return _.value;var A=_.get;return A===void 0?void 0:A.call(k)}},l=i(54),c=d(l),u=i(10),f=d(u);function d(w){return w&&w.__esModule?w:{default:w}}function p(w,N){if(!(w instanceof N))throw new TypeError("Cannot call a class as a function")}function m(w,N){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:w}function x(w,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);w.prototype=Object.create(N&&N.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(w,N):w.__proto__=N)}var y=(0,f.default)("quill:events"),v=["selectionchange","mousedown","mouseup","click"];v.forEach(function(w){document.addEventListener(w,function(){for(var N=arguments.length,j=Array(N),k=0;k<N;k++)j[k]=arguments[k];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(_){if(_.__quill&&_.__quill.emitter){var E;(E=_.__quill.emitter).handleDOM.apply(E,j)}})})});var b=function(w){x(N,w);function N(){p(this,N);var j=m(this,(N.__proto__||Object.getPrototypeOf(N)).call(this));return j.listeners={},j.on("error",y.error),j}return s(N,[{key:"emit",value:function(){y.log.apply(y,arguments),o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(k){for(var _=arguments.length,E=Array(_>1?_-1:0),A=1;A<_;A++)E[A-1]=arguments[A];(this.listeners[k.type]||[]).forEach(function(T){var M=T.node,P=T.handler;(k.target===M||M.contains(k.target))&&P.apply(void 0,[k].concat(E))})}},{key:"listenDOM",value:function(k,_,E){this.listeners[k]||(this.listeners[k]=[]),this.listeners[k].push({node:_,handler:E})}}]),N}(c.default);b.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.sources={API:"api",SILENT:"silent",USER:"user"},n.default=b},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=c,this.options=u};o.DEFAULTS={},n.default=o},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(u){if(s.indexOf(u)<=s.indexOf(o)){for(var f,d=arguments.length,p=Array(d>1?d-1:0),m=1;m<d;m++)p[m-1]=arguments[m];(f=console)[u].apply(f,p)}}function c(u){return s.reduce(function(f,d){return f[d]=l.bind(console,d,u),f},{})}l.level=c.level=function(u){o=u},n.default=c},function(r,n,i){var s=Array.prototype.slice,o=i(52),l=i(53),c=r.exports=function(p,m,x){return x||(x={}),p===m?!0:p instanceof Date&&m instanceof Date?p.getTime()===m.getTime():!p||!m||typeof p!="object"&&typeof m!="object"?x.strict?p===m:p==m:d(p,m,x)};function u(p){return p==null}function f(p){return!(!p||typeof p!="object"||typeof p.length!="number"||typeof p.copy!="function"||typeof p.slice!="function"||p.length>0&&typeof p[0]!="number")}function d(p,m,x){var y,v;if(u(p)||u(m)||p.prototype!==m.prototype)return!1;if(l(p))return l(m)?(p=s.call(p),m=s.call(m),c(p,m,x)):!1;if(f(p)){if(!f(m)||p.length!==m.length)return!1;for(y=0;y<p.length;y++)if(p[y]!==m[y])return!1;return!0}try{var b=o(p),w=o(m)}catch{return!1}if(b.length!=w.length)return!1;for(b.sort(),w.sort(),y=b.length-1;y>=0;y--)if(b[y]!=w[y])return!1;for(y=b.length-1;y>=0;y--)if(v=b[y],!c(p[v],m[v],x))return!1;return typeof p==typeof m}},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(c,u,f){f===void 0&&(f={}),this.attrName=c,this.keyName=u;var d=s.Scope.TYPE&s.Scope.ATTRIBUTE;f.scope!=null?this.scope=f.scope&s.Scope.LEVEL|d:this.scope=s.Scope.ATTRIBUTE,f.whitelist!=null&&(this.whitelist=f.whitelist)}return l.keys=function(c){return[].map.call(c.attributes,function(u){return u.name})},l.prototype.add=function(c,u){return this.canAdd(c,u)?(c.setAttribute(this.keyName,u),!0):!1},l.prototype.canAdd=function(c,u){var f=s.query(c,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return f==null?!1:this.whitelist==null?!0:typeof u=="string"?this.whitelist.indexOf(u.replace(/["']/g,""))>-1:this.whitelist.indexOf(u)>-1},l.prototype.remove=function(c){c.removeAttribute(this.keyName)},l.prototype.value=function(c){var u=c.getAttribute(this.keyName);return this.canAdd(c,u)&&u?u:""},l}();n.default=o},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function A(T,M){var P=[],R=!0,L=!1,$=void 0;try{for(var F=T[Symbol.iterator](),z;!(R=(z=F.next()).done)&&(P.push(z.value),!(M&&P.length===M));R=!0);}catch(W){L=!0,$=W}finally{try{!R&&F.return&&F.return()}finally{if(L)throw $}}return P}return function(T,M){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return A(T,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function A(T,M){for(var P=0;P<M.length;P++){var R=M[P];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(T,R.key,R)}}return function(T,M,P){return M&&A(T.prototype,M),P&&A(T,P),T}}(),l=function A(T,M,P){T===null&&(T=Function.prototype);var R=Object.getOwnPropertyDescriptor(T,M);if(R===void 0){var L=Object.getPrototypeOf(T);return L===null?void 0:A(L,M,P)}else{if("value"in R)return R.value;var $=R.get;return $===void 0?void 0:$.call(P)}},c=i(2),u=w(c),f=i(0),d=w(f),p=i(4),m=w(p),x=i(6),y=w(x),v=i(7),b=w(v);function w(A){return A&&A.__esModule?A:{default:A}}function N(A,T){if(!(A instanceof T))throw new TypeError("Cannot call a class as a function")}function j(A,T){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:A}function k(A,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);A.prototype=Object.create(T&&T.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(A,T):A.__proto__=T)}var _=function(A){k(T,A);function T(){return N(this,T),j(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return T}(y.default);_.blotName="code",_.tagName="CODE";var E=function(A){k(T,A);function T(){return N(this,T),j(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return o(T,[{key:"delta",value:function(){var P=this,R=this.domNode.textContent;return R.endsWith(`
`);return V.insert(G,D.attributes)}return V.push(D)},new u.default)}n.default=z},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function A(T,M){var P=[],R=!0,L=!1,$=void 0;try{for(var F=T[Symbol.iterator](),z;!(R=(z=F.next()).done)&&(P.push(z.value),!(M&&P.length===M));R=!0);}catch(W){L=!0,$=W}finally{try{!R&&F.return&&F.return()}finally{if(L)throw $}}return P}return function(T,M){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return A(T,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function A(T,M){for(var P=0;P<M.length;P++){var R=M[P];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(T,R.key,R)}}return function(T,M,P){return M&&A(T.prototype,M),P&&A(T,P),T}}(),l=i(0),c=b(l),u=i(21),f=b(u),d=i(11),p=b(d),m=i(8),x=b(m),y=i(10),v=b(y);function b(A){return A&&A.__esModule?A:{default:A}}function w(A){if(Array.isArray(A)){for(var T=0,M=Array(A.length);T<A.length;T++)M[T]=A[T];return M}else return Array.from(A)}function N(A,T){if(!(A instanceof T))throw new TypeError("Cannot call a class as a function")}var j=(0,v.default)("quill:selection"),k=function A(T){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;N(this,A),this.index=T,this.length=M},_=function(){function A(T,M){var P=this;N(this,A),this.emitter=M,this.scroll=T,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=c.default.create("cursor",this),this.lastRange=this.savedRange=new k(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){P.mouseDown||setTimeout(P.update.bind(P,x.default.sources.USER),1)}),this.emitter.on(x.default.events.EDITOR_CHANGE,function(R,L){R===x.default.events.TEXT_CHANGE&&L.length()>0&&P.update(x.default.sources.SILENT)}),this.emitter.on(x.default.events.SCROLL_BEFORE_UPDATE,function(){if(P.hasFocus()){var R=P.getNativeRange();R!=null&&R.start.node!==P.cursor.textNode&&P.emitter.once(x.default.events.SCROLL_UPDATE,function(){try{P.setNativeRange(R.start.node,R.start.offset,R.end.node,R.end.offset)}catch{}})}}),this.emitter.on(x.default.events.SCROLL_OPTIMIZE,function(R,L){if(L.range){var $=L.range,F=$.startNode,z=$.startOffset,W=$.endNode,K=$.endOffset;P.setNativeRange(F,z,W,K)}}),this.update(x.default.sources.SILENT)}return o(A,[{key:"handleComposition",value:function(){var M=this;this.root.addEventListener("compositionstart",function(){M.composing=!0}),this.root.addEventListener("compositionend",function(){if(M.composing=!1,M.cursor.parent){var P=M.cursor.restore();if(!P)return;setTimeout(function(){M.setNativeRange(P.startNode,P.startOffset,P.endNode,P.endOffset)},1)}})}},{key:"handleDragging",value:function(){var M=this;this.emitter.listenDOM("mousedown",document.body,function(){M.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){M.mouseDown=!1,M.update(x.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(M,P){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[M])){this.scroll.update();var R=this.getNativeRange();if(!(R==null||!R.native.collapsed||c.default.query(M,c.default.Scope.BLOCK))){if(R.start.node!==this.cursor.textNode){var L=c.default.find(R.start.node,!1);if(L==null)return;if(L instanceof c.default.Leaf){var $=L.split(R.start.offset);L.parent.insertBefore(this.cursor,$)}else L.insertBefore(this.cursor,R.start.node);this.cursor.attach()}this.cursor.format(M,P),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(M){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=this.scroll.length();M=Math.min(M,R-1),P=Math.min(M+P,R-1)-M;var L=void 0,$=this.scroll.leaf(M),F=s($,2),z=F[0],W=F[1];if(z==null)return null;var K=z.position(W,!0),q=s(K,2);L=q[0],W=q[1];var V=document.createRange();if(P>0){V.setStart(L,W);var D=this.scroll.leaf(M+P),U=s(D,2);if(z=U[0],W=U[1],z==null)return null;var G=z.position(W,!0),ee=s(G,2);return L=ee[0],W=ee[1],V.setEnd(L,W),V.getBoundingClientRect()}else{var Q="left",H=void 0;return L instanceof Text?(W<L.data.length?(V.setStart(L,W),V.setEnd(L,W+1)):(V.setStart(L,W-1),V.setEnd(L,W),Q="right"),H=V.getBoundingClientRect()):(H=z.domNode.getBoundingClientRect(),W>0&&(Q="right")),{bottom:H.top+H.height,height:H.height,left:H[Q],right:H[Q],top:H.top,width:0}}}},{key:"getNativeRange",value:function(){var M=document.getSelection();if(M==null||M.rangeCount<=0)return null;var P=M.getRangeAt(0);if(P==null)return null;var R=this.normalizeNative(P);return j.info("getNativeRange",R),R}},{key:"getRange",value:function(){var M=this.getNativeRange();if(M==null)return[null,null];var P=this.normalizedToRange(M);return[P,M]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(M){var P=this,R=[[M.start.node,M.start.offset]];M.native.collapsed||R.push([M.end.node,M.end.offset]);var L=R.map(function(z){var W=s(z,2),K=W[0],q=W[1],V=c.default.find(K,!0),D=V.offset(P.scroll);return q===0?D:V instanceof c.default.Container?D+V.length():D+V.index(K,q)}),$=Math.min(Math.max.apply(Math,w(L)),this.scroll.length()-1),F=Math.min.apply(Math,[$].concat(w(L)));return new k(F,$-F)}},{key:"normalizeNative",value:function(M){if(!E(this.root,M.startContainer)||!M.collapsed&&!E(this.root,M.endContainer))return null;var P={start:{node:M.startContainer,offset:M.startOffset},end:{node:M.endContainer,offset:M.endOffset},native:M};return[P.start,P.end].forEach(function(R){for(var L=R.node,$=R.offset;!(L instanceof Text)&&L.childNodes.length>0;)if(L.childNodes.length>$)L=L.childNodes[$],$=0;else if(L.childNodes.length===$)L=L.lastChild,$=L instanceof Text?L.data.length:L.childNodes.length+1;else break;R.node=L,R.offset=$}),P}},{key:"rangeToNative",value:function(M){var P=this,R=M.collapsed?[M.index]:[M.index,M.index+M.length],L=[],$=this.scroll.length();return R.forEach(function(F,z){F=Math.min($-1,F);var W=void 0,K=P.scroll.leaf(F),q=s(K,2),V=q[0],D=q[1],U=V.position(D,z!==0),G=s(U,2);W=G[0],D=G[1],L.push(W,D)}),L.length<2&&(L=L.concat(L)),L}},{key:"scrollIntoView",value:function(M){var P=this.lastRange;if(P!=null){var R=this.getBounds(P.index,P.length);if(R!=null){var L=this.scroll.length()-1,$=this.scroll.line(Math.min(P.index,L)),F=s($,1),z=F[0],W=z;if(P.length>0){var K=this.scroll.line(Math.min(P.index+P.length,L)),q=s(K,1);W=q[0]}if(!(z==null||W==null)){var V=M.getBoundingClientRect();R.top<V.top?M.scrollTop-=V.top-R.top:R.bottom>V.bottom&&(M.scrollTop+=R.bottom-V.bottom)}}}}},{key:"setNativeRange",value:function(M,P){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:M,L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:P,$=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(j.info("setNativeRange",M,P,R,L),!(M!=null&&(this.root.parentNode==null||M.parentNode==null||R.parentNode==null))){var F=document.getSelection();if(F!=null)if(M!=null){this.hasFocus()||this.root.focus();var z=(this.getNativeRange()||{}).native;if(z==null||$||M!==z.startContainer||P!==z.startOffset||R!==z.endContainer||L!==z.endOffset){M.tagName=="BR"&&(P=[].indexOf.call(M.parentNode.childNodes,M),M=M.parentNode),R.tagName=="BR"&&(L=[].indexOf.call(R.parentNode.childNodes,R),R=R.parentNode);var W=document.createRange();W.setStart(M,P),W.setEnd(R,L),F.removeAllRanges(),F.addRange(W)}}else F.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(M){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.default.sources.API;if(typeof P=="string"&&(R=P,P=!1),j.info("setRange",M),M!=null){var L=this.rangeToNative(M);this.setNativeRange.apply(this,w(L).concat([P]))}else this.setNativeRange(null);this.update(R)}},{key:"update",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x.default.sources.USER,P=this.lastRange,R=this.getRange(),L=s(R,2),$=L[0],F=L[1];if(this.lastRange=$,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,p.default)(P,this.lastRange)){var z;!this.composing&&F!=null&&F.native.collapsed&&F.start.node!==this.cursor.textNode&&this.cursor.restore();var W=[x.default.events.SELECTION_CHANGE,(0,f.default)(this.lastRange),(0,f.default)(P),M];if((z=this.emitter).emit.apply(z,[x.default.events.EDITOR_CHANGE].concat(W)),M!==x.default.sources.SILENT){var K;(K=this.emitter).emit.apply(K,W)}}}}]),A}();function E(A,T){try{T.parentNode}catch{return!1}return T instanceof Text&&(T=T.parentNode),A.contains(T)}n.Range=k,n.default=_},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(0),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(){return f(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"insertInto",value:function(b,w){b.children.length===0?o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"insertInto",this).call(this,b,w):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),y}(c.default.Embed);m.blotName="break",m.tagName="BR",n.default=m},function(r,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,m){p.__proto__=m}||function(p,m){for(var x in m)m.hasOwnProperty(x)&&(p[x]=m[x])};return function(p,m){d(p,m);function x(){this.constructor=p}p.prototype=m===null?Object.create(m):(x.prototype=m.prototype,new x)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),l=i(30),c=i(1),u=function(d){s(p,d);function p(m){var x=d.call(this,m)||this;return x.build(),x}return p.prototype.appendChild=function(m){this.insertBefore(m)},p.prototype.attach=function(){d.prototype.attach.call(this),this.children.forEach(function(m){m.attach()})},p.prototype.build=function(){var m=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(x){try{var y=f(x);m.insertBefore(y,m.children.head||void 0)}catch(v){if(v instanceof c.ParchmentError)return;throw v}})},p.prototype.deleteAt=function(m,x){if(m===0&&x===this.length())return this.remove();this.children.forEachAt(m,x,function(y,v,b){y.deleteAt(v,b)})},p.prototype.descendant=function(m,x){var y=this.children.find(x),v=y[0],b=y[1];return m.blotName==null&&m(v)||m.blotName!=null&&v instanceof m?[v,b]:v instanceof p?v.descendant(m,b):[null,-1]},p.prototype.descendants=function(m,x,y){x===void 0&&(x=0),y===void 0&&(y=Number.MAX_VALUE);var v=[],b=y;return this.children.forEachAt(x,y,function(w,N,j){(m.blotName==null&&m(w)||m.blotName!=null&&w instanceof m)&&v.push(w),w instanceof p&&(v=v.concat(w.descendants(m,N,b))),b-=j}),v},p.prototype.detach=function(){this.children.forEach(function(m){m.detach()}),d.prototype.detach.call(this)},p.prototype.formatAt=function(m,x,y,v){this.children.forEachAt(m,x,function(b,w,N){b.formatAt(w,N,y,v)})},p.prototype.insertAt=function(m,x,y){var v=this.children.find(m),b=v[0],w=v[1];if(b)b.insertAt(w,x,y);else{var N=y==null?c.create("text",x):c.create(x,y);this.appendChild(N)}},p.prototype.insertBefore=function(m,x){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(y){return m instanceof y}))throw new c.ParchmentError("Cannot insert "+m.statics.blotName+" into "+this.statics.blotName);m.insertInto(this,x)},p.prototype.length=function(){return this.children.reduce(function(m,x){return m+x.length()},0)},p.prototype.moveChildren=function(m,x){this.children.forEach(function(y){m.insertBefore(y,x)})},p.prototype.optimize=function(m){if(d.prototype.optimize.call(this,m),this.children.length===0)if(this.statics.defaultChild!=null){var x=c.create(this.statics.defaultChild);this.appendChild(x),x.optimize(m)}else this.remove()},p.prototype.path=function(m,x){x===void 0&&(x=!1);var y=this.children.find(m,x),v=y[0],b=y[1],w=[[this,m]];return v instanceof p?w.concat(v.path(b,x)):(v!=null&&w.push([v,b]),w)},p.prototype.removeChild=function(m){this.children.remove(m)},p.prototype.replace=function(m){m instanceof p&&m.moveChildren(this),d.prototype.replace.call(this,m)},p.prototype.split=function(m,x){if(x===void 0&&(x=!1),!x){if(m===0)return this;if(m===this.length())return this.next}var y=this.clone();return this.parent.insertBefore(y,this.next),this.children.forEachAt(m,this.length(),function(v,b,w){v=v.split(b,x),y.appendChild(v)}),y},p.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},p.prototype.update=function(m,x){var y=this,v=[],b=[];m.forEach(function(w){w.target===y.domNode&&w.type==="childList"&&(v.push.apply(v,w.addedNodes),b.push.apply(b,w.removedNodes))}),b.forEach(function(w){if(!(w.parentNode!=null&&w.tagName!=="IFRAME"&&document.body.compareDocumentPosition(w)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var N=c.find(w);N!=null&&(N.domNode.parentNode==null||N.domNode.parentNode===y.domNode)&&N.detach()}}),v.filter(function(w){return w.parentNode==y.domNode}).sort(function(w,N){return w===N?0:w.compareDocumentPosition(N)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(w){var N=null;w.nextSibling!=null&&(N=c.find(w.nextSibling));var j=f(w);(j.next!=N||j.next==null)&&(j.parent!=null&&j.parent.removeChild(y),y.insertBefore(j,N||void 0))})},p}(l.default);function f(d){var p=c.find(d);if(p==null)try{p=c.create(d)}catch{p=c.create(c.Scope.INLINE),[].slice.call(d.childNodes).forEach(function(x){p.domNode.appendChild(x)}),d.parentNode&&d.parentNode.replaceChild(p.domNode,d),p.attach()}return p}n.default=u},function(r,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,m){p.__proto__=m}||function(p,m){for(var x in m)m.hasOwnProperty(x)&&(p[x]=m[x])};return function(p,m){d(p,m);function x(){this.constructor=p}p.prototype=m===null?Object.create(m):(x.prototype=m.prototype,new x)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),l=i(31),c=i(17),u=i(1),f=function(d){s(p,d);function p(m){var x=d.call(this,m)||this;return x.attributes=new l.default(x.domNode),x}return p.formats=function(m){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return m.tagName.toLowerCase()},p.prototype.format=function(m,x){var y=u.query(m);y instanceof o.default?this.attributes.attribute(y,x):x&&y!=null&&(m!==this.statics.blotName||this.formats()[m]!==x)&&this.replaceWith(m,x)},p.prototype.formats=function(){var m=this.attributes.values(),x=this.statics.formats(this.domNode);return x!=null&&(m[this.statics.blotName]=x),m},p.prototype.replaceWith=function(m,x){var y=d.prototype.replaceWith.call(this,m,x);return this.attributes.copy(y),y},p.prototype.update=function(m,x){var y=this;d.prototype.update.call(this,m,x),m.some(function(v){return v.target===y.domNode&&v.type==="attributes"})&&this.attributes.build()},p.prototype.wrap=function(m,x){var y=d.prototype.wrap.call(this,m,x);return y instanceof p&&y.statics.scope===this.statics.scope&&this.attributes.move(y),y},p}(c.default);n.default=f},function(r,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var p in d)d.hasOwnProperty(p)&&(f[p]=d[p])};return function(f,d){u(f,d);function p(){this.constructor=f}f.prototype=d===null?Object.create(d):(p.prototype=d.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),l=i(1),c=function(u){s(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.value=function(d){return!0},f.prototype.index=function(d,p){return this.domNode===d||this.domNode.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(p,1):-1},f.prototype.position=function(d,p){var m=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return d>0&&(m+=1),[this.parent.domNode,m]},f.prototype.value=function(){var d;return d={},d[this.statics.blotName]=this.statics.value(this.domNode)||!0,d},f.scope=l.Scope.INLINE_BLOT,f}(o.default);n.default=c},function(r,n,i){var s=i(11),o=i(3),l={attributes:{compose:function(u,f,d){typeof u!="object"&&(u={}),typeof f!="object"&&(f={});var p=o(!0,{},f);d||(p=Object.keys(p).reduce(function(x,y){return p[y]!=null&&(x[y]=p[y]),x},{}));for(var m in u)u[m]!==void 0&&f[m]===void 0&&(p[m]=u[m]);return Object.keys(p).length>0?p:void 0},diff:function(u,f){typeof u!="object"&&(u={}),typeof f!="object"&&(f={});var d=Object.keys(u).concat(Object.keys(f)).reduce(function(p,m){return s(u[m],f[m])||(p[m]=f[m]===void 0?null:f[m]),p},{});return Object.keys(d).length>0?d:void 0},transform:function(u,f,d){if(typeof u!="object")return f;if(typeof f=="object"){if(!d)return f;var p=Object.keys(f).reduce(function(m,x){return u[x]===void 0&&(m[x]=f[x]),m},{});return Object.keys(p).length>0?p:void 0}}},iterator:function(u){return new c(u)},length:function(u){return typeof u.delete=="number"?u.delete:typeof u.retain=="number"?u.retain:typeof u.insert=="string"?u.insert.length:1}};function c(u){this.ops=u,this.index=0,this.offset=0}c.prototype.hasNext=function(){return this.peekLength()<1/0},c.prototype.next=function(u){u||(u=1/0);var f=this.ops[this.index];if(f){var d=this.offset,p=l.length(f);if(u>=p-d?(u=p-d,this.index+=1,this.offset=0):this.offset+=u,typeof f.delete=="number")return{delete:u};var m={};return f.attributes&&(m.attributes=f.attributes),typeof f.retain=="number"?m.retain=u:typeof f.insert=="string"?m.insert=f.insert.substr(d,u):m.insert=f.insert,m}else return{retain:1/0}},c.prototype.peek=function(){return this.ops[this.index]},c.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},c.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},c.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var u=this.offset,f=this.index,d=this.next(),p=this.ops.slice(this.index);return this.offset=u,this.index=f,[d].concat(p)}else return[]},r.exports=l},function(r,n){var i=function(){function s(y,v){return v!=null&&y instanceof v}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var c;try{c=Promise}catch{c=function(){}}function u(y,v,b,w,N){typeof v=="object"&&(b=v.depth,w=v.prototype,N=v.includeNonEnumerable,v=v.circular);var j=[],k=[],_=typeof Buffer<"u";typeof v>"u"&&(v=!0),typeof b>"u"&&(b=1/0);function E(A,T){if(A===null)return null;if(T===0)return A;var M,P;if(typeof A!="object")return A;if(s(A,o))M=new o;else if(s(A,l))M=new l;else if(s(A,c))M=new c(function(V,D){A.then(function(U){V(E(U,T-1))},function(U){D(E(U,T-1))})});else if(u.__isArray(A))M=[];else if(u.__isRegExp(A))M=new RegExp(A.source,x(A)),A.lastIndex&&(M.lastIndex=A.lastIndex);else if(u.__isDate(A))M=new Date(A.getTime());else{if(_&&Buffer.isBuffer(A))return Buffer.allocUnsafe?M=Buffer.allocUnsafe(A.length):M=new Buffer(A.length),A.copy(M),M;s(A,Error)?M=Object.create(A):typeof w>"u"?(P=Object.getPrototypeOf(A),M=Object.create(P)):(M=Object.create(w),P=w)}if(v){var R=j.indexOf(A);if(R!=-1)return k[R];j.push(A),k.push(M)}s(A,o)&&A.forEach(function(V,D){var U=E(D,T-1),G=E(V,T-1);M.set(U,G)}),s(A,l)&&A.forEach(function(V){var D=E(V,T-1);M.add(D)});for(var L in A){var $;P&&($=Object.getOwnPropertyDescriptor(P,L)),!($&&$.set==null)&&(M[L]=E(A[L],T-1))}if(Object.getOwnPropertySymbols)for(var F=Object.getOwnPropertySymbols(A),L=0;L<F.length;L++){var z=F[L],W=Object.getOwnPropertyDescriptor(A,z);W&&!W.enumerable&&!N||(M[z]=E(A[z],T-1),W.enumerable||Object.defineProperty(M,z,{enumerable:!1}))}if(N)for(var K=Object.getOwnPropertyNames(A),L=0;L<K.length;L++){var q=K[L],W=Object.getOwnPropertyDescriptor(A,q);W&&W.enumerable||(M[q]=E(A[q],T-1),Object.defineProperty(M,q,{enumerable:!1}))}return M}return E(y,b)}u.clonePrototype=function(v){if(v===null)return null;var b=function(){};return b.prototype=v,new b};function f(y){return Object.prototype.toString.call(y)}u.__objToStr=f;function d(y){return typeof y=="object"&&f(y)==="[object Date]"}u.__isDate=d;function p(y){return typeof y=="object"&&f(y)==="[object Array]"}u.__isArray=p;function m(y){return typeof y=="object"&&f(y)==="[object RegExp]"}u.__isRegExp=m;function x(y){var v="";return y.global&&(v+="g"),y.ignoreCase&&(v+="i"),y.multiline&&(v+="m"),v}return u.__getRegExpFlags=x,u}();typeof r=="object"&&r.exports&&(r.exports=i)},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function M(P,R){var L=[],$=!0,F=!1,z=void 0;try{for(var W=P[Symbol.iterator](),K;!($=(K=W.next()).done)&&(L.push(K.value),!(R&&L.length===R));$=!0);}catch(q){F=!0,z=q}finally{try{!$&&W.return&&W.return()}finally{if(F)throw z}}return L}return function(P,R){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return M(P,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function M(P,R){for(var L=0;L<R.length;L++){var $=R[L];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(P,$.key,$)}}return function(P,R,L){return R&&M(P.prototype,R),L&&M(P,L),P}}(),l=function M(P,R,L){P===null&&(P=Function.prototype);var $=Object.getOwnPropertyDescriptor(P,R);if($===void 0){var F=Object.getPrototypeOf(P);return F===null?void 0:M(F,R,L)}else{if("value"in $)return $.value;var z=$.get;return z===void 0?void 0:z.call(L)}},c=i(0),u=j(c),f=i(8),d=j(f),p=i(4),m=j(p),x=i(16),y=j(x),v=i(13),b=j(v),w=i(25),N=j(w);function j(M){return M&&M.__esModule?M:{default:M}}function k(M,P){if(!(M instanceof P))throw new TypeError("Cannot call a class as a function")}function _(M,P){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:M}function E(M,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);M.prototype=Object.create(P&&P.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(M,P):M.__proto__=P)}function A(M){return M instanceof m.default||M instanceof p.BlockEmbed}var T=function(M){E(P,M);function P(R,L){k(this,P);var $=_(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,R));return $.emitter=L.emitter,Array.isArray(L.whitelist)&&($.whitelist=L.whitelist.reduce(function(F,z){return F[z]=!0,F},{})),$.domNode.addEventListener("DOMNodeInserted",function(){}),$.optimize(),$.enable(),$}return o(P,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(L,$){var F=this.line(L),z=s(F,2),W=z[0],K=z[1],q=this.line(L+$),V=s(q,1),D=V[0];if(l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"deleteAt",this).call(this,L,$),D!=null&&W!==D&&K>0){if(W instanceof p.BlockEmbed||D instanceof p.BlockEmbed){this.optimize();return}if(W instanceof b.default){var U=W.newlineIndex(W.length(),!0);if(U>-1&&(W=W.split(U+1),W===D)){this.optimize();return}}else if(D instanceof b.default){var G=D.newlineIndex(0);G>-1&&D.split(G+1)}var ee=D.children.head instanceof y.default?null:D.children.head;W.moveChildren(D,ee),W.remove()}this.optimize()}},{key:"enable",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",L)}},{key:"formatAt",value:function(L,$,F,z){this.whitelist!=null&&!this.whitelist[F]||(l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"formatAt",this).call(this,L,$,F,z),this.optimize())}},{key:"insertAt",value:function(L,$,F){if(!(F!=null&&this.whitelist!=null&&!this.whitelist[$])){if(L>=this.length())if(F==null||u.default.query($,u.default.Scope.BLOCK)==null){var z=u.default.create(this.statics.defaultChild);this.appendChild(z),F==null&&$.endsWith(`
`):j.attributes!=null?Object.keys(j.attributes).some(function(k){return l.default.query(k,l.default.Scope.BLOCK)!=null}):!1}function w(N){var j=N.reduce(function(_,E){return _+=E.delete||0,_},0),k=N.length()-j;return b(N)&&(k-=1),k}n.default=v,n.getLastChangeIndex=w},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function U(G,ee){for(var Q=0;Q<ee.length;Q++){var H=ee[Q];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(G,H.key,H)}}return function(G,ee,Q){return ee&&U(G.prototype,ee),Q&&U(G,Q),G}}(),o=function U(G,ee,Q){G===null&&(G=Function.prototype);var H=Object.getOwnPropertyDescriptor(G,ee);if(H===void 0){var Y=Object.getPrototypeOf(G);return Y===null?void 0:U(Y,ee,Q)}else{if("value"in H)return H.value;var re=H.get;return re===void 0?void 0:re.call(Q)}},l=i(3),c=T(l),u=i(2),f=T(u),d=i(8),p=T(d),m=i(23),x=T(m),y=i(34),v=T(y),b=i(59),w=T(b),N=i(60),j=T(N),k=i(28),_=T(k),E=i(61),A=T(E);function T(U){return U&&U.__esModule?U:{default:U}}function M(U,G){if(!(U instanceof G))throw new TypeError("Cannot call a class as a function")}function P(U,G){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return G&&(typeof G=="object"||typeof G=="function")?G:U}function R(U,G){if(typeof G!="function"&&G!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof G);U.prototype=Object.create(G&&G.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),G&&(Object.setPrototypeOf?Object.setPrototypeOf(U,G):U.__proto__=G)}var L=[!1,"center","right","justify"],$=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],F=[!1,"serif","monospace"],z=["1","2","3",!1],W=["small",!1,"large","huge"],K=function(U){R(G,U);function G(ee,Q){M(this,G);var H=P(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,ee,Q)),Y=function re(J){if(!document.body.contains(ee.root))return document.body.removeEventListener("click",re);H.tooltip!=null&&!H.tooltip.root.contains(J.target)&&document.activeElement!==H.tooltip.textbox&&!H.quill.hasFocus()&&H.tooltip.hide(),H.pickers!=null&&H.pickers.forEach(function(ne){ne.container.contains(J.target)||ne.close()})};return ee.emitter.listenDOM("click",document.body,Y),H}return s(G,[{key:"addModule",value:function(Q){var H=o(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"addModule",this).call(this,Q);return Q==="toolbar"&&this.extendToolbar(H),H}},{key:"buildButtons",value:function(Q,H){Q.forEach(function(Y){var re=Y.getAttribute("class")||"";re.split(/\s+/).forEach(function(J){if(J.startsWith("ql-")&&(J=J.slice(3),H[J]!=null))if(J==="direction")Y.innerHTML=H[J][""]+H[J].rtl;else if(typeof H[J]=="string")Y.innerHTML=H[J];else{var ne=Y.value||"";ne!=null&&H[J][ne]&&(Y.innerHTML=H[J][ne])}})})}},{key:"buildPickers",value:function(Q,H){var Y=this;this.pickers=Q.map(function(J){if(J.classList.contains("ql-align"))return J.querySelector("option")==null&&D(J,L),new j.default(J,H.align);if(J.classList.contains("ql-background")||J.classList.contains("ql-color")){var ne=J.classList.contains("ql-background")?"background":"color";return J.querySelector("option")==null&&D(J,$,ne==="background"?"#ffffff":"#000000"),new w.default(J,H[ne])}else return J.querySelector("option")==null&&(J.classList.contains("ql-font")?D(J,F):J.classList.contains("ql-header")?D(J,z):J.classList.contains("ql-size")&&D(J,W)),new _.default(J)});var re=function(){Y.pickers.forEach(function(ne){ne.update()})};this.quill.on(p.default.events.EDITOR_CHANGE,re)}}]),G}(v.default);K.DEFAULTS=(0,c.default)(!0,{},v.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var G=this,ee=this.container.querySelector("input.ql-image[type=file]");ee==null&&(ee=document.createElement("input"),ee.setAttribute("type","file"),ee.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),ee.classList.add("ql-image"),ee.addEventListener("change",function(){if(ee.files!=null&&ee.files[0]!=null){var Q=new FileReader;Q.onload=function(H){var Y=G.quill.getSelection(!0);G.quill.updateContents(new f.default().retain(Y.index).delete(Y.length).insert({image:H.target.result}),p.default.sources.USER),G.quill.setSelection(Y.index+1,p.default.sources.SILENT),ee.value=""},Q.readAsDataURL(ee.files[0])}}),this.container.appendChild(ee)),ee.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var q=function(U){R(G,U);function G(ee,Q){M(this,G);var H=P(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,ee,Q));return H.textbox=H.root.querySelector('input[type="text"]'),H.listen(),H}return s(G,[{key:"listen",value:function(){var Q=this;this.textbox.addEventListener("keydown",function(H){x.default.match(H,"enter")?(Q.save(),H.preventDefault()):x.default.match(H,"escape")&&(Q.cancel(),H.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),H!=null?this.textbox.value=H:Q!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+Q)||""),this.root.setAttribute("data-mode",Q)}},{key:"restoreFocus",value:function(){var Q=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=Q}},{key:"save",value:function(){var Q=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var H=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",Q,p.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",Q,p.default.sources.USER)),this.quill.root.scrollTop=H;break}case"video":Q=V(Q);case"formula":{if(!Q)break;var Y=this.quill.getSelection(!0);if(Y!=null){var re=Y.index+Y.length;this.quill.insertEmbed(re,this.root.getAttribute("data-mode"),Q,p.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(re+1," ",p.default.sources.USER),this.quill.setSelection(re+2,p.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),G}(A.default);function V(U){var G=U.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||U.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return G?(G[1]||"https")+"://www.youtube.com/embed/"+G[2]+"?showinfo=0":(G=U.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(G[1]||"https")+"://player.vimeo.com/video/"+G[2]+"/":U}function D(U,G){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;G.forEach(function(Q){var H=document.createElement("option");Q===ee?H.setAttribute("selected","selected"):H.setAttribute("value",Q),U.appendChild(H)})}n.BaseTooltip=q,n.default=K},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var c,u=this.iterator();c=u();)if(c===l)return!0;return!1},o.prototype.insertBefore=function(l,c){l&&(l.next=c,c!=null?(l.prev=c.prev,c.prev!=null&&(c.prev.next=l),c.prev=l,c===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var c=0,u=this.head;u!=null;){if(u===l)return c;c+=u.length(),u=u.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var c=l;return l!=null&&(l=l.next),c}},o.prototype.find=function(l,c){c===void 0&&(c=!1);for(var u,f=this.iterator();u=f();){var d=u.length();if(l<d||c&&l===d&&(u.next==null||u.next.length()!==0))return[u,l];l-=d}return[null,0]},o.prototype.forEach=function(l){for(var c,u=this.iterator();c=u();)l(c)},o.prototype.forEachAt=function(l,c,u){if(!(c<=0))for(var f=this.find(l),d=f[0],p=f[1],m,x=l-p,y=this.iterator(d);(m=y())&&x<l+c;){var v=m.length();l>x?u(m,l-x,Math.min(c,x+v-l)):u(m,0,Math.min(v,l+c-x)),x+=v}},o.prototype.map=function(l){return this.reduce(function(c,u){return c.push(l(u)),c},[])},o.prototype.reduce=function(l,c){for(var u,f=this.iterator();u=f();)c=l(c,u);return c},o}();n.default=s},function(r,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,m){p.__proto__=m}||function(p,m){for(var x in m)m.hasOwnProperty(x)&&(p[x]=m[x])};return function(p,m){d(p,m);function x(){this.constructor=p}p.prototype=m===null?Object.create(m):(x.prototype=m.prototype,new x)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),l=i(1),c={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},u=100,f=function(d){s(p,d);function p(m){var x=d.call(this,m)||this;return x.scroll=x,x.observer=new MutationObserver(function(y){x.update(y)}),x.observer.observe(x.domNode,c),x.attach(),x}return p.prototype.detach=function(){d.prototype.detach.call(this),this.observer.disconnect()},p.prototype.deleteAt=function(m,x){this.update(),m===0&&x===this.length()?this.children.forEach(function(y){y.remove()}):d.prototype.deleteAt.call(this,m,x)},p.prototype.formatAt=function(m,x,y,v){this.update(),d.prototype.formatAt.call(this,m,x,y,v)},p.prototype.insertAt=function(m,x,y){this.update(),d.prototype.insertAt.call(this,m,x,y)},p.prototype.optimize=function(m,x){var y=this;m===void 0&&(m=[]),x===void 0&&(x={}),d.prototype.optimize.call(this,x);for(var v=[].slice.call(this.observer.takeRecords());v.length>0;)m.push(v.pop());for(var b=function(k,_){_===void 0&&(_=!0),!(k==null||k===y)&&k.domNode.parentNode!=null&&(k.domNode[l.DATA_KEY].mutations==null&&(k.domNode[l.DATA_KEY].mutations=[]),_&&b(k.parent))},w=function(k){k.domNode[l.DATA_KEY]==null||k.domNode[l.DATA_KEY].mutations==null||(k instanceof o.default&&k.children.forEach(w),k.optimize(x))},N=m,j=0;N.length>0;j+=1){if(j>=u)throw new Error("[Parchment] Maximum optimize iterations reached");for(N.forEach(function(k){var _=l.find(k.target,!0);_!=null&&(_.domNode===k.target&&(k.type==="childList"?(b(l.find(k.previousSibling,!1)),[].forEach.call(k.addedNodes,function(E){var A=l.find(E,!1);b(A,!1),A instanceof o.default&&A.children.forEach(function(T){b(T,!1)})})):k.type==="attributes"&&b(_.prev)),b(_))}),this.children.forEach(w),N=[].slice.call(this.observer.takeRecords()),v=N.slice();v.length>0;)m.push(v.pop())}},p.prototype.update=function(m,x){var y=this;x===void 0&&(x={}),m=m||this.observer.takeRecords(),m.map(function(v){var b=l.find(v.target,!0);return b==null?null:b.domNode[l.DATA_KEY].mutations==null?(b.domNode[l.DATA_KEY].mutations=[v],b):(b.domNode[l.DATA_KEY].mutations.push(v),null)}).forEach(function(v){v==null||v===y||v.domNode[l.DATA_KEY]==null||v.update(v.domNode[l.DATA_KEY].mutations||[],x)}),this.domNode[l.DATA_KEY].mutations!=null&&d.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,x),this.optimize(m,x)},p.blotName="scroll",p.defaultChild="block",p.scope=l.Scope.BLOCK_BLOT,p.tagName="DIV",p}(o.default);n.default=f},function(r,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,p){d.__proto__=p}||function(d,p){for(var m in p)p.hasOwnProperty(m)&&(d[m]=p[m])};return function(d,p){f(d,p);function m(){this.constructor=d}d.prototype=p===null?Object.create(p):(m.prototype=p.prototype,new m)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1);function c(f,d){if(Object.keys(f).length!==Object.keys(d).length)return!1;for(var p in f)if(f[p]!==d[p])return!1;return!0}var u=function(f){s(d,f);function d(){return f!==null&&f.apply(this,arguments)||this}return d.formats=function(p){if(p.tagName!==d.tagName)return f.formats.call(this,p)},d.prototype.format=function(p,m){var x=this;p===this.statics.blotName&&!m?(this.children.forEach(function(y){y instanceof o.default||(y=y.wrap(d.blotName,!0)),x.attributes.copy(y)}),this.unwrap()):f.prototype.format.call(this,p,m)},d.prototype.formatAt=function(p,m,x,y){if(this.formats()[x]!=null||l.query(x,l.Scope.ATTRIBUTE)){var v=this.isolate(p,m);v.format(x,y)}else f.prototype.formatAt.call(this,p,m,x,y)},d.prototype.optimize=function(p){f.prototype.optimize.call(this,p);var m=this.formats();if(Object.keys(m).length===0)return this.unwrap();var x=this.next;x instanceof d&&x.prev===this&&c(m,x.formats())&&(x.moveChildren(this),x.remove())},d.blotName="inline",d.scope=l.Scope.INLINE_BLOT,d.tagName="SPAN",d}(o.default);n.default=u},function(r,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var p in d)d.hasOwnProperty(p)&&(f[p]=d[p])};return function(f,d){u(f,d);function p(){this.constructor=f}f.prototype=d===null?Object.create(d):(p.prototype=d.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1),c=function(u){s(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.formats=function(d){var p=l.query(f.blotName).tagName;if(d.tagName!==p)return u.formats.call(this,d)},f.prototype.format=function(d,p){l.query(d,l.Scope.BLOCK)!=null&&(d===this.statics.blotName&&!p?this.replaceWith(f.blotName):u.prototype.format.call(this,d,p))},f.prototype.formatAt=function(d,p,m,x){l.query(m,l.Scope.BLOCK)!=null?this.format(m,x):u.prototype.formatAt.call(this,d,p,m,x)},f.prototype.insertAt=function(d,p,m){if(m==null||l.query(p,l.Scope.INLINE)!=null)u.prototype.insertAt.call(this,d,p,m);else{var x=this.split(d),y=l.create(p,m);x.parent.insertBefore(y,x)}},f.prototype.update=function(d,p){navigator.userAgent.match(/Trident/)?this.build():u.prototype.update.call(this,d,p)},f.blotName="block",f.scope=l.Scope.BLOCK_BLOT,f.tagName="P",f}(o.default);n.default=c},function(r,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var d in f)f.hasOwnProperty(d)&&(u[d]=f[d])};return function(u,f){c(u,f);function d(){this.constructor=u}u.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=function(c){s(u,c);function u(){return c!==null&&c.apply(this,arguments)||this}return u.formats=function(f){},u.prototype.format=function(f,d){c.prototype.formatAt.call(this,0,this.length(),f,d)},u.prototype.formatAt=function(f,d,p,m){f===0&&d===this.length()?this.format(p,m):c.prototype.formatAt.call(this,f,d,p,m)},u.prototype.formats=function(){return this.statics.formats(this.domNode)},u}(o.default);n.default=l},function(r,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var p in d)d.hasOwnProperty(p)&&(f[p]=d[p])};return function(f,d){u(f,d);function p(){this.constructor=f}f.prototype=d===null?Object.create(d):(p.prototype=d.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=i(1),c=function(u){s(f,u);function f(d){var p=u.call(this,d)||this;return p.text=p.statics.value(p.domNode),p}return f.create=function(d){return document.createTextNode(d)},f.value=function(d){var p=d.data;return p.normalize&&(p=p.normalize()),p},f.prototype.deleteAt=function(d,p){this.domNode.data=this.text=this.text.slice(0,d)+this.text.slice(d+p)},f.prototype.index=function(d,p){return this.domNode===d?p:-1},f.prototype.insertAt=function(d,p,m){m==null?(this.text=this.text.slice(0,d)+p+this.text.slice(d),this.domNode.data=this.text):u.prototype.insertAt.call(this,d,p,m)},f.prototype.length=function(){return this.text.length},f.prototype.optimize=function(d){u.prototype.optimize.call(this,d),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof f&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},f.prototype.position=function(d,p){return[this.domNode,d]},f.prototype.split=function(d,p){if(p===void 0&&(p=!1),!p){if(d===0)return this;if(d===this.length())return this.next}var m=l.create(this.domNode.splitText(d));return this.parent.insertBefore(m,this.next),this.text=this.statics.value(this.domNode),m},f.prototype.update=function(d,p){var m=this;d.some(function(x){return x.type==="characterData"&&x.target===m.domNode})&&(this.text=this.statics.value(this.domNode))},f.prototype.value=function(){return this.text},f.blotName="text",f.scope=l.Scope.INLINE_BLOT,f}(o.default);n.default=c},function(r,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,c){return arguments.length>1&&!this.contains(l)==!c?c:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,c){return c=c||0,this.substr(c,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,c){var u=this.toString();(typeof c!="number"||!isFinite(c)||Math.floor(c)!==c||c>u.length)&&(c=u.length),c-=l.length;var f=u.indexOf(l,c);return f!==-1&&f===c}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(c){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof c!="function")throw new TypeError("predicate must be a function");for(var u=Object(this),f=u.length>>>0,d=arguments[1],p,m=0;m<f;m++)if(p=u[m],c.call(d,p,m,u))return p}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(r,n){var i=-1,s=1,o=0;function l(j,k,_){if(j==k)return j?[[o,j]]:[];(_<0||j.length<_)&&(_=null);var E=d(j,k),A=j.substring(0,E);j=j.substring(E),k=k.substring(E),E=p(j,k);var T=j.substring(j.length-E);j=j.substring(0,j.length-E),k=k.substring(0,k.length-E);var M=c(j,k);return A&&M.unshift([o,A]),T&&M.push([o,T]),x(M),_!=null&&(M=b(M,_)),M=w(M),M}function c(j,k){var _;if(!j)return[[s,k]];if(!k)return[[i,j]];var E=j.length>k.length?j:k,A=j.length>k.length?k:j,T=E.indexOf(A);if(T!=-1)return _=[[s,E.substring(0,T)],[o,A],[s,E.substring(T+A.length)]],j.length>k.length&&(_[0][0]=_[2][0]=i),_;if(A.length==1)return[[i,j],[s,k]];var M=m(j,k);if(M){var P=M[0],R=M[1],L=M[2],$=M[3],F=M[4],z=l(P,L),W=l(R,$);return z.concat([[o,F]],W)}return u(j,k)}function u(j,k){for(var _=j.length,E=k.length,A=Math.ceil((_+E)/2),T=A,M=2*A,P=new Array(M),R=new Array(M),L=0;L<M;L++)P[L]=-1,R[L]=-1;P[T+1]=0,R[T+1]=0;for(var $=_-E,F=$%2!=0,z=0,W=0,K=0,q=0,V=0;V<A;V++){for(var D=-V+z;D<=V-W;D+=2){var U=T+D,G;D==-V||D!=V&&P[U-1]<P[U+1]?G=P[U+1]:G=P[U-1]+1;for(var ee=G-D;G<_&&ee<E&&j.charAt(G)==k.charAt(ee);)G++,ee++;if(P[U]=G,G>_)W+=2;else if(ee>E)z+=2;else if(F){var Q=T+$-D;if(Q>=0&&Q<M&&R[Q]!=-1){var H=_-R[Q];if(G>=H)return f(j,k,G,ee)}}}for(var Y=-V+K;Y<=V-q;Y+=2){var Q=T+Y,H;Y==-V||Y!=V&&R[Q-1]<R[Q+1]?H=R[Q+1]:H=R[Q-1]+1;for(var re=H-Y;H<_&&re<E&&j.charAt(_-H-1)==k.charAt(E-re-1);)H++,re++;if(R[Q]=H,H>_)q+=2;else if(re>E)K+=2;else if(!F){var U=T+$-Y;if(U>=0&&U<M&&P[U]!=-1){var G=P[U],ee=T+G-U;if(H=_-H,G>=H)return f(j,k,G,ee)}}}}return[[i,j],[s,k]]}function f(j,k,_,E){var A=j.substring(0,_),T=k.substring(0,E),M=j.substring(_),P=k.substring(E),R=l(A,T),L=l(M,P);return R.concat(L)}function d(j,k){if(!j||!k||j.charAt(0)!=k.charAt(0))return 0;for(var _=0,E=Math.min(j.length,k.length),A=E,T=0;_<A;)j.substring(T,A)==k.substring(T,A)?(_=A,T=_):E=A,A=Math.floor((E-_)/2+_);return A}function p(j,k){if(!j||!k||j.charAt(j.length-1)!=k.charAt(k.length-1))return 0;for(var _=0,E=Math.min(j.length,k.length),A=E,T=0;_<A;)j.substring(j.length-A,j.length-T)==k.substring(k.length-A,k.length-T)?(_=A,T=_):E=A,A=Math.floor((E-_)/2+_);return A}function m(j,k){var _=j.length>k.length?j:k,E=j.length>k.length?k:j;if(_.length<4||E.length*2<_.length)return null;function A(W,K,q){for(var V=W.substring(q,q+Math.floor(W.length/4)),D=-1,U="",G,ee,Q,H;(D=K.indexOf(V,D+1))!=-1;){var Y=d(W.substring(q),K.substring(D)),re=p(W.substring(0,q),K.substring(0,D));U.length<re+Y&&(U=K.substring(D-re,D)+K.substring(D,D+Y),G=W.substring(0,q-re),ee=W.substring(q+Y),Q=K.substring(0,D-re),H=K.substring(D+Y))}return U.length*2>=W.length?[G,ee,Q,H,U]:null}var T=A(_,E,Math.ceil(_.length/4)),M=A(_,E,Math.ceil(_.length/2)),P;if(!T&&!M)return null;M?T?P=T[4].length>M[4].length?T:M:P=M:P=T;var R,L,$,F;j.length>k.length?(R=P[0],L=P[1],$=P[2],F=P[3]):($=P[0],F=P[1],R=P[2],L=P[3]);var z=P[4];return[R,L,$,F,z]}function x(j){j.push([o,""]);for(var k=0,_=0,E=0,A="",T="",M;k<j.length;)switch(j[k][0]){case s:E++,T+=j[k][1],k++;break;case i:_++,A+=j[k][1],k++;break;case o:_+E>1?(_!==0&&E!==0&&(M=d(T,A),M!==0&&(k-_-E>0&&j[k-_-E-1][0]==o?j[k-_-E-1][1]+=T.substring(0,M):(j.splice(0,0,[o,T.substring(0,M)]),k++),T=T.substring(M),A=A.substring(M)),M=p(T,A),M!==0&&(j[k][1]=T.substring(T.length-M)+j[k][1],T=T.substring(0,T.length-M),A=A.substring(0,A.length-M))),_===0?j.splice(k-E,_+E,[s,T]):E===0?j.splice(k-_,_+E,[i,A]):j.splice(k-_-E,_+E,[i,A],[s,T]),k=k-_-E+(_?1:0)+(E?1:0)+1):k!==0&&j[k-1][0]==o?(j[k-1][1]+=j[k][1],j.splice(k,1)):k++,E=0,_=0,A="",T="";break}j[j.length-1][1]===""&&j.pop();var P=!1;for(k=1;k<j.length-1;)j[k-1][0]==o&&j[k+1][0]==o&&(j[k][1].substring(j[k][1].length-j[k-1][1].length)==j[k-1][1]?(j[k][1]=j[k-1][1]+j[k][1].substring(0,j[k][1].length-j[k-1][1].length),j[k+1][1]=j[k-1][1]+j[k+1][1],j.splice(k-1,1),P=!0):j[k][1].substring(0,j[k+1][1].length)==j[k+1][1]&&(j[k-1][1]+=j[k+1][1],j[k][1]=j[k][1].substring(j[k+1][1].length)+j[k+1][1],j.splice(k+1,1),P=!0)),k++;P&&x(j)}var y=l;y.INSERT=s,y.DELETE=i,y.EQUAL=o,r.exports=y;function v(j,k){if(k===0)return[o,j];for(var _=0,E=0;E<j.length;E++){var A=j[E];if(A[0]===i||A[0]===o){var T=_+A[1].length;if(k===T)return[E+1,j];if(k<T){j=j.slice();var M=k-_,P=[A[0],A[1].slice(0,M)],R=[A[0],A[1].slice(M)];return j.splice(E,1,P,R),[E+1,j]}else _=T}}throw new Error("cursor_pos is out of bounds!")}function b(j,k){var _=v(j,k),E=_[1],A=_[0],T=E[A],M=E[A+1];if(T==null)return j;if(T[0]!==o)return j;if(M!=null&&T[1]+M[1]===M[1]+T[1])return E.splice(A,2,M,T),N(E,A,2);if(M!=null&&M[1].indexOf(T[1])===0){E.splice(A,2,[M[0],T[1]],[0,T[1]]);var P=M[1].slice(T[1].length);return P.length>0&&E.splice(A+2,0,[M[0],P]),N(E,A,3)}else return j}function w(j){for(var k=!1,_=function(M){return M.charCodeAt(0)>=56320&&M.charCodeAt(0)<=57343},E=function(M){return M.charCodeAt(M.length-1)>=55296&&M.charCodeAt(M.length-1)<=56319},A=2;A<j.length;A+=1)j[A-2][0]===o&&E(j[A-2][1])&&j[A-1][0]===i&&_(j[A-1][1])&&j[A][0]===s&&_(j[A][1])&&(k=!0,j[A-1][1]=j[A-2][1].slice(-1)+j[A-1][1],j[A][1]=j[A-2][1].slice(-1)+j[A][1],j[A-2][1]=j[A-2][1].slice(0,-1));if(!k)return j;for(var T=[],A=0;A<j.length;A+=1)j[A][1].length>0&&T.push(j[A]);return T}function N(j,k,_){for(var E=k+_-1;E>=0&&E>=k-1;E--)if(E+1<j.length){var A=j[E],T=j[E+1];A[0]===T[1]&&j.splice(E,2,[A[0],A[1]+T[1]])}return j}},function(r,n){n=r.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var l in s)o.push(l);return o}},function(r,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=r.exports=i?s:o,n.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(r,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(u,f,d){this.fn=u,this.context=f,this.once=d||!1}function c(){this._events=new o,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],d,p;if(this._eventsCount===0)return f;for(p in d=this._events)i.call(d,p)&&f.push(s?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},c.prototype.listeners=function(f,d){var p=s?s+f:f,m=this._events[p];if(d)return!!m;if(!m)return[];if(m.fn)return[m.fn];for(var x=0,y=m.length,v=new Array(y);x<y;x++)v[x]=m[x].fn;return v},c.prototype.emit=function(f,d,p,m,x,y){var v=s?s+f:f;if(!this._events[v])return!1;var b=this._events[v],w=arguments.length,N,j;if(b.fn){switch(b.once&&this.removeListener(f,b.fn,void 0,!0),w){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,d),!0;case 3:return b.fn.call(b.context,d,p),!0;case 4:return b.fn.call(b.context,d,p,m),!0;case 5:return b.fn.call(b.context,d,p,m,x),!0;case 6:return b.fn.call(b.context,d,p,m,x,y),!0}for(j=1,N=new Array(w-1);j<w;j++)N[j-1]=arguments[j];b.fn.apply(b.context,N)}else{var k=b.length,_;for(j=0;j<k;j++)switch(b[j].once&&this.removeListener(f,b[j].fn,void 0,!0),w){case 1:b[j].fn.call(b[j].context);break;case 2:b[j].fn.call(b[j].context,d);break;case 3:b[j].fn.call(b[j].context,d,p);break;case 4:b[j].fn.call(b[j].context,d,p,m);break;default:if(!N)for(_=1,N=new Array(w-1);_<w;_++)N[_-1]=arguments[_];b[j].fn.apply(b[j].context,N)}}return!0},c.prototype.on=function(f,d,p){var m=new l(d,p||this),x=s?s+f:f;return this._events[x]?this._events[x].fn?this._events[x]=[this._events[x],m]:this._events[x].push(m):(this._events[x]=m,this._eventsCount++),this},c.prototype.once=function(f,d,p){var m=new l(d,p||this,!0),x=s?s+f:f;return this._events[x]?this._events[x].fn?this._events[x]=[this._events[x],m]:this._events[x].push(m):(this._events[x]=m,this._eventsCount++),this},c.prototype.removeListener=function(f,d,p,m){var x=s?s+f:f;if(!this._events[x])return this;if(!d)return--this._eventsCount===0?this._events=new o:delete this._events[x],this;var y=this._events[x];if(y.fn)y.fn===d&&(!m||y.once)&&(!p||y.context===p)&&(--this._eventsCount===0?this._events=new o:delete this._events[x]);else{for(var v=0,b=[],w=y.length;v<w;v++)(y[v].fn!==d||m&&!y[v].once||p&&y[v].context!==p)&&b.push(y[v]);b.length?this._events[x]=b.length===1?b[0]:b:--this._eventsCount===0?this._events=new o:delete this._events[x]}return this},c.prototype.removeAllListeners=function(f){var d;return f?(d=s?s+f:f,this._events[d]&&(--this._eventsCount===0?this._events=new o:delete this._events[d])):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=s,c.EventEmitter=c,typeof r<"u"&&(r.exports=c)},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},o=function(){function ue(he,we){var Oe=[],be=!0,We=!1,Je=void 0;try{for(var Ye=he[Symbol.iterator](),Ae;!(be=(Ae=Ye.next()).done)&&(Oe.push(Ae.value),!(we&&Oe.length===we));be=!0);}catch(Me){We=!0,Je=Me}finally{try{!be&&Ye.return&&Ye.return()}finally{if(We)throw Je}}return Oe}return function(he,we){if(Array.isArray(he))return he;if(Symbol.iterator in Object(he))return ue(he,we);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function ue(he,we){for(var Oe=0;Oe<we.length;Oe++){var be=we[Oe];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(he,be.key,be)}}return function(he,we,Oe){return we&&ue(he.prototype,we),Oe&&ue(he,Oe),he}}(),c=i(3),u=R(c),f=i(2),d=R(f),p=i(0),m=R(p),x=i(5),y=R(x),v=i(10),b=R(v),w=i(9),N=R(w),j=i(36),k=i(37),_=i(13),E=R(_),A=i(26),T=i(38),M=i(39),P=i(40);function R(ue){return ue&&ue.__esModule?ue:{default:ue}}function L(ue,he,we){return he in ue?Object.defineProperty(ue,he,{value:we,enumerable:!0,configurable:!0,writable:!0}):ue[he]=we,ue}function $(ue,he){if(!(ue instanceof he))throw new TypeError("Cannot call a class as a function")}function F(ue,he){if(!ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return he&&(typeof he=="object"||typeof he=="function")?he:ue}function z(ue,he){if(typeof he!="function"&&he!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof he);ue.prototype=Object.create(he&&he.prototype,{constructor:{value:ue,enumerable:!1,writable:!0,configurable:!0}}),he&&(Object.setPrototypeOf?Object.setPrototypeOf(ue,he):ue.__proto__=he)}var W=(0,b.default)("quill:clipboard"),K="__ql-matcher",q=[[Node.TEXT_NODE,Le],[Node.TEXT_NODE,ie],["br",te],[Node.ELEMENT_NODE,ie],[Node.ELEMENT_NODE,ne],[Node.ELEMENT_NODE,ye],[Node.ELEMENT_NODE,J],[Node.ELEMENT_NODE,Te],["li",ve],["b",re.bind(re,"bold")],["i",re.bind(re,"italic")],["style",se]],V=[j.AlignAttribute,T.DirectionAttribute].reduce(function(ue,he){return ue[he.keyName]=he,ue},{}),D=[j.AlignStyle,k.BackgroundStyle,A.ColorStyle,T.DirectionStyle,M.FontStyle,P.SizeStyle].reduce(function(ue,he){return ue[he.keyName]=he,ue},{}),U=function(ue){z(he,ue);function he(we,Oe){$(this,he);var be=F(this,(he.__proto__||Object.getPrototypeOf(he)).call(this,we,Oe));return be.quill.root.addEventListener("paste",be.onPaste.bind(be)),be.container=be.quill.addContainer("ql-clipboard"),be.container.setAttribute("contenteditable",!0),be.container.setAttribute("tabindex",-1),be.matchers=[],q.concat(be.options.matchers).forEach(function(We){var Je=o(We,2),Ye=Je[0],Ae=Je[1];!Oe.matchVisual&&Ae===ye||be.addMatcher(Ye,Ae)}),be}return l(he,[{key:"addMatcher",value:function(Oe,be){this.matchers.push([Oe,be])}},{key:"convert",value:function(Oe){if(typeof Oe=="string")return this.container.innerHTML=Oe.replace(/\>\r?\n +\</g,"><"),this.convert();var be=this.quill.getFormat(this.quill.selection.savedRange.index);if(be[E.default.blotName]){var We=this.container.innerText;return this.container.innerHTML="",new d.default().insert(We,L({},E.default.blotName,be[E.default.blotName]))}var Je=this.prepareMatching(),Ye=o(Je,2),Ae=Ye[0],Me=Ye[1],Re=Y(this.container,Ae,Me);return Q(Re,`
`)&&Re.ops[Re.ops.length-1].attributes==null&&(Re=Re.compose(new d.default().retain(Re.length()-1).delete(1))),W.log("convert",this.container.innerHTML,Re),this.container.innerHTML="",Re}},{key:"dangerouslyPasteHTML",value:function(Oe,be){var We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y.default.sources.API;if(typeof Oe=="string")this.quill.setContents(this.convert(Oe),be),this.quill.setSelection(0,y.default.sources.SILENT);else{var Je=this.convert(be);this.quill.updateContents(new d.default().retain(Oe).concat(Je),We),this.quill.setSelection(Oe+Je.length(),y.default.sources.SILENT)}}},{key:"onPaste",value:function(Oe){var be=this;if(!(Oe.defaultPrevented||!this.quill.isEnabled())){var We=this.quill.getSelection(),Je=new d.default().retain(We.index),Ye=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(y.default.sources.SILENT),setTimeout(function(){Je=Je.concat(be.convert()).delete(We.length),be.quill.updateContents(Je,y.default.sources.USER),be.quill.setSelection(Je.length()-We.length,y.default.sources.SILENT),be.quill.scrollingContainer.scrollTop=Ye,be.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Oe=this,be=[],We=[];return this.matchers.forEach(function(Je){var Ye=o(Je,2),Ae=Ye[0],Me=Ye[1];switch(Ae){case Node.TEXT_NODE:We.push(Me);break;case Node.ELEMENT_NODE:be.push(Me);break;default:[].forEach.call(Oe.container.querySelectorAll(Ae),function(Re){Re[K]=Re[K]||[],Re[K].push(Me)});break}}),[be,We]}}]),he}(N.default);U.DEFAULTS={matchers:[],matchVisual:!0};function G(ue,he,we){return(typeof he>"u"?"undefined":s(he))==="object"?Object.keys(he).reduce(function(Oe,be){return G(Oe,be,he[be])},ue):ue.reduce(function(Oe,be){return be.attributes&&be.attributes[he]?Oe.push(be):Oe.insert(be.insert,(0,u.default)({},L({},he,we),be.attributes))},new d.default)}function ee(ue){if(ue.nodeType!==Node.ELEMENT_NODE)return{};var he="__ql-computed-style";return ue[he]||(ue[he]=window.getComputedStyle(ue))}function Q(ue,he){for(var we="",Oe=ue.ops.length-1;Oe>=0&&we.length<he.length;--Oe){var be=ue.ops[Oe];if(typeof be.insert!="string")break;we=be.insert+we}return we.slice(-1*he.length)===he}function H(ue){if(ue.childNodes.length===0)return!1;var he=ee(ue);return["block","list-item"].indexOf(he.display)>-1}function Y(ue,he,we){return ue.nodeType===ue.TEXT_NODE?we.reduce(function(Oe,be){return be(ue,Oe)},new d.default):ue.nodeType===ue.ELEMENT_NODE?[].reduce.call(ue.childNodes||[],function(Oe,be){var We=Y(be,he,we);return be.nodeType===ue.ELEMENT_NODE&&(We=he.reduce(function(Je,Ye){return Ye(be,Je)},We),We=(be[K]||[]).reduce(function(Je,Ye){return Ye(be,Je)},We)),Oe.concat(We)},new d.default):new d.default}function re(ue,he,we){return G(we,ue,!0)}function J(ue,he){var we=m.default.Attributor.Attribute.keys(ue),Oe=m.default.Attributor.Class.keys(ue),be=m.default.Attributor.Style.keys(ue),We={};return we.concat(Oe).concat(be).forEach(function(Je){var Ye=m.default.query(Je,m.default.Scope.ATTRIBUTE);Ye!=null&&(We[Ye.attrName]=Ye.value(ue),We[Ye.attrName])||(Ye=V[Je],Ye!=null&&(Ye.attrName===Je||Ye.keyName===Je)&&(We[Ye.attrName]=Ye.value(ue)||void 0),Ye=D[Je],Ye!=null&&(Ye.attrName===Je||Ye.keyName===Je)&&(Ye=D[Je],We[Ye.attrName]=Ye.value(ue)||void 0))}),Object.keys(We).length>0&&(he=G(he,We)),he}function ne(ue,he){var we=m.default.query(ue);if(we==null)return he;if(we.prototype instanceof m.default.Embed){var Oe={},be=we.value(ue);be!=null&&(Oe[we.blotName]=be,he=new d.default().insert(Oe,we.formats(ue)))}else typeof we.formats=="function"&&(he=G(he,we.blotName,we.formats(ue)));return he}function te(ue,he){return Q(he,`
`)}return he}function Te(ue,he){var we={},Oe=ue.style||{};return Oe.fontStyle&&ee(ue).fontStyle==="italic"&&(we.italic=!0),Oe.fontWeight&&(ee(ue).fontWeight.startsWith("bold")||parseInt(ee(ue).fontWeight)>=700)&&(we.bold=!0),Object.keys(we).length>0&&(he=G(he,we)),parseFloat(Oe.textIndent||0)>0&&(he=new d.default().insert("	").concat(he)),he}function Le(ue,he){var we=ue.data;if(ue.parentNode.tagName==="O:P")return he.insert(we.trim());if(we.trim().length===0&&ue.parentNode.classList.contains("ql-clipboard"))return he;if(!ee(ue.parentNode).whiteSpace.startsWith("pre")){var Oe=function(We,Je){return Je=Je.replace(/[^\u00a0]/g,""),Je.length<1&&We?" ":Je};we=we.replace(/\r\n/g," ").replace(/\n/g," "),we=we.replace(/\s\s+/g,Oe.bind(Oe,!0)),(ue.previousSibling==null&&H(ue.parentNode)||ue.previousSibling!=null&&H(ue.previousSibling))&&(we=we.replace(/^\s+/,Oe.bind(Oe,!1))),(ue.nextSibling==null&&H(ue.parentNode)||ue.nextSibling!=null&&H(ue.nextSibling))&&(we=we.replace(/\s+$/,Oe.bind(Oe,!1)))}return he.insert(we)}n.default=U,n.matchAttributor=J,n.matchBlot=ne,n.matchNewline=ie,n.matchSpacing=ye,n.matchText=Le},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(6),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(){return f(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"optimize",value:function(b){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,b),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),y}(c.default);m.blotName="bold",m.tagName=["STRONG","B"],n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function P(R,L){var $=[],F=!0,z=!1,W=void 0;try{for(var K=R[Symbol.iterator](),q;!(F=(q=K.next()).done)&&($.push(q.value),!(L&&$.length===L));F=!0);}catch(V){z=!0,W=V}finally{try{!F&&K.return&&K.return()}finally{if(z)throw W}}return $}return function(R,L){if(Array.isArray(R))return R;if(Symbol.iterator in Object(R))return P(R,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function P(R,L){for(var $=0;$<L.length;$++){var F=L[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(R,F.key,F)}}return function(R,L,$){return L&&P(R.prototype,L),$&&P(R,$),R}}(),l=i(2),c=b(l),u=i(0),f=b(u),d=i(5),p=b(d),m=i(10),x=b(m),y=i(9),v=b(y);function b(P){return P&&P.__esModule?P:{default:P}}function w(P,R,L){return R in P?Object.defineProperty(P,R,{value:L,enumerable:!0,configurable:!0,writable:!0}):P[R]=L,P}function N(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")}function j(P,R){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:P}function k(P,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);P.prototype=Object.create(R&&R.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(P,R):P.__proto__=R)}var _=(0,x.default)("quill:toolbar"),E=function(P){k(R,P);function R(L,$){N(this,R);var F=j(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,L,$));if(Array.isArray(F.options.container)){var z=document.createElement("div");T(z,F.options.container),L.container.parentNode.insertBefore(z,L.container),F.container=z}else typeof F.options.container=="string"?F.container=document.querySelector(F.options.container):F.container=F.options.container;if(!(F.container instanceof HTMLElement)){var W;return W=_.error("Container required for toolbar",F.options),j(F,W)}return F.container.classList.add("ql-toolbar"),F.controls=[],F.handlers={},Object.keys(F.options.handlers).forEach(function(K){F.addHandler(K,F.options.handlers[K])}),[].forEach.call(F.container.querySelectorAll("button, select"),function(K){F.attach(K)}),F.quill.on(p.default.events.EDITOR_CHANGE,function(K,q){K===p.default.events.SELECTION_CHANGE&&F.update(q)}),F.quill.on(p.default.events.SCROLL_OPTIMIZE,function(){var K=F.quill.selection.getRange(),q=s(K,1),V=q[0];F.update(V)}),F}return o(R,[{key:"addHandler",value:function($,F){this.handlers[$]=F}},{key:"attach",value:function($){var F=this,z=[].find.call($.classList,function(K){return K.indexOf("ql-")===0});if(z){if(z=z.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){_.warn("ignoring attaching to disabled format",z,$);return}if(f.default.query(z)==null){_.warn("ignoring attaching to nonexistent format",z,$);return}}var W=$.tagName==="SELECT"?"change":"click";$.addEventListener(W,function(K){var q=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var V=$.options[$.selectedIndex];V.hasAttribute("selected")?q=!1:q=V.value||!1}else $.classList.contains("ql-active")?q=!1:q=$.value||!$.hasAttribute("value"),K.preventDefault();F.quill.focus();var D=F.quill.selection.getRange(),U=s(D,1),G=U[0];if(F.handlers[z]!=null)F.handlers[z].call(F,q);else if(f.default.query(z).prototype instanceof f.default.Embed){if(q=prompt("Enter "+z),!q)return;F.quill.updateContents(new c.default().retain(G.index).delete(G.length).insert(w({},z,q)),p.default.sources.USER)}else F.quill.format(z,q,p.default.sources.USER);F.update(G)}),this.controls.push([z,$])}}},{key:"update",value:function($){var F=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(z){var W=s(z,2),K=W[0],q=W[1];if(q.tagName==="SELECT"){var V=void 0;if($==null)V=null;else if(F[K]==null)V=q.querySelector("option[selected]");else if(!Array.isArray(F[K])){var D=F[K];typeof D=="string"&&(D=D.replace(/\"/g,'\\"')),V=q.querySelector('option[value="'+D+'"]')}V==null?(q.value="",q.selectedIndex=-1):V.selected=!0}else if($==null)q.classList.remove("ql-active");else if(q.hasAttribute("value")){var U=F[K]===q.getAttribute("value")||F[K]!=null&&F[K].toString()===q.getAttribute("value")||F[K]==null&&!q.getAttribute("value");q.classList.toggle("ql-active",U)}else q.classList.toggle("ql-active",F[K]!=null)})}}]),R}(v.default);E.DEFAULTS={};function A(P,R,L){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+R),L!=null&&($.value=L),P.appendChild($)}function T(P,R){Array.isArray(R[0])||(R=[R]),R.forEach(function(L){var $=document.createElement("span");$.classList.add("ql-formats"),L.forEach(function(F){if(typeof F=="string")A($,F);else{var z=Object.keys(F)[0],W=F[z];Array.isArray(W)?M($,z,W):A($,z,W)}}),P.appendChild($)})}function M(P,R,L){var $=document.createElement("select");$.classList.add("ql-"+R),L.forEach(function(F){var z=document.createElement("option");F!==!1?z.setAttribute("value",F):z.setAttribute("selected","selected"),$.appendChild(z)}),P.appendChild($)}E.DEFAULTS={container:null,handlers:{clean:function(){var R=this,L=this.quill.getSelection();if(L!=null)if(L.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(F){f.default.query(F,f.default.Scope.INLINE)!=null&&R.quill.format(F,!1)})}else this.quill.removeFormat(L,p.default.sources.USER)},direction:function(R){var L=this.quill.getFormat().align;R==="rtl"&&L==null?this.quill.format("align","right",p.default.sources.USER):!R&&L==="right"&&this.quill.format("align",!1,p.default.sources.USER),this.quill.format("direction",R,p.default.sources.USER)},indent:function(R){var L=this.quill.getSelection(),$=this.quill.getFormat(L),F=parseInt($.indent||0);if(R==="+1"||R==="-1"){var z=R==="+1"?1:-1;$.direction==="rtl"&&(z*=-1),this.quill.format("indent",F+z,p.default.sources.USER)}},link:function(R){R===!0&&(R=prompt("Enter link URL:")),this.quill.format("link",R,p.default.sources.USER)},list:function(R){var L=this.quill.getSelection(),$=this.quill.getFormat(L);R==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,p.default.sources.USER):this.quill.format("list","unchecked",p.default.sources.USER):this.quill.format("list",R,p.default.sources.USER)}}},n.default=E,n.addControls=T},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(28),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(v,b){f(this,y);var w=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,v));return w.label.innerHTML=b,w.container.classList.add("ql-color-picker"),[].slice.call(w.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(N){N.classList.add("ql-primary")}),w}return s(y,[{key:"buildItem",value:function(b){var w=o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"buildItem",this).call(this,b);return w.style.backgroundColor=b.getAttribute("value")||"",w}},{key:"selectItem",value:function(b,w){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,b,w);var N=this.label.querySelector(".ql-color-label"),j=b&&b.getAttribute("data-value")||"";N&&(N.tagName==="line"?N.style.stroke=j:N.style.fill=j)}}]),y}(c.default);n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(28),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(v,b){f(this,y);var w=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,v));return w.container.classList.add("ql-icon-picker"),[].forEach.call(w.container.querySelectorAll(".ql-picker-item"),function(N){N.innerHTML=b[N.getAttribute("data-value")||""]}),w.defaultItem=w.container.querySelector(".ql-selected"),w.selectItem(w.defaultItem),w}return s(y,[{key:"selectItem",value:function(b,w){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,b,w),b=b||this.defaultItem,this.label.innerHTML=b.innerHTML}}]),y}(c.default);n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function c(u,f){for(var d=0;d<f.length;d++){var p=f[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}}();function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(u,f){var d=this;o(this,c),this.quill=u,this.boundsContainer=f||document.body,this.root=u.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){d.root.style.marginTop=-1*d.quill.root.scrollTop+"px"}),this.hide()}return s(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(f){var d=f.left+f.width/2-this.root.offsetWidth/2,p=f.bottom+this.quill.root.scrollTop;this.root.style.left=d+"px",this.root.style.top=p+"px",this.root.classList.remove("ql-flip");var m=this.boundsContainer.getBoundingClientRect(),x=this.root.getBoundingClientRect(),y=0;if(x.right>m.right&&(y=m.right-x.right,this.root.style.left=d+y+"px"),x.left<m.left&&(y=m.left-x.left,this.root.style.left=d+y+"px"),x.bottom>m.bottom){var v=x.bottom-x.top,b=f.bottom-f.top+v;this.root.style.top=p-b+"px",this.root.classList.add("ql-flip")}return y}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c}();n.default=l},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function M(P,R){var L=[],$=!0,F=!1,z=void 0;try{for(var W=P[Symbol.iterator](),K;!($=(K=W.next()).done)&&(L.push(K.value),!(R&&L.length===R));$=!0);}catch(q){F=!0,z=q}finally{try{!$&&W.return&&W.return()}finally{if(F)throw z}}return L}return function(P,R){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return M(P,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function M(P,R,L){P===null&&(P=Function.prototype);var $=Object.getOwnPropertyDescriptor(P,R);if($===void 0){var F=Object.getPrototypeOf(P);return F===null?void 0:M(F,R,L)}else{if("value"in $)return $.value;var z=$.get;return z===void 0?void 0:z.call(L)}},l=function(){function M(P,R){for(var L=0;L<R.length;L++){var $=R[L];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(P,$.key,$)}}return function(P,R,L){return R&&M(P.prototype,R),L&&M(P,L),P}}(),c=i(3),u=N(c),f=i(8),d=N(f),p=i(43),m=N(p),x=i(27),y=N(x),v=i(15),b=i(41),w=N(b);function N(M){return M&&M.__esModule?M:{default:M}}function j(M,P){if(!(M instanceof P))throw new TypeError("Cannot call a class as a function")}function k(M,P){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:M}function _(M,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);M.prototype=Object.create(P&&P.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(M,P):M.__proto__=P)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],A=function(M){_(P,M);function P(R,L){j(this,P),L.modules.toolbar!=null&&L.modules.toolbar.container==null&&(L.modules.toolbar.container=E);var $=k(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,R,L));return $.quill.container.classList.add("ql-snow"),$}return l(P,[{key:"extendToolbar",value:function(L){L.container.classList.add("ql-snow"),this.buildButtons([].slice.call(L.container.querySelectorAll("button")),w.default),this.buildPickers([].slice.call(L.container.querySelectorAll("select")),w.default),this.tooltip=new T(this.quill,this.options.bounds),L.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,F){L.handlers.link.call(L,!F.format.link)})}}]),P}(m.default);A.DEFAULTS=(0,u.default)(!0,{},m.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(P){if(P){var R=this.quill.getSelection();if(R==null||R.length==0)return;var L=this.quill.getText(R);/^\S+@\S+\.\S+$/.test(L)&&L.indexOf("mailto:")!==0&&(L="mailto:"+L);var $=this.quill.theme.tooltip;$.edit("link",L)}else this.quill.format("link",!1)}}}}});var T=function(M){_(P,M);function P(R,L){j(this,P);var $=k(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,R,L));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(P,[{key:"listen",value:function(){var L=this;o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){L.root.classList.contains("ql-editing")?L.save():L.edit("link",L.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(L.linkRange!=null){var F=L.linkRange;L.restoreFocus(),L.quill.formatText(F,"link",!1,d.default.sources.USER),delete L.linkRange}$.preventDefault(),L.hide()}),this.quill.on(d.default.events.SELECTION_CHANGE,function($,F,z){if($!=null){if($.length===0&&z===d.default.sources.USER){var W=L.quill.scroll.descendant(y.default,$.index),K=s(W,2),q=K[0],V=K[1];if(q!=null){L.linkRange=new v.Range($.index-V,q.length());var D=y.default.formats(q.domNode);L.preview.textContent=D,L.preview.setAttribute("href",D),L.show(),L.position(L.quill.getBounds(L.linkRange));return}}else delete L.linkRange;L.hide()}})}},{key:"show",value:function(){o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),P}(p.BaseTooltip);T.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=A},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=be(s),l=i(36),c=i(38),u=i(64),f=i(65),d=be(f),p=i(66),m=be(p),x=i(67),y=be(x),v=i(37),b=i(26),w=i(39),N=i(40),j=i(56),k=be(j),_=i(68),E=be(_),A=i(27),T=be(A),M=i(69),P=be(M),R=i(70),L=be(R),$=i(71),F=be($),z=i(72),W=be(z),K=i(73),q=be(K),V=i(13),D=be(V),U=i(74),G=be(U),ee=i(75),Q=be(ee),H=i(57),Y=be(H),re=i(41),J=be(re),ne=i(28),te=be(ne),se=i(59),ve=be(se),ie=i(60),ye=be(ie),Te=i(61),Le=be(Te),ue=i(108),he=be(ue),we=i(62),Oe=be(we);function be(We){return We&&We.__esModule?We:{default:We}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":v.BackgroundClass,"attributors/class/color":b.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":w.FontClass,"attributors/class/size":N.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":v.BackgroundStyle,"attributors/style/color":b.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":w.FontStyle,"attributors/style/size":N.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":u.IndentClass,"formats/background":v.BackgroundStyle,"formats/color":b.ColorStyle,"formats/font":w.FontClass,"formats/size":N.SizeClass,"formats/blockquote":d.default,"formats/code-block":D.default,"formats/header":m.default,"formats/list":y.default,"formats/bold":k.default,"formats/code":V.Code,"formats/italic":E.default,"formats/link":T.default,"formats/script":P.default,"formats/strike":L.default,"formats/underline":F.default,"formats/image":W.default,"formats/video":q.default,"formats/list/item":x.ListItem,"modules/formula":G.default,"modules/syntax":Q.default,"modules/toolbar":Y.default,"themes/bubble":he.default,"themes/snow":Oe.default,"ui/icons":J.default,"ui/picker":te.default,"ui/icon-picker":ye.default,"ui/color-picker":ve.default,"ui/tooltip":Le.default},!0),n.default=o.default},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function y(v,b){for(var w=0;w<b.length;w++){var N=b[w];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(v,N.key,N)}}return function(v,b,w){return b&&y(v.prototype,b),w&&y(v,w),v}}(),o=function y(v,b,w){v===null&&(v=Function.prototype);var N=Object.getOwnPropertyDescriptor(v,b);if(N===void 0){var j=Object.getPrototypeOf(v);return j===null?void 0:y(j,b,w)}else{if("value"in N)return N.value;var k=N.get;return k===void 0?void 0:k.call(w)}},l=i(0),c=u(l);function u(y){return y&&y.__esModule?y:{default:y}}function f(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function d(y,v){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:y}function p(y,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);y.prototype=Object.create(v&&v.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(y,v):y.__proto__=v)}var m=function(y){p(v,y);function v(){return f(this,v),d(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,[{key:"add",value:function(w,N){if(N==="+1"||N==="-1"){var j=this.value(w)||0;N=N==="+1"?j+1:j-1}return N===0?(this.remove(w),!0):o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"add",this).call(this,w,N)}},{key:"canAdd",value:function(w,N){return o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"canAdd",this).call(this,w,N)||o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"canAdd",this).call(this,w,parseInt(N))}},{key:"value",value:function(w){return parseInt(o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"value",this).call(this,w))||void 0}}]),v}(c.default.Attributor.Class),x=new m("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=x},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="blockquote",d.tagName="blockquote",n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(x,y){for(var v=0;v<y.length;v++){var b=y[v];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(x,b.key,b)}}return function(x,y,v){return y&&m(x.prototype,y),v&&m(x,v),x}}(),o=i(4),l=c(o);function c(m){return m&&m.__esModule?m:{default:m}}function u(m,x){if(!(m instanceof x))throw new TypeError("Cannot call a class as a function")}function f(m,x){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:m}function d(m,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);m.prototype=Object.create(x&&x.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(m,x):m.__proto__=x)}var p=function(m){d(x,m);function x(){return u(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"formats",value:function(v){return this.tagName.indexOf(v.tagName)+1}}]),x}(l.default);p.blotName="header",p.tagName=["H1","H2","H3","H4","H5","H6"],n.default=p},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function j(k,_){for(var E=0;E<_.length;E++){var A=_[E];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(k,A.key,A)}}return function(k,_,E){return _&&j(k.prototype,_),E&&j(k,E),k}}(),o=function j(k,_,E){k===null&&(k=Function.prototype);var A=Object.getOwnPropertyDescriptor(k,_);if(A===void 0){var T=Object.getPrototypeOf(k);return T===null?void 0:j(T,_,E)}else{if("value"in A)return A.value;var M=A.get;return M===void 0?void 0:M.call(E)}},l=i(0),c=m(l),u=i(4),f=m(u),d=i(25),p=m(d);function m(j){return j&&j.__esModule?j:{default:j}}function x(j,k,_){return k in j?Object.defineProperty(j,k,{value:_,enumerable:!0,configurable:!0,writable:!0}):j[k]=_,j}function y(j,k){if(!(j instanceof k))throw new TypeError("Cannot call a class as a function")}function v(j,k){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:j}function b(j,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);j.prototype=Object.create(k&&k.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(j,k):j.__proto__=k)}var w=function(j){b(k,j);function k(){return y(this,k),v(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}return s(k,[{key:"format",value:function(E,A){E===N.blotName&&!A?this.replaceWith(c.default.create(this.statics.scope)):o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"format",this).call(this,E,A)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,A){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,A),this):(this.parent.unwrap(),o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"replaceWith",this).call(this,E,A))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:o(k.__proto__||Object.getPrototypeOf(k),"formats",this).call(this,E)}}]),k}(f.default);w.blotName="list-item",w.tagName="LI";var N=function(j){b(k,j),s(k,null,[{key:"create",value:function(E){var A=E==="ordered"?"OL":"UL",T=o(k.__proto__||Object.getPrototypeOf(k),"create",this).call(this,A);return(E==="checked"||E==="unchecked")&&T.setAttribute("data-checked",E==="checked"),T}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function k(_){y(this,k);var E=v(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,_)),A=function(M){if(M.target.parentNode===_){var P=E.statics.formats(_),R=c.default.find(M.target);P==="checked"?R.format("list","unchecked"):P==="unchecked"&&R.format("list","checked")}};return _.addEventListener("touchstart",A),_.addEventListener("mousedown",A),E}return s(k,[{key:"format",value:function(E,A){this.children.length>0&&this.children.tail.format(E,A)}},{key:"formats",value:function(){return x({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,A){if(E instanceof w)o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"insertBefore",this).call(this,E,A);else{var T=A==null?this.length():A.offset(this),M=this.split(T);M.parent.insertBefore(E,M)}}},{key:"optimize",value:function(E){o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"optimize",this).call(this,E);var A=this.next;A!=null&&A.prev===this&&A.statics.blotName===this.statics.blotName&&A.domNode.tagName===this.domNode.tagName&&A.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(A.moveChildren(this),A.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var A=c.default.create(this.statics.defaultChild);E.moveChildren(A),this.appendChild(A)}o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"replace",this).call(this,E)}}]),k}(p.default);N.blotName="list",N.scope=c.default.Scope.BLOCK_BLOT,N.tagName=["OL","UL"],N.defaultChild="list-item",N.allowedChildren=[w],n.ListItem=w,n.default=N},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="italic",d.tagName=["EM","I"],n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(y,v){for(var b=0;b<v.length;b++){var w=v[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,v,b){return v&&x(y.prototype,v),b&&x(y,b),y}}(),o=function x(y,v,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,v);if(w===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:x(N,v,b)}else{if("value"in w)return w.value;var j=w.get;return j===void 0?void 0:j.call(b)}},l=i(6),c=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}function d(x,y){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:x}function p(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);x.prototype=Object.create(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(x,y):x.__proto__=y)}var m=function(x){p(y,x);function y(){return f(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,null,[{key:"create",value:function(b){return b==="super"?document.createElement("sup"):b==="sub"?document.createElement("sub"):o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,b)}},{key:"formats",value:function(b){if(b.tagName==="SUB")return"sub";if(b.tagName==="SUP")return"super"}}]),y}(c.default);m.blotName="script",m.tagName=["SUB","SUP"],n.default=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="strike",d.tagName="S",n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function u(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d=function(p){f(m,p);function m(){return c(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default);d.blotName="underline",d.tagName="U",n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(b,w){for(var N=0;N<w.length;N++){var j=w[N];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,w,N){return w&&v(b.prototype,w),N&&v(b,N),b}}(),o=function v(b,w,N){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,w);if(j===void 0){var k=Object.getPrototypeOf(b);return k===null?void 0:v(k,w,N)}else{if("value"in j)return j.value;var _=j.get;return _===void 0?void 0:_.call(N)}},l=i(0),c=f(l),u=i(27);function f(v){return v&&v.__esModule?v:{default:v}}function d(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function p(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function m(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var x=["alt","height","width"],y=function(v){m(b,v);function b(){return d(this,b),p(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(N,j){x.indexOf(N)>-1?j?this.domNode.setAttribute(N,j):this.domNode.removeAttribute(N):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,N,j)}}],[{key:"create",value:function(N){var j=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,N);return typeof N=="string"&&j.setAttribute("src",this.sanitize(N)),j}},{key:"formats",value:function(N){return x.reduce(function(j,k){return N.hasAttribute(k)&&(j[k]=N.getAttribute(k)),j},{})}},{key:"match",value:function(N){return/\.(jpe?g|gif|png)$/.test(N)||/^data:image\/.+;base64/.test(N)}},{key:"sanitize",value:function(N){return(0,u.sanitize)(N,["http","https","data"])?N:"//:0"}},{key:"value",value:function(N){return N.getAttribute("src")}}]),b}(c.default.Embed);y.blotName="image",y.tagName="IMG",n.default=y},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(b,w){for(var N=0;N<w.length;N++){var j=w[N];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(b,j.key,j)}}return function(b,w,N){return w&&v(b.prototype,w),N&&v(b,N),b}}(),o=function v(b,w,N){b===null&&(b=Function.prototype);var j=Object.getOwnPropertyDescriptor(b,w);if(j===void 0){var k=Object.getPrototypeOf(b);return k===null?void 0:v(k,w,N)}else{if("value"in j)return j.value;var _=j.get;return _===void 0?void 0:_.call(N)}},l=i(4),c=i(27),u=f(c);function f(v){return v&&v.__esModule?v:{default:v}}function d(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function p(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function m(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var x=["height","width"],y=function(v){m(b,v);function b(){return d(this,b),p(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(N,j){x.indexOf(N)>-1?j?this.domNode.setAttribute(N,j):this.domNode.removeAttribute(N):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,N,j)}}],[{key:"create",value:function(N){var j=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,N);return j.setAttribute("frameborder","0"),j.setAttribute("allowfullscreen",!0),j.setAttribute("src",this.sanitize(N)),j}},{key:"formats",value:function(N){return x.reduce(function(j,k){return N.hasAttribute(k)&&(j[k]=N.getAttribute(k)),j},{})}},{key:"sanitize",value:function(N){return u.default.sanitize(N)}},{key:"value",value:function(N){return N.getAttribute("src")}}]),b}(l.BlockEmbed);y.blotName="video",y.className="ql-video",y.tagName="IFRAME",n.default=y},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function N(j,k){for(var _=0;_<k.length;_++){var E=k[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(j,E.key,E)}}return function(j,k,_){return k&&N(j.prototype,k),_&&N(j,_),j}}(),o=function N(j,k,_){j===null&&(j=Function.prototype);var E=Object.getOwnPropertyDescriptor(j,k);if(E===void 0){var A=Object.getPrototypeOf(j);return A===null?void 0:N(A,k,_)}else{if("value"in E)return E.value;var T=E.get;return T===void 0?void 0:T.call(_)}},l=i(35),c=m(l),u=i(5),f=m(u),d=i(9),p=m(d);function m(N){return N&&N.__esModule?N:{default:N}}function x(N,j){if(!(N instanceof j))throw new TypeError("Cannot call a class as a function")}function y(N,j){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:N}function v(N,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);N.prototype=Object.create(j&&j.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(N,j):N.__proto__=j)}var b=function(N){v(j,N);function j(){return x(this,j),y(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,null,[{key:"create",value:function(_){var E=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,_);return typeof _=="string"&&(window.katex.render(_,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",_)),E}},{key:"value",value:function(_){return _.getAttribute("data-value")}}]),j}(c.default);b.blotName="formula",b.className="ql-formula",b.tagName="SPAN";var w=function(N){v(j,N),s(j,null,[{key:"register",value:function(){f.default.register(b,!0)}}]);function j(){x(this,j);var k=y(this,(j.__proto__||Object.getPrototypeOf(j)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return k}return j}(p.default);n.FormulaBlot=b,n.default=w},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function _(E,A){for(var T=0;T<A.length;T++){var M=A[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}return function(E,A,T){return A&&_(E.prototype,A),T&&_(E,T),E}}(),o=function _(E,A,T){E===null&&(E=Function.prototype);var M=Object.getOwnPropertyDescriptor(E,A);if(M===void 0){var P=Object.getPrototypeOf(E);return P===null?void 0:_(P,A,T)}else{if("value"in M)return M.value;var R=M.get;return R===void 0?void 0:R.call(T)}},l=i(0),c=y(l),u=i(5),f=y(u),d=i(9),p=y(d),m=i(13),x=y(m);function y(_){return _&&_.__esModule?_:{default:_}}function v(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")}function b(_,E){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:_}function w(_,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);_.prototype=Object.create(E&&E.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(_,E):_.__proto__=E)}var N=function(_){w(E,_);function E(){return v(this,E),b(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,[{key:"replaceWith",value:function(T){this.domNode.textContent=this.domNode.textContent,this.attach(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,T)}},{key:"highlight",value:function(T){var M=this.domNode.textContent;this.cachedText!==M&&((M.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=T(M),this.domNode.normalize(),this.attach()),this.cachedText=M)}}]),E}(x.default);N.className="ql-syntax";var j=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),k=function(_){w(E,_),s(E,null,[{key:"register",value:function(){f.default.register(j,!0),f.default.register(N,!0)}}]);function E(A,T){v(this,E);var M=b(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,A,T));if(typeof M.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var P=null;return M.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(P),P=setTimeout(function(){M.highlight(),P=null},M.options.interval)}),M.highlight(),M}return s(E,[{key:"highlight",value:function(){var T=this;if(!this.quill.selection.composing){this.quill.update(f.default.sources.USER);var M=this.quill.getSelection();this.quill.scroll.descendants(N).forEach(function(P){P.highlight(T.options.highlight)}),this.quill.update(f.default.sources.SILENT),M!=null&&this.quill.setSelection(M,f.default.sources.SILENT)}}}]),E}(p.default);k.DEFAULTS={highlight:function(){return window.hljs==null?null:function(_){var E=window.hljs.highlightAuto(_);return E.value}}(),interval:1e3},n.CodeBlock=N,n.CodeToken=j,n.default=k},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function E(A,T,M){A===null&&(A=Function.prototype);var P=Object.getOwnPropertyDescriptor(A,T);if(P===void 0){var R=Object.getPrototypeOf(A);return R===null?void 0:E(R,T,M)}else{if("value"in P)return P.value;var L=P.get;return L===void 0?void 0:L.call(M)}},o=function(){function E(A,T){for(var M=0;M<T.length;M++){var P=T[M];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(A,P.key,P)}}return function(A,T,M){return T&&E(A.prototype,T),M&&E(A,M),A}}(),l=i(3),c=v(l),u=i(8),f=v(u),d=i(43),p=v(d),m=i(15),x=i(41),y=v(x);function v(E){return E&&E.__esModule?E:{default:E}}function b(E,A){if(!(E instanceof A))throw new TypeError("Cannot call a class as a function")}function w(E,A){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:E}function N(E,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);E.prototype=Object.create(A&&A.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(E,A):E.__proto__=A)}var j=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],k=function(E){N(A,E);function A(T,M){b(this,A),M.modules.toolbar!=null&&M.modules.toolbar.container==null&&(M.modules.toolbar.container=j);var P=w(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,M));return P.quill.container.classList.add("ql-bubble"),P}return o(A,[{key:"extendToolbar",value:function(M){this.tooltip=new _(this.quill,this.options.bounds),this.tooltip.root.appendChild(M.container),this.buildButtons([].slice.call(M.container.querySelectorAll("button")),y.default),this.buildPickers([].slice.call(M.container.querySelectorAll("select")),y.default)}}]),A}(p.default);k.DEFAULTS=(0,c.default)(!0,{},p.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(A){A?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var _=function(E){N(A,E);function A(T,M){b(this,A);var P=w(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,M));return P.quill.on(f.default.events.EDITOR_CHANGE,function(R,L,$,F){if(R===f.default.events.SELECTION_CHANGE)if(L!=null&&L.length>0&&F===f.default.sources.USER){P.show(),P.root.style.left="0px",P.root.style.width="",P.root.style.width=P.root.offsetWidth+"px";var z=P.quill.getLines(L.index,L.length);if(z.length===1)P.position(P.quill.getBounds(L));else{var W=z[z.length-1],K=P.quill.getIndex(W),q=Math.min(W.length()-1,L.index+L.length-K),V=P.quill.getBounds(new m.Range(K,q));P.position(V)}}else document.activeElement!==P.textbox&&P.quill.hasFocus()&&P.hide()}),P}return o(A,[{key:"listen",value:function(){var M=this;s(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){M.root.classList.remove("ql-editing")}),this.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!M.root.classList.contains("ql-hidden")){var P=M.quill.getSelection();P!=null&&M.position(M.quill.getBounds(P))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(M){var P=s(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"position",this).call(this,M),R=this.root.querySelector(".ql-tooltip-arrow");if(R.style.marginLeft="",P===0)return P;R.style.marginLeft=-1*P-R.offsetWidth/2+"px"}}]),A}(d.BaseTooltip);_.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=_,n.default=k},function(r,n,i){r.exports=i(63)}]).default})}(Zg)),Zg.exports}var Vi,F5;function zye(){if(F5)return Vi;F5=1;var t=Vi&&Vi.__extends||function(){var f=function(d,p){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,x){m.__proto__=x}||function(m,x){for(var y in x)x.hasOwnProperty(y)&&(m[y]=x[y])},f(d,p)};return function(d,p){f(d,p);function m(){this.constructor=d}d.prototype=p===null?Object.create(p):(m.prototype=p.prototype,new m)}}(),e=Vi&&Vi.__assign||function(){return e=Object.assign||function(f){for(var d,p=1,m=arguments.length;p<m;p++){d=arguments[p];for(var x in d)Object.prototype.hasOwnProperty.call(d,x)&&(f[x]=d[x])}return f},e.apply(this,arguments)},r=Vi&&Vi.__spreadArrays||function(){for(var f=0,d=0,p=arguments.length;d<p;d++)f+=arguments[d].length;for(var m=Array(f),x=0,d=0;d<p;d++)for(var y=arguments[d],v=0,b=y.length;v<b;v++,x++)m[x]=y[v];return m},n=Vi&&Vi.__importDefault||function(f){return f&&f.__esModule?f:{default:f}},i=n(ad()),s=n(xO()),o=n(Iq()),l=n(qye()),c=function(f){t(d,f);function d(p){var m=f.call(this,p)||this;m.dirtyProps=["modules","formats","bounds","theme","children"],m.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],m.state={generation:0},m.selection=null,m.onEditorChange=function(y,v,b,w){var N,j,k,_;y==="text-change"?(j=(N=m).onEditorChangeText)===null||j===void 0||j.call(N,m.editor.root.innerHTML,v,w,m.unprivilegedEditor):y==="selection-change"&&((_=(k=m).onEditorChangeSelection)===null||_===void 0||_.call(k,v,w,m.unprivilegedEditor))};var x=m.isControlled()?p.value:p.defaultValue;return m.value=x??"",m}return d.prototype.validateProps=function(p){var m;if(i.default.Children.count(p.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(p.children)){var x=i.default.Children.only(p.children);if(((m=x)===null||m===void 0?void 0:m.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&p.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},d.prototype.shouldComponentUpdate=function(p,m){var x=this,y;if(this.validateProps(p),!this.editor||this.state.generation!==m.generation)return!0;if("value"in p){var v=this.getEditorContents(),b=(y=p.value,y??"");this.isEqualValue(b,v)||this.setEditorContents(this.editor,b)}return p.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,p.readOnly),r(this.cleanProps,this.dirtyProps).some(function(w){return!o.default(p[w],x.props[w])})},d.prototype.shouldComponentRegenerate=function(p){var m=this;return this.dirtyProps.some(function(x){return!o.default(p[x],m.props[x])})},d.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},d.prototype.componentWillUnmount=function(){this.destroyEditor()},d.prototype.componentDidUpdate=function(p,m){var x=this;if(this.editor&&this.shouldComponentRegenerate(p)){var y=this.editor.getContents(),v=this.editor.getSelection();this.regenerationSnapshot={delta:y,selection:v},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==m.generation){var b=this.regenerationSnapshot,y=b.delta,w=b.selection;delete this.regenerationSnapshot,this.instantiateEditor();var N=this.editor;N.setContents(y),u(function(){return x.setEditorSelection(N,w)})}},d.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},d.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},d.prototype.isControlled=function(){return"value"in this.props},d.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},d.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},d.prototype.createEditor=function(p,m){var x=new l.default(p,m);return m.tabIndex!=null&&this.setEditorTabIndex(x,m.tabIndex),this.hookEditor(x),x},d.prototype.hookEditor=function(p){this.unprivilegedEditor=this.makeUnprivilegedEditor(p),p.on("editor-change",this.onEditorChange)},d.prototype.unhookEditor=function(p){p.off("editor-change",this.onEditorChange)},d.prototype.getEditorContents=function(){return this.value},d.prototype.getEditorSelection=function(){return this.selection},d.prototype.isDelta=function(p){return p&&p.ops},d.prototype.isEqualValue=function(p,m){return this.isDelta(p)&&this.isDelta(m)?o.default(p.ops,m.ops):o.default(p,m)},d.prototype.setEditorContents=function(p,m){var x=this;this.value=m;var y=this.getEditorSelection();typeof m=="string"?p.setContents(p.clipboard.convert(m)):p.setContents(m),u(function(){return x.setEditorSelection(p,y)})},d.prototype.setEditorSelection=function(p,m){if(this.selection=m,m){var x=p.getLength();m.index=Math.max(0,Math.min(m.index,x-1)),m.length=Math.max(0,Math.min(m.length,x-1-m.index)),p.setSelection(m)}},d.prototype.setEditorTabIndex=function(p,m){var x,y;!((y=(x=p)===null||x===void 0?void 0:x.scroll)===null||y===void 0)&&y.domNode&&(p.scroll.domNode.tabIndex=m)},d.prototype.setEditorReadOnly=function(p,m){m?p.disable():p.enable()},d.prototype.makeUnprivilegedEditor=function(p){var m=p;return{getHTML:function(){return m.root.innerHTML},getLength:m.getLength.bind(m),getText:m.getText.bind(m),getContents:m.getContents.bind(m),getSelection:m.getSelection.bind(m),getBounds:m.getBounds.bind(m)}},d.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var p=s.default.findDOMNode(this.editingArea);if(!p)throw new Error("Cannot find element for editing area");if(p.nodeType===3)throw new Error("Editing area cannot be a text node");return p},d.prototype.renderEditingArea=function(){var p=this,m=this.props,x=m.children,y=m.preserveWhitespace,v=this.state.generation,b={key:v,ref:function(w){p.editingArea=w}};return i.default.Children.count(x)?i.default.cloneElement(i.default.Children.only(x),b):y?i.default.createElement("pre",e({},b)):i.default.createElement("div",e({},b))},d.prototype.render=function(){var p;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(p=this.props.className,p??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},d.prototype.onEditorChangeText=function(p,m,x,y){var v,b;if(this.editor){var w=this.isDelta(this.value)?y.getContents():y.getHTML();w!==this.getEditorContents()&&(this.lastDeltaChangeSet=m,this.value=w,(b=(v=this.props).onChange)===null||b===void 0||b.call(v,p,m,x,y))}},d.prototype.onEditorChangeSelection=function(p,m,x){var y,v,b,w,N,j;if(this.editor){var k=this.getEditorSelection(),_=!k&&p,E=k&&!p;o.default(p,k)||(this.selection=p,(v=(y=this.props).onChangeSelection)===null||v===void 0||v.call(y,p,m,x),_?(w=(b=this.props).onFocus)===null||w===void 0||w.call(b,p,m,x):E&&((j=(N=this.props).onBlur)===null||j===void 0||j.call(N,k,m,x)))}},d.prototype.focus=function(){this.editor&&this.editor.focus()},d.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},d.displayName="React Quill",d.Quill=l.default,d.defaultProps={theme:"snow",modules:{},readOnly:!1},d}(i.default.Component);function u(f){Promise.resolve().then(f)}return Vi=c,Vi}var Uye=zye();const Hye=ht(Uye);function q5(){const{id:t}=us(),e=!!t,r=O.useRef(null),[n,i]=O.useState(null),[s,o]=O.useState(""),[l,c]=O.useState(null),[u,f]=O.useState(e),[d,p]=O.useState(!1),[m,x]=O.useState({wordCount:0,characterCount:0,readingTime:0,paragraphs:0});O.useEffect(()=>{e&&t&&y()},[e,t]),O.useEffect(()=>{v(s)},[s]);const y=async()=>{if(t)try{const{data:k,error:_}=await pe.from("documents").select("*").eq("content_item_id",t).maybeSingle();if(_)throw _;k&&(i(k),o(k.content_html||""),c(k.content_json))}catch(k){console.error("Error fetching document:",k)}finally{f(!1)}},v=k=>{const _=k.replace(/<[^>]*>/g,"").trim(),E=_?_.split(/\s+/).length:0,A=_.length,T=Math.ceil(E/200),M=k.split(/<\/p>/gi).length-1||(_?1:0);x({wordCount:E,characterCount:A,readingTime:Math.max(1,T),paragraphs:M})},b=async k=>{try{const _={content_item_id:k,content_html:s,content_json:l,word_count:m.wordCount,reading_time_minutes:m.readingTime};if(n){const{error:E}=await pe.from("documents").update({..._,updated_at:new Date().toISOString()}).eq("id",n.id);if(E)throw E}else{const{error:E}=await pe.from("documents").insert([_]);if(E)throw E}}catch(_){throw console.error("Error saving document data:",_),_}},w=(k,_,E,A)=>{o(k),c(A.getContents())},N={toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]},{size:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{align:[]}],["blockquote","code-block"],["link","image","video"],["clean"]]},clipboard:{matchVisual:!1}},j=["header","font","size","bold","italic","underline","strike","color","background","script","list","bullet","indent","align","blockquote","code-block","link","image","video"];return u?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading document..."})]})}):a.jsx(zp,{contentType:"document",isEdit:e,onSaveContent:b,title:"Documents",description:"Rich text documents and guides",color:"#10B981",icon:Ot,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(py,{className:"h-5 w-5 mr-2 text-green-500"}),"Document Statistics"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.wordCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide font-medium",children:"Words"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.characterCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-green-600 uppercase tracking-wide font-medium",children:"Characters"})]}),a.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:m.readingTime}),a.jsx("div",{className:"text-xs text-purple-600 uppercase tracking-wide font-medium",children:"Min Read"})]}),a.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.paragraphs}),a.jsx("div",{className:"text-xs text-orange-600 uppercase tracking-wide font-medium",children:"Paragraphs"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(DO,{className:"h-5 w-5 mr-2 text-green-500"}),"Document Content"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:()=>p(!1),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${d?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-green-100 text-green-700"}`,children:[a.jsx(MX,{className:"h-4 w-4 mr-1 inline"}),"Edit"]}),a.jsxs("button",{onClick:()=>p(!0),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${d?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(ii,{className:"h-4 w-4 mr-1 inline"}),"Preview"]})]})]}),d?a.jsx("div",{className:"prose max-w-none",children:a.jsx("div",{className:"min-h-96 p-6 border border-gray-200 rounded-lg bg-gray-50",children:s?a.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:s}}):a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Ot,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No content to preview"}),a.jsx("p",{className:"text-sm mt-1",children:"Switch to Edit mode to start writing"})]})})}):a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsx(Hye,{ref:r,theme:"snow",value:s,onChange:w,modules:N,formats:j,placeholder:"Start writing your document content here...\\n\\nYou can use the toolbar above to format text, add images, create lists, and more. This editor supports rich text formatting similar to Google Docs or Microsoft Word.",style:{minHeight:"400px",fontSize:"16px",lineHeight:"1.6"}})}),a.jsx("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(Ot,{className:"h-4 w-4 text-green-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-green-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"Professional Document Editor"}),a.jsx("p",{className:"text-xs leading-relaxed",children:"This rich-text editor supports all standard formatting options including headers, lists, links, images, and code blocks. Content is automatically saved and can be exported or shared with clients."})]})]})})]}),n&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Metadata"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Word Count"}),a.jsxs("p",{className:"text-gray-900",children:[m.wordCount.toLocaleString()," words"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Reading Time"}),a.jsxs("p",{className:"text-gray-900",children:[m.readingTime," minute",m.readingTime!==1?"s":""]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Last Updated"}),a.jsx("p",{className:"text-gray-900",children:new Date(n.updated_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-medium text-gray-700",children:"Document ID"}),a.jsx("p",{className:"text-gray-900 font-mono text-xs",children:n.id})]})]})]})]})})}const Wye=["General","Creative Writing","Business","Technical","Educational","Marketing","Customer Support","Data Analysis","Programming","Research","Social Media","Email","Other"];function z5(){const{id:t}=us(),e=!!t,[r,n]=O.useState(null),[i,s]=O.useState(""),[o,l]=O.useState("General"),[c,u]=O.useState(e),[f,d]=O.useState(!1),[p,m]=O.useState({characterCount:0,wordCount:0,lineCount:0,variables:[]});O.useEffect(()=>{e&&t&&x()},[e,t]),O.useEffect(()=>{y(i)},[i]);const x=async()=>{if(t)try{const{data:N,error:j}=await pe.from("prompts").select("*").eq("content_item_id",t).maybeSingle();if(j)throw j;N&&(n(N),s(N.prompt_text||""),l(N.prompt_category||"General"))}catch(N){console.error("Error fetching prompt:",N)}finally{u(!1)}},y=N=>{const j=N.length,k=N.trim()?N.trim().split(/\s+/).length:0,_=N.split(`
`).length,E=N.match(/\{([^}]+)\}|\[([^\]]+)\]/g)||[],A=[...new Set(E.map(T=>T.replace(/[{}\[\]]/g,"")))];m({characterCount:j,wordCount:k,lineCount:_,variables:A})},v=async()=>{try{await navigator.clipboard.writeText(i),d(!0),setTimeout(()=>d(!1),2e3),r&&(await pe.from("prompts").update({usage_count:(r.usage_count||0)+1,last_copied_at:new Date().toISOString()}).eq("id",r.id),n(N=>N?{...N,usage_count:(N.usage_count||0)+1,last_copied_at:new Date().toISOString()}:null))}catch(N){console.error("Failed to copy prompt:",N)}},b=N=>{const j=document.getElementById("promptText");if(j){const k=j.selectionStart,_=j.selectionEnd,E=i.substring(0,k)+`{${N}}`+i.substring(_);s(E),setTimeout(()=>{j.focus(),j.setSelectionRange(k+N.length+2,k+N.length+2)},0)}},w=async N=>{try{const j={content_item_id:N,prompt_text:i,prompt_category:o,usage_count:(r==null?void 0:r.usage_count)||0,last_copied_at:(r==null?void 0:r.last_copied_at)||null};if(r){const{error:k}=await pe.from("prompts").update({...j,updated_at:new Date().toISOString()}).eq("id",r.id);if(k)throw k}else{const{error:k}=await pe.from("prompts").insert([j]);if(k)throw k}}catch(j){throw console.error("Error saving prompt data:",j),j}};return c?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading prompt..."})]})}):a.jsx(zp,{contentType:"prompt",isEdit:e,onSaveContent:w,title:"Prompts",description:"Reusable prompt templates",color:"#8B5CF6",icon:Gr,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(py,{className:"h-5 w-5 mr-2 text-purple-500"}),"Prompt Statistics"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.characterCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide font-medium",children:"Characters"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.wordCount.toLocaleString()}),a.jsx("div",{className:"text-xs text-green-600 uppercase tracking-wide font-medium",children:"Words"})]}),a.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:p.lineCount}),a.jsx("div",{className:"text-xs text-purple-600 uppercase tracking-wide font-medium",children:"Lines"})]}),a.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p.variables.length}),a.jsx("div",{className:"text-xs text-orange-600 uppercase tracking-wide font-medium",children:"Variables"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Es,{className:"h-5 w-5 mr-2 text-purple-500"}),"Category & Classification"]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Prompt Category"}),a.jsx("select",{id:"category",value:o,onChange:N=>l(N.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:Wye.map(N=>a.jsx("option",{value:N,children:N},N))}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Categorize your prompt to make it easier to find and organize"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(Gr,{className:"h-5 w-5 mr-2 text-purple-500"}),"Prompt Content"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:v,disabled:!i.trim(),className:`inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md transition-all ${f?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700 hover:bg-purple-200"} disabled:opacity-50`,children:f?a.jsxs(a.Fragment,{children:[a.jsx(ln,{className:"h-4 w-4 mr-1"}),"Copied!"]}):a.jsxs(a.Fragment,{children:[a.jsx(gy,{className:"h-4 w-4 mr-1"}),"Copy"]})}),a.jsxs("div",{className:"text-sm text-gray-500",children:[p.characterCount," / ",p.wordCount," words"]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("textarea",{id:"promptText",value:i,onChange:N=>s(N.target.value),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm leading-relaxed",placeholder:"Enter your prompt template here...\\n\\nYou can use variables like {name}, {topic}, or [variable] to make your prompts reusable.\\n\\nExample:\\nYou are a helpful AI assistant specialized in {field}. Please help me with {task} by providing {output_format} that is {tone} and {length}."}),p.variables.length>0&&a.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[a.jsxs("h4",{className:"text-sm font-medium text-purple-900 mb-2 flex items-center",children:[a.jsx(xM,{className:"h-4 w-4 mr-1"}),"Detected Variables (",p.variables.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:p.variables.map((N,j)=>a.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-md font-mono",children:[a.jsx(xM,{className:"h-3 w-3 mr-1"}),N]},j))}),a.jsx("p",{className:"text-xs text-purple-700 mt-2",children:"These variables can be replaced when using the prompt"})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Quick Variables"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["name","topic","context","tone","format","length","audience","goal"].map(N=>a.jsxs("button",{onClick:()=>b(N),className:"inline-flex items-center px-2 py-1 bg-white border border-gray-200 text-gray-700 text-xs rounded-md hover:bg-gray-100 transition-colors",children:["+ ",N]},N))}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Click to insert common variables into your prompt"})]}),a.jsx("div",{className:"p-4 bg-purple-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(Gr,{className:"h-4 w-4 text-purple-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-purple-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"Prompt Template Tips"}),a.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:["Use ","{variable}"," or [variable] syntax for replaceable parts"]}),a.jsx("li",{children:"Be specific about the desired output format and style"}),a.jsx("li",{children:"Include context and constraints to guide the AI response"}),a.jsx("li",{children:"Test your prompts with different variables to ensure consistency"})]})]})]})})]})]}),r&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(go,{className:"h-5 w-5 mr-2 text-blue-500"}),"Usage Statistics"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.usage_count||0}),a.jsx("div",{className:"text-sm text-blue-600",children:"Times Copied"})]}),a.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium text-green-600",children:r.last_copied_at?new Date(r.last_copied_at).toLocaleDateString():"Never"}),a.jsx("div",{className:"text-sm text-green-600",children:"Last Copied"})]})]})]}),i.trim()&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prompt Preview"}),a.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:a.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono leading-relaxed",children:i})}),a.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm text-gray-600",children:[a.jsx("span",{children:"This is how your prompt will appear when copied"}),a.jsxs("button",{onClick:v,className:"inline-flex items-center px-3 py-1 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors",children:[a.jsx(gy,{className:"h-3 w-3 mr-1"}),"Copy Preview"]})]})]})]})})}const Vye=["Zapier","Make (Integromat)","Microsoft Power Automate","IFTTT","n8n","Bubble","Airtable","Google Sheets","Slack","Discord","Trello","Asana","Notion","Monday.com","HubSpot","Salesforce","Gmail","Outlook","Google Drive","Dropbox","AWS Lambda","GitHub Actions","Custom API","Other"];function U5(){const{id:t}=us(),e=!!t,[r,n]=O.useState(null),[i,s]=O.useState(""),[o,l]=O.useState([]),[c,u]=O.useState(""),[f,d]=O.useState(""),[p,m]=O.useState(""),[x,y]=O.useState(e),[v,b]=O.useState(!1),[w,N]=O.useState(null);O.useEffect(()=>{e&&t&&j()},[e,t]),O.useEffect(()=>{i.trim()?k(i.trim()):N(null)},[i]);const j=async()=>{if(t)try{const{data:M,error:P}=await pe.from("automations").select("*").eq("content_item_id",t).maybeSingle();if(P)throw P;M&&(n(M),s(M.automation_url||""),l(M.required_tools||[]),u(M.tool_description||""),d(M.setup_instructions||""))}catch(M){console.error("Error fetching automation:",M)}finally{y(!1)}},k=async M=>{b(!0);try{const P=new URL(M);let R="Unknown";P.hostname.includes("zapier.com")?R="Zapier":P.hostname.includes("make.com")||P.hostname.includes("integromat.com")?R="Make (Integromat)":P.hostname.includes("flow.microsoft.com")?R="Microsoft Power Automate":P.hostname.includes("ifttt.com")?R="IFTTT":P.hostname.includes("n8n.io")?R="n8n":P.hostname.includes("bubble.io")&&(R="Bubble"),N({isValid:!0,isReachable:!0,platform:R,title:`${R} Automation`,description:`Automation workflow hosted on ${R}`})}catch{N({isValid:!1,isReachable:!1})}finally{b(!1)}},_=M=>{const P=M.trim();P&&!o.includes(P)&&l([...o,P]),m("")},E=M=>{l(o.filter(P=>P!==M))},A=M=>{o.includes(M)||l([...o,M])},T=async M=>{try{const P={content_item_id:M,automation_url:i.trim(),required_tools:o,tool_description:c.trim()||null,setup_instructions:f.trim()||null};if(r){const{error:R}=await pe.from("automations").update({...P,updated_at:new Date().toISOString()}).eq("id",r.id);if(R)throw R}else{const{error:R}=await pe.from("automations").insert([P]);if(R)throw R}}catch(P){throw console.error("Error saving automation data:",P),P}};return x?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(cr,{size:"lg"}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading automation..."})]})}):a.jsx(zp,{contentType:"automation",isEdit:e,onSaveContent:T,title:"Automations",description:"Process automations and workflows",color:"#F59E0B",icon:Ei,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(n_,{className:"h-5 w-5 mr-2 text-orange-500"}),"Automation Link"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"automationUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"Automation URL *"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"url",id:"automationUrl",value:i,onChange:M=>s(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"https://zapier.com/shared/... or https://make.com/template/...",required:!0}),v&&a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:a.jsx(cr,{size:"sm"})})]}),w&&a.jsxs("div",{className:`mt-2 p-3 rounded-lg border ${w.isValid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[w.isValid?a.jsx(ln,{className:"h-4 w-4 text-green-600"}):a.jsx(ql,{className:"h-4 w-4 text-red-600"}),a.jsx("p",{className:`text-sm font-medium ${w.isValid?"text-green-700":"text-red-700"}`,children:w.isValid?`Valid ${w.platform} automation URL`:"Invalid URL format"})]}),w.isValid&&w.platform&&a.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:["Platform: ",a.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:w.platform})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Link to the automation template, workflow, or shared automation"})]}),i.trim()&&(w==null?void 0:w.isValid)&&a.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-orange-900",children:"Automation Preview"}),a.jsxs("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-orange-600 hover:text-orange-800",children:[a.jsx(Os,{className:"h-4 w-4 mr-1"}),"Open in New Tab"]})]}),a.jsxs("div",{className:"text-sm text-orange-800",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"URL:"})," ",a.jsx("span",{className:"font-mono text-xs break-all",children:i})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Platform:"})," ",w.platform]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(KX,{className:"h-5 w-5 mr-2 text-orange-500"}),"Required Tools & Services"]}),a.jsxs("div",{className:"space-y-4",children:[o.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Selected Tools (",o.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:o.map((M,P)=>a.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-orange-100 text-orange-800 border border-orange-200",children:[M,a.jsx("button",{onClick:()=>E(M),className:"ml-2 text-orange-600 hover:text-orange-800",children:a.jsx($r,{className:"h-3 w-3"})})]},P))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Custom Tool"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:p,onChange:M=>m(M.target.value),onKeyPress:M=>M.key==="Enter"&&_(p),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter tool or service name..."}),a.jsxs("button",{onClick:()=>_(p),disabled:!p.trim()||o.includes(p.trim()),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:[a.jsx(Vt,{className:"h-4 w-4 mr-1"}),"Add"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Add - Common Tools"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:Vye.map(M=>a.jsxs("button",{onClick:()=>A(M),disabled:o.includes(M),className:`px-3 py-2 text-sm border rounded-lg transition-colors ${o.includes(M)?"bg-green-50 border-green-200 text-green-700 cursor-default":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[o.includes(M)?a.jsx(ln,{className:"h-3 w-3 inline mr-1"}):a.jsx(Vt,{className:"h-3 w-3 inline mr-1"}),M]},M))})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Zn,{className:"h-5 w-5 mr-2 text-blue-500"}),"Tools Description"]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"toolDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description of Required Tools"}),a.jsx("textarea",{id:"toolDescription",rows:4,value:c,onChange:M=>u(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Explain what each tool is used for in this automation...\\n\\nExample:\\n- Zapier: Connects different apps and triggers actions\\n- Google Sheets: Stores and manages data\\n- Slack: Sends notifications to the team"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Help users understand what each tool does in the automation workflow"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Ei,{className:"h-5 w-5 mr-2 text-orange-500"}),"Setup Instructions"]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"setupInstructions",className:"block text-sm font-medium text-gray-700 mb-2",children:"Step-by-Step Setup Guide"}),a.jsx("textarea",{id:"setupInstructions",rows:8,value:f,onChange:M=>d(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 font-mono text-sm",placeholder:"Provide detailed setup instructions...\\n\\nExample:\\n1. Click the automation link above\\n2. Sign up for a Zapier account if you don't have one\\n3. Connect your Google Sheets and Slack accounts\\n4. Configure the trigger conditions\\n5. Test the automation\\n6. Turn on the automation\\n\\nTroubleshooting:\\n- If connection fails, check API permissions\\n- Make sure all required fields are filled"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Provide clear, step-by-step instructions for setting up this automation"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Automation Summary"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Configuration"}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"URL:"})," ",i?"Configured":"Not set"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Required Tools:"})," ",o.length," tool",o.length!==1?"s":""]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Instructions:"})," ",f.trim()?"Provided":"None"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Tool Description:"})," ",c.trim()?"Provided":"None"]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Tools Required"}),a.jsx("div",{className:"space-y-1",children:o.length>0?a.jsx("ul",{className:"text-sm text-gray-600 space-y-0.5",children:o.map((M,P)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full mr-2"}),M]},P))}):a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No tools specified"})})]})]})]})]})})}const qf={async getAll(t){let e=pe.from("missions").select("*").order("created_at",{ascending:!1});t!=null&&t.status&&(e=e.eq("status",t.status)),t!=null&&t.difficulty_level&&(e=e.eq("difficulty_level",t.difficulty_level)),t!=null&&t.tags&&t.tags.length>0&&(e=e.overlaps("tags",t.tags));const{data:r,error:n}=await e;if(n)throw n;return r||[]},async getById(t){const{data:e,error:r}=await pe.from("missions").select("*").eq("id",t).maybeSingle();if(r)throw r;return e},async create(t){const{data:e,error:r}=await pe.from("missions").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("missions").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("missions").delete().eq("id",t);if(e)throw e},async getAssignments(t){const[e,r,n]=await Promise.all([pe.from("mission_client_assignments").select("*").eq("mission_id",t),pe.from("mission_user_assignments").select("*").eq("mission_id",t),pe.from("mission_tag_assignments").select("*").eq("mission_id",t)]);return{clients:e.data||[],users:r.data||[],tags:n.data||[]}},async assignToClients(t,e,r){const n=e.map(s=>({mission_id:t,client_id:s,assigned_by:r})),{error:i}=await pe.from("mission_client_assignments").upsert(n);if(i)throw i}},zf={async getAll(t){let e=pe.from("courses").select("*").order("created_at",{ascending:!1});t!=null&&t.status&&(e=e.eq("status",t.status)),t!=null&&t.difficulty_level&&(e=e.eq("difficulty_level",t.difficulty_level)),t!=null&&t.tags&&t.tags.length>0&&(e=e.overlaps("tags",t.tags));const{data:r,error:n}=await e;if(n)throw n;return r||[]},async getById(t){const{data:e,error:r}=await pe.from("courses").select("*").eq("id",t).maybeSingle();if(r)throw r;return e},async create(t){const{data:e,error:r}=await pe.from("courses").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("courses").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("courses").delete().eq("id",t);if(e)throw e}},YN={async getByParent(t,e){const r=t==="mission"?"mission_id":"course_id",{data:n,error:i}=await pe.from("pages").select("*").eq(r,e).order("order_index",{ascending:!0});if(i)throw i;return n||[]},async getById(t,e=!1){const{data:r,error:n}=await pe.from("pages").select("*").eq("id",t).maybeSingle();if(n)throw n;if(!r)return null;if(e){const i=await Uf.getByPageId(t);return{...r,blocks:i}}return r},async create(t){const{data:e,error:r}=await pe.from("pages").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("pages").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("pages").delete().eq("id",t);if(e)throw e},async reorder(t){const e=t.map((r,n)=>({id:r,order_index:n}));for(const r of e)await pe.from("pages").update({order_index:r.order_index}).eq("id",r.id)}},Uf={async getByPageId(t){const{data:e,error:r}=await pe.from("blocks").select("*").eq("page_id",t).eq("is_visible",!0).order("order_index",{ascending:!0});if(r)throw r;return e||[]},async getById(t){const{data:e,error:r}=await pe.from("blocks").select("*").eq("id",t).maybeSingle();if(r)throw r;return e},async create(t){const{data:e,error:r}=await pe.from("blocks").insert(t).select().single();if(r)throw r;return e},async update(t,e){const{data:r,error:n}=await pe.from("blocks").update(e).eq("id",t).select().single();if(n)throw n;return r},async delete(t){const{error:e}=await pe.from("blocks").delete().eq("id",t);if(e)throw e},async reorder(t){const e=t.map((r,n)=>({id:r,order_index:n}));for(const r of e)await pe.from("blocks").update({order_index:r.order_index}).eq("id",r.id)}},H5={async trackProgress(t){const{data:e,error:r}=await pe.functions.invoke("track-user-progress",{body:t});if(r)throw r;return e.data},async getUserProgress(t,e,r){const n=e==="mission"?"mission_id":"course_id",{data:i,error:s}=await pe.from("user_progress").select("*").eq("user_id",t).eq(n,r).order("created_at",{ascending:!1});if(s)throw s;return i||[]}},W5={async getStructure(t,e,r){const{data:n,error:i}=await pe.functions.invoke("page-structure-manager",{body:{parentType:t,parentId:e,includeBlocks:(r==null?void 0:r.includeBlocks)??!1,includeProgress:(r==null?void 0:r.includeProgress)??!1,userId:r==null?void 0:r.userId}});if(i)throw i;return n.data},async bulkCreatePages(t,e,r,n){const{data:i,error:s}=await pe.functions.invoke("page-builder-bulk-create",{body:{pages:r,userId:n,parentId:e,parentType:t}});if(s)throw s;return i.data}};function Kye(){const[t,e]=O.useState([]),[r,n]=O.useState(!1),[i,s]=O.useState(null),o=O.useCallback(async f=>{try{n(!0),s(null);const d=await qf.getAll(f);e(d)}catch(d){s(d instanceof Error?d.message:"Failed to fetch missions")}finally{n(!1)}},[]),l=O.useCallback(async f=>{try{s(null);const d=await qf.create(f);return e(p=>[d,...p]),d}catch(d){throw s(d instanceof Error?d.message:"Failed to create mission"),d}},[]),c=O.useCallback(async(f,d)=>{try{s(null);const p=await qf.update(f,d);return e(m=>m.map(x=>x.id===f?p:x)),p}catch(p){throw s(p instanceof Error?p.message:"Failed to update mission"),p}},[]),u=O.useCallback(async f=>{try{s(null),await qf.delete(f),e(d=>d.filter(p=>p.id!==f))}catch(d){throw s(d instanceof Error?d.message:"Failed to delete mission"),d}},[]);return O.useEffect(()=>{o()},[]),{missions:t,loading:r,error:i,fetchMissions:o,createMission:l,updateMission:c,deleteMission:u}}function Gye(){const[t,e]=O.useState([]),[r,n]=O.useState(!1),[i,s]=O.useState(null),o=O.useCallback(async f=>{try{n(!0),s(null);const d=await zf.getAll(f);e(d)}catch(d){s(d instanceof Error?d.message:"Failed to fetch courses")}finally{n(!1)}},[]),l=O.useCallback(async f=>{try{s(null);const d=await zf.create(f);return e(p=>[d,...p]),d}catch(d){throw s(d instanceof Error?d.message:"Failed to create course"),d}},[]),c=O.useCallback(async(f,d)=>{try{s(null);const p=await zf.update(f,d);return e(m=>m.map(x=>x.id===f?p:x)),p}catch(p){throw s(p instanceof Error?p.message:"Failed to update course"),p}},[]),u=O.useCallback(async f=>{try{s(null),await zf.delete(f),e(d=>d.filter(p=>p.id!==f))}catch(d){throw s(d instanceof Error?d.message:"Failed to delete course"),d}},[]);return O.useEffect(()=>{o()},[]),{courses:t,loading:r,error:i,fetchCourses:o,createCourse:l,updateCourse:c,deleteCourse:u}}function C8(t,e){const{user:r}=Ln(),[n,i]=O.useState(null),[s,o]=O.useState(null),[l,c]=O.useState(null),[u,f]=O.useState(!1),[d,p]=O.useState(!1),[m,x]=O.useState(!1),[y,v]=O.useState(!1),[b,w]=O.useState(null),[N,j]=O.useState(!1),k=O.useCallback(async($=!1)=>{try{v(!0),w(null);const F=await W5.getStructure(t,e,{includeBlocks:!0,includeProgress:$,userId:r==null?void 0:r.id});if(F.pages.length===0&&(r!=null&&r.id)&&!N){console.log("No pages found, auto-creating Page 1 (ONCE ONLY)"),j(!0);try{await new Promise(W=>setTimeout(W,100));const z=await W5.getStructure(t,e,{includeBlocks:!1,includeProgress:!1,userId:r.id});if(z.pages.length===0){console.log("Confirmed no pages exist, creating Page 1");const W=await YN.create({title:"Page 1",description:"",status:"draft",is_locked:!1,[t==="mission"?"mission_id":"course_id"]:e,order_index:0,unlock_conditions:{},page_config:{},created_by:r.id});F.pages=[W],console.log("Page 1 auto-created successfully:",W.id)}else console.log("Pages were created concurrently, using existing pages:",z.pages.length),F.pages=z.pages}catch(z){console.error("Failed to auto-create Page 1:",z)}finally{j(!1)}}i(F),F.pages.length>0&&!s&&(o(F.pages[0]),console.log("Set current page to:",F.pages[0].title))}catch(F){w(F instanceof Error?F.message:"Failed to load page structure")}finally{v(!1),j(!1)}},[t,e,r==null?void 0:r.id,N]),_=O.useCallback(async $=>{try{w(null);const F=await YN.create({...$,status:$.status||"draft",is_locked:$.is_locked||!1,[t==="mission"?"mission_id":"course_id"]:e,order_index:(n==null?void 0:n.pages.length)||0,unlock_conditions:{},page_config:{},created_by:(r==null?void 0:r.id)||""});return await k(),o(F),F}catch(F){throw w(F instanceof Error?F.message:"Failed to create page"),F}},[t,e,n==null?void 0:n.pages.length,r==null?void 0:r.id,k]),E=O.useCallback(async $=>{if(s)try{w(null);const F=await YN.update(s.id,$);return o(F),n&&i({...n,pages:n.pages.map(z=>z.id===s.id?F:z)}),F}catch(F){throw w(F instanceof Error?F.message:"Failed to update page"),F}},[s,n]),A=O.useCallback(async($,F={})=>{var z;if(!(!s||!(r!=null&&r.id)))try{w(null);const W=await Uf.create({page_id:s.id,block_type:$,order_index:((z=s.blocks)==null?void 0:z.length)||0,config:{},style:{},content:F,visibility_conditions:{},is_visible:!0,created_by:r.id}),K=[...s.blocks||[],W];return o({...s,blocks:K}),W}catch(W){throw w(W instanceof Error?W.message:"Failed to create block"),W}},[s,r==null?void 0:r.id]),T=O.useCallback(async($,F)=>{var z;if(s)try{w(null);const W=await Uf.update($,F),K=((z=s.blocks)==null?void 0:z.map(q=>q.id===$?W:q))||[];return o({...s,blocks:K}),(l==null?void 0:l.id)===$&&c(W),W}catch(W){throw w(W instanceof Error?W.message:"Failed to update block"),W}},[s,l]),M=O.useCallback(async $=>{var F;if(s)try{w(null),await Uf.delete($);const z=((F=s.blocks)==null?void 0:F.filter(W=>W.id!==$))||[];o({...s,blocks:z}),(l==null?void 0:l.id)===$&&c(null)}catch(z){throw w(z instanceof Error?z.message:"Failed to delete block"),z}},[s,l]),P=O.useCallback(async $=>{if(s)try{w(null),await Uf.reorder($);const F=$.map((z,W)=>{var q;const K=(q=s.blocks)==null?void 0:q.find(V=>V.id===z);return K?{...K,order_index:W}:null}).filter(Boolean);o({...s,blocks:F})}catch(F){throw w(F instanceof Error?F.message:"Failed to reorder blocks"),F}},[s]),R=O.useCallback($=>{o($),c(null)},[]),L=O.useCallback($=>{n!=null&&n.pages&&n.pages[$]&&R(n.pages[$])},[n==null?void 0:n.pages,R]);return O.useEffect(()=>{e&&k()},[e,k]),{structure:n,currentPage:s,selectedBlock:l,isEditing:u,isDragging:d,previewMode:m,loading:y,error:b,loadStructure:k,createPage:_,updatePage:E,navigateToPage:R,navigateToPageIndex:L,createBlock:A,updateBlock:T,deleteBlock:M,reorderBlocks:P,setSelectedBlock:c,setIsEditing:f,setIsDragging:p,setPreviewMode:x}}function A8(t,e){const{user:r}=Ln(),[n,i]=O.useState([]),[s,o]=O.useState(!1),[l,c]=O.useState(null),u=O.useCallback(async()=>{if(r!=null&&r.id)try{o(!0),c(null);const p=await H5.getUserProgress(r.id,t,e);i(p)}catch(p){c(p instanceof Error?p.message:"Failed to load progress")}finally{o(!1)}},[r==null?void 0:r.id,t,e]),f=O.useCallback(async p=>{if(r!=null&&r.id)try{c(null);const m=await H5.trackProgress({userId:r.id,[t==="mission"?"missionId":"courseId"]:e,...p});return i(x=>[m.progress,...x]),m}catch(m){throw c(m instanceof Error?m.message:"Failed to track progress"),m}},[r==null?void 0:r.id,t,e]),d=O.useMemo(()=>{const p=n.filter(w=>w.progress_type==="page_completed"),m=n.filter(w=>w.progress_type==="block_interacted"),x=n.filter(w=>w.progress_type==="quiz_completed"),y=n.reduce((w,N)=>w+N.time_spent_seconds,0),v=n.length>0?n.reduce((w,N)=>w+N.completion_percentage,0)/n.length:0,b=n.length>0?n.reduce((w,N)=>new Date(N.created_at)>new Date(w.created_at)?N:w):null;return{totalPages:new Set(n.map(w=>w.page_id).filter(Boolean)).size,completedPages:new Set(p.map(w=>w.page_id)).size,totalInteractions:m.length,completedQuizzes:x.length,totalTimeSpent:y,averageCompletion:Math.round(v*100)/100,lastActivity:b}},[n]);return O.useEffect(()=>{u()},[u]),{progress:n,progressMetrics:d,loading:s,error:l,loadProgress:u,trackProgress:f}}function fe({className:t,variant:e="default",size:r="default",children:n,...i}){const s={default:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 text-gray-700 focus:ring-gray-500",link:"bg-transparent underline text-blue-600 hover:text-blue-700"},o={default:"px-4 py-2 text-sm",sm:"px-3 py-1.5 text-sm",lg:"px-6 py-3 text-base"};return a.jsx("button",{className:ge("inline-flex items-center justify-center rounded-md font-medium transition-colors","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:pointer-events-none",s[e],o[r],t),...i,children:n})}const ct=Z.forwardRef(({className:t,...e},r)=>a.jsx("input",{ref:r,className:ge("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm","placeholder:text-gray-400","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","disabled:cursor-not-allowed disabled:opacity-50",t),...e}));ct.displayName="Input";function At({className:t,variant:e="default",children:r,...n}){const i={default:"bg-blue-100 text-blue-800 border-blue-200",secondary:"bg-gray-100 text-gray-800 border-gray-200",destructive:"bg-red-100 text-red-800 border-red-200",outline:"bg-transparent border-gray-300 text-gray-700"};return a.jsx("span",{className:ge("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border",i[e],t),...n,children:r})}function T8({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:s="Confirm",cancelText:o="Cancel",variant:l="default",isLoading:c=!1}){const u=async()=>{try{await r()}catch(f){console.error("Confirmation action failed:",f)}};return t?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:c?void 0:e}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${l==="destructive"?"bg-red-100":"bg-yellow-100"}`,children:a.jsx(Pl,{className:`w-5 h-5 ${l==="destructive"?"text-red-600":"text-yellow-600"}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n}),a.jsx("p",{className:"text-gray-600",children:i})]})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:e,disabled:c,children:o}),a.jsx(fe,{onClick:u,disabled:c,variant:l==="destructive"?"destructive":"default",className:"min-w-[100px]",children:c?a.jsx(i_,{className:"w-4 h-4 animate-spin"}):s})]})]})]}):null}function Yye(){const t=Ti(),{user:e}=Ln(),[r,n]=O.useState("wods"),[i,s]=O.useState(""),[o,l]=O.useState("all"),[c,u]=O.useState("closed"),[f,d]=O.useState(null),[p,m]=O.useState(!1);Z.useEffect(()=>{console.log("Modal state changed to:",c,"Selected item:",(f==null?void 0:f.title)||"none")},[c,f]);const{missions:x,loading:y,error:v,createMission:b,deleteMission:w}=Kye(),{courses:N,loading:j,error:k,createCourse:_,deleteCourse:E}=Gye(),A=r==="wods"?y:j,T=r==="wods"?v:k,P=(r==="wods"?x:N).filter(q=>{const V=q.title.toLowerCase().includes(i.toLowerCase())||(q.description||"").toLowerCase().includes(i.toLowerCase()),D=o==="all"||q.status===o;return V&&D}),R=async()=>{console.log("Create new clicked, creating directly and navigating to builder"),m(!0);try{if(r==="wods"){const q=await b({title:"Untitled WOD",description:"",status:"draft",thumbnail_url:"",estimated_duration_minutes:void 0,difficulty_level:void 0,tags:[],created_by:(e==null?void 0:e.id)||""});console.log("WOD created successfully:",q.id),t(`/training-zone/wods/${q.id}`)}else{const q=await _({title:"Untitled Block",description:"",status:"draft",thumbnail_url:"",estimated_duration_minutes:void 0,difficulty_level:void 0,tags:[],prerequisite_course_ids:[],created_by:(e==null?void 0:e.id)||""});console.log("Block created successfully:",q.id),t(`/training-zone/blocks/${q.id}`)}}catch(q){console.error("Failed to create new item:",q)}finally{m(!1)}},L=q=>{t(r==="wods"?`/training-zone/wods/${q.id}`:`/training-zone/blocks/${q.id}`)},$=q=>{console.log("Edit clicked for:",q.title,"Navigating directly to builder"),t(r==="wods"?`/training-zone/wods/${q.id}`:`/training-zone/blocks/${q.id}`)},F=q=>{console.log("Delete clicked for:",q.title,"Setting modal state to delete"),d(q),u("delete")},z=async()=>{if(!f)return;m(!0);const q=new AbortController,V=setTimeout(()=>{q.abort(),m(!1),console.error("Delete operation timed out")},15e3);try{r==="wods"?await w(f.id):await E(f.id),clearTimeout(V),u("closed"),d(null)}catch(D){clearTimeout(V),console.error("Failed to delete:",D)}finally{m(!1)}},W=q=>{switch(q){case"published":return"default";case"draft":return"secondary";case"archived":return"outline";default:return"secondary"}},K=q=>{switch(q){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return a.jsxs(pr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Training Zone"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage WODs (Workouts of the Day), Blocks, and Programs"})]}),a.jsx("div",{className:"flex items-center space-x-3",children:a.jsxs(fe,{onClick:R,className:"flex items-center space-x-2",children:[a.jsx(Vt,{className:"w-4 h-4"}),a.jsxs("span",{children:["Create ",r==="wods"?"WOD":"Block"]})]})})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsx("button",{onClick:()=>n("wods"),className:ge("py-2 px-1 border-b-2 font-medium text-sm transition-colors",r==="wods"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Bw,{className:"w-4 h-4"}),a.jsx("span",{children:"WODs"}),a.jsx(At,{variant:"outline",className:"ml-1",children:x.length})]})}),a.jsx("button",{onClick:()=>n("blocks"),className:ge("py-2 px-1 border-b-2 font-medium text-sm transition-colors",r==="blocks"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Zn,{className:"w-4 h-4"}),a.jsx("span",{children:"Blocks"}),a.jsx(At,{variant:"outline",className:"ml-1",children:N.length})]})}),a.jsx("button",{onClick:()=>n("programs"),className:ge("py-2 px-1 border-b-2 font-medium text-sm transition-colors",r==="programs"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Fl,{className:"w-4 h-4"}),a.jsx("span",{children:"Programs"}),a.jsx(At,{variant:"outline",className:"ml-1",children:"0"})]})})]})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"flex-1 max-w-md",children:a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx(ct,{type:"text",placeholder:`Search ${r}...`,value:i,onChange:q=>s(q.target.value),className:"pl-10"})]})}),a.jsxs("select",{value:o,onChange:q=>l(q.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"published",children:"Published"}),a.jsx("option",{value:"archived",children:"Archived"})]})]}),A?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):T?a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:a.jsxs("p",{className:"text-red-800",children:["Error: ",T]})}):P.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:r==="wods"?a.jsx(Bw,{className:"w-12 h-12 mx-auto"}):a.jsx(Zn,{className:"w-12 h-12 mx-auto"})}),a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",r," found"]}),a.jsx("p",{className:"text-gray-500 mb-6",children:i||o!=="all"?`No ${r} match your search criteria.`:`Get started by creating your first ${r==="wods"?"WOD":"block"}.`}),!i&&o==="all"&&a.jsxs(fe,{onClick:R,children:[a.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Create ",r==="wods"?"WOD":"Block"]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(q=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg hover:shadow-lg transition-shadow group relative",children:[a.jsxs("div",{className:"absolute top-4 right-4 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[a.jsx(fe,{variant:"outline",size:"sm",onClick:V=>{V.stopPropagation(),$(q)},className:"w-8 h-8 p-0",children:a.jsx(yo,{className:"w-3 h-3"})}),a.jsx(fe,{variant:"outline",size:"sm",onClick:V=>{V.stopPropagation(),F(q)},className:"w-8 h-8 p-0 text-red-600 border-red-200 hover:bg-red-50",children:a.jsx(ns,{className:"w-3 h-3"})})]}),a.jsxs("div",{onClick:()=>L(q),className:"p-6 cursor-pointer",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[r==="wods"?a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Bw,{className:"w-4 h-4 text-blue-600"})}):a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Zn,{className:"w-4 h-4 text-green-600"})}),a.jsx(At,{variant:W(q.status),children:q.status})]}),q.thumbnail_url&&a.jsx("img",{src:q.thumbnail_url,alt:"Thumbnail",className:"w-12 h-12 rounded-lg object-cover"})]}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:q.title}),q.description&&a.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:q.description}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[q.difficulty_level&&a.jsx("span",{className:ge("px-2 py-1 rounded-full text-xs font-medium",K(q.difficulty_level)),children:q.difficulty_level}),q.estimated_duration_minutes&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Fl,{className:"w-3 h-3"}),a.jsxs("span",{children:[q.estimated_duration_minutes,"min"]})]})]}),a.jsx("span",{className:"text-xs",children:new Date(q.updated_at).toLocaleDateString()})]})]})]},q.id))})]}),a.jsx(T8,{isOpen:c==="delete",onClose:()=>{u("closed"),d(null)},onConfirm:z,title:`Delete ${r==="wods"?"WOD":"Block"}`,message:`Are you sure you want to delete "${f==null?void 0:f.title}"? This action cannot be undone.`,confirmText:"Delete",variant:"destructive",isLoading:p})]})}const Xye={section_header:{type:"section_header",label:"Section Header",icon:"Heading",category:"foundational",description:"Create section headers with different levels",defaultContent:{title:"Section Title",level:2},defaultConfig:{},defaultStyle:{marginBottom:"1rem"},isInteractive:!1},rich_text:{type:"rich_text",label:"Rich Text",icon:"Type",category:"foundational",description:"Rich text editor with formatting options",defaultContent:{html:"<p>Enter your text here...</p>",text:"Enter your text here..."},defaultConfig:{},defaultStyle:{},isInteractive:!1},image:{type:"image",label:"Image",icon:"Image",category:"foundational",description:"Add images with captions",defaultContent:{src:"",alt:"Image",caption:""},defaultConfig:{},defaultStyle:{},isInteractive:!1},list:{type:"list",label:"List",icon:"List",category:"foundational",description:"Create ordered or unordered lists",defaultContent:{type:"unordered",items:[{id:"1",text:"First item"}]},defaultConfig:{},defaultStyle:{},isInteractive:!1},quote:{type:"quote",label:"Quote",icon:"Quote",category:"foundational",description:"Add inspirational quotes",defaultContent:{text:"Quote text",author:"",source:""},defaultConfig:{},defaultStyle:{},isInteractive:!1},divider:{type:"divider",label:"Divider",icon:"Minus",category:"foundational",description:"Add visual dividers between content",defaultContent:{},defaultConfig:{},defaultStyle:{margin:"2rem 0"},isInteractive:!1},video:{type:"video",label:"Video",icon:"Play",category:"embedded",description:"Embed videos with progress tracking",defaultContent:{url:"",controls:!0,autoplay:!1},defaultConfig:{},defaultStyle:{},isInteractive:!0},agent:{type:"agent",label:"AI Agent",icon:"Bot",category:"embedded",description:"Interactive AI agent conversations",defaultContent:{agent_id:"",agent_name:"AI Assistant",initial_message:"Hello! How can I help you?"},defaultConfig:{},defaultStyle:{},isInteractive:!0},document:{type:"document",label:"Document",icon:"FileText",category:"embedded",description:"Embed documents and guides",defaultContent:{document_id:"",title:"Document",display_mode:"embedded"},defaultConfig:{},defaultStyle:{},isInteractive:!0},prompt:{type:"prompt",label:"Prompt",icon:"MessageSquare",category:"embedded",description:"Reusable prompt templates",defaultContent:{prompt_id:"",title:"Prompt",show_copy_button:!0},defaultConfig:{},defaultStyle:{},isInteractive:!0},automation:{type:"automation",label:"Automation",icon:"Zap",category:"embedded",description:"Embed automation workflows and tools",defaultContent:{automation_id:"",automation_name:"Automation",display_mode:"embedded"},defaultConfig:{},defaultStyle:{},isInteractive:!0},quiz:{type:"quiz",label:"Quiz",icon:"HelpCircle",category:"interactive",description:"Create interactive quizzes",defaultContent:{title:"Quiz",questions:[{id:"1",question:"Sample question?",type:"multiple_choice",options:["Option 1","Option 2"],correct_answer:"Option 1",points:1}]},defaultConfig:{},defaultStyle:{},isInteractive:!0},user_submission:{type:"user_submission",label:"User Submission",icon:"Upload",category:"interactive",description:"Collect user submissions and files",defaultContent:{title:"Submit Your Work",submission_type:"text",instructions:"Please provide your submission below"},defaultConfig:{},defaultStyle:{},isInteractive:!0},accordion:{type:"accordion",label:"Accordion",icon:"ChevronDown",category:"interactive",description:"Collapsible content sections",defaultContent:{items:[{id:"1",title:"Section 1",content:"Content for section 1",is_open_by_default:!1}],allow_multiple_open:!0},defaultConfig:{},defaultStyle:{},isInteractive:!0}};var XN={exports:{}},JN={};/**
`)}}Kl.empty=new Kl(!0);class nve{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function z8(t){let e=[];do e.push(ive(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function ive(t){let e=[];do e.push(sve(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function sve(t){let e=lve(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=ove(t,e);else break;return e}function Y5(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function ove(t,e){let r=Y5(t),n=r;return t.eat(",")&&(t.next!="}"?n=Y5(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function ave(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let s in r){let o=r[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function lve(t){if(t.eat("(")){let e=z8(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=ave(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function cve(t){let e=[[]];return i(s(t,0),r()),e;function r(){return e.push([])-1}function n(o,l,c){let u={term:c,to:l};return e[o].push(u),u}function i(o,l){o.forEach(c=>c.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((c,u)=>c.concat(s(u,l)),[]);if(o.type=="seq")for(let c=0;;c++){let u=s(o.exprs[c],l);if(c==o.exprs.length-1)return u;i(u,l=r())}else if(o.type=="star"){let c=r();return n(l,c),i(s(o.expr,c),c),[n(c)]}else if(o.type=="plus"){let c=r();return i(s(o.expr,l),c),i(s(o.expr,c),c),[n(c)]}else{if(o.type=="opt")return[n(l)].concat(s(o.expr,l));if(o.type=="range"){let c=l;for(let u=0;u<o.min;u++){let f=r();i(s(o.expr,c),f),c=f}if(o.max==-1)i(s(o.expr,c),c);else for(let u=o.min;u<o.max;u++){let f=r();n(c,f),i(s(o.expr,c),f),c=f}return[n(c)]}else{if(o.type=="name")return[n(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function U8(t,e){return e-t}function X5(t,e){let r=[];return n(e),r.sort(U8);function n(i){let s=t[i];if(s.length==1&&!s[0].term)return n(s[0].to);r.push(i);for(let o=0;o<s.length;o++){let{term:l,to:c}=s[o];!l&&r.indexOf(c)==-1&&n(c)}}}function uve(t){let e=Object.create(null);return r(X5(t,0));function r(n){let i=[];n.forEach(o=>{t[o].forEach(({term:l,to:c})=>{if(!l)return;let u;for(let f=0;f<i.length;f++)i[f][0]==l&&(u=i[f][1]);X5(t,c).forEach(f=>{u||i.push([l,u=[]]),u.indexOf(f)==-1&&u.push(f)})})});let s=e[n.join(",")]=new Kl(n.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(U8);s.next.push({type:i[o][0],next:e[l.join(",")]||r(l)})}return s}}function dve(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:c,next:u}=i.next[l];o.push(c.name),s&&!(c.isText||c.hasRequiredAttrs())&&(s=!1),n.indexOf(u)==-1&&n.push(u)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function H8(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function W8(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let s=t[n];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function V8(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function K8(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new hve(t,n,e[n]);return r}let J5=class G8{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=K8(e,n.attrs),this.defaultAttrs=H8(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Kl.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:W8(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Na(this,this.computeAttrs(e),Ne.from(r),Tt.setFrom(n))}createChecked(e=null,r,n){return r=Ne.from(r),this.checkContent(r),new Na(this,this.computeAttrs(e),r,Tt.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=Ne.from(r),r.size){let o=this.contentMatch.fillBefore(r);if(!o)return null;r=o.append(r)}let i=this.contentMatch.matchFragment(r),s=i&&i.fillBefore(Ne.empty,!0);return s?new Na(this,e,r.append(s),Tt.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){V8(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:Tt.none:e}static compile(e,r){let n=Object.create(null);e.forEach((s,o)=>n[s]=new G8(s,r,o));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function fve(t,e,r){let n=r.split("|");return i=>{let s=i===null?"null":typeof i;if(n.indexOf(s)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${s}`)}}class hve{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?fve(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class mx{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=K8(e,i.attrs),this.excluded=null;let s=H8(this.attrs);this.instance=s?new Tt(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Tt(this,W8(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((s,o)=>n[s]=new mx(s,i++,r,o)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){V8(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Y8{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=Hr.from(e.nodes),r.marks=Hr.from(e.marks||{}),this.nodes=J5.compile(this.spec.nodes,this),this.marks=mx.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=n[o]||(n[o]=Kl.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?Q5(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Q5(this,o.split(" "))}this.nodeFromJSON=i=>Na.fromJSON(this,i),this.markFromJSON=i=>Tt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof J5){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new Nv(n,n.defaultAttrs,e,Tt.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function Q5(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],s=t.marks[i],o=s;if(s)r.push(s);else for(let l in t.marks){let c=t.marks[l];(i=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(i)>-1)&&r.push(o=c)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function pve(t){return t.tag!=null}function mve(t){return t.style!=null}class ka{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(pve(i))this.tags.push(i);else if(mve(i)){let s=/[^=]*/.exec(i.style)[0];n.indexOf(s)<0&&n.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,r={}){let n=new e$(this,r,!1);return n.addAll(e,Tt.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new e$(this,r,!0);return n.addAll(e,Tt.none,r.from,r.to),Ie.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(vve(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||r.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,r,n,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!n.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=r))){if(o.getAttrs){let c=o.getAttrs(r);if(c===!1)continue;o.attrs=c||void 0}return o}}}static schemaRules(e){let r=[];function n(i){let s=i.priority==null?50:i.priority,o=0;for(;o<r.length;o++){let l=r[o];if((l.priority==null?50:l.priority)<s)break}r.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{n(o=t$(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{n(o=t$(o)),o.node||o.ignore||o.mark||(o.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ka(e,ka.schemaRules(e)))}}const X8={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},gve={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},J8={ol:!0,ul:!0},cp=1,M2=2,ey=4;function Z5(t,e,r){return e!=null?(e?cp:0)|(e==="full"?M2:0):t&&t.whitespace=="pre"?cp|M2:r&-5}class Pg{constructor(e,r,n,i,s,o){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=o,this.content=[],this.activeMarks=Tt.none,this.match=s||(o&ey?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ne.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&cp)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let r=Ne.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(Ne.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!X8.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class e${constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,s,o=Z5(null,r.preserveWhitespace,0)|(n?ey:0);i?s=new Pg(i.type,i.attrs,Tt.none,!0,r.topMatch||i.type.contentMatch,o):n?s=new Pg(null,null,Tt.none,!0,null,o):s=new Pg(e.schema.topNodeType,null,Tt.none,!0,null,o),this.nodes=[s],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,s=i.options&M2?"full":this.localPreserveWS||(i.options&cp)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(s)s!=="full"?n=n.replace(/\r?\n|\r/g," "):n=n.replace(/\r\n?/g,`
`))),0,0):Ie.empty;let d=t.someProp("clipboardTextParser",p=>p(e,i,n,t));if(d)l=d;else{let p=i.marks(),{schema:m}=t.state,x=uc.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let v=o.appendChild(document.createElement("p"));y&&v.appendChild(x.serializeNode(m.text(y,p)))})}}else t.someProp("transformPastedHTML",d=>{r=d(r,t)}),o=B0e(r),Wp&&F0e(o);let u=o&&o.querySelector("[data-pm-slice]"),f=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(f&&f[3])for(let d=+f[3];d>0;d--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||ka.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(c||f),context:i,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!D0e.test(p.parentNode.nodeName)?{ignore:!0}:null}})),f)l=q0e(R$(l,+f[1],+f[2]),f[4]);else if(l=Ie.maxOpen(L0e(l.content,i),!0),l.openStart||l.openEnd){let d=0,p=0;for(let m=l.content.firstChild;d<l.openStart&&!m.type.spec.isolating;d++,m=m.firstChild);for(let m=l.content.lastChild;p<l.openEnd&&!m.type.spec.isolating;p++,m=m.lastChild);l=R$(l,d,p)}return t.someProp("transformPasted",d=>{l=d(l,t)}),l}const D0e=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function L0e(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),s,o=[];if(t.forEach(l=>{if(!o)return;let c=i.findWrapping(l.type),u;if(!c)return o=null;if(u=o.length&&s.length&&MU(c,s,l,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=RU(o[o.length-1],s.length));let f=PU(l,c);o.push(f),i=i.matchType(f.type),s=c}}),o)return Ne.from(o)}return t}function PU(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,Ne.from(t));return t}function MU(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=MU(t,e,r,n.lastChild,i+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(Ne.from(PU(r,t,i+1))))}}function RU(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,RU(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(Ne.empty,!0);return t.copy(r.append(n))}function H2(t,e,r,n,i,s){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(s=0),i<n-1&&(l=H2(l,e,r,n,i+1,s)),i>=r&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(Ne.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function R$(t,e,r){return e<t.openStart&&(t=new Ie(H2(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new Ie(H2(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const IU={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let I$=null;function DU(){return I$||(I$=document.implementation.createHTMLDocument("title"))}let lk=null;function $0e(t){let e=window.trustedTypes;return e?(lk||(lk=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),lk.createHTML(t)):t}function B0e(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=DU().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&IU[n[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),r.innerHTML=$0e(t),i)for(let s=0;s<i.length;s++)r=r.querySelector(i[s])||r;return r}function F0e(t){let e=t.querySelectorAll(an?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==" "&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function q0e(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let l=n.length-2;l>=0;l-=2){let c=r.nodes[n[l]];if(!c||c.hasRequiredAttrs())break;i=Ne.from(c.create(n[l+1],i)),s++,o++}return new Ie(i,s,o)}const wn={},jn={},z0e={touchstart:!0,touchmove:!0};class U0e{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function H0e(t){for(let e in wn){let r=wn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{V0e(t,n)&&!JE(t,n)&&(t.editable||!(n.type in jn))&&r(t,n)},z0e[e]?{passive:!0}:void 0)}bn&&t.dom.addEventListener("input",()=>null),W2(t)}function ba(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function W0e(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function W2(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>JE(t,n))})}function JE(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function V0e(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function K0e(t,e){!JE(t,e)&&wn[e.type]&&(t.editable||!(e.type in jn))&&wn[e.type](t,e)}jn.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!$U(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ao&&an&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),rd&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,Sl(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||I0e(t,r)?r.preventDefault():ba(t,"key")};jn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};jn.keypress=(t,e)=>{let r=e;if($U(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||ji&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof et)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),s=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,n.$from.pos,n.$to.pos,i,s))&&t.dispatch(s()),r.preventDefault()}};function wx(t){return{left:t.clientX,top:t.clientY}}function G0e(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function QE(t,e,r,n,i){if(n==-1)return!1;let s=t.state.doc.resolve(n);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,l=>o>s.depth?l(t,r,s.nodeAfter,s.before(o),i,!0):l(t,r,s.node(o),s.before(o),i,!1)))return!0;return!1}function ju(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);n.setMeta("pointer",!0),t.dispatch(n)}function Y0e(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&He.isSelectable(n)?(ju(t,new He(r)),!0):!1}function X0e(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof He&&(n=r.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(He.isSelectable(l)){n&&r.$from.depth>0&&o>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?i=s.before(r.$from.depth):i=s.before(o);break}}return i!=null?(ju(t,He.create(t.state.doc,i)),!0):!1}function J0e(t,e,r,n,i){return QE(t,"handleClickOn",e,r,n)||t.someProp("handleClick",s=>s(t,e,n))||(i?X0e(t,r):Y0e(t,r))}function Q0e(t,e,r,n){return QE(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function Z0e(t,e,r,n){return QE(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||exe(t,r,n)}function exe(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(ju(t,et.create(n,0,n.content.size)),!0):!1;let i=n.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)ju(t,et.create(n,l+1,l+1+o.content.size));else if(He.isSelectable(o))ju(t,He.create(n,l));else continue;return!0}}function ZE(t){return Ov(t)}const LU=ji?"metaKey":"ctrlKey";wn.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=ZE(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&G0e(r,t.input.lastClick)&&!r[LU]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:s,button:r.button};let o=t.posAtCoords(wx(r));o&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new txe(t,o,r,!!n)):(s=="doubleClick"?Q0e:Z0e)(t,o.pos,o.inside,r)?r.preventDefault():ba(t,"pointer"))};class txe{constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[LU],this.allowDefault=n.shiftKey;let s,o;if(r.inside>-1)s=e.state.doc.nodeAt(r.inside),o=r.inside;else{let f=e.state.doc.resolve(r.pos);s=f.parent,o=f.depth?f.before():0}const l=i?null:n.target,c=l?e.docView.nearestDesc(l,!0):null;this.target=c&&c.dom.nodeType==1?c.dom:null;let{selection:u}=e.state;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof He&&u.from<=o&&u.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&is&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ba(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>po(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(wx(e))),this.updateAllowDefault(e),this.allowDefault||!r?ba(this.view,"pointer"):J0e(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||bn&&this.mightDrag&&!this.mightDrag.node.isAtom||an&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(ju(this.view,ot.near(this.view.state.doc.resolve(r.pos))),e.preventDefault()):ba(this.view,"pointer")}move(e){this.updateAllowDefault(e),ba(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}wn.touchstart=t=>{t.input.lastTouch=Date.now(),ZE(t),ba(t,"pointer")};wn.touchmove=t=>{t.input.lastTouch=Date.now(),ba(t,"pointer")};wn.contextmenu=t=>ZE(t);function $U(t,e){return t.composing?!0:bn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const rxe=ao?5e3:-1;jn.compositionstart=jn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof et&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||r.marks(),Ov(t,!0),t.markCursor=null;else if(Ov(t,!e.selection.empty),is&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,s=n.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}BU(t,rxe)};jn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,BU(t,20))};function BU(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Ov(t),e))}function FU(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=ixe());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function nxe(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=Yve(e.focusNode,e.focusOffset),n=Xve(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(r==s||n==s)return s;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let o=r.pmViewDesc;if(!(!o||!o.isText(r.nodeValue)))return n}}return r||n}function ixe(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Ov(t,e=!1){if(!(ao&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),FU(t),e||t.docView&&t.docView.dirty){let r=GE(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function sxe(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const fp=Rn&&_a<15||rd&&t0e<604;wn.copy=jn.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let s=fp?null:r.clipboardData,o=n.content(),{dom:l,text:c}=XE(t,o);s?(r.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",c)):sxe(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function oxe(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function axe(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?hp(t,n.value,null,i,e):hp(t,n.textContent,n.innerHTML,i,e)},50)}function hp(t,e,r,n,i){let s=TU(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",c=>c(t,i,s||Ie.empty)))return!0;if(!s)return!1;let o=oxe(s),l=o?t.state.tr.replaceSelectionWith(o,n):t.state.tr.replaceSelection(s);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function qU(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}jn.paste=(t,e)=>{let r=e;if(t.composing&&!ao)return;let n=fp?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&hp(t,qU(n),n.getData("text/html"),i,r)?r.preventDefault():axe(t,r)};class zU{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const lxe=ji?"altKey":"ctrlKey";function UU(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[lxe]}wn.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(wx(r)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof He?i.to-1:i.to))){if(n&&n.mightDrag)o=He.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let d=t.docView.nearestDesc(r.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(o=He.create(t.state.doc,d.posBefore))}}let l=(o||t.state.selection).content(),{dom:c,text:u,slice:f}=XE(t,l);(!r.dataTransfer.files.length||!an||mU>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(fp?"Text":"text/html",c.innerHTML),r.dataTransfer.effectAllowed="copyMove",fp||r.dataTransfer.setData("text/plain",u),t.dragging=new zU(f,UU(t,r),o)};wn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};jn.dragover=jn.dragenter=(t,e)=>e.preventDefault();jn.drop=(t,e)=>{let r=e,n=t.dragging;if(t.dragging=null,!r.dataTransfer)return;let i=t.posAtCoords(wx(r));if(!i)return;let s=t.state.doc.resolve(i.pos),o=n&&n.slice;o?t.someProp("transformPasted",x=>{o=x(o,t)}):o=TU(t,qU(r.dataTransfer),fp?null:r.dataTransfer.getData("text/html"),!1,s);let l=!!(n&&UU(t,r));if(t.someProp("handleDrop",x=>x(t,r,o||Ie.empty,l))){r.preventDefault();return}if(!o)return;r.preventDefault();let c=o?oU(t.state.doc,s.pos,o):s.pos;c==null&&(c=s.pos);let u=t.state.tr;if(l){let{node:x}=n;x?x.replace(u):u.deleteSelection()}let f=u.mapping.map(c),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=u.doc;if(d?u.replaceRangeWith(f,f,o.content.firstChild):u.replaceRange(f,f,o),u.doc.eq(p))return;let m=u.doc.resolve(f);if(d&&He.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new He(m));else{let x=u.mapping.map(c);u.mapping.maps[u.mapping.maps.length-1].forEach((y,v,b,w)=>x=w),u.setSelection(YE(t,m,u.doc.resolve(x)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};wn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&po(t)},20))};wn.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};wn.beforeinput=(t,e)=>{if(an&&ao&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Sl(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in jn)wn[t]=jn[t];function pp(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class Ev{constructor(e,r){this.toDOM=e,this.spec=r||Ll,this.side=this.spec.side||0}map(e,r,n,i){let{pos:s,deleted:o}=e.mapResult(r.from+i,this.side<0?-1:1);return o?null:new vn(s-n,s-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Ev&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&pp(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ea{constructor(e,r){this.attrs=e,this.spec=r||Ll}map(e,r,n,i){let s=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,o=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return s>=o?null:new vn(s,o,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof Ea&&pp(this.attrs,e.attrs)&&pp(this.spec,e.spec)}static is(e){return e.type instanceof Ea}destroy(){}}class eC{constructor(e,r){this.attrs=e,this.spec=r||Ll}map(e,r,n,i){let s=e.mapResult(r.from+i,1);if(s.deleted)return null;let o=e.mapResult(r.to+i,-1);return o.deleted||o.pos<=s.pos?null:new vn(s.pos-n,o.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),s;return i==r.from&&!(s=e.child(n)).isText&&i+s.nodeSize==r.to}eq(e){return this==e||e instanceof eC&&pp(this.attrs,e.attrs)&&pp(this.spec,e.spec)}destroy(){}}class vn{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new vn(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new vn(e,e,new Ev(r,n))}static inline(e,r,n,i){return new vn(e,r,new Ea(n,i))}static node(e,r,n,i){return new vn(e,r,new eC(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ea}get widget(){return this.type instanceof Ev}}const ou=[],Ll={};class Qt{constructor(e,r){this.local=e.length?e:ou,this.children=r.length?r:ou}static create(e,r){return r.length?Cv(r,e,0,Ll):sn}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=r&&l.to>=e&&(!s||s(l.spec))&&n.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<r&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,r-l,n,i+l,s)}}map(e,r,n){return this==sn||e.maps.length==0?this:this.mapInner(e,r,0,0,n||Ll)}mapInner(e,r,n,i,s){let o;for(let l=0;l<this.local.length;l++){let c=this.local[l].map(e,n,i);c&&c.type.valid(r,c)?(o||(o=[])).push(c):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?cxe(this.children,o||[],e,r,n,i,s):o?new Qt(o.sort($l),ou):sn}add(e,r){return r.length?this==sn?Qt.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,s=0;e.forEach((l,c)=>{let u=c+n,f;if(f=WU(r,l,u)){for(i||(i=this.children.slice());s<i.length&&i[s]<c;)s+=3;i[s]==c?i[s+2]=i[s+2].addInner(l,f,u+1):i.splice(s,0,c,c+l.nodeSize,Cv(f,l,u+1,Ll)),s+=3}});let o=HU(s?VU(r):r,-n);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Qt(o.length?this.local.concat(o).sort($l):this.local,i||this.children)}remove(e){return e.length==0||this==sn?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let s=0;s<n.length;s+=3){let o,l=n[s]+r,c=n[s+1]+r;for(let f=0,d;f<e.length;f++)(d=e[f])&&d.from>l&&d.to<c&&(e[f]=null,(o||(o=[])).push(d));if(!o)continue;n==this.children&&(n=this.children.slice());let u=n[s+2].removeInner(o,l+1);u!=sn?n[s+2]=u:(n.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,r)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new Qt(i,n):sn}forChild(e,r){if(this==sn)return this;if(r.isLeaf)return Qt.empty;let n,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(n=this.children[l+2]);break}let s=e+1,o=s+r.content.size;for(let l=0;l<this.local.length;l++){let c=this.local[l];if(c.from<o&&c.to>s&&c.type instanceof Ea){let u=Math.max(s,c.from)-s,f=Math.min(o,c.to)-s;u<f&&(i||(i=[])).push(c.copy(u,f))}}if(i){let l=new Qt(i.sort($l),ou);return n?new pa([l,n]):l}return n||sn}eq(e){if(this==e)return!0;if(!(e instanceof Qt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return tC(this.localsInner(e))}localsInner(e){if(this==sn)return ou;if(e.inlineContent||!this.local.some(Ea.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Ea||r.push(this.local[n]);return r}forEachSet(e){e(this)}}Qt.empty=new Qt([],[]);Qt.removeOverlap=tC;const sn=Qt.empty;class pa{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,Ll));return pa.from(n)}forChild(e,r){if(r.isLeaf)return Qt.empty;let n=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,r);s!=sn&&(s instanceof pa?n=n.concat(s.members):n.push(s))}return pa.from(n)}eq(e){if(!(e instanceof pa)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!r)r=s;else{n&&(r=r.slice(),n=!1);for(let o=0;o<s.length;o++)r.push(s[o])}}return r?tC(n?r:r.sort($l)):ou}static from(e){switch(e.length){case 0:return sn;case 1:return e[0];default:return new pa(e.every(r=>r instanceof Qt)?e:e.reduce((r,n)=>r.concat(n instanceof Qt?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function cxe(t,e,r,n,i,s,o){let l=t.slice();for(let u=0,f=s;u<r.maps.length;u++){let d=0;r.maps[u].forEach((p,m,x,y)=>{let v=y-x-(m-p);for(let b=0;b<l.length;b+=3){let w=l[b+1];if(w<0||p>w+f-d)continue;let N=l[b]+f-d;m>=N?l[b+1]=p<=N?-2:-1:p>=f&&v&&(l[b]+=v,l[b+1]+=v)}d+=v}),f=r.maps[u].map(f,-1)}let c=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){c=!0,l[u+1]=-1;continue}let f=r.map(t[u]+s),d=f-i;if(d<0||d>=n.content.size){c=!0;continue}let p=r.map(t[u+1]+s,-1),m=p-i,{index:x,offset:y}=n.content.findIndex(d),v=n.maybeChild(x);if(v&&y==d&&y+v.nodeSize==m){let b=l[u+2].mapInner(r,v,f+1,t[u]+s+1,o);b!=sn?(l[u]=d,l[u+1]=m,l[u+2]=b):(l[u+1]=-2,c=!0)}else c=!0}if(c){let u=uxe(l,t,e,r,i,s,o),f=Cv(u,n,0,o);e=f.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,p=0;d<f.children.length;d+=3){let m=f.children[d];for(;p<l.length&&l[p]<m;)p+=3;l.splice(p,0,f.children[d],f.children[d+1],f.children[d+2])}}return new Qt(e.sort($l),l)}function HU(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new vn(i.from+e,i.to+e,i.type))}return r}function uxe(t,e,r,n,i,s,o){function l(c,u){for(let f=0;f<c.local.length;f++){let d=c.local[f].map(n,i,u);d?r.push(d):o.onRemove&&o.onRemove(c.local[f].spec)}for(let f=0;f<c.children.length;f+=3)l(c.children[f+2],c.children[f]+u+1)}for(let c=0;c<t.length;c+=3)t[c+1]==-1&&l(t[c+2],e[c]+s+1);return r}function WU(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>r&&o.to<n&&((i||(i=[])).push(o),t[s]=null);return i}function VU(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function Cv(t,e,r,n){let i=[],s=!1;e.forEach((l,c)=>{let u=WU(t,l,c+r);if(u){s=!0;let f=Cv(u,l,r+c+1,n);f!=sn&&i.push(c,c+l.nodeSize,f)}});let o=HU(s?VU(t):t,-r).sort($l);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(n.onRemove&&n.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Qt(o,i):sn}function $l(t,e){return t.from-e.from||t.to-e.to}function tC(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let s=e[i];if(s.from==n.from){s.to!=n.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,n.to),D$(e,i+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,s.from),D$(e,i,n.copy(s.from,n.to)));break}}}return e}function D$(t,e,r){for(;e<t.length&&$l(r,t[e])>0;)e++;t.splice(e,0,r)}function ck(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=sn&&e.push(n)}),t.cursorWrapper&&e.push(Qt.create(t.state.doc,[t.cursorWrapper.deco])),pa.from(e)}const dxe={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},fxe=Rn&&_a<=11;class hxe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class pxe{constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new hxe,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);Rn&&_a<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),fxe&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,dxe)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(E$(this.view)){if(this.suppressingSelectionUpdates)return po(this.view);if(Rn&&_a<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Yl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let s=e.focusNode;s;s=td(s))r.add(s);for(let s=e.anchorNode;s;s=td(s))if(r.has(s)){n=s;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&E$(e)&&!this.ignoreSelectionChange(n),s=-1,o=-1,l=!1,c=[];if(e.editable)for(let f=0;f<r.length;f++){let d=this.registerMutation(r[f],c);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(l=!0))}if(is&&c.length){let f=c.filter(d=>d.nodeName=="BR");if(f.length==2){let[d,p]=f;d.parentNode&&d.parentNode.parentNode==p.parentNode?p.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let p of f){let m=p.parentNode;m&&m.nodeName=="LI"&&(!d||yxe(e,d)!=m)&&p.remove()}}}let u=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&xx(n)&&(u=GE(e))&&u.eq(ot.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,po(e),this.currentSelection.set(n),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),mxe(e)),this.handleDOMChange(s,o,l,c),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||po(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let f=0;f<e.addedNodes.length;f++){let d=e.addedNodes[f];r.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Rn&&_a<=11&&e.addedNodes.length)for(let f=0;f<e.addedNodes.length;f++){let{previousSibling:d,nextSibling:p}=e.addedNodes[f];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(s=p)}let o=i&&i.parentNode==e.target?Wr(i)+1:0,l=n.localPosFromDOM(e.target,o,-1),c=s&&s.parentNode==e.target?Wr(s):e.target.childNodes.length,u=n.localPosFromDOM(e.target,c,1);return{from:l,to:u}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let L$=new WeakMap,$$=!1;function mxe(t){if(!L$.has(t)&&(L$.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=is,$$)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),$$=!0}}function B$(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Yl(o.node,o.offset,i,s)&&([r,n,i,s]=[i,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}}function gxe(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return B$(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?B$(t,r):null}function yxe(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function vxe(t,e,r){let{node:n,fromOffset:i,toOffset:s,from:o,to:l}=t.docView.parseRange(e,r),c=t.domSelectionRange(),u,f=c.anchorNode;if(f&&t.dom.contains(f.nodeType==1?f:f.parentNode)&&(u=[{node:f,offset:c.anchorOffset}],xx(c)||u.push({node:c.focusNode,offset:c.focusOffset})),an&&t.input.lastKeyCode===8)for(let v=s;v>i;v--){let b=n.childNodes[v-1],w=b.pmViewDesc;if(b.nodeName=="BR"&&!w){s=v;break}if(!w||w.size)break}let d=t.state.doc,p=t.someProp("domParser")||ka.fromSchema(t.state.schema),m=d.resolve(o),x=null,y=p.parse(n,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:i,to:s,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:xxe,context:m});if(u&&u[0].pos!=null){let v=u[0].pos,b=u[1]&&u[1].pos;b==null&&(b=v),x={anchor:v+o,head:b+o}}return{doc:y,sel:x,from:o,to:l}}function xxe(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(bn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||bn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const bxe=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function wxe(t,e,r,n,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let A=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,T=GE(t,A);if(T&&!t.state.selection.eq(T)){if(an&&ao&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",P=>P(t,Sl(13,"Enter"))))return;let M=t.state.tr.setSelection(T);A=="pointer"?M.setMeta("pointer",!0):A=="key"&&M.scrollIntoView(),s&&M.setMeta("composition",s),t.dispatch(M)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(r);e=o.before(l+1),r=t.state.doc.resolve(r).after(l+1);let c=t.state.selection,u=vxe(t,e,r),f=t.state.doc,d=f.slice(u.from,u.to),p,m;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(p=t.state.selection.to,m="end"):(p=t.state.selection.from,m="start"),t.input.lastKeyCode=null;let x=Nxe(d.content,u.doc.content,u.from,p,m);if(x&&t.input.domChangeCount++,(rd&&t.input.lastIOSEnter>Date.now()-225||ao)&&i.some(A=>A.nodeType==1&&!bxe.test(A.nodeName))&&(!x||x.endA>=x.endB)&&t.someProp("handleKeyDown",A=>A(t,Sl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!x)if(n&&c instanceof et&&!c.empty&&c.$head.sameParent(c.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))x={start:c.from,endA:c.to,endB:c.to};else{if(u.sel){let A=F$(t,t.state.doc,u.sel);if(A&&!A.eq(t.state.selection)){let T=t.state.tr.setSelection(A);s&&T.setMeta("composition",s),t.dispatch(T)}}return}t.state.selection.from<t.state.selection.to&&x.start==x.endB&&t.state.selection instanceof et&&(x.start>t.state.selection.from&&x.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?x.start=t.state.selection.from:x.endA<t.state.selection.to&&x.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(x.endB+=t.state.selection.to-x.endA,x.endA=t.state.selection.to)),Rn&&_a<=11&&x.endB==x.start+1&&x.endA==x.start&&x.start>u.from&&u.doc.textBetween(x.start-u.from-1,x.start-u.from+1)=="  "&&(x.start--,x.endA--,x.endB--);let y=u.doc.resolveNoCache(x.start-u.from),v=u.doc.resolveNoCache(x.endB-u.from),b=f.resolve(x.start),w=y.sameParent(v)&&y.parent.inlineContent&&b.end()>=x.endA,N;if((rd&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(A=>A.nodeName=="DIV"||A.nodeName=="P"))||!w&&y.pos<u.doc.content.size&&(!y.sameParent(v)||!y.parent.inlineContent)&&!/\S/.test(u.doc.textBetween(y.pos,v.pos,"",""))&&(N=ot.findFrom(u.doc.resolve(y.pos+1),1,!0))&&N.head>y.pos)&&t.someProp("handleKeyDown",A=>A(t,Sl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>x.start&&Sxe(f,x.start,x.endA,y,v)&&t.someProp("handleKeyDown",A=>A(t,Sl(8,"Backspace")))){ao&&an&&t.domObserver.suppressSelectionUpdates();return}an&&x.endB==x.start&&(t.input.lastChromeDelete=Date.now()),ao&&!w&&y.start()!=v.start()&&v.parentOffset==0&&y.depth==v.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==x.endA&&(x.endB-=2,v=u.doc.resolveNoCache(x.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(A){return A(t,Sl(13,"Enter"))})},20));let j=x.start,k=x.endA,_=A=>{let T=A||t.state.tr.replace(j,k,u.doc.slice(x.start-u.from,x.endB-u.from));if(u.sel){let M=F$(t,T.doc,u.sel);M&&!(an&&t.composing&&M.empty&&(x.start!=x.endB||t.input.lastChromeDelete<Date.now()-100)&&(M.head==j||M.head==T.mapping.map(k)-1)||Rn&&M.empty&&M.head==j)&&T.setSelection(M)}return s&&T.setMeta("composition",s),T.scrollIntoView()},E;if(w){if(y.pos==v.pos){Rn&&_a<=11&&y.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>po(t),20));let A=_(t.state.tr.delete(j,k)),T=f.resolve(x.start).marksAcross(f.resolve(x.endA));T&&A.ensureMarks(T),t.dispatch(A)}else if(x.endA==x.endB&&(E=jxe(y.parent.content.cut(y.parentOffset,v.parentOffset),b.parent.content.cut(b.parentOffset,x.endA-b.start())))){let A=_(t.state.tr);E.type=="add"?A.addMark(j,k,E.mark):A.removeMark(j,k,E.mark),t.dispatch(A)}else if(y.parent.child(y.index()).isText&&y.index()==v.index()-(v.textOffset?0:1)){let A=y.parent.textBetween(y.parentOffset,v.parentOffset),T=()=>_(t.state.tr.insertText(A,j,k));t.someProp("handleTextInput",M=>M(t,j,k,A,T))||t.dispatch(T())}}else t.dispatch(_())}function F$(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:YE(t,e.resolve(r.anchor),e.resolve(r.head))}function jxe(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,s=n,o,l,c;for(let f=0;f<n.length;f++)i=n[f].removeFromSet(i);for(let f=0;f<r.length;f++)s=r[f].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",c=f=>f.mark(l.addToSet(f.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",c=f=>f.mark(l.removeFromSet(f.marks));else return null;let u=[];for(let f=0;f<e.childCount;f++)u.push(c(e.child(f)));if(Ne.from(u).eq(t))return{mark:l,type:o}}function Sxe(t,e,r,n,i){if(r-e<=i.pos-n.pos||uk(n,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(!n.parent.isTextblock){let l=s.nodeAfter;return l!=null&&r==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(uk(s,!0,!0));return!o.parent.isTextblock||o.pos>r||uk(o,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(o.parent.content)}function uk(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let s=t.node(n).maybeChild(t.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function Nxe(t,e,r,n,i){let s=t.findDiffStart(e,r);if(s==null)return null;let{a:o,b:l}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let c=Math.max(0,s-Math.min(o,l));n-=o+c-s}if(o<s&&t.size<e.size){let c=n<=s&&n>=o?s-n:0;s-=c,s&&s<e.size&&q$(e.textBetween(s-1,s+1))&&(s+=c?1:-1),l=s+(l-o),o=s}else if(l<s){let c=n<=s&&n>=l?s-n:0;s-=c,s&&s<t.size&&q$(t.textBetween(s-1,s+1))&&(s+=c?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function q$(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class KU{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new U0e,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(V$),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=H$(this),U$(this),this.nodeViews=W$(this),this.docView=j$(this.state.doc,z$(this),ck(this),this.dom,this),this.domObserver=new pxe(this,(n,i,s,o)=>wxe(this,n,i,s,o)),this.domObserver.start(),H0e(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&W2(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach(V$),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(FU(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(l||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let m=W$(this);_xe(m,this.nodeViews)&&(this.nodeViews=m,s=!0)}(l||r.handleDOMEvents!=this._props.handleDOMEvents)&&W2(this),this.editable=H$(this),U$(this);let c=ck(this),u=z$(this),f=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,u,c);(d||!e.selection.eq(i.selection))&&(o=!0);let p=f=="preserve"&&o&&this.dom.style.overflowAnchor==null&&i0e(this);if(o){this.domObserver.stop();let m=d&&(Rn||an)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&kxe(i.selection,e.selection);if(d){let x=an?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=nxe(this)),(s||!this.docView.update(e.doc,u,c,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=j$(e.doc,u,c,this.dom,this)),x&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&E0e(this))?po(this,m):(EU(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),f=="reset"?this.dom.scrollTop=0:f=="to selection"?this.scrollToSelection():p&&s0e(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof He){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&g$(this,r.getBoundingClientRect(),e)}else g$(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let s=n.from+(this.state.doc.content.size-r.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==n.node&&(i=s)}this.dragging=new zU(e.slice,e.move,i<0?void 0:He.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=r?r(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=r?r(l):l))return i}}hasFocus(){if(Rn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&o0e(this.dom),po(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return d0e(this,e)}coordsAtPos(e,r=1){return bU(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return g0e(this,r||this.state,e)}pasteHTML(e,r){return hp(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return hp(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return XE(this,e)}destroy(){this.docView&&(W0e(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ck(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Kve())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return K0e(this,e)}domSelectionRange(){let e=this.domSelection();return e?bn&&this.root.nodeType===11&&Qve(this.dom.ownerDocument)==this.dom&&gxe(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}KU.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function z$(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[vn.node(0,t.state.doc.content.size,e)]}function U$(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:vn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function H$(t){return!t.someProp("editable",e=>e(t.state)===!1)}function kxe(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function W$(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function _xe(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function V$(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ta={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Av={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Oxe=typeof navigator<"u"&&/Mac/.test(navigator.platform),Exe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Vr=0;Vr<10;Vr++)Ta[48+Vr]=Ta[96+Vr]=String(Vr);for(var Vr=1;Vr<=24;Vr++)Ta[Vr+111]="F"+Vr;for(var Vr=65;Vr<=90;Vr++)Ta[Vr]=String.fromCharCode(Vr+32),Av[Vr]=String.fromCharCode(Vr);for(var dk in Ta)Av.hasOwnProperty(dk)||(Av[dk]=Ta[dk]);function Cxe(t){var e=Oxe&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Exe&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Av:Ta)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const Axe=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Txe=typeof navigator<"u"&&/Win/.test(navigator.platform);function Pxe(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,s,o;for(let l=0;l<e.length-1;l++){let c=e[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))i=!0;else if(/^s(hift)?$/i.test(c))s=!0;else if(/^mod$/i.test(c))Axe?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),o&&(r="Meta-"+r),s&&(r="Shift-"+r),r}function Mxe(t){let e=Object.create(null);for(let r in t)e[Pxe(r)]=t[r];return e}function fk(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function Rxe(t){return new nr({props:{handleKeyDown:GU(t)}})}function GU(t){let e=Mxe(t);return function(r,n){let i=Cxe(n),s,o=e[fk(i,n)];if(o&&o(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let l=e[fk(i,n,!1)];if(l&&l(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(Txe&&n.ctrlKey&&n.altKey)&&(s=Ta[n.keyCode])&&s!=i){let l=e[fk(s,n)];if(l&&l(r.state,r.dispatch,r))return!0}}return!1}}const rC=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function YU(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const XU=(t,e,r)=>{let n=YU(t,r);if(!n)return!1;let i=nC(n);if(!i){let o=n.blockRange(),l=o&&Sd(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(s7(t,i,e,-1))return!0;if(n.parent.content.size==0&&(nd(s,"end")||He.isSelectable(s)))for(let o=n.depth;;o--){let l=yx(t.doc,n.before(o),n.after(o),Ie.empty);if(l&&l.slice.size<l.to-l.from){if(e){let c=t.tr.step(l);c.setSelection(nd(s,"end")?ot.findFrom(c.doc.resolve(c.mapping.map(i.pos,-1)),-1):He.create(c.doc,i.pos-s.nodeSize)),e(c.scrollIntoView())}return!0}if(o==1||n.node(o-1).childCount>1)break}return s.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},Ixe=(t,e,r)=>{let n=YU(t,r);if(!n)return!1;let i=nC(n);return i?JU(t,i,e):!1},Dxe=(t,e,r)=>{let n=ZU(t,r);if(!n)return!1;let i=iC(n);return i?JU(t,i,e):!1};function JU(t,e,r){let n=e.nodeBefore,i=n,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let f=i.lastChild;if(!f)return!1;i=f}let o=e.nodeAfter,l=o,c=e.pos+1;for(;!l.isTextblock;c++){if(l.type.spec.isolating)return!1;let f=l.firstChild;if(!f)return!1;l=f}let u=yx(t.doc,s,c,Ie.empty);if(!u||u.from!=s||u instanceof Rr&&u.slice.size>=c-s)return!1;if(r){let f=t.tr.step(u);f.setSelection(et.create(f.doc,s)),r(f.scrollIntoView())}return!0}function nd(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const QU=(t,e,r)=>{let{$head:n,empty:i}=t.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;s=nC(n)}let o=s&&s.nodeBefore;return!o||!He.isSelectable(o)?!1:(e&&e(t.tr.setSelection(He.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function nC(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function ZU(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const e7=(t,e,r)=>{let n=ZU(t,r);if(!n)return!1;let i=iC(n);if(!i)return!1;let s=i.nodeAfter;if(s7(t,i,e,1))return!0;if(n.parent.content.size==0&&(nd(s,"start")||He.isSelectable(s))){let o=yx(t.doc,n.before(),n.after(),Ie.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(nd(s,"start")?ot.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):He.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},t7=(t,e,r)=>{let{$head:n,empty:i}=t.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;s=iC(n)}let o=s&&s.nodeAfter;return!o||!He.isSelectable(o)?!1:(e&&e(t.tr.setSelection(He.create(t.doc,s.pos)).scrollIntoView()),!0)};function iC(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const Lxe=(t,e)=>{let r=t.selection,n=r instanceof He,i;if(n){if(r.node.isTextblock||!Ha(t.doc,r.from))return!1;i=r.from}else if(i=gx(t.doc,r.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);n&&s.setSelection(He.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},$xe=(t,e)=>{let r=t.selection,n;if(r instanceof He){if(r.node.isTextblock||!Ha(t.doc,r.to))return!1;n=r.to}else if(n=gx(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},Bxe=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),s=i&&Sd(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},r7=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
grep: write error: Broken pipe
