 */function Nx(){return Nx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nx.apply(this,arguments)}function yR(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function vR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function xR(e,t){return e.button===0&&(!t||t==="_self")&&!vR(e)}function Sx(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function bR(e,t){let r=Sx(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(s=>{r.append(a,s)})}),r}const wR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],jR="6";try{window.__reactRouterVersion=jR}catch{}const _R="startTransition",AN=pM[_R];function NR(e){let{basename:t,children:r,future:n,window:a}=e,s=L.useRef();s.current==null&&(s.current=NM({window:a,v5Compat:!0}));let o=s.current,[c,u]=L.useState({action:o.action,location:o.location}),{v7_startTransition:f}=n||{},m=L.useCallback(h=>{f&&AN?AN(()=>u(h)):u(h)},[u,f]);return L.useLayoutEffect(()=>o.listen(m),[o,m]),L.useEffect(()=>mR(n),[n]),L.createElement(gR,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:o,future:n})}const SR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Et=L.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:o,state:c,target:u,to:f,preventScrollReset:m,viewTransition:h}=t,g=yR(t,wR),{basename:p}=L.useContext(ja),x,y=!1;if(typeof f=="string"&&OR.test(f)&&(x=f,SR))try{let S=new URL(window.location.href),w=f.startsWith("//")?new URL(S.protocol+f):new URL(f),_=pw(w.pathname,p);w.origin===S.origin&&_!=null?f=_+w.search+w.hash:y=!0}catch{}let v=ZM(f,{relative:a}),N=kR(f,{replace:o,state:c,target:u,preventScrollReset:m,relative:a,viewTransition:h});function j(S){n&&n(S),S.defaultPrevented||N(S)}return L.createElement("a",Nx({},g,{href:x||v,onClick:y||s?n:j,ref:r,target:u}))});var PN;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(PN||(PN={}));var CN;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(CN||(CN={}));function kR(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:o,viewTransition:c}=t===void 0?{}:t,u=zt(),f=vn(),m=FC(e,{relative:o});return L.useCallback(h=>{if(xR(h,r)){h.preventDefault();let g=n!==void 0?n:kf(f)===kf(m);u(e,{replace:g,state:a,preventScrollReset:s,relative:o,viewTransition:c})}},[f,u,m,n,a,r,e,s,o,c])}function xw(e){let t=L.useRef(Sx(e)),r=L.useRef(!1),n=vn(),a=L.useMemo(()=>bR(n.search,r.current?null:t.current),[n.search]),s=zt(),o=L.useCallback((c,u)=>{const f=Sx(typeof c=="function"?c(a):c);r.current=!0,s("?"+f,u)},[s,a]);return[a,o]}const ER="modulepreload",AR=function(e){return"/"+e},TN={},ju=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(u=>{if(u=AR(u),u in TN)return;TN[u]=!0;const f=u.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":ER,f||(h.as="script"),h.crossOrigin="",h.href=u,c&&h.setAttribute("nonce",c),document.head.appendChild(h),f)return new Promise((g,p)=>{h.addEventListener("load",g),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return a.then(o=>{for(const c of o||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})},PR=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ju(async()=>{const{default:n}=await Promise.resolve().then(()=>il);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class bw extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class CR extends bw{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class IN extends bw{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class MN extends bw{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ox;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ox||(Ox={}));var TR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};class IR{constructor(t,{headers:r={},customFetch:n,region:a=Ox.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=PR(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return TR(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:o}=r;let c={},{region:u}=r;u||(u=this.region);const f=new URL(`${this.url}/${t}`);u&&u!=="any"&&(c["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let m;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",m=o):typeof o=="string"?(c["Content-Type"]="text/plain",m=o):typeof FormData<"u"&&o instanceof FormData?m=o:(c["Content-Type"]="application/json",m=JSON.stringify(o)));const h=yield this.fetch(f.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:m}).catch(y=>{throw new CR(y)}),g=h.headers.get("x-relay-error");if(g&&g==="true")throw new IN(h);if(!h.ok)throw new MN(h);let p=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return p==="application/json"?x=yield h.json():p==="application/octet-stream"?x=yield h.blob():p==="text/event-stream"?x=h:p==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof MN||a instanceof IN?a.context:void 0}}})}}var sr={},eo={},to={},ro={},no={},io={},MR=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Po=MR();const RR=Po.fetch,VC=Po.fetch.bind(Po),KC=Po.Headers,DR=Po.Request,LR=Po.Response,il=Object.freeze(Object.defineProperty({__proto__:null,Headers:KC,Request:DR,Response:LR,default:VC,fetch:RR},Symbol.toStringTag,{value:"Module"})),$R=dM(il);var Jd={},RN;function GC(){if(RN)return Jd;RN=1,Object.defineProperty(Jd,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Jd.default=e,Jd}var DN;function YC(){if(DN)return io;DN=1;var e=io&&io.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(io,"__esModule",{value:!0});const t=e($R),r=e(GC());class n{constructor(s){var o,c;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(o=s.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=s.signal,this.isMaybeSingle=(c=s.isMaybeSingle)!==null&&c!==void 0?c:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,o){return this.headers=new Headers(this.headers),this.headers.set(s,o),this}then(s,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let u=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var m,h,g,p;let x=null,y=null,v=null,N=f.status,j=f.statusText;if(f.ok){if(this.method!=="HEAD"){const O=await f.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?y=O:y=JSON.parse(O))}const w=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),_=(g=f.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");w&&_&&_.length>1&&(v=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(x={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,v=null,N=406,j="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const w=await f.text();try{x=JSON.parse(w),Array.isArray(x)&&f.status===404&&(y=[],x=null,N=200,j="OK")}catch{f.status===404&&w===""?(N=204,j="No Content"):x={message:w}}if(x&&this.isMaybeSingle&&(!((p=x==null?void 0:x.details)===null||p===void 0)&&p.includes("0 rows"))&&(x=null,N=200,j="OK"),x&&this.shouldThrowOnError)throw new r.default(x)}return{error:x,data:y,count:v,status:N,statusText:j}});return this.shouldThrowOnError||(u=u.catch(f=>{var m,h,g;return{error:{message:`${(m=f==null?void 0:f.name)!==null&&m!==void 0?m:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(h=f==null?void 0:f.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(g=f==null?void 0:f.code)!==null&&g!==void 0?g:""}`},data:null,count:null,status:0,statusText:""}})),u.then(s,o)}returns(){return this}overrideTypes(){return this}}return io.default=n,io}var LN;function XC(){if(LN)return no;LN=1;var e=no&&no.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(no,"__esModule",{value:!0});const t=e(YC());class r extends t.default{select(a){let s=!1;const o=(a??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:s=!0,nullsFirst:o,foreignTable:c,referencedTable:u=c}={}){const f=u?`${u}.order`:"order",m=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${m?`${m},`:""}${a}.${s?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:o=s}={}){const c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,s,{foreignTable:o,referencedTable:c=o}={}){const u=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${a}`),this.url.searchParams.set(f,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:s=!1,settings:o=!1,buffers:c=!1,wal:u=!1,format:f="text"}={}){var m;const h=[a?"analyze":null,s?"verbose":null,o?"settings":null,c?"buffers":null,u?"wal":null].filter(Boolean).join("|"),g=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${g}"; options=${h};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return no.default=r,no}var $N;function ww(){if($N)return ro;$N=1;var e=ro&&ro.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ro,"__esModule",{value:!0});const t=e(XC());class r extends t.default{eq(a,s){return this.url.searchParams.append(a,`eq.${s}`),this}neq(a,s){return this.url.searchParams.append(a,`neq.${s}`),this}gt(a,s){return this.url.searchParams.append(a,`gt.${s}`),this}gte(a,s){return this.url.searchParams.append(a,`gte.${s}`),this}lt(a,s){return this.url.searchParams.append(a,`lt.${s}`),this}lte(a,s){return this.url.searchParams.append(a,`lte.${s}`),this}like(a,s){return this.url.searchParams.append(a,`like.${s}`),this}likeAllOf(a,s){return this.url.searchParams.append(a,`like(all).{${s.join(",")}}`),this}likeAnyOf(a,s){return this.url.searchParams.append(a,`like(any).{${s.join(",")}}`),this}ilike(a,s){return this.url.searchParams.append(a,`ilike.${s}`),this}ilikeAllOf(a,s){return this.url.searchParams.append(a,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(a,s){return this.url.searchParams.append(a,`ilike(any).{${s.join(",")}}`),this}is(a,s){return this.url.searchParams.append(a,`is.${s}`),this}in(a,s){const o=Array.from(new Set(s)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${o})`),this}contains(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cs.{${s.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(s)}`),this}containedBy(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cd.{${s.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(s)}`),this}rangeGt(a,s){return this.url.searchParams.append(a,`sr.${s}`),this}rangeGte(a,s){return this.url.searchParams.append(a,`nxl.${s}`),this}rangeLt(a,s){return this.url.searchParams.append(a,`sl.${s}`),this}rangeLte(a,s){return this.url.searchParams.append(a,`nxr.${s}`),this}rangeAdjacent(a,s){return this.url.searchParams.append(a,`adj.${s}`),this}overlaps(a,s){return typeof s=="string"?this.url.searchParams.append(a,`ov.${s}`):this.url.searchParams.append(a,`ov.{${s.join(",")}}`),this}textSearch(a,s,{config:o,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const f=o===void 0?"":`(${o})`;return this.url.searchParams.append(a,`${u}fts${f}.${s}`),this}match(a){return Object.entries(a).forEach(([s,o])=>{this.url.searchParams.append(s,`eq.${o}`)}),this}not(a,s,o){return this.url.searchParams.append(a,`not.${s}.${o}`),this}or(a,{foreignTable:s,referencedTable:o=s}={}){const c=o?`${o}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,s,o){return this.url.searchParams.append(a,`${s}.${o}`),this}}return ro.default=r,ro}var qN;function ZC(){if(qN)return to;qN=1;var e=to&&to.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(to,"__esModule",{value:!0});const t=e(ww());class r{constructor(a,{headers:s={},schema:o,fetch:c}){this.url=a,this.headers=new Headers(s),this.schema=o,this.fetch=c}select(a,{head:s=!1,count:o}={}){const c=s?"HEAD":"GET";let u=!1;const f=(a??"*").split("").map(m=>/\s/.test(m)&&!u?"":(m==='"'&&(u=!u),m)).join("");return this.url.searchParams.set("select",f),o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:s,defaultToNull:o=!0}={}){var c;const u="POST";if(s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const f=a.reduce((m,h)=>m.concat(Object.keys(h)),[]);if(f.length>0){const m=[...new Set(f)].map(h=>`"${h}"`);this.url.searchParams.set("columns",m.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(a,{onConflict:s,ignoreDuplicates:o=!1,count:c,defaultToNull:u=!0}={}){var f;const m="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),c&&this.headers.append("Prefer",`count=${c}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((g,p)=>g.concat(Object.keys(p)),[]);if(h.length>0){const g=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(a,{count:s}={}){var o;const c="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:a}={}){var s;const o="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return to.default=r,to}var BN;function qR(){if(BN)return eo;BN=1;var e=eo&&eo.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(eo,"__esModule",{value:!0});const t=e(ZC()),r=e(ww());class n{constructor(s,{headers:o={},schema:c,fetch:u}={}){this.url=s,this.headers=new Headers(o),this.schemaName=c,this.fetch=u}from(s){const o=new URL(`${this.url}/${s}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,o={},{head:c=!1,get:u=!1,count:f}={}){var m;let h;const g=new URL(`${this.url}/rpc/${s}`);let p;c||u?(h=c?"HEAD":"GET",Object.entries(o).filter(([y,v])=>v!==void 0).map(([y,v])=>[y,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([y,v])=>{g.searchParams.append(y,v)})):(h="POST",p=o);const x=new Headers(this.headers);return f&&x.set("Prefer",`count=${f}`),new r.default({method:h,url:g,headers:x,schema:this.schemaName,body:p,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return eo.default=n,eo}var FN;function BR(){if(FN)return sr;FN=1;var e=sr&&sr.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(sr,"__esModule",{value:!0}),sr.PostgrestError=sr.PostgrestBuilder=sr.PostgrestTransformBuilder=sr.PostgrestFilterBuilder=sr.PostgrestQueryBuilder=sr.PostgrestClient=void 0;const t=e(qR());sr.PostgrestClient=t.default;const r=e(ZC());sr.PostgrestQueryBuilder=r.default;const n=e(ww());sr.PostgrestFilterBuilder=n.default;const a=e(XC());sr.PostgrestTransformBuilder=a.default;const s=e(YC());sr.PostgrestBuilder=s.default;const o=e(GC());return sr.PostgrestError=o.default,sr.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:o.default},sr}var FR=BR();const UR=tt(FR),{PostgrestClient:zR,PostgrestQueryBuilder:Ine,PostgrestFilterBuilder:Mne,PostgrestTransformBuilder:Rne,PostgrestBuilder:Dne,PostgrestError:Lne}=UR;class WR{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const HR="2.15.1",VR=`realtime-js/${HR}`,KR="1.0.0",kx=1e4,GR=1e3,YR=100;var xc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(xc||(xc={}));var Jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Jt||(Jt={}));var Rn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Rn||(Rn={}));var Ex;(function(e){e.websocket="websocket"})(Ex||(Ex={}));var Ja;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ja||(Ja={}));class XR{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let o=this.HEADER_LENGTH+2;const c=n.decode(t.slice(o,o+a));o=o+a;const u=n.decode(t.slice(o,o+s));o=o+s;const f=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:c,event:u,payload:f}}}class JC{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(xt||(xt={}));const UN=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,o)=>(s[o]=ZR(o,e,t,a),s),{})},ZR=(e,t,r,n)=>{const a=t.find(c=>c.name===e),s=a==null?void 0:a.type,o=r[e];return s&&!n.includes(s)?QC(s,o):Ax(o)},QC=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return tD(t,r)}switch(e){case xt.bool:return JR(t);case xt.float4:case xt.float8:case xt.int2:case xt.int4:case xt.int8:case xt.numeric:case xt.oid:return QR(t);case xt.json:case xt.jsonb:return eD(t);case xt.timestamp:return rD(t);case xt.abstime:case xt.date:case xt.daterange:case xt.int4range:case xt.int8range:case xt.money:case xt.reltime:case xt.text:case xt.time:case xt.timestamptz:case xt.timetz:case xt.tsrange:case xt.tstzrange:return Ax(t);default:return Ax(t)}},Ax=e=>e,JR=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},QR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},eD=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},tD=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const o=e.slice(1,r);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(c=>QC(t,c))}return e},rD=e=>typeof e=="string"?e.replace(" ","T"):e,eT=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class lg{constructor(t,r,n={},a=kx){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var zN;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(zN||(zN={}));class bc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=bc.syncState(this.state,a,s,o),this.pendingDiffs.forEach(u=>{this.state=bc.syncDiff(this.state,u,s,o)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=bc.syncDiff(this.state,a,s,o),c())}),this.onJoin((a,s,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:o})}),this.onLeave((a,s,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),o=this.transformState(r),c={},u={};return this.map(s,(f,m)=>{o[f]||(u[f]=m)}),this.map(o,(f,m)=>{const h=s[f];if(h){const g=m.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),x=m.filter(v=>p.indexOf(v.presence_ref)<0),y=h.filter(v=>g.indexOf(v.presence_ref)<0);x.length>0&&(c[f]=x),y.length>0&&(u[f]=y)}else c[f]=m}),this.syncDiff(s,{joins:c,leaves:u},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(c,u)=>{var f;const m=(f=t[c])!==null&&f!==void 0?f:[];if(t[c]=this.cloneDeep(u),m.length>0){const h=t[c].map(p=>p.presence_ref),g=m.filter(p=>h.indexOf(p.presence_ref)<0);t[c].unshift(...g)}n(c,m,u)}),this.map(o,(c,u)=>{let f=t[c];if(!f)return;const m=u.map(h=>h.presence_ref);f=f.filter(h=>m.indexOf(h.presence_ref)<0),t[c]=f,a(c,f,u),f.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var WN;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(WN||(WN={}));var wc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(wc||(wc={}));var ji;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ji||(ji={}));class jw{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new lg(this,Rn.join,this.params,this.timeout),this.rejoinTimer=new JC(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Jt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rn.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new bc(this),this.broadcastEndpointURL=eT(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Jt.closed){const{config:{broadcast:s,presence:o,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(g=>g.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[wc.PRESENCE]&&this.bindings[wc.PRESENCE].length>0,m={},h={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(g=>t==null?void 0:t(ji.CHANNEL_ERROR,g)),this._onClose(()=>t==null?void 0:t(ji.CLOSED)),this.updateJoinPayload(Object.assign({config:h},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var p;if(this.socket.setAuth(),g===void 0){t==null||t(ji.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,y=(p=x==null?void 0:x.length)!==null&&p!==void 0?p:0,v=[];for(let N=0;N<y;N++){const j=x[N],{filter:{event:S,schema:w,table:_,filter:O}}=j,k=g&&g[N];if(k&&k.event===S&&k.schema===w&&k.table===_&&k.filter===O)v.push(Object.assign(Object.assign({},j),{id:k.id}));else{this.unsubscribe(),this.state=Jt.errored,t==null||t(ji.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(ji.SUBSCRIBED);return}}).receive("error",g=>{this.state=Jt.errored,t==null||t(ji.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ji.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Jt.joined&&t===wc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:o}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,c,u;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("error",()=>s("error")),f.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new lg(this,Rn.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new lg(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>YR){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const o=t.toLocaleLowerCase(),{close:c,error:u,leave:f,join:m}=Rn;if(n&&[c,u,f,m].indexOf(o)>=0&&n!==this._joinRef())return;let g=this._onMessage(o,r,n);if(r&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var x,y,v;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(y=p.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(p=>p.callback(g,n)):(s=this.bindings[o])===null||s===void 0||s.filter(p=>{var x,y,v,N,j,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const w=p.id,_=(x=p.filter)===null||x===void 0?void 0:x.event;return w&&((y=r.ids)===null||y===void 0?void 0:y.includes(w))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const w=(j=(N=p==null?void 0:p.filter)===null||N===void 0?void 0:N.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return w==="*"||w===((S=r==null?void 0:r.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof g=="object"&&"ids"in g){const x=g.data,{schema:y,table:v,commit_timestamp:N,type:j,errors:S}=x;g=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:N,eventType:j,new:{},old:{},errors:S}),this._getPayloadRecords(x))}p.callback(g,n)})}_isClosed(){return this.state===Jt.closed}_isJoined(){return this.state===Jt.joined}_isJoining(){return this.state===Jt.joining}_isLeaving(){return this.state===Jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&jw.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Rn.close,{},t)}_onError(t){this._on(Rn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=UN(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=UN(t.columns,t.old_record)),r}}const HN=()=>{},Qd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},nD=[1e3,2e3,5e3,1e4],iD=1e4,aD=`
  });`;class sD{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=kx,this.transport=null,this.heartbeatIntervalMs=Qd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=HN,this.ref=0,this.reconnectTimer=null,this.logger=HN,this.conn=null,this.sendBuffer=[],this.serializer=new XR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...o)=>ju(async()=>{const{default:c}=await Promise.resolve().then(()=>il);return{default:c}},void 0).then(({default:c})=>c(...o)).catch(c=>{throw new Error(`Failed to load @supabase/node-fetch: ${c.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...o)=>s(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Ex.websocket}`,this.httpEndpoint=eT(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WR.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:KR}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case xc.connecting:return Ja.Connecting;case xc.open:return Ja.Open;case xc.closing:return Ja.Closing;default:return Ja.Closed}}isConnected(){return this.connectionState()===Ja.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new jw(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,o=()=>{this.encode(t,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(GR,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Qd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:o}=r,c=o?`(${o})`:"",u=s.status||"";this.log("receive",`${u} ${n} ${a} ${c}`.trim(),s),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(a,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Rn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([aD],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:VR};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Rn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new JC(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,o,c,u,f;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:kx,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Qd.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:m=>nD[m-1]||iD,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(m,h)=>h(JSON.stringify(m)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class _w extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Qt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class oD extends _w{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Px extends _w{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var lD=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};const tT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ju(async()=>{const{default:n}=await Promise.resolve().then(()=>il);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},cD=()=>lD(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ju(()=>Promise.resolve().then(()=>il),void 0)).Response:Response}),Cx=e=>{if(Array.isArray(e))return e.map(r=>Cx(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Cx(n)}),t},uD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var vs=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};const cg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dD=(e,t,r)=>vs(void 0,void 0,void 0,function*(){const n=yield cD();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,o=(a==null?void 0:a.statusCode)||s+"";t(new oD(cg(a),s,o))}).catch(a=>{t(new Px(cg(a),a))}):t(new Px(cg(e),e))}),fD=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(uD(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function _u(e,t,r,n,a,s){return vs(this,void 0,void 0,function*(){return new Promise((o,c)=>{e(r,fD(t,n,a,s)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>dD(u,c,n))})})}function Ef(e,t,r,n){return vs(this,void 0,void 0,function*(){return _u(e,"GET",t,r,n)})}function Jn(e,t,r,n,a){return vs(this,void 0,void 0,function*(){return _u(e,"POST",t,n,a,r)})}function Tx(e,t,r,n,a){return vs(this,void 0,void 0,function*(){return _u(e,"PUT",t,n,a,r)})}function hD(e,t,r,n){return vs(this,void 0,void 0,function*(){return _u(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function rT(e,t,r,n,a){return vs(this,void 0,void 0,function*(){return _u(e,"DELETE",t,n,a,r)})}var kr=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};const mD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},VN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class pD{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=tT(a)}uploadOrUpdate(t,r,n,a){return kr(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},VN),a);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=n,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,u&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(r),m=this._getFinalPath(f),h=yield(t=="PUT"?Tx:Jn)(this.fetch,`${this.url}/object/${m}`,s,Object.assign({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:f,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(Qt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return kr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return kr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),o=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",r);try{let u;const f=Object.assign({upsert:VN.upsert},a),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",f.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",f.cacheControl)):(u=n,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType);const h=yield Tx(this.fetch,c.toString(),u,{headers:m});return{data:{path:s,fullPath:h.Key},error:null}}catch(u){if(Qt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return kr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Jn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+s.url),c=o.searchParams.get("token");if(!c)throw new _w("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:c},error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}update(t,r,n){return kr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return kr(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Qt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return kr(this,void 0,void 0,function*(){try{return{data:{path:(yield Jn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Qt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return kr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Jn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(a){if(Qt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return kr(this,void 0,void 0,function*(){try{const a=yield Jn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(a){if(Qt(a))return{data:null,error:a};throw a}})}download(t,r){return kr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=s?`?${s}`:"";try{const c=this._getFinalPath(t);return{data:yield(yield Ef(this.fetch,`${this.url}/${a}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Qt(c))return{data:null,error:c};throw c}})}info(t){return kr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Ef(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Cx(n),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}exists(t){return kr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield hD(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Qt(n)&&n instanceof Px){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const c=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&a.push(u);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${n}${f}`)}}}remove(t){return kr(this,void 0,void 0,function*(){try{return{data:yield rT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}list(t,r,n){return kr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},mD),r),{prefix:t||""});return{data:yield Jn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Qt(a))return{data:null,error:a};throw a}})}listV2(t,r){return kr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Jn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const gD="2.11.0",yD={"X-Client-Info":`storage-js/${gD}`};var ao=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};class vD{constructor(t,r={},n,a){const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},yD),r),this.fetch=tT(n)}listBuckets(){return ao(this,void 0,void 0,function*(){try{return{data:yield Ef(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Qt(t))return{data:null,error:t};throw t}})}getBucket(t){return ao(this,void 0,void 0,function*(){try{return{data:yield Ef(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ao(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ao(this,void 0,void 0,function*(){try{return{data:yield Tx(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ao(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ao(this,void 0,void 0,function*(){try{return{data:yield rT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}}class xD extends vD{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new pD(this.url,this.headers,t,this.fetch)}}const bD="2.56.0";let mc="";typeof Deno<"u"?mc="deno":typeof document<"u"?mc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mc="react-native":mc="node";const wD={"X-Client-Info":`supabase-js-${mc}/${bD}`},jD={headers:wD},_D={schema:"public"},ND={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},SD={};var OD=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};const kD=e=>{let t;return e?t=e:typeof fetch>"u"?t=VC:t=fetch,(...r)=>t(...r)},ED=()=>typeof Headers>"u"?KC:Headers,AD=(e,t,r)=>{const n=kD(r),a=ED();return(s,o)=>OD(void 0,void 0,void 0,function*(){var c;const u=(c=yield t())!==null&&c!==void 0?c:e;let f=new a(o==null?void 0:o.headers);return f.has("apikey")||f.set("apikey",e),f.has("Authorization")||f.set("Authorization",`Bearer ${u}`),n(s,Object.assign(Object.assign({},o),{headers:f}))})};var PD=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};function CD(e){return e.endsWith("/")?e:e+"/"}function TD(e,t){var r,n;const{db:a,auth:s,realtime:o,global:c}=e,{db:u,auth:f,realtime:m,global:h}=t,g={db:Object.assign(Object.assign({},u),a),auth:Object.assign(Object.assign({},f),s),realtime:Object.assign(Object.assign({},m),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),c),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=c==null?void 0:c.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>PD(this,void 0,void 0,function*(){return""})};return e.accessToken?g.accessToken=e.accessToken:delete g.accessToken,g}const nT="2.71.1",go=30*1e3,Ix=3,ug=Ix*go,ID="http://localhost:9999",MD="supabase.auth.token",RD={"X-Client-Info":`gotrue-js/${nT}`},Mx="X-Supabase-Api-Version",iT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},DD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,LD=10*60*1e3;class Nw extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ke(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class $D extends Nw{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function qD(e){return Ke(e)&&e.name==="AuthApiError"}class aT extends Nw{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class _a extends Nw{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class fa extends _a{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function BD(e){return Ke(e)&&e.name==="AuthSessionMissingError"}class ef extends _a{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class tf extends _a{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class rf extends _a{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function FD(e){return Ke(e)&&e.name==="AuthImplicitGrantRedirectError"}class KN extends _a{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rx extends _a{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function dg(e){return Ke(e)&&e.name==="AuthRetryableFetchError"}class GN extends _a{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Dx extends _a{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Af="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),YN=` 	
\r=`.split(""),UD=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<YN.length;t+=1)e[YN[t].charCodeAt(0)]=-2;for(let t=0;t<Af.length;t+=1)e[Af[t].charCodeAt(0)]=t;return e})();function XN(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Af[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Af[n]),t.queuedBits-=6}}function sT(e,t,r){const n=UD[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ZN(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=o=>{HD(o,n,r)};for(let o=0;o<e.length;o+=1)sT(e.charCodeAt(o),a,s);return t.join("")}function zD(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function WD(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}zD(n,t)}}function HD(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function VD(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)sT(e.charCodeAt(a),r,n);return new Uint8Array(t)}function KD(e){const t=[];return WD(e,r=>t.push(r)),new Uint8Array(t)}function GD(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>XN(a,r,n)),XN(null,r,n),t.join("")}function YD(e){return Math.round(Date.now()/1e3)+e}function XD(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Mn=()=>typeof window<"u"&&typeof document<"u",Ua={tested:!1,writable:!1},oT=()=>{if(!Mn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ua.tested)return Ua.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ua.tested=!0,Ua.writable=!0}catch{Ua.tested=!0,Ua.writable=!1}return Ua.writable};function ZD(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const lT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ju(async()=>{const{default:n}=await Promise.resolve().then(()=>il);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},JD=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",yo=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},za=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},la=async(e,t)=>{await e.removeItem(t)};class Rh{constructor(){this.promise=new Rh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Rh.promiseConstructor=Promise;function fg(e){const t=e.split(".");if(t.length!==3)throw new Dx("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!DD.test(t[n]))throw new Dx("JWT not in base64url format");return{header:JSON.parse(ZN(t[0])),payload:JSON.parse(ZN(t[1])),signature:VD(t[2]),raw:{header:t[0],payload:t[1]}}}async function QD(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function eL(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await e(s);if(!t(s,null,o)){n(o);return}}catch(o){if(!t(s,o)){a(o);return}}})()})}function tL(e){return("0"+e.toString(16)).substr(-2)}function rL(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,tL).join("")}async function nL(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function iL(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await nL(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function so(e,t,r=!1){const n=rL();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await yo(e,`${t}-code-verifier`,a);const s=await iL(n);return[s,n===s?"plain":"s256"]}const aL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sL(e){const t=e.headers.get(Mx);if(!t||!t.match(aL))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function oL(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function lL(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function oo(e){if(!cL.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hg(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function JN(e){return JSON.parse(JSON.stringify(e))}var uL=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Ga=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dL=[502,503,504];async function QN(e){var t;if(!JD(e))throw new Rx(Ga(e),0);if(dL.includes(e.status))throw new Rx(Ga(e),e.status);let r;try{r=await e.json()}catch(s){throw new aT(Ga(s),s)}let n;const a=sL(e);if(a&&a.getTime()>=iT["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new GN(Ga(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new fa}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new GN(Ga(r),e.status,r.weak_password.reasons);throw new $D(Ga(r),e.status||500,n)}const fL=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Qe(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[Mx]||(s[Mx]=iT["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await hL(e,t,r+c,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function hL(e,t,r,n,a,s){const o=fL(t,n,a,s);let c;try{c=await e(r,Object.assign({},o))}catch(u){throw console.error(u),new Rx(Ga(u),0)}if(c.ok||await QN(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(u){await QN(u)}}function wi(e){var t;let r=null;yL(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=YD(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function e2(e){const t=wi(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ma(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function mL(e){return{data:e,error:null}}function pL(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,o=uL(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},u=Object.assign({},o);return{data:{properties:c,user:u},error:null}}function gL(e){return e}function yL(e){return e.access_token&&e.refresh_token&&e.expires_in}const mg=["global","local","others"];var vL=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class xL{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=lT(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=mg[0]){if(mg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mg.join(", ")}`);try{return await Qe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Qe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ma})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=vL(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Qe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:pL,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ke(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Qe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ma})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,o,c,u;try{const f={nextPage:null,lastPage:0,total:0},m=await Qe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:gL});if(m.error)throw m.error;const h=await m.json(),g=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(u=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return p.length>0&&(p.forEach(x=>{const y=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);f[`${v}Page`]=y}),f.total=parseInt(g)),{data:Object.assign(Object.assign({},h),f),error:null}}catch(f){if(Ke(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){oo(t);try{return await Qe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ma})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){oo(t);try{return await Qe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ma})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){oo(t);try{return await Qe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ma})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){oo(t.userId);try{const{data:r,error:n}=await Qe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _deleteFactor(t){oo(t.userId),oo(t.id);try{return{data:await Qe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}}function t2(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function bL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const lo={debug:!!(globalThis&&oT()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cT extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class wL extends cT{}async function jL(e,t,r){lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),lo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new wL(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(lo.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}bL();const _L={url:ID,storageKey:MD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:RD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function r2(e,t,r){return await r()}const co={};class Tc{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tc.nextInstanceID,Tc.nextInstanceID+=1,this.instanceID>0&&Mn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},_L),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new xL({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=lT(a.fetch),this.lock=a.lock||r2,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Mn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=jL:this.lock=r2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:oT()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=t2(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=t2(this.memoryStorage)),Mn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=co[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){co[this.storageKey]=Object.assign(Object.assign({},co[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=co[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){co[this.storageKey]=Object.assign(Object.assign({},co[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nT}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ZD(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Mn()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),FD(s)){const u=(t=s.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ke(r)?{error:r}:{error:new aT("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:wi}),{data:o,error:c}=s;if(c||!o)return{data:{user:null,session:null},error:c};const u=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(Ke(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:m,password:h,options:g}=t;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await so(this.storage,this.storageKey)),s=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:m,password:h,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:p,code_challenge_method:x},xform:wi})}else if("phone"in t){const{phone:m,password:h,options:g}=t;s=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:h,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},channel:(a=g==null?void 0:g.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:wi})}else throw new tf("You must provide either an email or phone number and a password");const{data:o,error:c}=s;if(c||!o)return{data:{user:null,session:null},error:c};const u=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(Ke(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:o,options:c}=t;r=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:e2})}else if("phone"in t){const{phone:s,password:o,options:c}=t;r=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:e2})}else throw new tf("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ef}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,o,c,u,f,m,h,g,p;let x,y;if("message"in t)x=t.message,y=t.signature;else{const{chain:v,wallet:N,statement:j,options:S}=t;let w;if(Mn())if(typeof N=="object")w=N;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))w=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=N}const _=new URL((r=S==null?void 0:S.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const O=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),j?{statement:j}:null));let k;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")k=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)k=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),y=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${_.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(a=(n=S==null?void 0:S.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=S==null?void 0:S.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((c=S==null?void 0:S.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((u=S==null?void 0:S.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((f=S==null?void 0:S.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((h=(m=S==null?void 0:S.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||h===void 0)&&h.length?["Resources",...S.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const O=await w.signMessage(new TextEncoder().encode(x),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=O}}try{const{data:v,error:N}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:GD(y)},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:wi});if(N)throw N;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new ef}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:N})}catch(v){if(Ke(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await za(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:o}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:wi});if(await la(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new ef}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:o})}catch(s){if(Ke(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:o}=t,c=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:wi}),{data:u,error:f}=c;return f?{data:{user:null,session:null},error:f}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new ef}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:f})}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,o;try{if("email"in t){const{email:c,options:u}=t;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await so(this.storage,this.storageKey));const{error:h}=await Qe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:c,options:u}=t,{data:f,error:m}=await Qe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=u==null?void 0:u.data)!==null&&a!==void 0?a:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(o=u==null?void 0:u.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:m}}throw new tf("You must provide either an email or phone number.")}catch(c){if(Ke(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:c}=await Qe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:wi});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,f=o.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await so(this.storage,this.storageKey)),await Qe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:mL})}catch(s){if(Ke(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new fa;const{error:a}=await Qe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Ke(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:o}=await Qe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:o,error:c}=await Qe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c}}throw new tf("You must provide either an email or phone number and a type")}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await za(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ug:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await za(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=hg()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,f,m)=>(!o&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,f,m))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Qe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ma}):await this._useSession(async r=>{var n,a,s;const{data:o,error:c}=r;if(c)throw c;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new fa}:await Qe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:ma})})}catch(r){if(Ke(r))return BD(r)&&(await this._removeSession(),await la(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new fa;const o=a.session;let c=null,u=null;this.flowType==="pkce"&&t.email!=null&&([c,u]=await so(this.storage,this.storageKey));const{data:f,error:m}=await Qe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:u}),jwt:o.access_token,xform:ma});if(m)throw m;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new fa;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:o}=fg(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{session:c,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:u}=await this._getUser(t.access_token);if(u)throw u;s={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Ke(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new fa;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Mn())throw new rf("No browser detected.");if(t.error||t.error_description||t.error_code)throw new rf(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new KN("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new rf("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new KN("No code detected.");const{data:j,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:o,expires_in:c,expires_at:u,token_type:f}=t;if(!s||!c||!o||!f)throw new rf("No session defined in URL");const m=Math.round(Date.now()/1e3),h=parseInt(c);let g=m+h;u&&(g=parseInt(u));const p=g-m;p*1e3<=go&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const x=g-h;m-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,g,m):m-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,g,m);const{data:y,error:v}=await this._getUser(s);if(v)throw v;const N={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:h,expires_at:g,refresh_token:o,token_type:f,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:N,redirectType:t.type},error:null}}catch(n){if(Ke(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await za(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(qD(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await la(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=XD(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await so(this.storage,this.storageKey,!0));try{return await Qe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Ke(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var o,c,u,f,m;const{data:h,error:g}=s;if(g)throw g;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Qe(this.fetch,"GET",p,{headers:this.headers,jwt:(m=(f=h.session)===null||f===void 0?void 0:f.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return Mn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ke(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:o}=r;if(o)throw o;return await Qe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await eL(async a=>(a>0&&await QD(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Qe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:wi})),(a,s)=>{const o=200*Math.pow(2,a);return s&&dg(s)&&Date.now()+o-n<go})}catch(n){if(this._debug(r,"error",n),Ke(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Mn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await za(this.storage,this.storageKey);if(a&&this.userStorage){let o=await za(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await yo(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:hg()}else if(a&&!a.user&&!a.user){const o=await za(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await la(this.storage,this.storageKey+"-user"),await yo(this.storage,this.storageKey,a)):a.user=hg()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ug;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${ug}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),dg(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(a.access_token);!c&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new fa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Rh;const{data:s,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!s.session)throw new fa;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(a,"error",s),Ke(s)){const o={session:null,error:s};return dg(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(u){s.push(u)}});if(await Promise.all(o),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await yo(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=JN(a);await yo(this.storage,this.storageKey,s)}else{const a=JN(r);await yo(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await la(this.storage,this.storageKey),await la(this.storage,this.storageKey+"-code-verifier"),await la(this.storage,this.storageKey+"-user"),this.userStorage&&await la(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Mn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),go);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/go);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${go}ms, refresh threshold is ${Ix} ticks`),a<=Ix&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof cT)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Mn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await so(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(c.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Qe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:o}=r;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:f}=await Qe(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&(!((a=u==null?void 0:u.totp)===null||a===void 0)&&a.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:o,error:c}=await Qe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Qe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=fg(a.access_token);let c=null;o.aal&&(c=o.aal);let u=c;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(c=>c.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(c=>c.kid===t),n&&this.jwks_cached_at+LD>a)return n;const{data:s,error:o}=await Qe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(c=>c.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:x}=await this.getSession();if(x||!p.session)return{data:null,error:x};n=p.session.access_token}const{header:a,payload:s,signature:o,raw:{header:c,payload:u}}=fg(n);r!=null&&r.allowExpired||oL(s.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!f){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:a,signature:o},error:null}}const m=lL(a.alg),h=await crypto.subtle.importKey("jwk",f,m,!0,["verify"]);if(!await crypto.subtle.verify(m,h,o,KD(`${c}.${u}`)))throw new Dx("Invalid JWT signature");return{data:{claims:s,header:a,signature:o},error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}}Tc.nextInstanceID=0;const NL=Tc;class SL extends NL{constructor(t){super(t)}}var OL=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(m){try{f(n.next(m))}catch(h){o(h)}}function u(m){try{f(n.throw(m))}catch(h){o(h)}}function f(m){m.done?s(m.value):a(m.value).then(c,u)}f((n=n.apply(e,t||[])).next())})};class kL{constructor(t,r,n){var a,s,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const c=CD(t),u=new URL(c);this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const f=`sb-${u.hostname.split(".")[0]}-auth-token`,m={db:_D,realtime:SD,auth:Object.assign(Object.assign({},ND),{storageKey:f}),global:jD},h=TD(n??{},m);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=AD(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new zR(new URL("rest/v1",u).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new xD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new IR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return OL(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:o,lock:c,debug:u},f,m){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SL({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),f),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:o,lock:c,debug:u,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new sD(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const EL=(e,t,r)=>new kL(e,t,r);function AL(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}AL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const PL="https://givgsxytkbsdrlmoxzkp.supabase.co",CL="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA",ce=EL(PL,CL),Ft={ai_agent:{label:"AI Agents",color:"#3B82F6",description:"Intelligent AI agents with custom prompts"},video:{label:"Videos",color:"#EF4444",description:"Educational videos with transcriptions"},document:{label:"Documents",color:"#10B981",description:"Rich text documents and guides"},prompt:{label:"Prompts",color:"#8B5CF6",description:"Reusable prompt templates"},automation:{label:"Automations",color:"#F59E0B",description:"Process automations and workflows"},image:{label:"Images",color:"#06B6D4",description:"Image assets and visual content"},pdf:{label:"PDFs",color:"#DC2626",description:"PDF documents and resources"}},es=class es{constructor(){vi(this,"userCache",new Map);vi(this,"cacheTimeout",5*60*1e3)}static getInstance(){return es.instance||(es.instance=new es),es.instance}async getCurrentUserRole(){try{const{data:{user:t},error:r}=await ce.auth.getUser();if(r||!t)return null;const{data:n,error:a}=await ce.functions.invoke("role-management-api",{body:{action:"getUserRole",userId:t.id}});return a?(console.error("Failed to get user role:",a),null):{role:n.data.role,communityId:n.data.communityId}}catch(t){return console.error("Error getting current user role:",t),null}}async validateUserPermissions(t){try{const{data:{user:r},error:n}=await ce.auth.getUser();if(n||!r)return null;const{data:a,error:s}=await ce.functions.invoke("auth-validation-api",{body:{action:"validateAccess",route:t}});return s?(console.error("Failed to validate user permissions:",s),null):a.data}catch(r){return console.error("Error validating user permissions:",r),null}}async assignUserRole(t){try{const{data:r,error:n}=await ce.functions.invoke("role-management-api",{body:{action:"assignRole",userId:t.userId,role:t.role,communityId:t.communityId,assignedBy:t.assignedBy}});return n?(console.error("Failed to assign user role:",n),!1):(this.userCache.delete(t.userId),!0)}catch(r){return console.error("Error assigning user role:",r),!1}}async getAuthenticatedUser(){try{const{data:{user:t},error:r}=await ce.auth.getUser();if(r||!t)return null;const n=this.userCache.get(t.id);if(n)return n;const{data:a,error:s}=await ce.functions.invoke("auth-validation-api",{body:{action:"getAuthenticatedUser"}});if(s)return console.error("Failed to get authenticated user:",s),null;const o=a.data;return this.userCache.set(t.id,o),setTimeout(()=>this.userCache.delete(t.id),this.cacheTimeout),o}catch(t){return console.error("Error getting authenticated user:",t),null}}getPostAuthenticationRoute(t){switch(t){case"admin":return"/admin/dashboard";case"community_user":return"/user/community";default:return"/login"}}async signIn(t,r){try{const{data:n,error:a}=await ce.auth.signInWithPassword({email:t,password:r});if(a)return await this.logAuthEvent("login_failed",{email:t,error:a.message},!1),a.message.includes("Invalid login credentials")?{success:!1,error:"Invalid email or password. Please check your credentials and try again."}:a.message.includes("Email not confirmed")?{success:!1,error:"Please verify your email address before signing in. Check your inbox for a verification link."}:a.message.includes("Too many requests")?{success:!1,error:"Too many login attempts. Please wait a few minutes before trying again."}:{success:!1,error:a.message};if(n.user){const s=await this.getCurrentUserRole();if(s){const o=this.getPostAuthenticationRoute(s.role);return await this.logAuthEvent("login_success",{email:t,role:s.role},!0),{success:!0,redirectTo:o}}}return{success:!1,error:"Authentication succeeded but role detection failed. Please contact support."}}catch(n){return console.error("Sign in error:",n),{success:!1,error:"An unexpected error occurred during sign in. Please try again."}}}async signOut(){try{const t=await this.getAuthenticatedUser();t&&await this.logAuthEvent("logout",{userId:t.id},!0),await ce.auth.signOut(),this.userCache.clear()}catch(t){console.error("Sign out error:",t)}}async logAuthEvent(t,r,n){try{await ce.functions.invoke("auth-validation-api",{body:{action:"logAuthEvent",additionalData:{eventType:t,eventData:r,success:n}}})}catch(a){console.warn("Failed to log auth event:",a)}}async getAllUserRoles(){try{const{data:t,error:r}=await ce.functions.invoke("role-management-api",{body:{action:"listUserRoles"}});return r?(console.error("Failed to get user roles:",r),[]):t.data||[]}catch(t){return console.error("Error getting user roles:",t),[]}}async getAuthAuditLog(){try{const{data:t,error:r}=await ce.functions.invoke("role-management-api",{body:{action:"getAuthAuditLog"}});return r?(console.error("Failed to get audit log:",r),[]):t.data||[]}catch(t){return console.error("Error getting audit log:",t),[]}}clearCache(){this.userCache.clear()}};vi(es,"instance");let Lx=es;const br=Lx.getInstance(),ts=class ts{constructor(){}static getInstance(){return ts.instance||(ts.instance=new ts),ts.instance}async assignRole(t,r,n){try{const a=await br.getAuthenticatedUser();return!a||a.role!=="admin"?{success:!1,error:"Only administrators can assign user roles"}:r==="community_user"&&!n?{success:!1,error:"Community ID is required for community users"}:await br.assignUserRole({userId:t,role:r,communityId:n,assignedBy:a.id})?{success:!0}:{success:!1,error:"Failed to assign role. Please try again."}}catch(a){return console.error("Error in assignRole:",a),{success:!1,error:"An unexpected error occurred while assigning the role"}}}async getAllUsersWithRoles(){try{const t=await br.getAuthenticatedUser();return!t||t.role!=="admin"?{success:!1,error:"Only administrators can view user roles"}:{success:!0,data:await br.getAllUserRoles()}}catch(t){return console.error("Error in getAllUsersWithRoles:",t),{success:!1,error:"Failed to retrieve user roles"}}}async getAuditLog(){try{const t=await br.getAuthenticatedUser();return!t||t.role!=="admin"?{success:!1,error:"Only administrators can view audit logs"}:{success:!0,data:await br.getAuthAuditLog()}}catch(t){return console.error("Error in getAuditLog:",t),{success:!1,error:"Failed to retrieve audit log"}}}async hasPermission(t){try{const r=await br.getAuthenticatedUser();if(!r)return!1;switch(t){case"admin":return r.role==="admin";case"community_access":return r.role==="community_user"||r.role==="admin";case"role_management":return r.role==="admin";default:return!1}}catch(r){return console.error("Error checking permission:",r),!1}}async getUserCommunities(t){var r;try{if(!(t||((r=await br.getAuthenticatedUser())==null?void 0:r.id)))return[];const a=await br.getAuthenticatedUser();return a!=null&&a.communityId?[{id:a.communityId,role:a.role==="admin"?"admin":"member"}]:[]}catch(n){return console.error("Error getting user communities:",n),[]}}async validateRouteAccess(t){try{const r=await br.validateUserPermissions(t);return r?{hasAccess:r.hasAccess,redirectTo:r.redirectTo,userRole:r.userRole}:{hasAccess:!1,redirectTo:"/login"}}catch(r){return console.error("Error validating route access:",r),{hasAccess:!1,redirectTo:"/login"}}}};vi(ts,"instance");let $x=ts;const n2=$x.getInstance(),TL={UNEXPECTED_ERROR:"An unexpected error occurred. Please try again."};function uT(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}const dT=L.createContext(void 0);function Nu(){const e=L.useContext(dT);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function IL({children:e}){const[t,r]=L.useState(null),[n,a]=L.useState(!0),[s,o]=L.useState(!1),c=L.useCallback(async()=>{try{a(!0);const x=await br.getAuthenticatedUser();r(x)}catch(x){console.error("Error loading user:",x),r(null)}finally{a(!1),o(!0)}},[]);L.useEffect(()=>{c();const{data:{subscription:x}}=ce.auth.onAuthStateChange(async(y,v)=>{if(console.log("Auth state change:",y),y==="SIGNED_OUT"||!(v!=null&&v.user))r(null),br.clearCache();else if(y==="SIGNED_IN"||y==="TOKEN_REFRESHED")try{const N=await br.getAuthenticatedUser();r(N)}catch(N){console.error("Error refreshing user data:",N),r(null)}});return()=>x.unsubscribe()},[]);const u=L.useCallback(async(x,y)=>{a(!0);try{const v=await br.signIn(x,y);return v.success,v}catch(v){return console.error("Sign in error:",v),{success:!1,error:TL.UNEXPECTED_ERROR}}finally{a(!1)}},[]),f=L.useCallback(async()=>{try{a(!0),await br.signOut(),r(null)}catch(x){console.error("Sign out error:",x)}finally{a(!1)}},[]),m=L.useCallback(async x=>await n2.hasPermission(x),[]),h=L.useCallback(async()=>{try{const x=await br.getAuthenticatedUser();r(x)}catch(x){console.error("Error refreshing user:",x)}},[]),g=L.useCallback(async x=>await n2.validateRouteAccess(x),[]),p={user:t,loading:n&&!s,signIn:u,signOut:f,hasPermission:m,refreshUser:h,validateRouteAccess:g};return i.jsx(dT.Provider,{value:p,children:e})}/**
 */const Lc=Ne("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);class $c extends J.Component{constructor(r){super(r);vi(this,"retryCount",0);vi(this,"maxRetries",3);vi(this,"handleRetry",()=>{this.retryCount<this.maxRetries?(this.retryCount++,console.log(` Error Boundary Retry Attempt ${this.retryCount}/${this.maxRetries}`),this.setState({hasError:!1,error:null,errorId:Date.now().toString(36)})):(console.warn(" Max retry attempts reached, manual intervention required"),window.location.reload())});vi(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorId:Date.now().toString(36)}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorId:Date.now().toString(36)}}componentDidCatch(r,n){var a,s;console.group(" Error Boundary Caught Error"),console.error("Error:",r),console.error("Error Info:",n),console.error("Component Stack:",n.componentStack),console.groupEnd(),(s=(a=this.props).onError)==null||s.call(a,r,n),console.warn("Production error reporting not configured")}render(){var r,n,a,s,o,c;if(this.state.hasError){if(this.props.fallback){const m=this.props.fallback;return i.jsx(m,{error:this.state.error,retry:this.handleRetry})}const u=(n=(r=this.state.error)==null?void 0:r.message)==null?void 0:n.includes("Maximum update depth exceeded"),f=((s=(a=this.state.error)==null?void 0:a.message)==null?void 0:s.includes("navigate"))||((c=(o=this.state.error)==null?void 0:o.message)==null?void 0:c.includes("router"));return i.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:i.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:i.jsxs("div",{className:"bg-white py-8 px-4 shadow-lg sm:rounded-lg sm:px-10",children:[i.jsxs("div",{className:"text-center",children:[i.jsx(Ei,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:u?"System Stability Error":f?"Navigation Error":"Something went wrong"}),i.jsx("p",{className:"text-sm text-gray-600 mb-6",children:u?"The application encountered a rendering loop. This has been automatically contained.":f?"There was an issue with page navigation. You can safely continue using the application.":"An unexpected error occurred, but the system remains stable."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("button",{onClick:this.handleRetry,disabled:this.retryCount>=this.maxRetries,className:"w-full flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(_T,{className:"h-4 w-4 mr-2"}),this.retryCount>=this.maxRetries?"Max Retries Reached":`Try Again (${this.retryCount}/${this.maxRetries})`]}),i.jsxs("button",{onClick:this.handleGoHome,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(bT,{className:"h-4 w-4 mr-2"}),"Go to Dashboard"]})]}),!1]})})})}return this.props.children}}function kT(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=kT(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Xe(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=kT(e))&&(n&&(n+=" "),n+=t);return n}const Aw="-",a$=e=>{const t=o$(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const c=o.split(Aw);return c[0]===""&&c.length!==1&&c.shift(),ET(c,t)||s$(o)},getConflictingClassGroupIds:(o,c)=>{const u=r[o]||[];return c&&n[o]?[...u,...n[o]]:u}}},ET=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?ET(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const s=e.join(Aw);return(o=t.validators.find(({validator:c})=>c(s)))==null?void 0:o.classGroupId},o2=/^\[(.+)\]$/,s$=e=>{if(o2.test(e)){const t=o2.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},o$=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return c$(Object.entries(e.classGroups),r).forEach(([s,o])=>{zx(o,n,s,t)}),n},zx=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const s=a===""?t:l2(t,a);s.classGroupId=r;return}if(typeof a=="function"){if(l$(a)){zx(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([s,o])=>{zx(o,l2(t,s),r,n)})})},l2=(e,t)=>{let r=e;return t.split(Aw).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},l$=e=>e.isThemeGetter,c$=(e,t)=>t?e.map(([r,n])=>{const a=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,c])=>[t+o,c])):s);return[r,a]}):e,u$=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(s,o)=>{r.set(s,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let o=r.get(s);if(o!==void 0)return o;if((o=n.get(s))!==void 0)return a(s,o),o},set(s,o){r.has(s)?r.set(s,o):a(s,o)}}},AT="!",d$=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],s=t.length,o=c=>{const u=[];let f=0,m=0,h;for(let v=0;v<c.length;v++){let N=c[v];if(f===0){if(N===a&&(n||c.slice(v,v+s)===t)){u.push(c.slice(m,v)),m=v+s;continue}if(N==="/"){h=v;continue}}N==="["?f++:N==="]"&&f--}const g=u.length===0?c:c.substring(m),p=g.startsWith(AT),x=p?g.substring(1):g,y=h&&h>m?h-m:void 0;return{modifiers:u,hasImportantModifier:p,baseClassName:x,maybePostfixModifierPosition:y}};return r?c=>r({className:c,parseClassName:o}):o},f$=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},h$=e=>({cache:u$(e.cacheSize),parseClassName:d$(e),...a$(e)}),m$=/\s+/,p$=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,s=[],o=e.trim().split(m$);let c="";for(let u=o.length-1;u>=0;u-=1){const f=o[u],{modifiers:m,hasImportantModifier:h,baseClassName:g,maybePostfixModifierPosition:p}=r(f);let x=!!p,y=n(x?g.substring(0,p):g);if(!y){if(!x){c=f+(c.length>0?" "+c:c);continue}if(y=n(g),!y){c=f+(c.length>0?" "+c:c);continue}x=!1}const v=f$(m).join(":"),N=h?v+AT:v,j=N+y;if(s.includes(j))continue;s.push(j);const S=a(y,x);for(let w=0;w<S.length;++w){const _=S[w];s.push(N+_)}c=f+(c.length>0?" "+c:c)}return c};function g$(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=PT(t))&&(n&&(n+=" "),n+=r);return n}const PT=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=PT(e[n]))&&(r&&(r+=" "),r+=t);return r};function y$(e,...t){let r,n,a,s=o;function o(u){const f=t.reduce((m,h)=>h(m),e());return r=h$(f),n=r.cache.get,a=r.cache.set,s=c,c(u)}function c(u){const f=n(u);if(f)return f;const m=p$(u,r);return a(u,m),m}return function(){return s(g$.apply(null,arguments))}}const kt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},CT=/^\[(?:([a-z-]+):)?(.+)\]$/i,v$=/^\d+\/\d+$/,x$=new Set(["px","full","screen"]),b$=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,w$=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,j$=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,_$=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,N$=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,xi=e=>So(e)||x$.has(e)||v$.test(e),ca=e=>ol(e,"length",T$),So=e=>!!e&&!Number.isNaN(Number(e)),pg=e=>ol(e,"number",So),tc=e=>!!e&&Number.isInteger(Number(e)),S$=e=>e.endsWith("%")&&So(e.slice(0,-1)),Ye=e=>CT.test(e),ua=e=>b$.test(e),O$=new Set(["length","size","percentage"]),k$=e=>ol(e,O$,TT),E$=e=>ol(e,"position",TT),A$=new Set(["image","url"]),P$=e=>ol(e,A$,M$),C$=e=>ol(e,"",I$),rc=()=>!0,ol=(e,t,r)=>{const n=CT.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},T$=e=>w$.test(e)&&!j$.test(e),TT=()=>!1,I$=e=>_$.test(e),M$=e=>N$.test(e),R$=()=>{const e=kt("colors"),t=kt("spacing"),r=kt("blur"),n=kt("brightness"),a=kt("borderColor"),s=kt("borderRadius"),o=kt("borderSpacing"),c=kt("borderWidth"),u=kt("contrast"),f=kt("grayscale"),m=kt("hueRotate"),h=kt("invert"),g=kt("gap"),p=kt("gradientColorStops"),x=kt("gradientColorStopPositions"),y=kt("inset"),v=kt("margin"),N=kt("opacity"),j=kt("padding"),S=kt("saturate"),w=kt("scale"),_=kt("sepia"),O=kt("skew"),k=kt("space"),I=kt("translate"),C=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto",Ye,t],P=()=>[Ye,t],R=()=>["",xi,ca],q=()=>["auto",So,Ye],F=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],W=()=>["","0",Ye],U=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[So,Ye];return{cacheSize:500,separator:":",theme:{colors:[rc],spacing:[xi,ca],blur:["none","",ua,Ye],brightness:D(),borderColor:[e],borderRadius:["none","","full",ua,Ye],borderSpacing:P(),borderWidth:R(),contrast:D(),grayscale:W(),hueRotate:D(),invert:W(),gap:P(),gradientColorStops:[e],gradientColorStopPositions:[S$,ca],inset:T(),margin:T(),opacity:D(),padding:P(),saturate:D(),scale:D(),sepia:W(),skew:D(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",Ye]}],container:["container"],columns:[{columns:[ua]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...F(),Ye]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",tc,Ye]}],basis:[{basis:T()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ye]}],grow:[{grow:W()}],shrink:[{shrink:W()}],order:[{order:["first","last","none",tc,Ye]}],"grid-cols":[{"grid-cols":[rc]}],"col-start-end":[{col:["auto",{span:["full",tc,Ye]},Ye]}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":[rc]}],"row-start-end":[{row:["auto",{span:[tc,Ye]},Ye]}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ye]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ye]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[j]}],px:[{px:[j]}],py:[{py:[j]}],ps:[{ps:[j]}],pe:[{pe:[j]}],pt:[{pt:[j]}],pr:[{pr:[j]}],pb:[{pb:[j]}],pl:[{pl:[j]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ye,t]}],"min-w":[{"min-w":[Ye,t,"min","max","fit"]}],"max-w":[{"max-w":[Ye,t,"none","full","min","max","fit","prose",{screen:[ua]},ua]}],h:[{h:[Ye,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ye,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ye,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ye,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ua,ca]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",pg]}],"font-family":[{font:[rc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ye]}],"line-clamp":[{"line-clamp":["none",So,pg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",xi,Ye]}],"list-image":[{"list-image":["none",Ye]}],"list-style-type":[{list:["none","disc","decimal",Ye]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[N]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",xi,ca]}],"underline-offset":[{"underline-offset":["auto",xi,Ye]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ye]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ye]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[N]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...F(),E$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",k$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},P$]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[N]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[N]}],"divide-style":[{divide:H()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[xi,Ye]}],"outline-w":[{outline:[xi,ca]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:R()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[N]}],"ring-offset-w":[{"ring-offset":[xi,ca]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ua,C$]}],"shadow-color":[{shadow:[rc]}],opacity:[{opacity:[N]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",ua,Ye]}],grayscale:[{grayscale:[f]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[f]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[N]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ye]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",Ye]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ye]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[tc,Ye]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[O]}],"skew-y":[{"skew-y":[O]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ye]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ye]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ye]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[xi,ca,pg]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},D$=y$(R$);function Cf(...e){return D$(Xe(e))}function Ge({size:e="md",className:t}){const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return i.jsx("div",{className:Cf("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",r[e],t)})}function Pw({children:e,allowedRoles:t}){const{user:r,loading:n,validateRouteAccess:a}=Nu(),s=vn(),[o,c]=L.useState({hasAccess:!1,redirectTo:void 0,checked:!1});if(L.useEffect(()=>{async function u(){if(!n){if(!r){c({hasAccess:!1,redirectTo:"/login",checked:!0});return}try{const f=await a(s.pathname);c({hasAccess:f.hasAccess,redirectTo:f.redirectTo,checked:!0})}catch(f){console.error("Error validating route access:",f),c({hasAccess:!1,redirectTo:"/login",checked:!0})}}}u()},[r,n,s.pathname,a]),n||!o.checked)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Verifying authentication..."})]})});if(!o.hasAccess&&o.redirectTo)return i.jsx(Bn,{to:o.redirectTo,replace:!0});if(t&&r&&!t.includes(r.role)){const u=r.role==="admin"?"/admin/dashboard":"/user/community";return i.jsx(Bn,{to:u,replace:!0})}return i.jsx(i.Fragment,{children:e})}function Je({children:e}){return i.jsx(Pw,{allowedRoles:["admin"],children:e})}function c2({children:e}){return i.jsx(Pw,{allowedRoles:["community_user","admin"],children:e})}function L$({children:e}){const{user:t,loading:r}=Nu();if(r)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading..."})]})});if(t){const n=t.role==="admin"?"/admin/dashboard":"/user/community";return i.jsx(Bn,{to:n,replace:!0})}return i.jsx(i.Fragment,{children:e})}function $$(){const{user:e,loading:t}=Nu();if(t)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading..."})]})});if(e){const r=e.role==="admin"?"/admin/dashboard":"/user/community";return i.jsx(Bn,{to:r,replace:!0})}return i.jsx(Bn,{to:"/login",replace:!0})}function q$(){const[e,t]=L.useState(""),[r,n]=L.useState(""),[a,s]=L.useState(!1),[o,c]=L.useState(""),[u,f]=L.useState(!1),{user:m,signIn:h}=Nu();if(vn(),m)return m.role==="admin"?i.jsx(Bn,{to:"/admin/dashboard",replace:!0}):i.jsx(Bn,{to:"/user/community",replace:!0});const g=async p=>{if(p.preventDefault(),c(""),!e||!r){c("Please enter both email and password");return}if(!uT(e)){c("Please enter a valid email address");return}f(!0);try{const x=await h(e,r);x.success||c(x.error||"Login failed")}catch(x){console.error("Login error:",x),c("An unexpected error occurred. Please try again.")}finally{f(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center px-4",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-xl flex items-center justify-center mb-4",children:i.jsx(Mc,{className:"h-8 w-8 text-white"})}),i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"AI GYM Platform"}),i.jsx("p",{className:"mt-2 text-gray-600",children:"Administrator Access Portal"}),i.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Admin & Super Admin Login"})]}),i.jsxs("div",{className:"bg-white shadow-lg rounded-xl border border-gray-200 p-8",children:[i.jsxs("form",{className:"space-y-6",onSubmit:g,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Administrator Email"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:p=>t(p.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"admin@example.com",disabled:u})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{id:"password",name:"password",type:a?"text":"password",autoComplete:"current-password",required:!0,value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your admin password",disabled:u}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!a),disabled:u,children:a?i.jsx(Fn,{className:"h-5 w-5 text-gray-400"}):i.jsx(Ut,{className:"h-5 w-5 text-gray-400"})})]})]}),o&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("p",{className:"text-sm text-red-800",children:o})}),i.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?i.jsxs(i.Fragment,{children:[i.jsx(Ge,{size:"sm",className:"mr-2"}),"Signing in..."]}):"Sign In as Administrator"})]}),i.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-xs text-gray-600 font-medium mb-1",children:"Demo Admin Credentials:"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Email: ez@aiworkify.com"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Password: 12345678"})]}),i.jsx("div",{className:"mt-4 text-center",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Community member?"," ",i.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Access Community Portal"})]})})]})]})})}function u2(){const[e,t]=L.useState(""),[r,n]=L.useState(""),[a,s]=L.useState(!1),[o,c]=L.useState(""),[u,f]=L.useState(!1),{user:m,signIn:h}=Nu();if(vn(),m){if(m.role==="community_user")return i.jsx(Bn,{to:"/user/community",replace:!0});if(m.role==="admin")return i.jsx(Bn,{to:"/admin/dashboard",replace:!0})}const g=async p=>{if(p.preventDefault(),c(""),!e||!r){c("Please enter both email and password");return}if(!uT(e)){c("Please enter a valid email address");return}f(!0);try{const x=await h(e,r);x.success||c(x.error||"Login failed")}catch(x){console.error("Login error:",x),c("An unexpected error occurred. Please try again.")}finally{f(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 flex items-center justify-center px-4",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"mx-auto h-16 w-16 bg-green-600 rounded-xl flex items-center justify-center mb-4",children:i.jsx(Mt,{className:"h-8 w-8 text-white"})}),i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"AI GYM Community"}),i.jsx("p",{className:"mt-2 text-gray-600",children:"Member Access Portal"}),i.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Community Members Login"})]}),i.jsxs("div",{className:"bg-white shadow-lg rounded-xl border border-gray-200 p-8",children:[i.jsxs("form",{className:"space-y-6",onSubmit:g,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Community Email"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:p=>t(p.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",placeholder:"member@example.com",disabled:u})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{id:"password",name:"password",type:a?"text":"password",autoComplete:"current-password",required:!0,value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",placeholder:"Enter your password",disabled:u}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!a),disabled:u,children:a?i.jsx(Fn,{className:"h-5 w-5 text-gray-400"}):i.jsx(Ut,{className:"h-5 w-5 text-gray-400"})})]})]}),o&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("p",{className:"text-sm text-red-800",children:o})}),i.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?i.jsxs(i.Fragment,{children:[i.jsx(Ge,{size:"sm",className:"mr-2"}),"Signing in..."]}):"Access Community"})]}),i.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-xs text-gray-600 font-medium mb-1",children:"Demo Community Credentials:"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Email: dlocal@aiworkify.com"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Password: admin123"})]}),i.jsx("div",{className:"mt-4 text-center",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Platform administrator?"," ",i.jsx("a",{href:"/admin/login",className:"text-blue-600 hover:text-blue-500",children:"Access Admin Portal"})]})})]})]})})}const B$=L.createContext(void 0);function Un(){const e=L.useContext(B$);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function F$(){var h;const{admin:e,signOut:t}=Un(),[r,n]=L.useState(!1),[a,s]=L.useState(!1),o=vn(),c=[{name:"Dashboard",href:"/dashboard",icon:bT},{name:"Communities",href:"/communities",icon:Mc},{name:"Users",href:"/users",icon:Mt},{name:"Tags",href:"/tags",icon:ni},{name:"Training Zone",href:"/training-zone",icon:Kt}],u=[{name:"AI Agents",href:"/content/ai-agents",icon:ls,color:"#3B82F6"},{name:"Videos",href:"/content/videos",icon:Ti,color:"#EF4444"},{name:"Documents",href:"/content/documents",icon:mt,color:"#10B981"},{name:"Images",href:"/content/images",icon:xa,color:"#06B6D4"},{name:"PDFs",href:"/content/pdfs",icon:Sw,color:"#DC2626"},{name:"Prompts",href:"/content/prompts",icon:ki,color:"#8B5CF6"},{name:"Automations",href:"/content/automations",icon:Lc,color:"#F59E0B"}],f=async()=>{await t()},m=o.pathname.startsWith("/content");return i.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center h-16",children:[i.jsx("div",{className:"flex items-center",children:i.jsxs(Et,{to:"/dashboard",className:"flex items-center space-x-3",children:[i.jsx("div",{className:"h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center",children:i.jsx(Mc,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"AI GYM"}),i.jsx("p",{className:"text-xs text-gray-500",children:"by AI Workify"})]})]})}),i.jsxs("nav",{className:"hidden md:flex space-x-8",children:[c.map(g=>{const p=o.pathname===g.href,x=g.icon;return i.jsxs(Et,{to:g.href,className:`inline-flex items-center space-x-1 px-1 pt-1 text-sm font-medium transition-colors ${p?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(x,{className:"h-4 w-4"}),i.jsx("span",{children:g.name})]},g.name)}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>s(!a),className:`inline-flex items-center space-x-1 px-1 pt-1 text-sm font-medium transition-colors ${m?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(mt,{className:"h-4 w-4"}),i.jsx("span",{children:"Content"}),i.jsx(cs,{className:"h-3 w-3"})]}),a&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),i.jsx("div",{className:"absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:i.jsxs("div",{className:"py-2",children:[i.jsx("div",{className:"px-3 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Repositories"}),u.map(g=>{const p=g.icon,x=o.pathname===g.href;return i.jsxs(Et,{to:g.href,className:`flex items-center px-3 py-2 text-sm transition-colors ${x?"bg-blue-50 text-blue-700 border-r-2 border-blue-600":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[i.jsx(p,{className:"mr-3 h-4 w-4",style:{color:g.color}}),g.name]},g.name)})]})})]})]})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>n(!r),className:"flex items-center space-x-3 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white text-sm font-medium",children:e==null?void 0:e.email.charAt(0).toUpperCase()})}),i.jsxs("div",{className:"hidden md:block text-left",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:e==null?void 0:e.email}),i.jsx("p",{className:"text-xs text-gray-500 capitalize",children:(h=e==null?void 0:e.role)==null?void 0:h.replace("_"," ")})]}),i.jsx(cs,{className:"h-4 w-4 text-gray-400"})]})}),r&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),i.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:i.jsxs("div",{className:"py-1",children:[i.jsxs(Et,{to:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>n(!1),children:[i.jsx(xs,{className:"mr-3 h-4 w-4"}),"Settings"]}),i.jsxs("button",{onClick:f,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[i.jsx(jT,{className:"mr-3 h-4 w-4"}),"Sign Out"]})]})})]})]})]})})})}function Rt({children:e}){return i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx(F$,{}),i.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:e})]})}var gg,d2;function zr(){if(d2)return gg;d2=1;var e=Array.isArray;return gg=e,gg}var yg,f2;function IT(){if(f2)return yg;f2=1;var e=typeof Xd=="object"&&Xd&&Xd.Object===Object&&Xd;return yg=e,yg}var vg,h2;function oi(){if(h2)return vg;h2=1;var e=IT(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return vg=r,vg}var xg,m2;function ku(){if(m2)return xg;m2=1;var e=oi(),t=e.Symbol;return xg=t,xg}var bg,p2;function U$(){if(p2)return bg;p2=1;var e=ku(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function s(o){var c=r.call(o,a),u=o[a];try{o[a]=void 0;var f=!0}catch{}var m=n.call(o);return f&&(c?o[a]=u:delete o[a]),m}return bg=s,bg}var wg,g2;function z$(){if(g2)return wg;g2=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return wg=r,wg}var jg,y2;function $i(){if(y2)return jg;y2=1;var e=ku(),t=U$(),r=z$(),n="[object Null]",a="[object Undefined]",s=e?e.toStringTag:void 0;function o(c){return c==null?c===void 0?a:n:s&&s in Object(c)?t(c):r(c)}return jg=o,jg}var _g,v2;function qi(){if(v2)return _g;v2=1;function e(t){return t!=null&&typeof t=="object"}return _g=e,_g}var Ng,x2;function ll(){if(x2)return Ng;x2=1;var e=$i(),t=qi(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return Ng=n,Ng}var Sg,b2;function Cw(){if(b2)return Sg;b2=1;var e=zr(),t=ll(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){if(e(s))return!1;var c=typeof s;return c=="number"||c=="symbol"||c=="boolean"||s==null||t(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Sg=a,Sg}var Og,w2;function Sa(){if(w2)return Og;w2=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Og=e,Og}var kg,j2;function Tw(){if(j2)return kg;j2=1;var e=$i(),t=Sa(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function o(c){if(!t(c))return!1;var u=e(c);return u==n||u==a||u==r||u==s}return kg=o,kg}var Eg,_2;function W$(){if(_2)return Eg;_2=1;var e=oi(),t=e["__core-js_shared__"];return Eg=t,Eg}var Ag,N2;function H$(){if(N2)return Ag;N2=1;var e=W$(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Ag=r,Ag}var Pg,S2;function MT(){if(S2)return Pg;S2=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Pg=r,Pg}var Cg,O2;function V$(){if(O2)return Cg;O2=1;var e=Tw(),t=H$(),r=Sa(),n=MT(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,c=Object.prototype,u=o.toString,f=c.hasOwnProperty,m=RegExp("^"+u.call(f).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(g){if(!r(g)||t(g))return!1;var p=e(g)?m:s;return p.test(n(g))}return Cg=h,Cg}var Tg,k2;function K$(){if(k2)return Tg;k2=1;function e(t,r){return t==null?void 0:t[r]}return Tg=e,Tg}var Ig,E2;function bs(){if(E2)return Ig;E2=1;var e=V$(),t=K$();function r(n,a){var s=t(n,a);return e(s)?s:void 0}return Ig=r,Ig}var Mg,A2;function Lh(){if(A2)return Mg;A2=1;var e=bs(),t=e(Object,"create");return Mg=t,Mg}var Rg,P2;function G$(){if(P2)return Rg;P2=1;var e=Lh();function t(){this.__data__=e?e(null):{},this.size=0}return Rg=t,Rg}var Dg,C2;function Y$(){if(C2)return Dg;C2=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Dg=e,Dg}var Lg,T2;function X$(){if(T2)return Lg;T2=1;var e=Lh(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(s){var o=this.__data__;if(e){var c=o[s];return c===t?void 0:c}return n.call(o,s)?o[s]:void 0}return Lg=a,Lg}var $g,I2;function Z$(){if(I2)return $g;I2=1;var e=Lh(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var s=this.__data__;return e?s[a]!==void 0:r.call(s,a)}return $g=n,$g}var qg,M2;function J$(){if(M2)return qg;M2=1;var e=Lh(),t="__lodash_hash_undefined__";function r(n,a){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&a===void 0?t:a,this}return qg=r,qg}var Bg,R2;function Q$(){if(R2)return Bg;R2=1;var e=G$(),t=Y$(),r=X$(),n=Z$(),a=J$();function s(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var f=o[c];this.set(f[0],f[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,Bg=s,Bg}var Fg,D2;function e8(){if(D2)return Fg;D2=1;function e(){this.__data__=[],this.size=0}return Fg=e,Fg}var Ug,L2;function Iw(){if(L2)return Ug;L2=1;function e(t,r){return t===r||t!==t&&r!==r}return Ug=e,Ug}var zg,$2;function $h(){if($2)return zg;$2=1;var e=Iw();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return zg=t,zg}var Wg,q2;function t8(){if(q2)return Wg;q2=1;var e=$h(),t=Array.prototype,r=t.splice;function n(a){var s=this.__data__,o=e(s,a);if(o<0)return!1;var c=s.length-1;return o==c?s.pop():r.call(s,o,1),--this.size,!0}return Wg=n,Wg}var Hg,B2;function r8(){if(B2)return Hg;B2=1;var e=$h();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return Hg=t,Hg}var Vg,F2;function n8(){if(F2)return Vg;F2=1;var e=$h();function t(r){return e(this.__data__,r)>-1}return Vg=t,Vg}var Kg,U2;function i8(){if(U2)return Kg;U2=1;var e=$h();function t(r,n){var a=this.__data__,s=e(a,r);return s<0?(++this.size,a.push([r,n])):a[s][1]=n,this}return Kg=t,Kg}var Gg,z2;function qh(){if(z2)return Gg;z2=1;var e=e8(),t=t8(),r=r8(),n=n8(),a=i8();function s(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var f=o[c];this.set(f[0],f[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,Gg=s,Gg}var Yg,W2;function Mw(){if(W2)return Yg;W2=1;var e=bs(),t=oi(),r=e(t,"Map");return Yg=r,Yg}var Xg,H2;function a8(){if(H2)return Xg;H2=1;var e=Q$(),t=qh(),r=Mw();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Xg=n,Xg}var Zg,V2;function s8(){if(V2)return Zg;V2=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Zg=e,Zg}var Jg,K2;function Bh(){if(K2)return Jg;K2=1;var e=s8();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Jg=t,Jg}var Qg,G2;function o8(){if(G2)return Qg;G2=1;var e=Bh();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Qg=t,Qg}var ey,Y2;function l8(){if(Y2)return ey;Y2=1;var e=Bh();function t(r){return e(this,r).get(r)}return ey=t,ey}var ty,X2;function c8(){if(X2)return ty;X2=1;var e=Bh();function t(r){return e(this,r).has(r)}return ty=t,ty}var ry,Z2;function u8(){if(Z2)return ry;Z2=1;var e=Bh();function t(r,n){var a=e(this,r),s=a.size;return a.set(r,n),this.size+=a.size==s?0:1,this}return ry=t,ry}var ny,J2;function Rw(){if(J2)return ny;J2=1;var e=a8(),t=o8(),r=l8(),n=c8(),a=u8();function s(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var f=o[c];this.set(f[0],f[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,ny=s,ny}var iy,Q2;function RT(){if(Q2)return iy;Q2=1;var e=Rw(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var s=function(){var o=arguments,c=a?a.apply(this,o):o[0],u=s.cache;if(u.has(c))return u.get(c);var f=n.apply(this,o);return s.cache=u.set(c,f)||u,f};return s.cache=new(r.Cache||e),s}return r.Cache=e,iy=r,iy}var ay,eS;function d8(){if(eS)return ay;eS=1;var e=RT(),t=500;function r(n){var a=e(n,function(o){return s.size===t&&s.clear(),o}),s=a.cache;return a}return ay=r,ay}var sy,tS;function f8(){if(tS)return sy;tS=1;var e=d8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(t,function(o,c,u,f){s.push(u?f.replace(r,"$1"):c||o)}),s});return sy=n,sy}var oy,rS;function Dw(){if(rS)return oy;rS=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,s=Array(a);++n<a;)s[n]=r(t[n],n,t);return s}return oy=e,oy}var ly,nS;function h8(){if(nS)return ly;nS=1;var e=ku(),t=Dw(),r=zr(),n=ll(),a=e?e.prototype:void 0,s=a?a.toString:void 0;function o(c){if(typeof c=="string")return c;if(r(c))return t(c,o)+"";if(n(c))return s?s.call(c):"";var u=c+"";return u=="0"&&1/c==-1/0?"-0":u}return ly=o,ly}var cy,iS;function DT(){if(iS)return cy;iS=1;var e=h8();function t(r){return r==null?"":e(r)}return cy=t,cy}var uy,aS;function LT(){if(aS)return uy;aS=1;var e=zr(),t=Cw(),r=f8(),n=DT();function a(s,o){return e(s)?s:t(s,o)?[s]:r(n(s))}return uy=a,uy}var dy,sS;function Fh(){if(sS)return dy;sS=1;var e=ll();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return dy=t,dy}var fy,oS;function Lw(){if(oS)return fy;oS=1;var e=LT(),t=Fh();function r(n,a){a=e(a,n);for(var s=0,o=a.length;n!=null&&s<o;)n=n[t(a[s++])];return s&&s==o?n:void 0}return fy=r,fy}var hy,lS;function $T(){if(lS)return hy;lS=1;var e=Lw();function t(r,n,a){var s=r==null?void 0:e(r,n);return s===void 0?a:s}return hy=t,hy}var m8=$T();const tn=tt(m8);var my,cS;function p8(){if(cS)return my;cS=1;function e(t){return t==null}return my=e,my}var g8=p8();const Ve=tt(g8);var py,uS;function y8(){if(uS)return py;uS=1;var e=$i(),t=zr(),r=qi(),n="[object String]";function a(s){return typeof s=="string"||!t(s)&&r(s)&&e(s)==n}return py=a,py}var v8=y8();const Eu=tt(v8);var x8=Tw();const Ue=tt(x8);var b8=Sa();const cl=tt(b8);var gy={exports:{}},lt={};/**
        `).eq("user_id",e).eq("activity_type","content_completed").order("created_at",{ascending:!1}).limit(50),A=(C==null?void 0:C.map(T=>{var P;return{id:T.id,content_item:T.content_items||{title:"Content Item",content_type:"document",thumbnail_url:null},practiced_at:T.created_at,completion_score:((P=T.activity_data)==null?void 0:P.score)||Math.floor(Math.random()*40)+60}}))||[];h(A)}catch(C){console.error("Error loading content mastery:",C)}},S=async()=>{if(e)try{const C=[{id:"1",course_title:"AI Fundamentals",progress_percentage:75,lessons_completed:6,total_lessons:8,last_accessed:new Date(Date.now()-1728e5).toISOString()},{id:"2",course_title:"Advanced Prompt Engineering",progress_percentage:45,lessons_completed:9,total_lessons:20,last_accessed:new Date(Date.now()-432e6).toISOString()},{id:"3",course_title:"Machine Learning Basics",progress_percentage:100,lessons_completed:12,total_lessons:12,last_accessed:new Date(Date.now()-864e5).toISOString()}];p(C)}catch(C){console.error("Error loading course progress:",C)}},w=C=>{if(C.length===0)return 0;let A=0;const T=[...C].sort((P,R)=>new Date(R.date).getTime()-new Date(P.date).getTime());for(const P of T)if(P.activities>0)A++;else break;return A};L.useEffect(()=>{v()},[v]),L.useEffect(()=>{o==="content"?j():o==="courses"&&S()},[o,e]);const _=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),O=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=C=>{switch(C){case"ai_agent":return i.jsx(ki,{size:16,className:"text-blue-500"});case"video":return i.jsx(FL,{size:16,className:"text-red-500"});case"document":return i.jsx(mt,{size:16,className:"text-green-500"});default:return i.jsx(vo,{size:16,className:"text-gray-500"})}},I=()=>{switch(o){case"overview":return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.totalActivities}),i.jsx("div",{className:"text-sm text-blue-800",children:"Total Activities"})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.contentCompleted}),i.jsx("div",{className:"text-sm text-green-800",children:"Content Completed"})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.avgScore}),i.jsx("div",{className:"text-sm text-purple-800",children:"Avg Score"})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:x.streakDays}),i.jsx("div",{className:"text-sm text-orange-800",children:"Day Streak"})]}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[x.totalTimeSpent,"m"]}),i.jsx("div",{className:"text-sm text-gray-800",children:"Time Spent"})]})]}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Score (Last 30 Days)"}),i.jsx("div",{className:"h-64",children:i.jsx(lb,{width:"100%",height:"100%",children:i.jsxs(yQ,{data:u,children:[i.jsx(M1,{strokeDasharray:"3 3"}),i.jsx(gl,{dataKey:"date",tick:{fontSize:12},tickFormatter:C=>new Date(C).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),i.jsx(yl,{tick:{fontSize:12}}),i.jsx(fn,{labelFormatter:C=>_(C),formatter:(C,A)=>[C,A==="score"?"Activity Score":"Activities Count"]}),i.jsx(Lu,{type:"monotone",dataKey:"score",stroke:"#3B82F6",strokeWidth:2,dot:{fill:"#3B82F6",strokeWidth:2,r:4}})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),m.slice(0,5).length>0?i.jsx("div",{className:"space-y-3",children:m.slice(0,5).map(C=>i.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg",children:[k(C.content_item.content_type),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.content_item.title}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Completed ",O(C.practiced_at)]})]}),i.jsxs("div",{className:"text-sm font-semibold text-green-600",children:[C.completion_score,"%"]})]},C.id))}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent activity"})]})]});case"content":return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Content Mastery Log"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[m.length," items practiced"]})]}),m.length>0?i.jsx("div",{className:"space-y-3",children:m.map(C=>i.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[k(C.content_item.content_type),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:C.content_item.title}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Practiced on ",O(C.practiced_at)]})]})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[C.completion_score,"%"]}),i.jsx("div",{className:"text-xs text-gray-500",children:"Completion"})]}),C.completion_score>=90&&i.jsx(_r,{size:20,className:"text-green-500"})]})]},C.id))}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(vo,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-gray-500",children:"No content practiced yet"})]})]});case"courses":return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Progress"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[g.length," courses enrolled"]})]}),g.length>0?i.jsx("div",{className:"space-y-4",children:g.map(C=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900",children:C.course_title}),i.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${C.progress_percentage===100?"bg-green-100 text-green-800":C.progress_percentage>=50?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:[C.progress_percentage,"% Complete"]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[i.jsxs("span",{children:[C.lessons_completed," of ",C.total_lessons," lessons"]}),i.jsxs("span",{children:["Last accessed ",_(C.last_accessed)]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${C.progress_percentage}%`}})})]}),C.progress_percentage===100&&i.jsxs("div",{className:"flex items-center text-green-600",children:[i.jsx(_r,{size:16,className:"mr-2"}),i.jsx("span",{className:"text-sm font-medium",children:"Course Completed!"})]})]},C.id))}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(vo,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-gray-500",children:"No courses enrolled yet"})]})]});default:return null}};return a?i.jsx("div",{className:"flex justify-center items-center min-h-screen",children:i.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r?i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"flex items-center justify-between py-6",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("button",{onClick:()=>t(-1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(ri,{size:24})}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white text-xl font-semibold",style:{backgroundColor:r.client.brand_color},children:[r.first_name.charAt(0).toUpperCase(),r.last_name.charAt(0).toUpperCase()]}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r.first_name," ",r.last_name]}),i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(Fx,{size:16}),i.jsx("span",{children:r.email})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(jt,{size:16}),i.jsxs("span",{children:["Joined ",_(r.created_at)]})]}),r.last_active&&i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(_f,{size:16}),i.jsxs("span",{children:["Active ",_(r.last_active)]})]})]}),i.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[r.client.logo_url?i.jsx("img",{src:r.client.logo_url,alt:r.client.name,className:"w-6 h-6 rounded-full"}):i.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:r.client.brand_color}}),i.jsx("span",{className:"text-sm text-gray-700",children:r.client.name})]}),r.tags.length>0&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ni,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:r.tags.map(C=>i.jsx("span",{className:"inline-block px-2 py-1 text-xs text-white rounded-full",style:{backgroundColor:C.color},children:C.name},C.id))})]})]})]})]})]})})})}),i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",label:"Overview",icon:Ew},{id:"content",label:"Content Mastery",icon:vo},{id:"courses",label:"Course Progress",icon:_r}].map(C=>{const A=C.icon;return i.jsxs("button",{onClick:()=>c(C.id),className:`flex items-center space-x-2 px-1 py-4 border-b-2 font-medium text-sm transition-colors ${o===C.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(A,{size:18}),i.jsx("span",{children:C.label})]},C.id)})})})}),i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:I()})})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User not found"}),i.jsx("button",{onClick:()=>t("/clients"),className:"mt-4 text-blue-600 hover:text-blue-800",children:"Back to Clients"})]})},Kee=()=>{const[e]=xw(),t=zt(),r=e.get("community"),[n,a]=L.useState(null),[s,o]=L.useState(!0),[c,u]=L.useState(!1),[f,m]=L.useState(!1),[h,g]=L.useState(!1),[p,x]=L.useState({}),[y,v]=L.useState(!1),[N,j]=L.useState({email:"",password:"",confirmPassword:"",firstName:"",lastName:""});L.useEffect(()=>{if(!r){x({general:"Invalid signup link. Please contact your community administrator."}),o(!1);return}S()},[r]);const S=async()=>{try{o(!0);const{data:k,error:I}=await ce.functions.invoke("community-signup-validator",{body:{signupToken:r}});if(I)throw I;k!=null&&k.data?a({id:k.data.id,name:k.data.community_name,brand_color:k.data.brand_color,logo_url:k.data.logo_url}):x({general:"Invalid or expired signup link. Please contact your community administrator."})}catch(k){console.error("Error validating community token:",k),x({general:"Invalid or expired signup link. Please contact your community administrator."})}finally{o(!1)}},w=()=>{const k={};return N.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(N.email)||(k.email="Please enter a valid email address"):k.email="Email is required",N.password?N.password.length<6&&(k.password="Password must be at least 6 characters long"):k.password="Password is required",N.confirmPassword?N.password!==N.confirmPassword&&(k.confirmPassword="Passwords do not match"):k.confirmPassword="Please confirm your password",N.firstName.trim()||(k.firstName="First name is required"),N.lastName.trim()||(k.lastName="Last name is required"),x(k),Object.keys(k).length===0},_=async k=>{var I;if(k.preventDefault(),!(!w()||!n)){u(!0),x({});try{const{data:C,error:A}=await ce.auth.signUp({email:N.email,password:N.password,options:{data:{first_name:N.firstName,last_name:N.lastName,community_id:n.id,signup_token:r}}});if(A)throw A;if(C.user){const{error:T}=await ce.functions.invoke("community-signup",{body:{action:"complete_signup",user_data:{user_id:C.user.id,community_id:n.id,email:N.email,first_name:N.firstName,last_name:N.lastName,signup_token:r}}});T&&console.error("Error assigning user to community:",T),v(!0),setTimeout(()=>{t("/login?message=Welcome! Please sign in to access your community.")},3e3)}else throw new Error("Signup failed - no user created")}catch(C){console.error("Signup error:",C),(I=C.message)!=null&&I.includes("already registered")?x({email:"This email is already registered. Please sign in instead."}):x({general:C.message||"An error occurred during signup. Please try again."})}finally{u(!1)}}},O=(k,I)=>{j(C=>({...C,[k]:I})),p[k]&&x(C=>({...C,[k]:void 0}))};return s?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Validating signup link..."})]})}):p.general&&!n?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[i.jsx(Ei,{size:48,className:"mx-auto text-red-500 mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Invalid Signup Link"}),i.jsx("p",{className:"text-gray-600 mb-6",children:p.general}),i.jsx("button",{onClick:()=>t("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Community Login"})]})}):y?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[i.jsx(_r,{size:48,className:"mx-auto text-green-500 mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Account Created Successfully!"}),i.jsxs("p",{className:"text-gray-600 mb-4",children:["You've been successfully registered for ",i.jsx("strong",{children:n==null?void 0:n.name}),"."]}),i.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Please check your email to verify your account, then you can sign in to access your community dashboard."}),i.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})]})}):i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n&&i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex justify-center mb-4",children:n.logo_url?i.jsx("img",{src:n.logo_url,alt:n.name,className:"w-16 h-16 rounded-full object-cover border-2 border-gray-200"}):i.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white font-semibold text-xl",style:{backgroundColor:n.brand_color},children:n.name.charAt(0).toUpperCase()})}),i.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Join ",n.name]}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Create your account to get started"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8",children:[i.jsxs("form",{onSubmit:_,className:"space-y-6",children:[p.general&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:i.jsxs("div",{className:"flex",children:[i.jsx(Ei,{size:16,className:"text-red-500 mr-2 mt-0.5"}),i.jsx("p",{className:"text-sm text-red-800",children:p.general})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),i.jsx("input",{id:"firstName",type:"text",value:N.firstName,onChange:k=>O("firstName",k.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.firstName?"border-red-500":"border-gray-300"}`,placeholder:"John",required:!0}),p.firstName&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.firstName})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),i.jsx("input",{id:"lastName",type:"text",value:N.lastName,onChange:k=>O("lastName",k.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.lastName?"border-red-500":"border-gray-300"}`,placeholder:"Doe",required:!0}),p.lastName&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.lastName})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),i.jsx("input",{id:"email",type:"email",value:N.email,onChange:k=>O("email",k.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.email?"border-red-500":"border-gray-300"}`,placeholder:"john@example.com",required:!0}),p.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.email})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{id:"password",type:f?"text":"password",value:N.password,onChange:k=>O("password",k.target.value),className:`w-full border rounded-md px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter your password",required:!0}),i.jsx("button",{type:"button",onClick:()=>m(!f),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:f?i.jsx(Fn,{size:16}):i.jsx(Ut,{size:16})})]}),p.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.password})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password *"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{id:"confirmPassword",type:h?"text":"password",value:N.confirmPassword,onChange:k=>O("confirmPassword",k.target.value),className:`w-full border rounded-md px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm your password",required:!0}),i.jsx("button",{type:"button",onClick:()=>g(!h),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:h?i.jsx(Fn,{size:16}):i.jsx(Ut,{size:16})})]}),p.confirmPassword&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.confirmPassword})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:c,className:`w-full flex justify-center items-center px-4 py-3 border border-transparent rounded-md shadow-sm text-sm font-medium text-white transition-colors ${c?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,style:{backgroundColor:n!=null&&n.brand_color&&!c?n.brand_color:void 0},children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Account..."]}):i.jsxs(i.Fragment,{children:["Create Account",i.jsx(DL,{size:16,className:"ml-2"})]})})})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",i.jsx("button",{onClick:()=>t("/login"),className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in to community"})]})})]})]})})};function Gee(){const e=zt(),{signOut:t,loading:r}=Un();return L.useEffect(()=>{(async()=>{try{await t(),e("/login",{replace:!0})}catch(a){console.error("Logout error:",a),e("/login",{replace:!0})}})()},[t,e]),i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"mb-4",children:i.jsx(jT,{className:"h-12 w-12 text-blue-500 mx-auto"})}),i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Signing out..."})]})})}function D1({user:e,size:t="md",className:r=""}){const n={sm:"h-6 w-6",md:"h-8 w-8",lg:"h-10 w-10"},a={sm:"text-xs",md:"text-sm",lg:"text-base"},s=o=>o?o.charAt(0).toUpperCase():"U";return i.jsx("div",{className:`${n[t]} bg-blue-600 rounded-full flex items-center justify-center ${r}`,children:i.jsx("span",{className:`font-bold text-white ${a[t]}`,children:s(e==null?void 0:e.email)})})}function Yee(){var o;const{user:e}=Un(),[t,r]=L.useState(null),[n,a]=L.useState("");L.useEffect(()=>{async function c(){if(e)try{const{data:u,error:f}=await ce.from("users").select("client_id").eq("id",e.id).maybeSingle();if(f||!u){console.error("Error fetching user data:",f);return}const{data:m,error:h}=await ce.from("clients").select("name, brand_color, logo_url").eq("id",u.client_id).maybeSingle();if(h){console.error("Error fetching client data:",h);return}m&&r(m)}catch(u){console.error("Error:",u)}}c()},[e]);const s=c=>{c.preventDefault(),console.log("Search:",n)};return i.jsx("header",{className:"bg-white border-b border-gray-200 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[t!=null&&t.logo_url?i.jsx("img",{src:t.logo_url,alt:t.name,className:"h-8 w-8 rounded-full"}):i.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-sm",children:((o=t==null?void 0:t.name)==null?void 0:o.charAt(0))||"C"})}),i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:(t==null?void 0:t.name)||"Community"})]}),i.jsx("div",{className:"flex-1 max-w-lg mx-8",children:i.jsxs("form",{onSubmit:s,className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(xn,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",value:n,onChange:c=>a(c.target.value),placeholder:"Search...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-lg",children:[i.jsx(LL,{className:"h-6 w-6"}),i.jsx("span",{className:"absolute top-0 right-0 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-xs font-bold text-white",children:"1"})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(D1,{user:e}),i.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-lg",children:i.jsx(xs,{className:"h-5 w-5"})})]})]})]})})}const Xee=[{name:"Community",path:"/user/community",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-2-2V14M9 8h6.5L21 8.5v0L9 8z"})})},{name:"Training Zone",path:"/user/training-zone",icon:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}];function Zee(){const e=vn();return i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsx("nav",{className:"flex space-x-8","aria-label":"Tabs",children:Xee.map(t=>{const r=e.pathname===t.path;return i.jsxs(Et,{to:t.path,className:Cf("flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),"aria-current":r?"page":void 0,children:[t.icon,i.jsx("span",{children:t.name})]},t.name)})})})})}function Jee({children:e}){return i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx(Yee,{}),i.jsx(Zee,{}),i.jsx("main",{className:"flex-1",children:e})]})}var Qee=e=>{switch(e){case"success":return rte;case"info":return ite;case"warning":return nte;case"error":return ate;default:return null}},ete=Array(12).fill(0),tte=({visible:e,className:t})=>J.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},J.createElement("div",{className:"sonner-spinner"},ete.map((r,n)=>J.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),rte=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),nte=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),ite=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ate=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ste=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},J.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),J.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),ote=()=>{let[e,t]=J.useState(document.hidden);return J.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},hw=1,lte=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:hw++,s=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...e,id:a,title:r}),{...c,...e,id:a,dismissible:o,title:r}):c):this.addToast({title:r,...n,dismissible:o,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),a=r!==void 0,s,o=n.then(async u=>{if(s=["resolve",u],J.isValidElement(u))a=!1,this.create({id:r,type:"default",message:u});else if(ute(u)&&!u.ok){a=!1;let f=typeof t.error=="function"?await t.error(`HTTP error! status: ${u.status}`):t.error,m=typeof t.description=="function"?await t.description(`HTTP error! status: ${u.status}`):t.description;this.create({id:r,type:"error",message:f,description:m})}else if(t.success!==void 0){a=!1;let f=typeof t.success=="function"?await t.success(u):t.success,m=typeof t.description=="function"?await t.description(u):t.description;this.create({id:r,type:"success",message:f,description:m})}}).catch(async u=>{if(s=["reject",u],t.error!==void 0){a=!1;let f=typeof t.error=="function"?await t.error(u):t.error,m=typeof t.description=="function"?await t.description(u):t.description;this.create({id:r,type:"error",message:f,description:m})}}).finally(()=>{var u;a&&(this.dismiss(r),r=void 0),(u=t.finally)==null||u.call(t)}),c=()=>new Promise((u,f)=>o.then(()=>s[0]==="reject"?f(s[1]):u(s[1])).catch(f));return typeof r!="string"&&typeof r!="number"?{unwrap:c}:Object.assign(r,{unwrap:c})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||hw++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Br=new lte,cte=(e,t)=>{let r=(t==null?void 0:t.id)||hw++;return Br.addToast({title:e,...t,id:r}),r},ute=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",dte=cte,fte=()=>Br.toasts,hte=()=>Br.getActiveToasts(),Qr=Object.assign(dte,{success:Br.success,info:Br.info,warning:Br.warning,error:Br.error,custom:Br.custom,message:Br.message,promise:Br.promise,dismiss:Br.dismiss,loading:Br.loading},{getHistory:fte,getToasts:hte});function mte(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}mte(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
                  `,children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(a,{className:`h-5 w-5 ${s?"text-orange-600":"text-gray-500 group-hover:text-gray-700"}`}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:n.name}),i.jsx("p",{className:`text-xs ${s?"text-orange-600":"text-gray-500"}`,children:n.description})]})]}),i.jsx(Su,{className:`h-4 w-4 ${s?"text-orange-600":"text-gray-400 group-hover:text-gray-600"}`})]},n.name)})})]}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(pR,{})})]})})}function vC(){const[e,t]=L.useState({totalWods:0,publishedWods:0,draftWods:0,totalBlocks:0,totalPrograms:0,activeUsers:0}),[r,n]=L.useState([]),[a,s]=L.useState(!0),[o,c]=L.useState(null);L.useEffect(()=>{u()},[]);const u=async()=>{try{s(!0),c(null);const{data:g,error:p}=await ce.from("wods").select("id, title, description, status, created_at, updated_at").order("updated_at",{ascending:!1}).limit(3);p&&console.error("Error fetching WODs:",p);const{count:x}=await ce.from("wods").select("*",{count:"exact",head:!0}),{count:y}=await ce.from("wods").select("*",{count:"exact",head:!0}).eq("status","published"),{count:v}=await ce.from("wods").select("*",{count:"exact",head:!0}).eq("status","draft"),{count:N}=await ce.from("user_activities").select("user_id",{count:"exact",head:!0}).gte("created_at",new Date(Date.now()-30*24*60*60*1e3).toISOString()),j=(g||[]).map(S=>({...S,type:"wod"}));t({totalWods:x||0,publishedWods:y||0,draftWods:v||0,totalBlocks:0,totalPrograms:0,activeUsers:N||0}),n(j)}catch(g){console.error("Error fetching dashboard data:",g),c(g instanceof Error?g.message:"Failed to load dashboard data")}finally{s(!1)}},f=g=>{switch(g){case"published":return"bg-green-100 text-green-800";case"draft":return"bg-yellow-100 text-yellow-800";case"archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},m=g=>{switch(g){case"wod":return Kt;case"block":return cr;case"program":return jt;default:return Dc}},h=g=>{switch(g){case"wod":return"text-orange-600";case"block":return"text-blue-600";case"program":return"text-purple-600";default:return"text-gray-600"}};return a?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading Dashboard..."})]})}):o?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(Ic,{className:"h-12 w-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Dashboard"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:o}),i.jsx("button",{onClick:u,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Try Again"})]})}):i.jsx("div",{className:"h-full overflow-y-auto",children:i.jsxs("div",{className:"p-8 space-y-8",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Training Zone Dashboard"}),i.jsx("p",{className:"mt-2 text-gray-600",children:"Monitor and manage your training content across all modules"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs(Et,{to:"/page-builder",className:"inline-flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-all",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create Page"]}),i.jsxs(Et,{to:"/program-builder",className:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-all",children:[i.jsx(jt,{className:"-ml-1 mr-2 h-4 w-4"}),"Create Program"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6",children:[i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-orange-500 rounded-lg p-3 mr-4",children:i.jsx(Dc,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total WODs"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:e.totalWods.toLocaleString()})]})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-green-500 rounded-lg p-3 mr-4",children:i.jsx(Ut,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Published"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.publishedWods.toLocaleString()})]})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-yellow-500 rounded-lg p-3 mr-4",children:i.jsx(xn,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Drafts"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:e.draftWods.toLocaleString()})]})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-blue-500 rounded-lg p-3 mr-4",children:i.jsx(cr,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"BLOCKS"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.totalBlocks.toLocaleString()})]})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-purple-500 rounded-lg p-3 mr-4",children:i.jsx(jt,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Programs"}),i.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.totalPrograms.toLocaleString()})]})]})}),i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-indigo-500 rounded-lg p-3 mr-4",children:i.jsx(Mt,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),i.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:e.activeUsers.toLocaleString()})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[i.jsxs(Et,{to:"/training-zone/wods",className:"flex items-center space-x-3 p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[i.jsx("div",{className:"bg-orange-100 p-3 rounded-lg group-hover:bg-orange-200 transition-colors",children:i.jsx(Kt,{className:"h-5 w-5 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Browse WODs"}),i.jsx("p",{className:"text-sm text-gray-500",children:"View all workouts"})]})]}),i.jsxs(Et,{to:"/page-builder?repo=wods",className:"flex items-center space-x-3 p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[i.jsx("div",{className:"bg-green-100 p-3 rounded-lg group-hover:bg-green-200 transition-colors",children:i.jsx(_t,{className:"h-5 w-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Create WOD"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Design new workout"})]})]}),i.jsxs(Et,{to:"/training-zone/blocks",className:"flex items-center space-x-3 p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[i.jsx("div",{className:"bg-blue-100 p-3 rounded-lg group-hover:bg-blue-200 transition-colors",children:i.jsx(cr,{className:"h-5 w-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Browse BLOCKS"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Modular components"})]})]}),i.jsxs(Et,{to:"/page-builder?repo=blocks",className:"flex items-center space-x-3 p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[i.jsx("div",{className:"bg-cyan-100 p-3 rounded-lg group-hover:bg-cyan-200 transition-colors",children:i.jsx(_t,{className:"h-5 w-5 text-cyan-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Create BLOCK"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Build new component"})]})]}),i.jsxs(Et,{to:"/training-zone/programs",className:"flex items-center space-x-3 p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[i.jsx("div",{className:"bg-purple-100 p-3 rounded-lg group-hover:bg-purple-200 transition-colors",children:i.jsx(jt,{className:"h-5 w-5 text-purple-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Browse Programs"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Training programs"})]})]}),i.jsxs(Et,{to:"/program-builder",className:"flex items-center space-x-3 p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors group",children:[i.jsx("div",{className:"bg-violet-100 p-3 rounded-lg group-hover:bg-violet-200 transition-colors",children:i.jsx(_t,{className:"h-5 w-5 text-violet-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Create Program"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Build training program"})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Activity"}),i.jsx(Et,{to:"/training-zone/wods",className:"text-sm font-medium text-orange-600 hover:text-orange-700",children:"View All"})]}),i.jsx("div",{className:"p-6",children:r.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"bg-orange-100 mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",children:i.jsx(Ew,{className:"h-12 w-12 text-orange-600"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No recent activity"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Start creating content to see recent activity here."}),i.jsx("div",{className:"mt-6",children:i.jsxs(Et,{to:"/page-builder",className:"inline-flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 shadow-sm",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create Content"]})})]}):i.jsx("div",{className:"space-y-4",children:r.map(g=>{const p=m(g.type);return i.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gray-100",children:i.jsx(p,{className:`h-5 w-5 ${h(g.type)}`})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-gray-900 truncate",children:g.title}),i.jsx("p",{className:"text-sm text-gray-500 truncate",children:g.description||"No description provided"}),i.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${f(g.status)}`,children:g.status}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Updated ",new Date(g.updated_at).toLocaleDateString()]})]})]})]},g.id)})})})]})]})})}function Lte(){const e=zt(),[t,r]=L.useState([]),[n,a]=L.useState([]),[s,o]=L.useState([]),[c,u]=L.useState(!0),[f,m]=L.useState(null),[h,g]=L.useState({}),p=L.useRef(!0),x=L.useRef(""),[y,v]=L.useState(new Set),[N,j]=L.useState(!1),[S,w]=L.useState(!1),[_,O]=L.useState(!1),[k,I]=L.useState(null),[C,A]=L.useState({search:"",communities:[],status:"all",difficulty:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:"cards",showFavorites:!1,folderId:null}),[T,P]=L.useState(!1),R=L.useMemo(()=>JSON.stringify({search:C.search,communities:C.communities.sort(),status:C.status,difficulty:C.difficulty,sortBy:C.sortBy,sortOrder:C.sortOrder,showFavorites:C.showFavorites,folderId:C.folderId}),[C.search,C.communities,C.status,C.difficulty,C.sortBy,C.sortOrder,C.showFavorites,C.folderId]);L.useCallback(async()=>{try{const{data:G,error:Z}=await ce.functions.invoke("folders-api",{method:"GET",headers:{"Content-Type":"application/json"}});return Z?(console.error("Error fetching folders:",Z),[]):(G==null?void 0:G.data)||[]}catch(G){return console.error("Error fetching folders:",G),[]}},[]),L.useCallback(async(G,Z)=>{const{data:X,error:ee}=await ce.functions.invoke("folders-api",{method:"POST",body:{name:G,parent_folder_id:Z,repository_type:"wods"}});if(ee)throw new Error(ee.message||"Failed to create folder");return X==null?void 0:X.data},[]),L.useCallback(async(G,Z,X)=>{const{data:ee,error:re}=await ce.functions.invoke("content-management-api",{method:"POST",body:{action:G,items:Z,repository_type:"wods",folder_id:X}});if(re)throw new Error(re.message||`Failed to ${G} items`);return ee==null?void 0:ee.data},[]);const q=L.useCallback(async()=>{if(!p.current)return;const G=R;if(x.current!==G)try{u(!0),m(null),x.current=G;let Z=ce.from("wods").select("*");C.search.trim()&&(Z=Z.or(`title.ilike.%${C.search}%,description.ilike.%${C.search}%`)),C.status!=="all"&&(Z=Z.eq("status",C.status)),C.difficulty!=="all"&&(Z=Z.eq("difficulty_level",C.difficulty)),Z=Z.order(C.sortBy,{ascending:C.sortOrder==="asc"});const{data:X,error:ee}=await Z;if(!p.current)return;if(ee){console.error("Error fetching WODs:",ee),m("Failed to load WODs"),r([]);return}let re=X||[];if(C.communities.length>0){const{data:Q,error:se}=await ce.from("wod_community_assignments").select("wod_id").in("community_id",C.communities);if(se)console.error("Error fetching assignments:",se);else if(Q){const te=Q.map(ie=>ie.wod_id);re=re.filter(ie=>te.includes(ie.id))}}if(!p.current)return;if(r(re),re.length>0){const Q=re.map(me=>me.id),[se,te]=await Promise.all([ce.from("wod_community_assignments").select("wod_id").in("wod_id",Q),ce.from("user_wods").select("wod_id").in("wod_id",Q)]),ie={};Q.forEach(me=>{var Ce,Re;const ye=((Ce=se.data)==null?void 0:Ce.filter(de=>de.wod_id===me).length)||0,Oe=((Re=te.data)==null?void 0:Re.filter(de=>de.wod_id===me).length)||0;ie[me]=ye+Oe}),p.current&&g(ie)}}catch(Z){console.error("Error in fetchData:",Z),p.current&&(m("Failed to load WODs"),r([]))}finally{p.current&&u(!1)}},[R,C.search,C.communities,C.status,C.difficulty,C.sortBy,C.sortOrder]),F=L.useCallback(async()=>{try{const{data:G,error:Z}=await ce.from("communities").select("*").eq("status","active").order("name");Z?console.error("Error fetching communities:",Z):G&&p.current&&o(G)}catch(G){console.error("Error fetching communities:",G)}},[]);L.useEffect(()=>{q()},[q]),L.useEffect(()=>{F()},[F]),L.useEffect(()=>()=>{p.current=!1},[]);const H=L.useCallback(()=>{e("/page-builder?repo=wods")},[e]),K=L.useCallback(G=>{e(`/page-builder?repo=wods&id=${G}`)},[e]),V=L.useCallback((G,Z)=>{A(X=>({...X,[G]:Z}))},[]),W=L.useCallback(()=>{A(G=>({search:"",communities:[],status:"all",difficulty:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:G.viewMode,showFavorites:!1,folderId:null}))},[]),U=L.useCallback(G=>{const Z={published:{color:"bg-green-100 text-green-800",icon:Ut,label:"Published"},draft:{color:"bg-yellow-100 text-yellow-800",icon:Fn,label:"Draft"},archived:{color:"bg-gray-100 text-gray-800",icon:Fn,label:"Archived"}},X=Z[G]||Z.draft,ee=X.icon;return i.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${X.color}`,children:[i.jsx(ee,{className:"h-3 w-3 mr-1"}),X.label]})},[]),D=L.useCallback(G=>{const Z={beginner:"bg-green-100 text-green-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"};return i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${Z[G]||"bg-gray-100 text-gray-800"}`,children:G})},[]),B=L.useCallback(G=>new Date(G).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[]),z=L.useCallback(G=>{if(G<60)return`${G}m`;const Z=Math.floor(G/60),X=G%60;return X>0?`${Z}h ${X}m`:`${Z}h`},[]);return f&&!c?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(Kt,{className:"h-12 w-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading WODs"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:f}),i.jsx("button",{onClick:()=>{m(null),q()},className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:"Try Again"})]})}):i.jsxs("div",{className:"min-h-full flex bg-gray-50",children:[i.jsxs("div",{className:`transition-all duration-300 ${T?"w-80":"w-12"} bg-white border-r border-gray-200 flex flex-col shadow-sm`,children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("button",{onClick:()=>P(!T),className:"flex items-center justify-center w-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[i.jsx(Na,{className:"h-5 w-5"}),T&&i.jsx("span",{className:"ml-2 text-sm font-medium",children:"Filters"})]})}),T&&i.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search WODs"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),i.jsx("input",{type:"text",placeholder:"Search by title or description...",value:C.search,onChange:G=>V("search",G.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),i.jsxs("select",{value:C.status,onChange:G=>V("status",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"published",children:"Published Only"}),i.jsx("option",{value:"draft",children:"Drafts Only"}),i.jsx("option",{value:"archived",children:"Archived Only"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),i.jsxs("select",{value:C.difficulty,onChange:G=>V("difficulty",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Levels"}),i.jsx("option",{value:"beginner",children:"Beginner"}),i.jsx("option",{value:"intermediate",children:"Intermediate"}),i.jsx("option",{value:"advanced",children:"Advanced"})]})]}),s.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Communities"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:s.map(G=>i.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:C.communities.includes(G.id),onChange:Z=>{Z.target.checked?V("communities",[...C.communities,G.id]):V("communities",C.communities.filter(X=>X!==G.id))},className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:G.brand_color}}),i.jsx("span",{className:"text-sm text-gray-900",children:G.name})]})]},G.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort WODs"}),i.jsxs("select",{value:`${C.sortBy}_${C.sortOrder}`,onChange:G=>{const[Z,X]=G.target.value.split("_");V("sortBy",Z),V("sortOrder",X)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm",children:[i.jsx("option",{value:"updated_at_desc",children:"Last Updated (Newest)"}),i.jsx("option",{value:"updated_at_asc",children:"Last Updated (Oldest)"}),i.jsx("option",{value:"created_at_desc",children:"Date Created (Newest)"}),i.jsx("option",{value:"created_at_asc",children:"Date Created (Oldest)"}),i.jsx("option",{value:"title_asc",children:"Title (A-Z)"}),i.jsx("option",{value:"title_desc",children:"Title (Z-A)"})]})]}),i.jsx("div",{className:"pt-4 border-t border-gray-200",children:i.jsx("button",{onClick:W,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Clear All Filters"})})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center shadow-sm bg-orange-100",children:i.jsx(Kt,{className:"h-6 w-6 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"WODs (Workouts of the Day)"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage fitness challenges and workout programs"}),i.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[i.jsxs("span",{className:"text-xs text-gray-500",children:[t.length," ",t.length===1?"WOD":"WODs"]}),C.status!=="all"&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" Filtered by ",C.status]}),C.difficulty!=="all"&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" ",C.difficulty," level"]}),C.communities.length>0&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" ",C.communities.length," community(s)"]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>V("viewMode","cards"),className:`p-2 rounded-md transition-colors ${C.viewMode==="cards"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Card View",children:i.jsx(Ou,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>V("viewMode","list"),className:`p-2 rounded-md transition-colors ${C.viewMode==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:i.jsx(al,{className:"h-4 w-4"})})]}),i.jsxs("button",{onClick:H,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-all",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create WOD"]})]})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c?i.jsx("div",{className:"flex justify-center items-center py-20",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading WODs..."})]})}):t.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"bg-orange-100 mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",children:i.jsx(Kt,{className:"h-12 w-12 text-orange-600"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No WODs found"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:C.search||C.status!=="all"||C.difficulty!=="all"||C.communities.length>0?"Try adjusting your filters to find more results.":"Get started by creating your first workout of the day."}),i.jsx("div",{className:"mt-6",children:i.jsxs("button",{onClick:H,className:"inline-flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 shadow-sm",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create WOD"]})})]}):i.jsx("div",{className:C.viewMode==="cards"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:t.map(G=>i.jsx("div",{onClick:()=>K(G.id),className:`cursor-pointer group transition-all ${C.viewMode==="cards"?"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md bg-white":"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 bg-white"}`,children:C.viewMode==="cards"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"aspect-video bg-gray-200 relative overflow-hidden",children:[G.thumbnail_url?i.jsx("img",{src:G.thumbnail_url,alt:G.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):i.jsx("div",{className:"w-full h-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center",children:i.jsx(Kt,{className:"h-8 w-8 text-white"})}),i.jsx("div",{className:"absolute top-2 right-2 flex space-x-1",children:U(G.status)})]}),i.jsxs("div",{className:"p-4",children:[i.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-orange-600 transition-colors line-clamp-2",children:G.title}),i.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:G.description||"No description provided"}),i.jsx("div",{className:"flex items-center justify-between mt-3",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[G.difficulty_level&&D(G.difficulty_level),G.estimated_duration_minutes&&i.jsxs("span",{className:"inline-flex items-center text-xs text-gray-500",children:[i.jsx(jt,{className:"h-3 w-3 mr-1"}),z(G.estimated_duration_minutes)]})]})})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center flex-shrink-0",children:G.thumbnail_url?i.jsx("img",{src:G.thumbnail_url,alt:G.title,className:"w-full h-full object-cover rounded-lg"}):i.jsx(Kt,{className:"h-6 w-6 text-gray-500"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:G.title}),i.jsx("p",{className:"text-sm text-gray-600 truncate",children:G.description||"No description provided"}),i.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[U(G.status),G.difficulty_level&&D(G.difficulty_level),G.estimated_duration_minutes&&i.jsxs("span",{className:"inline-flex items-center text-xs text-gray-500",children:[i.jsx(jt,{className:"h-3 w-3 mr-1"}),z(G.estimated_duration_minutes)]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Updated ",B(G.updated_at)]})]})]})]})},G.id))})})]})]})}function $te(){const e=zt(),[t,r]=L.useState([]),[n,a]=L.useState([]),[s,o]=L.useState(!0),[c,u]=L.useState(null),[f,m]=L.useState({}),h=L.useRef(!0),g=L.useRef(""),[p,x]=L.useState({search:"",communities:[],status:"all",difficulty:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:"cards"}),[y,v]=L.useState(!1),N=L.useMemo(()=>JSON.stringify({search:p.search,communities:p.communities.sort(),status:p.status,difficulty:p.difficulty,sortBy:p.sortBy,sortOrder:p.sortOrder}),[p.search,p.communities,p.status,p.difficulty,p.sortBy,p.sortOrder]),j=L.useCallback(async()=>{if(!h.current)return;const P=N;if(g.current!==P)try{o(!0),u(null),g.current=P;const R=new URLSearchParams;p.search.trim()&&R.append("search",p.search),p.status!=="all"&&R.append("status",p.status),p.difficulty!=="all"&&R.append("difficulty",p.difficulty);const q=R.toString(),F=q?`workout-blocks-api?${q}`:"workout-blocks-api",{data:H,error:K}=await ce.functions.invoke(F,{method:"GET",headers:{"Content-Type":"application/json"}});if(!h.current)return;if(K){console.error("Error fetching workout blocks:",K),u("Failed to load BLOCKS"),r([]);return}let V=(H==null?void 0:H.data)||[];if(p.communities.length>0){const{data:W,error:U}=await ce.from("workout_block_community_assignments").select("workout_block_id").in("community_id",p.communities);if(U)console.error("Error fetching assignments:",U);else if(W){const D=W.map(B=>B.workout_block_id);V=V.filter(B=>D.includes(B.id))}}if(V.sort((W,U)=>{const D=W[p.sortBy],B=U[p.sortBy];return p.sortOrder==="asc"?D.localeCompare(B):B.localeCompare(D)}),!h.current)return;if(r(V),V.length>0){const W=V.map(B=>B.id),U=await ce.from("workout_block_community_assignments").select("workout_block_id").in("workout_block_id",W),D={};W.forEach(B=>{var G;const z=((G=U.data)==null?void 0:G.filter(Z=>Z.workout_block_id===B).length)||0;D[B]=z}),h.current&&m(D)}}catch(R){console.error("Error in fetchData:",R),h.current&&(u("Failed to load BLOCKS"),r([]))}finally{h.current&&o(!1)}},[N,p.search,p.communities,p.status,p.difficulty,p.sortBy,p.sortOrder]),S=L.useCallback(async()=>{try{const{data:P,error:R}=await ce.from("communities").select("*").eq("status","active").order("name");R?console.error("Error fetching communities:",R):P&&h.current&&a(P)}catch(P){console.error("Error fetching communities:",P)}},[]);L.useEffect(()=>{j()},[j]),L.useEffect(()=>{S()},[S]),L.useEffect(()=>()=>{h.current=!1},[]);const w=L.useCallback(()=>{e("/page-builder?repo=blocks")},[e]),_=L.useCallback(P=>{e(`/page-builder?repo=blocks&id=${P}`)},[e]),O=L.useCallback((P,R)=>{x(q=>({...q,[P]:R}))},[]),k=L.useCallback(()=>{x(P=>({search:"",communities:[],status:"all",difficulty:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:P.viewMode}))},[]),I=L.useCallback(P=>{const R={published:{color:"bg-green-100 text-green-800",icon:Ut,label:"Published"},draft:{color:"bg-yellow-100 text-yellow-800",icon:Fn,label:"Draft"},archived:{color:"bg-gray-100 text-gray-800",icon:Fn,label:"Archived"}},q=R[P]||R.draft,F=q.icon;return i.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${q.color}`,children:[i.jsx(F,{className:"h-3 w-3 mr-1"}),q.label]})},[]),C=L.useCallback(P=>{const R={beginner:"bg-green-100 text-green-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"};return i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${R[P]||"bg-gray-100 text-gray-800"}`,children:P})},[]),A=L.useCallback(P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[]),T=L.useCallback(P=>{if(P<60)return`${P}m`;const R=Math.floor(P/60),q=P%60;return q>0?`${R}h ${q}m`:`${R}h`},[]);return c&&!s?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(cr,{className:"h-12 w-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading BLOCKS"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:c}),i.jsx("button",{onClick:()=>{u(null),j()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})}):i.jsxs("div",{className:"min-h-full flex bg-gray-50",children:[i.jsxs("div",{className:`transition-all duration-300 ${y?"w-80":"w-12"} bg-white border-r border-gray-200 flex flex-col shadow-sm`,children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("button",{onClick:()=>v(!y),className:"flex items-center justify-center w-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[i.jsx(Na,{className:"h-5 w-5"}),y&&i.jsx("span",{className:"ml-2 text-sm font-medium",children:"Filters"})]})}),y&&i.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search BLOCKS"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),i.jsx("input",{type:"text",placeholder:"Search by title or description...",value:p.search,onChange:P=>O("search",P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),i.jsxs("select",{value:p.status,onChange:P=>O("status",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"published",children:"Published Only"}),i.jsx("option",{value:"draft",children:"Drafts Only"}),i.jsx("option",{value:"archived",children:"Archived Only"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),i.jsxs("select",{value:p.difficulty,onChange:P=>O("difficulty",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Levels"}),i.jsx("option",{value:"beginner",children:"Beginner"}),i.jsx("option",{value:"intermediate",children:"Intermediate"}),i.jsx("option",{value:"advanced",children:"Advanced"})]})]}),n.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Communities"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:n.map(P=>i.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.communities.includes(P.id),onChange:R=>{R.target.checked?O("communities",[...p.communities,P.id]):O("communities",p.communities.filter(q=>q!==P.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:P.brand_color}}),i.jsx("span",{className:"text-sm text-gray-900",children:P.name})]})]},P.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort BLOCKS"}),i.jsxs("select",{value:`${p.sortBy}_${p.sortOrder}`,onChange:P=>{const[R,q]=P.target.value.split("_");O("sortBy",R),O("sortOrder",q)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"updated_at_desc",children:"Last Updated (Newest)"}),i.jsx("option",{value:"updated_at_asc",children:"Last Updated (Oldest)"}),i.jsx("option",{value:"created_at_desc",children:"Date Created (Newest)"}),i.jsx("option",{value:"created_at_asc",children:"Date Created (Oldest)"}),i.jsx("option",{value:"title_asc",children:"Title (A-Z)"}),i.jsx("option",{value:"title_desc",children:"Title (Z-A)"})]})]}),i.jsx("div",{className:"pt-4 border-t border-gray-200",children:i.jsx("button",{onClick:k,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Clear All Filters"})})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center shadow-sm bg-blue-100",children:i.jsx(cr,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"BLOCKS (Modular Workout Components)"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage reusable workout building blocks"}),i.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[i.jsxs("span",{className:"text-xs text-gray-500",children:[t.length," ",t.length===1?"BLOCK":"BLOCKS"]}),p.status!=="all"&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" Filtered by ",p.status]}),p.difficulty!=="all"&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" ",p.difficulty," level"]}),p.communities.length>0&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" ",p.communities.length," community(s)"]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>O("viewMode","cards"),className:`p-2 rounded-md transition-colors ${p.viewMode==="cards"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Card View",children:i.jsx(Ou,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>O("viewMode","list"),className:`p-2 rounded-md transition-colors ${p.viewMode==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:i.jsx(al,{className:"h-4 w-4"})})]}),i.jsxs("button",{onClick:w,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create BLOCK"]})]})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s?i.jsx("div",{className:"flex justify-center items-center py-20",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading BLOCKS..."})]})}):t.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"bg-blue-100 mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",children:i.jsx(cr,{className:"h-12 w-12 text-blue-600"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No BLOCKS found"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:p.search||p.status!=="all"||p.difficulty!=="all"||p.communities.length>0?"Try adjusting your filters to find more results.":"BLOCKS are modular workout components that can be reused across different programs. Get started by creating your first BLOCK."}),i.jsx("div",{className:"mt-6",children:i.jsxs("button",{onClick:w,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-sm",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create BLOCK"]})})]}):i.jsx("div",{className:p.viewMode==="cards"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:t.map(P=>i.jsx("div",{onClick:()=>_(P.id),className:`cursor-pointer group transition-all ${p.viewMode==="cards"?"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md bg-white":"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 bg-white"}`,children:p.viewMode==="cards"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"aspect-video bg-gray-200 relative overflow-hidden",children:[P.thumbnail_url?i.jsx("img",{src:P.thumbnail_url,alt:P.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):i.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center",children:i.jsx(cr,{className:"h-8 w-8 text-white"})}),i.jsx("div",{className:"absolute top-2 right-2 flex space-x-1",children:I(P.status)}),i.jsx("div",{className:"absolute top-2 left-2",children:i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:P.block_category})})]}),i.jsxs("div",{className:"p-4",children:[i.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors line-clamp-2",children:P.title}),i.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:P.description||"No description provided"}),i.jsx("div",{className:"flex items-center justify-between mt-3",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[P.difficulty_level&&C(P.difficulty_level),P.estimated_duration_minutes&&i.jsxs("span",{className:"inline-flex items-center text-xs text-gray-500",children:[i.jsx(jt,{className:"h-3 w-3 mr-1"}),T(P.estimated_duration_minutes)]})]})}),P.equipment_needed&&P.equipment_needed.length>0&&i.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[P.equipment_needed.slice(0,2).map((R,q)=>i.jsx("span",{className:"inline-block text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded",children:R},q)),P.equipment_needed.length>2&&i.jsxs("span",{className:"inline-block text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded",children:["+",P.equipment_needed.length-2," more"]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center flex-shrink-0",children:P.thumbnail_url?i.jsx("img",{src:P.thumbnail_url,alt:P.title,className:"w-full h-full object-cover rounded-lg"}):i.jsx(cr,{className:"h-6 w-6 text-gray-500"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:P.title}),i.jsx("p",{className:"text-sm text-gray-600 truncate",children:P.description||"No description provided"}),i.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[I(P.status),i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:P.block_category}),P.difficulty_level&&C(P.difficulty_level),P.estimated_duration_minutes&&i.jsxs("span",{className:"inline-flex items-center text-xs text-gray-500",children:[i.jsx(jt,{className:"h-3 w-3 mr-1"}),T(P.estimated_duration_minutes)]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Updated ",A(P.updated_at)]})]})]})]})},P.id))})})]})]})}const qte=[{id:"1",title:"Beginner Fitness Foundation",description:"A comprehensive 8-week program designed for fitness beginners to build strength, endurance, and healthy habits.",thumbnail_url:"",status:"published",estimated_duration_weeks:8,difficulty_level:"beginner",tags:["foundation","beginner","full-body"],created_by:"admin",created_at:"2025-01-01T00:00:00Z",updated_at:"2025-01-15T00:00:00Z",folder_id:null,is_favorite:!1,program_type:"strength",weeks_count:8},{id:"2",title:"Advanced Strength Building",description:"Intensive 12-week program focused on progressive strength training and muscle development.",thumbnail_url:"",status:"published",estimated_duration_weeks:12,difficulty_level:"advanced",tags:["strength","muscle-gain","progressive"],created_by:"admin",created_at:"2025-01-02T00:00:00Z",updated_at:"2025-01-20T00:00:00Z",folder_id:null,is_favorite:!0,program_type:"muscle-gain",weeks_count:12},{id:"3",title:"Cardio Blast Program",description:"High-intensity 6-week cardiovascular program to improve endurance and burn calories.",thumbnail_url:"",status:"draft",estimated_duration_weeks:6,difficulty_level:"intermediate",tags:["cardio","hiit","endurance"],created_by:"admin",created_at:"2025-01-05T00:00:00Z",updated_at:"2025-01-22T00:00:00Z",folder_id:null,is_favorite:!1,program_type:"cardio",weeks_count:6}],Bte=[{id:"1",name:"Fitness Beginners",brand_color:"#10B981"},{id:"2",name:"Strength Athletes",brand_color:"#F59E0B"},{id:"3",name:"Cardio Enthusiasts",brand_color:"#EF4444"}];function Fte(){const e=zt(),[t,r]=L.useState([]),[n,a]=L.useState([]),[s,o]=L.useState([]),[c,u]=L.useState(!1),[f,m]=L.useState(null),[h,g]=L.useState({}),p=L.useRef(!0),[x,y]=L.useState(new Set),[v,N]=L.useState(!1),[j,S]=L.useState(!1),[w,_]=L.useState(!1),[O,k]=L.useState(null),[I,C]=L.useState({search:"",communities:[],status:"all",difficulty:"all",programType:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:"cards",showFavorites:!1,folderId:null}),[A,T]=L.useState(!1);L.useEffect(()=>{P(),o(Bte)},[]);const P=async()=>{var z;try{u(!0),m(null);const{data:{session:G}}=await ce.auth.getSession();if(!G)throw new Error("User not authenticated");const ee=await fetch("https://givgsxytkbsdrlmoxzkp.supabase.co/functions/v1/programs-api",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${G.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA"}});if(!ee.ok){const te=await ee.json();throw new Error(((z=te.error)==null?void 0:z.message)||`Failed to load programs: ${ee.status}`)}const se=((await ee.json()).data||[]).map(te=>({id:te.id,title:te.title,description:te.description||"",thumbnail_url:te.thumbnail_url||"",status:te.status,estimated_duration_weeks:te.estimated_duration_weeks,difficulty_level:te.difficulty_level,tags:te.tags||[],created_by:te.created_by,created_at:te.created_at,updated_at:te.updated_at,folder_id:null,is_favorite:!1,program_type:te.program_type,weeks_count:te.estimated_duration_weeks}));r(se)}catch(G){console.error("Error loading programs:",G),m(G instanceof Error?G.message:"Failed to load programs"),r(qte)}finally{u(!1)}};L.useEffect(()=>()=>{p.current=!1},[]);const R=L.useCallback(()=>{e("/program-builder")},[e]),q=L.useCallback(z=>{e(`/program-builder?id=${z}`)},[e]),F=L.useCallback((z,G)=>{C(Z=>({...Z,[z]:G}))},[]),H=L.useCallback(()=>{C(z=>({search:"",communities:[],status:"all",difficulty:"all",programType:"all",sortBy:"updated_at",sortOrder:"desc",viewMode:z.viewMode,showFavorites:!1,folderId:null}))},[]),K=L.useCallback(z=>{const G={published:{color:"bg-green-100 text-green-800",icon:Ut,label:"Published"},draft:{color:"bg-yellow-100 text-yellow-800",icon:Fn,label:"Draft"},archived:{color:"bg-gray-100 text-gray-800",icon:Fn,label:"Archived"}},Z=G[z]||G.draft,X=Z.icon;return i.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${Z.color}`,children:[i.jsx(X,{className:"h-3 w-3 mr-1"}),Z.label]})},[]),V=L.useCallback(z=>{const G={beginner:"bg-green-100 text-green-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"};return i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${G[z]||"bg-gray-100 text-gray-800"}`,children:z})},[]),W=L.useCallback(z=>{const G={strength:"bg-blue-100 text-blue-800",cardio:"bg-red-100 text-red-800","weight-loss":"bg-orange-100 text-orange-800","muscle-gain":"bg-purple-100 text-purple-800",endurance:"bg-green-100 text-green-800",flexibility:"bg-pink-100 text-pink-800"};return i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${G[z]||"bg-gray-100 text-gray-800"}`,children:z.replace("-"," ")})},[]),U=L.useCallback(z=>new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[]),D=L.useCallback(z=>z===1?"1 week":`${z} weeks`,[]),B=L.useMemo(()=>{let z=[...t];if(I.search.trim()){const G=I.search.toLowerCase();z=z.filter(Z=>Z.title.toLowerCase().includes(G)||Z.description.toLowerCase().includes(G))}return I.status!=="all"&&(z=z.filter(G=>G.status===I.status)),I.difficulty!=="all"&&(z=z.filter(G=>G.difficulty_level===I.difficulty)),I.programType!=="all"&&(z=z.filter(G=>G.program_type===I.programType)),I.showFavorites&&(z=z.filter(G=>G.is_favorite)),z.sort((G,Z)=>{const X=G[I.sortBy],ee=Z[I.sortBy];return I.sortOrder==="asc"?X.localeCompare(ee):ee.localeCompare(X)}),z},[t,I]);return f&&!c?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(jt,{className:"h-12 w-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading PROGRAMS"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:f}),i.jsx("button",{onClick:()=>{m(null),P()},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Try Again"})]})}):i.jsxs("div",{className:"min-h-full flex bg-gray-50",children:[i.jsxs("div",{className:`transition-all duration-300 ${A?"w-80":"w-12"} bg-white border-r border-gray-200 flex flex-col shadow-sm`,children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("button",{onClick:()=>T(!A),className:"flex items-center justify-center w-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[i.jsx(Na,{className:"h-5 w-5"}),A&&i.jsx("span",{className:"ml-2 text-sm font-medium",children:"Filters"})]})}),A&&i.jsxs("div",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Programs"}),i.jsxs("div",{className:"relative",children:[i.jsx(xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),i.jsx("input",{type:"text",placeholder:"Search by title or description...",value:I.search,onChange:z=>F("search",z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Status"}),i.jsxs("select",{value:I.status,onChange:z=>F("status",z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"published",children:"Published Only"}),i.jsx("option",{value:"draft",children:"Drafts Only"}),i.jsx("option",{value:"archived",children:"Archived Only"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),i.jsxs("select",{value:I.difficulty,onChange:z=>F("difficulty",z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Levels"}),i.jsx("option",{value:"beginner",children:"Beginner"}),i.jsx("option",{value:"intermediate",children:"Intermediate"}),i.jsx("option",{value:"advanced",children:"Advanced"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Program Type"}),i.jsxs("select",{value:I.programType,onChange:z=>F("programType",z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Types"}),i.jsx("option",{value:"strength",children:"Strength"}),i.jsx("option",{value:"cardio",children:"Cardio"}),i.jsx("option",{value:"weight-loss",children:"Weight Loss"}),i.jsx("option",{value:"muscle-gain",children:"Muscle Gain"}),i.jsx("option",{value:"endurance",children:"Endurance"}),i.jsx("option",{value:"flexibility",children:"Flexibility"})]})]}),s.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Communities"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:s.map(z=>i.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:I.communities.includes(z.id),onChange:G=>{G.target.checked?F("communities",[...I.communities,z.id]):F("communities",I.communities.filter(Z=>Z!==z.id))},className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:z.brand_color}}),i.jsx("span",{className:"text-sm text-gray-900",children:z.name})]})]},z.id))})]}),i.jsx("div",{children:i.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:I.showFavorites,onChange:z=>F("showFavorites",z.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show Favorites Only"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Programs"}),i.jsxs("select",{value:`${I.sortBy}_${I.sortOrder}`,onChange:z=>{const[G,Z]=z.target.value.split("_");F("sortBy",G),F("sortOrder",Z)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",children:[i.jsx("option",{value:"updated_at_desc",children:"Last Updated (Newest)"}),i.jsx("option",{value:"updated_at_asc",children:"Last Updated (Oldest)"}),i.jsx("option",{value:"created_at_desc",children:"Date Created (Newest)"}),i.jsx("option",{value:"created_at_asc",children:"Date Created (Oldest)"}),i.jsx("option",{value:"title_asc",children:"Title (A-Z)"}),i.jsx("option",{value:"title_desc",children:"Title (Z-A)"})]})]}),i.jsx("div",{className:"pt-4 border-t border-gray-200",children:i.jsx("button",{onClick:H,className:"w-full px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Clear All Filters"})})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"h-12 w-12 rounded-xl flex items-center justify-center shadow-sm bg-purple-100",children:i.jsx(jt,{className:"h-6 w-6 text-purple-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"PROGRAMS (Structured Training Programs)"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage comprehensive fitness programs that combine WODs and BLOCKS"}),i.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[i.jsxs("span",{className:"text-xs text-gray-500",children:[B.length," ",B.length===1?"PROGRAM":"PROGRAMS"]}),I.status!=="all"&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" Filtered by ",I.status]}),I.difficulty!=="all"&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" ",I.difficulty," level"]}),I.communities.length>0&&i.jsxs("span",{className:"text-xs text-gray-500",children:[" ",I.communities.length," community(s)"]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>F("viewMode","cards"),className:`p-2 rounded-md transition-colors ${I.viewMode==="cards"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Card View",children:i.jsx(Ou,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>F("viewMode","list"),className:`p-2 rounded-md transition-colors ${I.viewMode==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:i.jsx(al,{className:"h-4 w-4"})})]}),i.jsxs("button",{onClick:R,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-all",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create PROGRAM"]})]})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c?i.jsx("div",{className:"flex justify-center items-center py-20",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading Programs..."})]})}):B.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"bg-purple-100 mx-auto h-24 w-24 rounded-full flex items-center justify-center mb-4",children:i.jsx(jt,{className:"h-12 w-12 text-purple-600"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No Programs found"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:I.search||I.status!=="all"||I.difficulty!=="all"||I.communities.length>0?"Try adjusting your filters to find more results.":"Get started by creating your first training program."}),i.jsx("div",{className:"mt-6",children:i.jsxs("button",{onClick:R,className:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 shadow-sm",children:[i.jsx(_t,{className:"-ml-1 mr-2 h-4 w-4"}),"Create PROGRAM"]})})]}):i.jsx("div",{className:I.viewMode==="cards"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:B.map(z=>i.jsx("div",{onClick:()=>q(z.id),className:`cursor-pointer group transition-all ${I.viewMode==="cards"?"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md bg-white":"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 bg-white"}`,children:I.viewMode==="cards"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"aspect-video bg-gray-200 relative overflow-hidden",children:[z.thumbnail_url?i.jsx("img",{src:z.thumbnail_url,alt:z.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):i.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center",children:i.jsx(jt,{className:"h-8 w-8 text-white"})}),i.jsx("div",{className:"absolute top-2 right-2 flex space-x-1",children:K(z.status)}),z.is_favorite&&i.jsx("div",{className:"absolute top-2 left-2",children:i.jsx(ds,{className:"h-4 w-4 text-yellow-400 fill-current"})})]}),i.jsxs("div",{className:"p-4",children:[i.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-purple-600 transition-colors line-clamp-2",children:z.title}),i.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:z.description||"No description provided"}),i.jsx("div",{className:"flex items-center justify-between mt-3",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[z.difficulty_level&&V(z.difficulty_level),z.program_type&&W(z.program_type)]})}),i.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[i.jsxs("span",{className:"inline-flex items-center text-xs text-gray-500",children:[i.jsx(jt,{className:"h-3 w-3 mr-1"}),D(z.estimated_duration_weeks)]}),i.jsx("span",{className:"text-xs text-gray-400",children:""}),i.jsxs("span",{className:"text-xs text-gray-500",children:[z.weeks_count," weeks"]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center flex-shrink-0",children:z.thumbnail_url?i.jsx("img",{src:z.thumbnail_url,alt:z.title,className:"w-full h-full object-cover rounded-lg"}):i.jsx(jt,{className:"h-6 w-6 text-gray-500"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:z.title}),z.is_favorite&&i.jsx(ds,{className:"h-4 w-4 text-yellow-400 fill-current flex-shrink-0"})]}),i.jsx("p",{className:"text-sm text-gray-600 truncate",children:z.description||"No description provided"}),i.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[K(z.status),z.difficulty_level&&V(z.difficulty_level),z.program_type&&W(z.program_type),i.jsxs("span",{className:"inline-flex items-center text-xs text-gray-500",children:[i.jsx(jt,{className:"h-3 w-3 mr-1"}),D(z.estimated_duration_weeks)]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Updated ",U(z.updated_at)]})]})]})]})},z.id))})})]})]})}function Ute({subsection:e,onUpdate:t,onDelete:r,onMove:n,onAssignContent:a,onSelect:s,isSelected:o,canMoveUp:c,canMoveDown:u}){const[f,m]=L.useState(!1),[h,g]=L.useState(e.title),[p,x]=L.useState(!1),[y,v]=L.useState(!1),N=()=>{t({title:h}),m(!1)},j=()=>{g(e.title),m(!1)},S=k=>{k.key==="Enter"?N():k.key==="Escape"&&j()},w=k=>{a(e.id,k),v(!1),x(!1)},_=k=>k==="wods"?i.jsx(jt,{className:"h-4 w-4"}):i.jsx(Ti,{className:"h-4 w-4"}),O=k=>k==="wods"?"text-orange-600":"text-blue-600";return i.jsxs("div",{className:`group flex items-center justify-between p-3 rounded-lg border transition-all cursor-pointer ${o?"border-purple-300 bg-purple-50":"border-gray-200 bg-gray-50 hover:bg-white hover:border-gray-300"}`,onClick:s,children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx("div",{className:"text-gray-400 hover:text-gray-600 cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(xT,{className:"h-4 w-4"})}),e.assignedContent&&i.jsx("div",{className:`${O(e.assignedContent.type)}`,children:_(e.assignedContent.type)}),i.jsx("div",{className:"flex-1 min-w-0",children:f?i.jsx("input",{type:"text",value:h,onChange:k=>g(k.target.value),onBlur:N,onKeyDown:S,className:"w-full text-sm font-medium text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white rounded px-2 py-1",autoFocus:!0,onClick:k=>k.stopPropagation()}):i.jsxs("div",{className:"truncate",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),e.assignedContent&&i.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[e.assignedContent.type.toUpperCase(),": ",e.assignedContent.title]})]})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:k=>{k.stopPropagation(),x(!p)},className:"p-1 text-gray-400 hover:text-gray-600 rounded transition-colors opacity-0 group-hover:opacity-100",children:i.jsx(pT,{className:"h-4 w-4"})}),p&&i.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-20",children:[i.jsxs("button",{onClick:k=>{k.stopPropagation(),m(!0),x(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(kw,{className:"h-4 w-4"}),i.jsx("span",{children:"Title"})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:k=>{k.stopPropagation(),v(!y)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ow,{className:"h-4 w-4"}),i.jsx("span",{children:"Assign"})]}),i.jsx("span",{className:"text-xs text-gray-400",children:""})]}),y&&i.jsxs("div",{className:"absolute left-full top-0 ml-1 w-32 bg-white rounded-lg shadow-lg border border-gray-200 py-1",children:[i.jsxs("button",{onClick:k=>{k.stopPropagation(),w("wods")},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(jt,{className:"h-4 w-4 text-orange-600"}),i.jsx("span",{children:"WODs"})]}),i.jsxs("button",{onClick:k=>{k.stopPropagation(),w("blocks")},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(Ti,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{children:"BLOCKS"})]})]})]}),c&&i.jsxs("button",{onClick:k=>{k.stopPropagation(),n("up"),x(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(hT,{className:"h-4 w-4"}),i.jsx("span",{children:"Move Up"})]}),u&&i.jsxs("button",{onClick:k=>{k.stopPropagation(),n("down"),x(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(fT,{className:"h-4 w-4"}),i.jsx("span",{children:"Move Down"})]}),i.jsx("hr",{className:"my-1"}),i.jsxs("button",{onClick:k=>{k.stopPropagation(),r(),x(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[i.jsx(Li,{className:"h-4 w-4"}),i.jsx("span",{children:"Delete"})]})]}),(p||y)&&i.jsx("div",{className:"fixed inset-0 z-10",onClick:k=>{k.stopPropagation(),x(!1),v(!1)}})]})]})}function zte({section:e,onUpdate:t,onDelete:r,onMove:n,onAddSubsection:a,onUpdateSubsection:s,onDeleteSubsection:o,onMoveSubsection:c,onAssignContent:u,onSubsectionSelect:f,selectedSubsectionId:m,canMoveUp:h,canMoveDown:g}){const[p,x]=L.useState(!1),[y,v]=L.useState(e.title),[N,j]=L.useState(!1),S=()=>{t({title:y}),x(!1)},w=()=>{v(e.title),x(!1)},_=k=>{k.key==="Enter"?S():k.key==="Escape"&&w()},O=()=>{t({isExpanded:!e.isExpanded})};return i.jsxs("div",{className:"border border-gray-200 rounded-lg bg-white",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[i.jsx("div",{className:"text-gray-400 hover:text-gray-600 cursor-move",children:i.jsx(xT,{className:"h-4 w-4"})}),i.jsx("button",{onClick:O,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.isExpanded?i.jsx(cs,{className:"h-4 w-4"}):i.jsx(Su,{className:"h-4 w-4"})}),i.jsx("span",{className:"text-sm font-medium text-purple-600 bg-purple-100 px-2 py-1 rounded",children:e.order}),i.jsx("div",{className:"flex-1",children:p?i.jsx("input",{type:"text",value:y,onChange:k=>v(k.target.value),onBlur:S,onKeyDown:_,className:"w-full text-lg font-bold text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white rounded px-2 py-1",autoFocus:!0}):i.jsx("h3",{className:"text-lg font-bold text-gray-900 cursor-pointer hover:text-purple-600 transition-colors",onClick:()=>x(!0),children:e.title})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>j(!N),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg transition-colors",children:i.jsx(pT,{className:"h-4 w-4"})}),N&&i.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[i.jsxs("button",{onClick:()=>{x(!0),j(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(kw,{className:"h-4 w-4"}),i.jsx("span",{children:"Edit Title"})]}),h&&i.jsxs("button",{onClick:()=>{n("up"),j(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(hT,{className:"h-4 w-4"}),i.jsx("span",{children:"Move Up"})]}),g&&i.jsxs("button",{onClick:()=>{n("down"),j(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[i.jsx(fT,{className:"h-4 w-4"}),i.jsx("span",{children:"Move Down"})]}),i.jsx("hr",{className:"my-1"}),i.jsxs("button",{onClick:()=>{r(),j(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[i.jsx(Li,{className:"h-4 w-4"}),i.jsx("span",{children:"Delete Section"})]})]}),N&&i.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>j(!1)})]})]}),e.isExpanded&&i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"space-y-2",children:[e.subsections.map((k,I)=>i.jsx(Ute,{subsection:k,onUpdate:C=>s(k.id,C),onDelete:()=>o(k.id),onMove:C=>c(k.id,C),onAssignContent:u,onSelect:()=>f(k.id),isSelected:m===k.id,canMoveUp:I>0,canMoveDown:I<e.subsections.length-1},k.id)),i.jsxs("button",{onClick:a,className:"w-full p-3 border-2 border-dashed border-gray-200 rounded-lg text-gray-500 hover:text-purple-600 hover:border-purple-300 transition-colors flex items-center justify-center space-x-2",children:[i.jsx(_t,{className:"h-4 w-4"}),i.jsx("span",{children:"Add Subsection"})]})]})})]})}function Wte({programData:e,setProgramData:t,onAssignContent:r,onSubsectionSelect:n,selectedSubsectionId:a}){const s=()=>{const p={id:`section-${Date.now()}`,title:`Section ${e.sections.length+1}`,order:e.sections.length+1,isExpanded:!0,subsections:[]};t({...e,sections:[...e.sections,p]})},o=(p,x)=>{t({...e,sections:e.sections.map(y=>y.id===p?{...y,...x}:y)})},c=p=>{const x=e.sections.filter(y=>y.id!==p).map((y,v)=>({...y,order:v+1}));t({...e,sections:x})},u=(p,x)=>{const y=e.sections.findIndex(v=>v.id===p);if(x==="up"&&y>0||x==="down"&&y<e.sections.length-1){const v=[...e.sections],N=x==="up"?y-1:y+1;[v[y],v[N]]=[v[N],v[y]],v.forEach((j,S)=>{j.order=S+1}),t({...e,sections:v})}},f=p=>{const x=e.sections.find(v=>v.id===p);if(!x)return;const y={id:`subsection-${Date.now()}`,title:`Subsection ${x.subsections.length+1}`,order:x.subsections.length+1,sectionId:p};o(p,{subsections:[...x.subsections,y]})},m=(p,x)=>{t({...e,sections:e.sections.map(y=>({...y,subsections:y.subsections.map(v=>v.id===p?{...v,...x}:v)}))})},h=p=>{t({...e,sections:e.sections.map(x=>({...x,subsections:x.subsections.filter(y=>y.id!==p).map((y,v)=>({...y,order:v+1}))}))})},g=(p,x)=>{const y=e.sections.find(N=>N.subsections.some(j=>j.id===p));if(!y)return;const v=y.subsections.findIndex(N=>N.id===p);if(x==="up"&&v>0||x==="down"&&v<y.subsections.length-1){const N=[...y.subsections],j=x==="up"?v-1:v+1;[N[v],N[j]]=[N[j],N[v]],N.forEach((S,w)=>{S.order=w+1}),o(y.id,{subsections:N})}};return i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-100",children:[i.jsx("input",{type:"text",value:e.title,onChange:p=>t({...e,title:p.target.value}),className:"w-full text-lg font-semibold text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white rounded px-2 py-1",placeholder:"Program Title"}),i.jsx("textarea",{value:e.description,onChange:p=>t({...e,description:p.target.value}),className:"w-full mt-2 text-sm text-gray-600 bg-transparent border-none outline-none resize-none focus:ring-2 focus:ring-purple-500 focus:bg-white rounded px-2 py-1",placeholder:"Program description...",rows:2})]}),i.jsxs("div",{className:"p-6 space-y-4",children:[e.sections.map(p=>i.jsx(zte,{section:p,onUpdate:x=>o(p.id,x),onDelete:()=>c(p.id),onMove:x=>u(p.id,x),onAddSubsection:()=>f(p.id),onUpdateSubsection:m,onDeleteSubsection:h,onMoveSubsection:g,onAssignContent:r,onSubsectionSelect:n,selectedSubsectionId:a,canMoveUp:p.order>1,canMoveDown:p.order<e.sections.length},p.id)),i.jsxs("button",{onClick:s,className:"w-full p-4 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:text-purple-600 hover:border-purple-300 transition-colors flex items-center justify-center space-x-2",children:[i.jsx(_t,{className:"h-5 w-5"}),i.jsx("span",{children:"Add Section"})]})]})]})}function L1({block:e,isSelected:t,canMoveUp:r,canMoveDown:n,onSelect:a,onMoveUp:s,onMoveDown:o,onDelete:c,isPreview:u=!1}){const f=()=>{var m,h,g,p,x,y,v,N,j,S,w,_,O,k,I,C;switch(e.type){case"section-header":return i.jsx("div",{className:"text-center",children:i.jsx("h2",{className:`font-bold ${e.data.level==="h1"?"text-3xl":e.data.level==="h2"?"text-2xl":e.data.level==="h3"?"text-xl":e.data.level==="h4"?"text-lg":e.data.level==="h5"?"text-base":"text-sm"}`,children:e.data.text||"Section Title"})});case"rich-text":return i.jsx("div",{className:"prose max-w-none",children:i.jsx("p",{children:e.data.content||"Enter your text here..."})});case"list":return i.jsx("div",{children:i.jsx("ul",{className:"list-disc list-inside space-y-1",children:(e.data.items||["List item 1"]).map((z,G)=>i.jsx("li",{className:"text-gray-700",children:z},G))})});case"division":return i.jsx("div",{className:"flex justify-center py-4",children:i.jsx("div",{className:"w-24 h-px bg-gray-300"})});case"quote":return i.jsxs("blockquote",{className:"border-l-4 border-blue-500 pl-4 italic text-gray-700",children:[i.jsxs("p",{children:['"',e.data.text||"Quote text",'"']}),e.data.author&&i.jsxs("cite",{className:"block mt-2 text-sm text-gray-500",children:[" ",e.data.author]})]});case"quiz":return i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsx("h3",{className:"font-semibold mb-2",children:e.data.title||"Quiz Title"}),i.jsxs("p",{className:"text-gray-600 text-sm",children:[((m=e.data.questions)==null?void 0:m.length)||0," questions"]})]});case"image-upload":return i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),i.jsx("p",{className:"text-gray-600",children:"Image upload block"}),e.data.caption&&i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:e.data.caption})]});case"video":const A=e.data.selectedContent;if(u&&((h=A==null?void 0:A.video)!=null&&h.video_url)){const z=A.video.video_url,G=(g=A.video.video_platform)==null?void 0:g.toLowerCase(),Z=A.video.video_id,X=()=>G==="youtube"&&Z?i.jsx("div",{className:"aspect-video",children:i.jsx("iframe",{src:`https://www.youtube.com/embed/${Z}?rel=0&modestbranding=1`,className:"w-full h-full rounded-lg border-0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,title:A.title,loading:"lazy"})}):G==="vimeo"&&Z?i.jsx("div",{className:"aspect-video",children:i.jsx("iframe",{src:`https://player.vimeo.com/video/${Z}?h=0&badge=0&autopause=0&player_id=0&app_id=58479`,className:"w-full h-full rounded-lg border-0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:A.title,loading:"lazy"})}):z&&(z.includes(".mp4")||z.includes(".webm")||z.includes(".ogg"))?i.jsx("div",{className:"aspect-video",children:i.jsxs("video",{controls:!0,className:"w-full h-full rounded-lg object-cover",src:z,poster:A.video.thumbnail_url,children:[i.jsx("source",{src:z,type:`video/${z.split(".").pop()}`}),"Your browser does not support the video tag."]})}):i.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"text-gray-600",children:"Video format not supported for preview"}),i.jsx("a",{href:z,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline text-sm mt-2 block",children:"Open video in new tab"})]})});return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-semibold",children:A.title}),A.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:A.description}),A.video.duration_seconds&&i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Duration: ",Math.floor(A.video.duration_seconds/60),":",(A.video.duration_seconds%60).toString().padStart(2,"0")]})]}),X()]})}const P=(()=>{var z,G,Z;return(z=A==null?void 0:A.video)!=null&&z.thumbnail_url?A.video.thumbnail_url:((G=A==null?void 0:A.video)==null?void 0:G.video_platform)==="youtube"&&((Z=A==null?void 0:A.video)!=null&&Z.video_id)?`https://img.youtube.com/vi/${A.video.video_id}/mqdefault.jpg`:null})();return i.jsxs("div",{className:"bg-gray-100 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(A==null?void 0:A.title)||"Video Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(A==null?void 0:A.description)||"Select a video from repository"}),((p=A==null?void 0:A.video)==null?void 0:p.video_platform)&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1 capitalize",children:["Platform: ",A.video.video_platform]}),((x=A==null?void 0:A.video)==null?void 0:x.duration_seconds)&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Duration: ",Math.floor(A.video.duration_seconds/60),":",(A.video.duration_seconds%60).toString().padStart(2,"0")]}),P&&i.jsx("div",{className:"mt-4",children:i.jsx("img",{src:P,alt:A.title,className:"w-40 h-24 object-cover rounded mx-auto shadow-sm",onError:z=>{z.currentTarget.style.display="none"}})})]});case"ai-agent":const R=e.data.selectedContent;return u&&((y=R==null?void 0:R.ai_agent)!=null&&y.system_prompt)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:R.ai_agent.agent_name||R.title}),R.ai_agent.short_description&&i.jsx("p",{className:"text-gray-600 mt-2",children:R.ai_agent.short_description})]}),i.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:"AI"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"AI Agent Ready"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"This AI agent is configured and ready to assist. In a real training environment, you would be able to interact with it directly."}),i.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"System Prompt Preview:"}),i.jsxs("p",{className:"text-sm text-gray-700 line-clamp-3",children:[R.ai_agent.system_prompt.substring(0,200),R.ai_agent.system_prompt.length>200?"...":""]})]}),R.ai_agent.test_conversations&&R.ai_agent.test_conversations.length>0&&i.jsx("div",{className:"mt-3",children:i.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:[R.ai_agent.test_conversations.length," test conversation(s) available"]})})]})]})})]}):i.jsxs("div",{className:"bg-blue-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:((v=R==null?void 0:R.ai_agent)==null?void 0:v.agent_name)||(R==null?void 0:R.title)||"AI Agent Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:((N=R==null?void 0:R.ai_agent)==null?void 0:N.short_description)||(R==null?void 0:R.description)||"Select an AI agent from repository"}),((j=R==null?void 0:R.ai_agent)==null?void 0:j.test_conversations)&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[R.ai_agent.test_conversations.length," test conversation(s)"]})]});case"document":const q=e.data.selectedContent,H=(()=>{var z,G,Z;return q&&(((z=q.document)==null?void 0:z.content_html)||q.content_html||q.content||q.text||q.description||((G=q.document)==null?void 0:G.content)||((Z=q.document)==null?void 0:Z.text))||null})();return u&&H?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:(q==null?void 0:q.title)||"Document"}),(q==null?void 0:q.description)&&i.jsx("p",{className:"text-gray-600 mt-2",children:q.description}),((S=q==null?void 0:q.document)==null?void 0:S.word_count)&&i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[q.document.word_count," words  ",q.document.reading_time_minutes," min read"]})]}),i.jsx("div",{className:"prose max-w-none",children:H.includes("<")?i.jsx("div",{dangerouslySetInnerHTML:{__html:H}}):i.jsx("div",{className:"whitespace-pre-wrap",children:H})})]}):i.jsxs("div",{className:"bg-green-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(q==null?void 0:q.title)||"Document Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(q==null?void 0:q.description)||"Select a document from repository"}),((w=q==null?void 0:q.document)==null?void 0:w.word_count)&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[q.document.word_count," words  ",q.document.reading_time_minutes," min read"]})]});case"image":const K=e.data.selectedContent;return u&&((_=K==null?void 0:K.image)!=null&&_.image_url)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-semibold",children:K.title}),K.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:K.description})]}),i.jsxs("div",{className:"flex justify-center",children:[i.jsx("img",{src:K.image.image_url,alt:K.image.alt_text||K.title,className:"max-w-full h-auto rounded-lg shadow-md",style:{maxHeight:K.image.height&&K.image.height>600?"600px":"auto"},onError:z=>{z.currentTarget.style.display="none";const G=z.currentTarget.nextElementSibling;G&&(G.style.display="block")}}),i.jsxs("div",{className:"bg-gray-100 rounded-lg p-8 text-center",style:{display:"none"},children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"text-gray-600",children:"Failed to load image"})]})]}),K.image.alt_text&&i.jsx("p",{className:"text-sm text-gray-500 text-center italic",children:K.image.alt_text}),(K.image.width||K.image.height||K.image.file_size)&&i.jsxs("div",{className:"text-xs text-gray-400 text-center space-x-4",children:[K.image.width&&K.image.height&&i.jsxs("span",{children:[K.image.width,"  ",K.image.height,"px"]}),K.image.file_size&&i.jsxs("span",{children:[Math.round(K.image.file_size/1024)," KB"]})]})]}):i.jsxs("div",{className:"bg-purple-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(K==null?void 0:K.title)||"Image Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(K==null?void 0:K.description)||"Select an image from repository"}),(K==null?void 0:K.image)&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1 space-x-4",children:[K.image.width&&K.image.height&&i.jsxs("span",{children:[K.image.width,"  ",K.image.height,"px"]}),K.image.file_size&&i.jsxs("span",{children:[Math.round(K.image.file_size/1024)," KB"]})]})]});case"pdf":const V=e.data.selectedContent;return u&&((O=V==null?void 0:V.pdf)!=null&&O.pdf_url)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:V.title}),V.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:V.description}),i.jsxs("div",{className:"flex justify-center items-center space-x-4 text-sm text-gray-500 mt-2",children:[V.pdf.page_count&&i.jsxs("span",{children:[V.pdf.page_count," pages"]}),V.pdf.file_size&&i.jsxs("span",{children:[Math.round(V.pdf.file_size/1048576)," MB"]}),i.jsx("a",{href:V.pdf.pdf_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"Open in new tab"})]})]}),i.jsx("div",{className:"w-full",children:i.jsx("iframe",{src:`${V.pdf.pdf_url}#toolbar=1&navpanes=1&scrollbar=1`,className:"w-full h-96 border border-gray-300 rounded-lg",title:V.title,onError:()=>{console.log("PDF iframe failed to load")}})})]}):i.jsxs("div",{className:"bg-red-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(V==null?void 0:V.title)||"PDF Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(V==null?void 0:V.description)||"Select a PDF from repository"}),(V==null?void 0:V.pdf)&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1 space-x-4",children:[V.pdf.page_count&&i.jsxs("span",{children:[V.pdf.page_count," pages"]}),V.pdf.file_size&&i.jsxs("span",{children:[Math.round(V.pdf.file_size/1048576)," MB"]})]})]});case"prompts":const W=e.data.selectedContent;return u&&((k=W==null?void 0:W.prompt)!=null&&k.prompt_text)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:W.title}),W.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:W.description}),i.jsxs("div",{className:"flex justify-center items-center space-x-4 text-sm text-gray-500 mt-2",children:[W.prompt.prompt_category&&i.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:W.prompt.prompt_category}),W.prompt.usage_count>0&&i.jsxs("span",{children:["Used ",W.prompt.usage_count," times"]})]})]}),i.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center text-white text-xl",children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Prompt Template"}),i.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 shadow-sm",children:i.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-700 font-mono leading-relaxed",children:W.prompt.prompt_text})}),i.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[i.jsxs("p",{className:"text-xs text-gray-500",children:[W.prompt.prompt_text.length," characters"]}),i.jsx("button",{className:"px-3 py-1 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors",children:"Copy Prompt"})]})]})]})})]}):i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(W==null?void 0:W.title)||"Prompts Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(W==null?void 0:W.description)||"Select prompts from repository"}),(W==null?void 0:W.prompt)&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1 space-x-4",children:[W.prompt.prompt_category&&i.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:W.prompt.prompt_category}),W.prompt.usage_count>0&&i.jsxs("span",{children:["Used ",W.prompt.usage_count," times"]})]})]});case"automation":const U=e.data.selectedContent;return u&&((I=U==null?void 0:U.automation)!=null&&I.automation_url)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:U.title}),U.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:U.description})]}),i.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center text-white text-xl",children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Automation Workflow"}),U.automation.tool_description&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Description"}),i.jsx("p",{className:"text-sm text-gray-600",children:U.automation.tool_description})]}),U.automation.required_tools&&U.automation.required_tools.length>0&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Required Tools"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:U.automation.required_tools.map((z,G)=>i.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs",children:z},G))})]}),U.automation.setup_instructions&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Setup Instructions"}),i.jsx("div",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:U.automation.setup_instructions})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Automation ready to deploy"}),i.jsx("a",{href:U.automation.automation_url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-orange-500 text-white text-sm rounded hover:bg-orange-600 transition-colors",children:"Open Automation"})]})]})]})})]}):i.jsxs("div",{className:"bg-orange-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(U==null?void 0:U.title)||"Automation Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(U==null?void 0:U.description)||"Select automation from repository"}),((C=U==null?void 0:U.automation)==null?void 0:C.required_tools)&&U.automation.required_tools.length>0&&i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[i.jsx("p",{children:"Required tools:"}),i.jsx("div",{className:"flex justify-center flex-wrap gap-1 mt-1",children:U.automation.required_tools.map((z,G)=>i.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded",children:z},G))})]})]});case"wods":const D=e.data.selectedContent;return u&&(D!=null&&D.wod)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:D.title}),D.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:D.description}),i.jsxs("div",{className:"flex justify-center items-center space-x-4 text-sm text-gray-500 mt-2",children:[D.wod.duration_minutes&&i.jsxs("span",{children:[D.wod.duration_minutes," min"]}),D.wod.difficulty_level&&i.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs",children:[D.wod.difficulty_level," difficulty"]})]})]}),i.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center text-white text-xl",children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Workout of the Day"}),D.wod.instructions&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Instructions"}),i.jsx("div",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:D.wod.instructions})]}),D.wod.target_muscle_groups&&D.wod.target_muscle_groups.length>0&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Target Muscle Groups"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:D.wod.target_muscle_groups.map((z,G)=>i.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs",children:z},G))})]}),D.wod.equipment_needed&&D.wod.equipment_needed.length>0&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Equipment Needed"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:D.wod.equipment_needed.map((z,G)=>i.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs",children:z},G))})]}),D.wod.notes&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Notes"}),i.jsx("p",{className:"text-sm text-gray-600",children:D.wod.notes})]})]})]})})]}):i.jsxs("div",{className:"bg-orange-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(D==null?void 0:D.title)||"WOD Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(D==null?void 0:D.description)||"Select a WOD from repository"}),(D==null?void 0:D.wod)&&i.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-x-4",children:[D.wod.duration_minutes&&i.jsxs("span",{children:[D.wod.duration_minutes," min"]}),D.wod.difficulty_level&&i.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded",children:[D.wod.difficulty_level," difficulty"]})]})]});case"blocks":const B=e.data.selectedContent;return u&&(B!=null&&B.block)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:B.title}),B.description&&i.jsx("p",{className:"text-gray-600 mt-2",children:B.description}),i.jsxs("div",{className:"flex justify-center items-center space-x-4 text-sm text-gray-500 mt-2",children:[B.block.duration_minutes&&i.jsxs("span",{children:[B.block.duration_minutes," min"]}),B.block.intensity_level&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:[B.block.intensity_level," intensity"]}),B.block.block_type&&i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:B.block.block_type})]})]}),i.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6",children:i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-xl",children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Training Block"}),B.block.instructions&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Instructions"}),i.jsx("div",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:B.block.instructions})]}),B.block.target_area&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-2",children:"Target Area"}),i.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:B.block.target_area})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[B.block.repetitions>0&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-1",children:"Repetitions"}),i.jsx("p",{className:"text-lg font-bold text-blue-600",children:B.block.repetitions})]}),B.block.rest_periods>0&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-1",children:"Rest Period"}),i.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[B.block.rest_periods,"s"]})]}),B.block.intensity_level&&i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[i.jsx("h5",{className:"font-medium text-sm text-gray-900 mb-1",children:"Intensity"}),i.jsx("p",{className:"text-lg font-bold text-blue-600",children:B.block.intensity_level})]})]})]})]})})]}):i.jsxs("div",{className:"bg-blue-50 rounded-lg p-8 text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("p",{className:"font-medium",children:(B==null?void 0:B.title)||"Training Block"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(B==null?void 0:B.description)||"Select a training block from repository"}),(B==null?void 0:B.block)&&i.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-x-4",children:[B.block.duration_minutes&&i.jsxs("span",{children:[B.block.duration_minutes," min"]}),B.block.intensity_level&&i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded",children:[B.block.intensity_level," intensity"]})]})]});default:return i.jsxs("div",{className:"text-center text-gray-400",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsxs("p",{children:["Unknown block type: ",e.type]})]})}};return u?i.jsx("div",{className:"bg-white rounded-lg",children:f()}):i.jsxs("div",{className:`
                  `,onClick:()=>t(_),children:h==="grid"?i.jsxs("div",{children:[i.jsxs("div",{className:"aspect-video bg-gray-100 rounded-lg mb-3 flex items-center justify-center overflow-hidden",children:[_.thumbnail_url?i.jsx("img",{src:_.thumbnail_url,alt:_.title,className:"w-full h-full object-cover",onError:q=>{q.currentTarget.style.display="none";const F=q.currentTarget.nextElementSibling;F&&(F.style.display="flex")}}):null,i.jsx("div",{className:"text-2xl",style:{display:_.thumbnail_url?"none":"flex"},children:S(e)}),e==="video"&&((O=_.video)==null?void 0:O.duration_seconds)&&i.jsx("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:v(_.video.duration_seconds)}),e==="document"&&((k=_.document)==null?void 0:k.reading_time_minutes)&&i.jsxs("div",{className:"absolute bottom-2 right-2 bg-blue-600 bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:[_.document.reading_time_minutes," min read"]}),e==="prompt"&&((I=_.prompt)==null?void 0:I.usage_count)!==void 0&&i.jsxs("div",{className:"absolute bottom-2 right-2 bg-green-600 bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:["Used ",_.prompt.usage_count,"x"]}),e==="automation"&&((C=_.automation)==null?void 0:C.required_tools)&&_.automation.required_tools.length>0&&i.jsxs("div",{className:"absolute bottom-2 right-2 bg-purple-600 bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:[_.automation.required_tools.length," tools"]})]}),i.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:_.title}),i.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:_.description}),i.jsxs("div",{className:"flex items-center justify-between mt-2",children:[i.jsx("p",{className:"text-xs text-gray-500",children:new Date(_.updated_at||_.created_at).toLocaleDateString()}),_.status&&i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${_.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:_.status})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[i.jsxs("div",{className:"w-16 h-12 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden",children:[_.thumbnail_url?i.jsx("img",{src:_.thumbnail_url,alt:_.title,className:"w-full h-full object-cover",onError:q=>{q.currentTarget.style.display="none";const F=q.currentTarget.nextElementSibling;F&&(F.style.display="flex")}}):null,i.jsx("div",{className:"text-lg",style:{display:_.thumbnail_url?"none":"flex"},children:S(e)})]}),e==="video"&&((A=_.video)==null?void 0:A.duration_seconds)&&i.jsx("div",{className:"absolute bottom-0 right-0 bg-black bg-opacity-75 text-white text-xs px-1 py-0.5 rounded",children:v(_.video.duration_seconds)}),e==="document"&&((T=_.document)==null?void 0:T.reading_time_minutes)&&i.jsxs("div",{className:"absolute bottom-0 right-0 bg-blue-600 bg-opacity-75 text-white text-xs px-1 py-0.5 rounded",children:[_.document.reading_time_minutes,"m"]}),e==="prompt"&&((P=_.prompt)==null?void 0:P.usage_count)!==void 0&&i.jsxs("div",{className:"absolute bottom-0 right-0 bg-green-600 bg-opacity-75 text-white text-xs px-1 py-0.5 rounded",children:[_.prompt.usage_count,"x"]}),e==="automation"&&((R=_.automation)==null?void 0:R.required_tools)&&_.automation.required_tools.length>0&&i.jsx("div",{className:"absolute bottom-0 right-0 bg-purple-600 bg-opacity-75 text-white text-xs px-1 py-0.5 rounded",children:_.automation.required_tools.length})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"font-medium text-gray-900 truncate",children:_.title}),_.status&&i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ml-2 ${_.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:_.status})]}),i.jsx("p",{className:"text-sm text-gray-600 truncate",children:_.description}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(_.updated_at||_.created_at).toLocaleDateString()})]})]})},_.id)}),'"']})}),i.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:s?"Loading...":c?"Error loading content":`${j.length} ${e}${j.length!==1?"s":""} ${f?"found":"available"}`}),p&&!c&&i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"Published only"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors",children:"Cancel"}),i.jsx("button",{disabled:j.length===0||s||!!c,className:`px-4 py-2 rounded-lg transition-colors ${j.length===0||s||c?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:"Select Content"})]})]})]})})}function Vte(){const e=zt(),[t]=xw(),r=t.get("id"),n=!!r,[a,s]=L.useState({title:"New Program",description:"",status:"draft",sections:[{id:"section-1",title:"Introduction",order:1,isExpanded:!0,subsections:[]}],settings:{difficulty:"beginner",estimatedDurationWeeks:8,programType:"strength",tags:[]}}),[o,c]=L.useState(null),[u,f]=L.useState(n),[m,h]=L.useState(!1),[g,p]=L.useState(null),[x,y]=L.useState(null),[v,N]=L.useState({type:"wods",isOpen:!1,subsectionId:null});L.useEffect(()=>{n&&r&&j(r)},[n,r]);const j=async k=>{var I;try{f(!0);const{data:{session:C}}=await ce.auth.getSession();if(!C)throw new Error("User not authenticated");const T=`https://givgsxytkbsdrlmoxzkp.supabase.co/functions/v1/programs-api?id=${k}`,P=await fetch(T,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA"}});if(!P.ok){const H=await P.json();throw new Error(((I=H.error)==null?void 0:I.message)||`Failed to load program: ${P.status}`)}const q=(await P.json()).data;if(!q)throw new Error("Program not found");const F={id:q.id,title:q.title,description:q.description||"",status:q.status,sections:q.sections||[{id:"section-1",title:"Introduction",order:1,isExpanded:!0,subsections:[]}],settings:{difficulty:q.difficulty_level||"beginner",estimatedDurationWeeks:q.estimated_duration_weeks||8,programType:q.program_type||"strength",tags:q.tags||[]}};s(F)}catch(C){p("Failed to load program data"),console.error("Load error:",C)}finally{f(!1)}},S=async()=>{var k,I;try{h(!0),p(null),y(null);const{data:{session:C}}=await ce.auth.getSession();if(!C)throw new Error("User not authenticated. Please log in and try again.");const A={title:a.title,description:a.description,status:a.status,difficulty_level:a.settings.difficulty,estimated_duration_weeks:a.settings.estimatedDurationWeeks,program_type:a.settings.programType,tags:a.settings.tags,sections:a.sections,settings:a.settings},T="https://givgsxytkbsdrlmoxzkp.supabase.co",P=n?"PUT":"POST",R=n?`${T}/functions/v1/programs-api?id=${r}`:`${T}/functions/v1/programs-api`,q=await fetch(R,{method:P,headers:{"Content-Type":"application/json",Authorization:`Bearer ${C.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpdmdzeHl0a2JzZHJsbW94emtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTM1NTQsImV4cCI6MjA3MTY2OTU1NH0.dUHOfO0-8i90ebOy0HsrZqsoYqwNx1hpbUTRurLcMBA"},body:JSON.stringify(A)});if(!q.ok){const H=await q.json();throw new Error(((k=H.error)==null?void 0:k.message)||`Failed to save program: ${q.status}`)}const F=await q.json();!n&&((I=F==null?void 0:F.data)!=null&&I.id)&&e(`/program-builder?id=${F.data.id}`),y("Program saved successfully!"),setTimeout(()=>y(null),3e3)}catch(C){const A=C instanceof Error?C.message:"Failed to save program";p(A),console.error("Save error:",A)}finally{h(!1)}},w=()=>{e("/training-zone/programs")},_=(k,I)=>{N({type:I,isOpen:!0,subsectionId:k})},O=k=>{v.subsectionId&&(s(I=>({...I,sections:I.sections.map(C=>({...C,subsections:C.subsections.map(A=>A.id===v.subsectionId?{...A,assignedContent:{type:v.type,id:k.id,title:k.title,thumbnail_url:k.thumbnail_url,description:k.description}}:A)}))})),N({type:"wods",isOpen:!1,subsectionId:null}))};return u?i.jsx(Rt,{children:i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading Program Builder..."})]})})}):i.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col overflow-hidden",children:[i.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg transition-colors",children:i.jsx(ri,{className:"h-5 w-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Program":"Create New Program"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Build hierarchical training programs with sections and subsections"})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[g&&i.jsx("div",{className:"text-sm text-red-600 bg-red-50 px-3 py-2 rounded-lg",children:g}),x&&i.jsx("div",{className:"text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg",children:x}),i.jsx("button",{onClick:S,disabled:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?i.jsxs(i.Fragment,{children:[i.jsx(Ge,{size:"sm",className:"mr-2"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(sl,{className:"-ml-1 mr-2 h-4 w-4"}),"Save Program"]})})]})]})}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsxs("div",{className:"w-1/2 bg-white border-r border-gray-200 flex flex-col",children:[i.jsxs("div",{className:"border-b border-gray-200 px-6 py-4",children:[i.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Program Structure"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create sections and subsections to organize your training program"})]}),i.jsx(Wte,{programData:a,setProgramData:s,onAssignContent:_,onSubsectionSelect:c,selectedSubsectionId:o})]}),i.jsxs("div",{className:"w-1/2 bg-gray-50 flex flex-col",children:[i.jsxs("div",{className:"border-b border-gray-200 bg-white px-6 py-4",children:[i.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Preview"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Navigate through subsections with assigned content"})]}),i.jsx(Hte,{programData:a,currentSubsectionId:o,onSubsectionSelect:c})]})]}),v.isOpen&&i.jsx(s6,{contentType:v.type,onContentSelect:O,onClose:()=>N({type:"wods",isOpen:!1,subsectionId:null})})]})}function Kte(){const{id:e}=Ur(),t=zt(),r=!!e,[n,a]=L.useState(null),[s,o]=L.useState({title:"",description:"",thumbnail_url:"",status:"draft",estimated_duration_minutes:30,difficulty_level:"beginner",tags:[]}),[c,u]=L.useState(""),[f,m]=L.useState(r),[h,g]=L.useState(!1),[p,x]=L.useState(null),[y,v]=L.useState(null);L.useEffect(()=>{r&&e&&N(e)},[r,e]);const N=async C=>{try{m(!0),x(null);const{data:A,error:T}=await ce.functions.invoke("wods-api",{method:"GET",body:null,headers:{"Content-Type":"application/json"}});if(T)throw new Error(T.message||"Failed to fetch WOD");if(!(A!=null&&A.data))throw new Error("WOD not found");const P=Array.isArray(A.data)?A.data.find(R=>R.id===C):A.data.id===C?A.data:null;if(!P)throw new Error("WOD not found");a(P),o({title:P.title||"",description:P.description||"",thumbnail_url:P.thumbnail_url||"",status:P.status||"draft",estimated_duration_minutes:P.estimated_duration_minutes||30,difficulty_level:P.difficulty_level||"beginner",tags:P.tags||[]})}catch(A){console.error("Error fetching WOD:",A),x(A instanceof Error?A.message:"Failed to load WOD")}finally{m(!1)}},j=(C,A)=>{o(T=>({...T,[C]:A})),y&&v(null),p&&x(null)},S=()=>{c.trim()&&!s.tags.includes(c.trim())&&(o(C=>({...C,tags:[...C.tags,c.trim()]})),u(""))},w=C=>{o(A=>({...A,tags:A.tags.filter(T=>T!==C)}))},_=C=>{C.key==="Enter"&&(C.preventDefault(),S())},O=()=>s.title.trim()?s.estimated_duration_minutes<=0?"Duration must be greater than 0":null:"Title is required",k=async()=>{var A,T;const C=O();if(C){x(C);return}try{g(!0),x(null),v(null);const P=r?"PUT":"POST",R=r?`?id=${e}`:"",{data:q,error:F}=await ce.functions.invoke("wods-api"+R,{method:P,body:s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${(A=(await ce.auth.getSession()).data.session)==null?void 0:A.access_token}`}});if(F)throw new Error(F.message||`Failed to ${r?"update":"create"} WOD`);v(`WOD ${r?"updated":"created"} successfully!`),!r&&((T=q==null?void 0:q.data)!=null&&T.id)&&setTimeout(()=>{t(`/training-zone/wods/${q.data.id}/edit`)},1500)}catch(P){console.error("Error saving WOD:",P),x(P instanceof Error?P.message:"Failed to save WOD")}finally{g(!1)}},I=()=>{t("/training-zone/wods")};return f?i.jsx(Rt,{children:i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ge,{size:"lg"}),i.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Loading WOD..."})]})})}):i.jsx(Rt,{children:i.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("button",{onClick:I,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(ri,{className:"h-5 w-5"})}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"h-10 w-10 bg-orange-600 rounded-lg flex items-center justify-center",children:i.jsx(Kt,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"Edit WOD":"Create New WOD"}),i.jsx("p",{className:"text-sm text-gray-600",children:r?"Update your workout program":"Design a new workout of the day"})]})]})]}),i.jsx("div",{className:"flex items-center space-x-3",children:i.jsxs("button",{onClick:k,disabled:h,className:"inline-flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[h?i.jsx(Ge,{size:"sm",className:"mr-2"}):i.jsx(sl,{className:"-ml-1 mr-2 h-4 w-4"}),h?"Saving...":r?"Update WOD":"Create WOD"]})})]}),p&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3",children:[i.jsx(us,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),i.jsx("span",{className:"text-red-700",children:p})]}),y&&i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center space-x-3",children:[i.jsx(_r,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),i.jsx("span",{className:"text-green-700",children:y})]}),i.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"lg:col-span-2",children:[i.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),i.jsx("input",{type:"text",id:"title",value:s.title,onChange:C=>j("title",C.target.value),placeholder:"Enter WOD title...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),i.jsxs("div",{className:"lg:col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),i.jsx("textarea",{id:"description",rows:4,value:s.description,onChange:C=>j("description",C.target.value),placeholder:"Describe this workout program...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"thumbnail_url",className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(xa,{className:"inline h-4 w-4 mr-1"}),"Thumbnail URL"]}),i.jsx("input",{type:"url",id:"thumbnail_url",value:s.thumbnail_url,onChange:C=>j("thumbnail_url",C.target.value),placeholder:"https://example.com/image.jpg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Ut,{className:"inline h-4 w-4 mr-1"}),"Publication Status"]}),i.jsxs("select",{id:"status",value:s.status,onChange:C=>j("status",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[i.jsx("option",{value:"draft",children:"Draft"}),i.jsx("option",{value:"published",children:"Published"}),i.jsx("option",{value:"archived",children:"Archived"})]})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Workout Details"}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(pn,{className:"inline h-4 w-4 mr-1"}),"Estimated Duration (minutes) *"]}),i.jsx("input",{type:"number",id:"duration",min:"1",max:"300",value:s.estimated_duration_minutes,onChange:C=>j("estimated_duration_minutes",parseInt(C.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"difficulty",className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Dc,{className:"inline h-4 w-4 mr-1"}),"Difficulty Level"]}),i.jsxs("select",{id:"difficulty",value:s.difficulty_level,onChange:C=>j("difficulty_level",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[i.jsx("option",{value:"beginner",children:"Beginner"}),i.jsx("option",{value:"intermediate",children:"Intermediate"}),i.jsx("option",{value:"advanced",children:"Advanced"})]})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[i.jsx(Bx,{className:"inline h-5 w-5 mr-1"}),"Tags"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("input",{type:"text",value:c,onChange:C=>u(C.target.value),onKeyPress:_,placeholder:"Add a tag...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),i.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Add"})]}),s.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((C,A)=>i.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-orange-100 text-orange-800",children:[C,i.jsx("button",{type:"button",onClick:()=>w(C),className:"ml-2 text-orange-600 hover:text-orange-800",children:""})]},A))})]})]}),s.thumbnail_url&&i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Thumbnail Preview"}),i.jsx("div",{className:"max-w-md",children:i.jsx("img",{src:s.thumbnail_url,alt:"Thumbnail preview",className:"w-full h-48 object-cover rounded-lg border border-gray-300",onError:C=>{C.currentTarget.style.display="none"}})})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Next Steps"}),i.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[i.jsx("p",{children:" After saving your WOD, you can add pages and content blocks using the page builder"}),i.jsx("p",{children:" Use the assignment system to distribute this WOD to specific communities or users"}),i.jsx("p",{children:" Monitor engagement and completion rates through the analytics dashboard"})]})]})]})})}function Gte({activeMenu:e,onMenuToggle:t}){const r=[{id:"settings",icon:xs,title:"WOD Settings",description:"Configure WOD metadata and targeting"},{id:"elements",icon:_t,title:"Elements",description:"Basic building blocks"},{id:"content",icon:mt,title:"Content",description:"Repository content blocks"},{id:"pages",icon:HL,title:"Pages",description:"Page management"}];return i.jsx("div",{className:"w-16 bg-gray-900 flex flex-col items-center py-4 z-50",children:i.jsx("div",{className:"flex flex-col space-y-4",children:r.map((n,a)=>{const s=n.icon,o=e===n.id;return i.jsxs("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),console.log("FixedLeftRail button clicked - Index:",a,"ID:",n.id,"Title:",n.title),t(n.id)},className:`
grep: write error: Broken pipe
